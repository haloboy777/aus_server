var L=Object.defineProperty;var g=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var f=(o,e,t)=>e in o?L(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,y=(o,e)=>{for(var t in e||(e={}))S.call(e,t)&&f(o,t,e[t]);if(g)for(var t of g(e))C.call(e,t)&&f(o,t,e[t]);return o};var a=(o,e,t)=>(f(o,typeof e!="symbol"?e+"":e,t),t);import{s as h,P as w,I as M,r as B,j as n,L as I,a as O,b as c,T as p,c as D,d as x,R as m,B as T,A as P,e as F,f as j,g as A,h as E,i as R,m as u,k as b,F as v,l as _,n as z,o as G}from"./vendor.384a7eb5.js";const N=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};N();function K(o=0){return new Promise(e=>{setTimeout(e,o)})}const W=h(w)(({theme:o})=>({position:"fixed",zIndex:1400,width:300,[o.breakpoints.up("sm")]:{width:"43.5ch"}})),U=h(M)(({theme:o})=>({color:"inherit",width:"100%","& .MuiInputBase-input":{padding:o.spacing(1,1,1,0),paddingLeft:`calc(1em + ${o.spacing(4)})`,transition:o.transitions.create("width"),width:"100%",[o.breakpoints.up("sm")]:{width:"28ch","&:focus":{width:"36ch"}}}}));class $ extends B.exports.Component{constructor(e){super(e);a(this,"onFocus",()=>{this.setState({isSearchOpen:!0,suggestions:[]})});a(this,"onChange",e=>{e.target.value.length!==0&&this.fetchSuggestion(e.target.value)});a(this,"onKeyDown",e=>{e.key==="Enter"});a(this,"onBlur",async e=>{await K(150),this.setState({isSearchOpen:!1})});a(this,"suggestionItem",(e,t)=>n(I,{onClick:()=>this.props.onOptionClicked(e),children:n(O,{primary:e.title,secondary:c(p,{color:"text.secondary",variant:"body2",component:"p",children:[e.location,n("br",{}),e.actor1+", "+e.actor2+", "+e.actor3]})})},t));a(this,"fetchSuggestion",async e=>{let t;try{t=await(await fetch("/api/search?q="+e)).json(),this.setState({suggestions:t})}catch(s){console.log(s)}});this.state={isSearchOpen:!1,suggestions:[]}}render(){return c("div",{children:[n(U,{placeholder:"Search Movie, Location, Actor\u2026",inputProps:{onFocus:this.onFocus,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,"aria-label":"search"}}),this.state.isSearchOpen&&n(W,{children:n(D,{children:this.state.suggestions.map(this.suggestionItem)})})]})}}const H=h("div")(({theme:o})=>({position:"relative",borderRadius:o.shape.borderRadius,backgroundColor:x(o.palette.common.white,.15),"&:hover":{backgroundColor:x(o.palette.common.white,.25)},marginLeft:0,width:"100%",[o.breakpoints.up("sm")]:{marginLeft:o.spacing(1),width:"auto"}})),Q=h("div")(({theme:o})=>({padding:o.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}));class J extends m.Component{constructor(e){super(e)}render(){return n(T,{sx:{flexGrow:1},children:n(P,{position:"static",children:c(F,{children:[n(p,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:"AUS Movie Map"}),n(j,{size:"small",color:"inherit",sx:{mr:1},onClick:()=>this.props.changeMode(),children:this.props.mode==="light"?n(A,{}):n(E,{})}),c(H,{children:[n(Q,{children:n(R,{})}),n($,{onOptionClicked:e=>this.props.onOptionClicked(e)})]})]})})})}}const k="pk.eyJ1IjoiYWtzLXRyeWl0IiwiYSI6ImNrdmRlbnJ5ZDZ5azkyb3M3NDBpeWxhYmcifQ.jQvHGw0T9zNJhSRF1QmrjQ";var d;(function(o){o.LIGHT="streets-v11",o.DARK="dark-v10",o.SATELLITE="satellite-v9"})(d||(d={}));class Y{constructor(e,t,s){a(this,"map");a(this,"defaultStyle","mapbox://styles/mapbox/");if(u.accessToken=k,!document.getElementById(e))throw new Error("map div not found! check if div#"+e+" exists");this.map=new u.Map({container:e,style:this.defaultStyle+d.LIGHT,center:t,zoom:s||9})}addMarker(e,t){return new u.Marker({color:"red"}).setLngLat(e).setPopup(new u.Popup({offset:25}).setText(t)).addTo(this.map)}changeStyle(e){this.map.setStyle(this.defaultStyle+e)}}const q=h(w)(({theme:o})=>({width:314,height:"auto",padding:20,position:"fixed",right:10,top:"inherit",bottom:10,transition:"transform 0.5s, opacity 0.5s",[o.breakpoints.up("sm")]:{width:360,top:74,bottom:"inherit"}}));class X extends m.Component{constructor(e){super(e);a(this,"markers");a(this,"getFilmLocations",async e=>e?(await(await fetch("/api/getFilmLocations?film="+e)).json()).map(r=>r.location):[]);a(this,"getCoordinatesForLoc",async e=>{var r;return((r=(await(await fetch("https://api.mapbox.com/geocoding/v5/mapbox.places/"+e+".json?bbox=-122.56373153395461%2C37.59355295186727%2C-122.34817039626597%2C37.828163031434954&limit=1&fuzzyMatch=true&access_token="+k)).json()).features[0])==null?void 0:r.center)||[]});this.markers=[]}async getDataOnUpdate(){var r;this.removeMarkers();let e=await this.getFilmLocations((r=this.props.data)==null?void 0:r.title),t=await Promise.all(e.map(i=>this.getCoordinatesForLoc(i))),s=e.map((i,l)=>({text:i,coordinates:t[l]}));this.markers=s.filter(i=>i.coordinates.length>0).map(i=>this.addMarkers(i))}addMarkers(e){var t;return(t=this.props.map)==null?void 0:t.addMarker(new b.exports.LngLat(e.coordinates[0],e.coordinates[1]),e.text)}removeMarkers(){this.markers.forEach(e=>e&&e.remove())}async componentDidMount(){await this.getDataOnUpdate()}async componentDidUpdate(){await this.getDataOnUpdate()}render(){const{data:e}=this.props,t=[e==null?void 0:e.actor1,e==null?void 0:e.actor2,e==null?void 0:e.actor3];return n(q,{className:"mainPaper",children:c("div",{children:[n(p,{variant:"h4",children:e==null?void 0:e.title}),n("br",{}),t.length>0&&c(p,{variant:"body1",component:"p",children:["Actors: ",t.join(", ")]}),(e==null?void 0:e.writer)&&c(p,{variant:"caption",component:"p",children:["Writer: ",e==null?void 0:e.writer]}),(e==null?void 0:e.director)&&c(p,{variant:"caption",component:"p",children:["Director: ",e==null?void 0:e.director]}),(e==null?void 0:e.production_company)&&c(p,{variant:"caption",component:"p",children:["Production Company: ",e==null?void 0:e.production_company]}),(e==null?void 0:e.distributor)&&c(p,{variant:"caption",component:"p",children:["Distributor: ",e==null?void 0:e.distributor]}),(e==null?void 0:e.fun_fact)&&c(v,{children:[n("br",{}),n(p,{variant:"h5",children:"Fun Fact"}),n(p,{variant:"body2",children:e==null?void 0:e.fun_fact})]}),(e==null?void 0:e.location)&&c(v,{children:[n("br",{}),n(p,{variant:"h5",children:"Location"}),n(p,{variant:"body2",children:e==null?void 0:e.location})]})]})})}}class Z extends m.Component{constructor(e){super(e);a(this,"map");a(this,"onOptionClicked",e=>{this.setState({infoBoxOpen:!0,infoBoxData:e})});a(this,"changeMode",()=>{var t,s;let e;this.state.mode==="light"?(e="dark",(t=this.map)==null||t.changeStyle(d.DARK)):(e="light",(s=this.map)==null||s.changeStyle(d.LIGHT)),this.setState({mode:e})});this.state={mode:"light",infoBoxOpen:!1,infoBoxData:void 0}}componentDidMount(){this.map=new Y("map",new b.exports.LngLat(-122.431297,37.773972),9)}render(){const e={changeMode:this.changeMode,mode:this.state.mode,onOptionClicked:this.onOptionClicked},t=_({palette:{mode:this.state.mode,primary:{main:"#2c4d35"},secondary:{main:"#0f73b7"}}});return c(z,{theme:t,children:[n(J,y({},e)),n("div",{id:"map",style:{height:"100%",width:"100%"}}),this.state.infoBoxOpen&&n(X,{data:this.state.infoBoxData,map:this.map})]})}}G.render(n(m.StrictMode,{children:n(Z,{})}),document.getElementById("root"));
