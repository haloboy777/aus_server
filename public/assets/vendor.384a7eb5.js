var RS=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Vx(t){if(t.__esModule)return t;var o=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(c){var m=Object.getOwnPropertyDescriptor(t,c);Object.defineProperty(o,c,m.get?m:{enumerable:!0,get:function(){return t[c]}})}),o}var Oe={exports:{}},Qt={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var $x=Object.getOwnPropertySymbols,LS=Object.prototype.hasOwnProperty,BS=Object.prototype.propertyIsEnumerable;function FS(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function OS(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var o={},c=0;c<10;c++)o["_"+String.fromCharCode(c)]=c;var m=Object.getOwnPropertyNames(o).map(function(T){return o[T]});if(m.join("")!=="0123456789")return!1;var x={};return"abcdefghijklmnopqrst".split("").forEach(function(T){x[T]=T}),Object.keys(Object.assign({},x)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var jx=OS()?Object.assign:function(t,o){for(var c,m=FS(t),x,T=1;T<arguments.length;T++){c=Object(arguments[T]);for(var k in c)LS.call(c,k)&&(m[k]=c[k]);if($x){x=$x(c);for(var a=0;a<x.length;a++)BS.call(c,x[a])&&(m[x[a]]=c[x[a]])}}return m};/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qm=jx,Nl=60103,Gx=60106;Qt.Fragment=60107;Qt.StrictMode=60108;Qt.Profiler=60114;var Zx=60109,qx=60110,Wx=60112;Qt.Suspense=60113;var Xx=60115,Hx=60116;if(typeof Symbol=="function"&&Symbol.for){var Xi=Symbol.for;Nl=Xi("react.element"),Gx=Xi("react.portal"),Qt.Fragment=Xi("react.fragment"),Qt.StrictMode=Xi("react.strict_mode"),Qt.Profiler=Xi("react.profiler"),Zx=Xi("react.provider"),qx=Xi("react.context"),Wx=Xi("react.forward_ref"),Qt.Suspense=Xi("react.suspense"),Xx=Xi("react.memo"),Hx=Xi("react.lazy")}var Kx=typeof Symbol=="function"&&Symbol.iterator;function NS(t){return t===null||typeof t!="object"?null:(t=Kx&&t[Kx]||t["@@iterator"],typeof t=="function"?t:null)}function Pu(t){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+t,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+t+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qx={};function Ul(t,o,c){this.props=t,this.context=o,this.refs=Qx,this.updater=c||Yx}Ul.prototype.isReactComponent={};Ul.prototype.setState=function(t,o){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(Pu(85));this.updater.enqueueSetState(this,t,o,"setState")};Ul.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jx(){}Jx.prototype=Ul.prototype;function Jm(t,o,c){this.props=t,this.context=o,this.refs=Qx,this.updater=c||Yx}var eg=Jm.prototype=new Jx;eg.constructor=Jm;Qm(eg,Ul.prototype);eg.isPureReactComponent=!0;var tg={current:null},ev=Object.prototype.hasOwnProperty,tv={key:!0,ref:!0,__self:!0,__source:!0};function nv(t,o,c){var m,x={},T=null,k=null;if(o!=null)for(m in o.ref!==void 0&&(k=o.ref),o.key!==void 0&&(T=""+o.key),o)ev.call(o,m)&&!tv.hasOwnProperty(m)&&(x[m]=o[m]);var a=arguments.length-2;if(a===1)x.children=c;else if(1<a){for(var B=Array(a),W=0;W<a;W++)B[W]=arguments[W+2];x.children=B}if(t&&t.defaultProps)for(m in a=t.defaultProps,a)x[m]===void 0&&(x[m]=a[m]);return{$$typeof:Nl,type:t,key:T,ref:k,props:x,_owner:tg.current}}function US(t,o){return{$$typeof:Nl,type:t.type,key:o,ref:t.ref,props:t.props,_owner:t._owner}}function ng(t){return typeof t=="object"&&t!==null&&t.$$typeof===Nl}function VS(t){var o={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(c){return o[c]})}var rv=/\/+/g;function rg(t,o){return typeof t=="object"&&t!==null&&t.key!=null?VS(""+t.key):o.toString(36)}function rp(t,o,c,m,x){var T=typeof t;(T==="undefined"||T==="boolean")&&(t=null);var k=!1;if(t===null)k=!0;else switch(T){case"string":case"number":k=!0;break;case"object":switch(t.$$typeof){case Nl:case Gx:k=!0}}if(k)return k=t,x=x(k),t=m===""?"."+rg(k,0):m,Array.isArray(x)?(c="",t!=null&&(c=t.replace(rv,"$&/")+"/"),rp(x,o,c,"",function(W){return W})):x!=null&&(ng(x)&&(x=US(x,c+(!x.key||k&&k.key===x.key?"":(""+x.key).replace(rv,"$&/")+"/")+t)),o.push(x)),1;if(k=0,m=m===""?".":m+":",Array.isArray(t))for(var a=0;a<t.length;a++){T=t[a];var B=m+rg(T,a);k+=rp(T,o,c,B,x)}else if(B=NS(t),typeof B=="function")for(t=B.call(t),a=0;!(T=t.next()).done;)T=T.value,B=m+rg(T,a++),k+=rp(T,o,c,B,x);else if(T==="object")throw o=""+t,Error(Pu(31,o==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":o));return k}function ip(t,o,c){if(t==null)return t;var m=[],x=0;return rp(t,m,"","",function(T){return o.call(c,T,x++)}),m}function $S(t){if(t._status===-1){var o=t._result;o=o(),t._status=0,t._result=o,o.then(function(c){t._status===0&&(c=c.default,t._status=1,t._result=c)},function(c){t._status===0&&(t._status=2,t._result=c)})}if(t._status===1)return t._result;throw t._result}var iv={current:null};function No(){var t=iv.current;if(t===null)throw Error(Pu(321));return t}var jS={ReactCurrentDispatcher:iv,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:tg,IsSomeRendererActing:{current:!1},assign:Qm};Qt.Children={map:ip,forEach:function(t,o,c){ip(t,function(){o.apply(this,arguments)},c)},count:function(t){var o=0;return ip(t,function(){o++}),o},toArray:function(t){return ip(t,function(o){return o})||[]},only:function(t){if(!ng(t))throw Error(Pu(143));return t}};Qt.Component=Ul;Qt.PureComponent=Jm;Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jS;Qt.cloneElement=function(t,o,c){if(t==null)throw Error(Pu(267,t));var m=Qm({},t.props),x=t.key,T=t.ref,k=t._owner;if(o!=null){if(o.ref!==void 0&&(T=o.ref,k=tg.current),o.key!==void 0&&(x=""+o.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(B in o)ev.call(o,B)&&!tv.hasOwnProperty(B)&&(m[B]=o[B]===void 0&&a!==void 0?a[B]:o[B])}var B=arguments.length-2;if(B===1)m.children=c;else if(1<B){a=Array(B);for(var W=0;W<B;W++)a[W]=arguments[W+2];m.children=a}return{$$typeof:Nl,type:t.type,key:x,ref:T,props:m,_owner:k}};Qt.createContext=function(t,o){return o===void 0&&(o=null),t={$$typeof:qx,_calculateChangedBits:o,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:Zx,_context:t},t.Consumer=t};Qt.createElement=nv;Qt.createFactory=function(t){var o=nv.bind(null,t);return o.type=t,o};Qt.createRef=function(){return{current:null}};Qt.forwardRef=function(t){return{$$typeof:Wx,render:t}};Qt.isValidElement=ng;Qt.lazy=function(t){return{$$typeof:Hx,_payload:{_status:-1,_result:t},_init:$S}};Qt.memo=function(t,o){return{$$typeof:Xx,type:t,compare:o===void 0?null:o}};Qt.useCallback=function(t,o){return No().useCallback(t,o)};Qt.useContext=function(t,o){return No().useContext(t,o)};Qt.useDebugValue=function(){};Qt.useEffect=function(t,o){return No().useEffect(t,o)};Qt.useImperativeHandle=function(t,o,c){return No().useImperativeHandle(t,o,c)};Qt.useLayoutEffect=function(t,o){return No().useLayoutEffect(t,o)};Qt.useMemo=function(t,o){return No().useMemo(t,o)};Qt.useReducer=function(t,o,c){return No().useReducer(t,o,c)};Qt.useRef=function(t){return No().useRef(t)};Qt.useState=function(t){return No().useState(t)};Qt.version="17.0.2";Oe.exports=Qt;var Du=Oe.exports,ov={exports:{}},Ai={},sv={exports:{}},av={};/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){var o,c,m,x;if(typeof performance=="object"&&typeof performance.now=="function"){var T=performance;t.unstable_now=function(){return T.now()}}else{var k=Date,a=k.now();t.unstable_now=function(){return k.now()-a}}if(typeof window=="undefined"||typeof MessageChannel!="function"){var B=null,W=null,ce=function(){if(B!==null)try{var He=t.unstable_now();B(!0,He),B=null}catch(Ye){throw setTimeout(ce,0),Ye}};o=function(He){B!==null?setTimeout(o,0,He):(B=He,setTimeout(ce,0))},c=function(He,Ye){W=setTimeout(He,Ye)},m=function(){clearTimeout(W)},t.unstable_shouldYield=function(){return!1},x=t.unstable_forceFrameRate=function(){}}else{var J=window.setTimeout,q=window.clearTimeout;if(typeof console!="undefined"){var ve=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof ve!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var Ae=!1,Se=null,ee=-1,Q=5,re=0;t.unstable_shouldYield=function(){return t.unstable_now()>=re},x=function(){},t.unstable_forceFrameRate=function(He){0>He||125<He?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<He?Math.floor(1e3/He):5};var Te=new MessageChannel,xe=Te.port2;Te.port1.onmessage=function(){if(Se!==null){var He=t.unstable_now();re=He+Q;try{Se(!0,He)?xe.postMessage(null):(Ae=!1,Se=null)}catch(Ye){throw xe.postMessage(null),Ye}}else Ae=!1},o=function(He){Se=He,Ae||(Ae=!0,xe.postMessage(null))},c=function(He,Ye){ee=J(function(){He(t.unstable_now())},Ye)},m=function(){q(ee),ee=-1}}function Ve(He,Ye){var ut=He.length;He.push(Ye);e:for(;;){var Mt=ut-1>>>1,Jt=He[Mt];if(Jt!==void 0&&0<We(Jt,Ye))He[Mt]=Ye,He[ut]=Jt,ut=Mt;else break e}}function Ie(He){return He=He[0],He===void 0?null:He}function $e(He){var Ye=He[0];if(Ye!==void 0){var ut=He.pop();if(ut!==Ye){He[0]=ut;e:for(var Mt=0,Jt=He.length;Mt<Jt;){var Nn=2*(Mt+1)-1,kn=He[Nn],_t=Nn+1,Ft=He[_t];if(kn!==void 0&&0>We(kn,ut))Ft!==void 0&&0>We(Ft,kn)?(He[Mt]=Ft,He[_t]=ut,Mt=_t):(He[Mt]=kn,He[Nn]=ut,Mt=Nn);else if(Ft!==void 0&&0>We(Ft,ut))He[Mt]=Ft,He[_t]=ut,Mt=_t;else break e}}return Ye}return null}function We(He,Ye){var ut=He.sortIndex-Ye.sortIndex;return ut!==0?ut:He.id-Ye.id}var je=[],ot=[],zt=1,Rt=null,St=3,Zt=!1,Ht=!1,qt=!1;function Wt(He){for(var Ye=Ie(ot);Ye!==null;){if(Ye.callback===null)$e(ot);else if(Ye.startTime<=He)$e(ot),Ye.sortIndex=Ye.expirationTime,Ve(je,Ye);else break;Ye=Ie(ot)}}function xn(He){if(qt=!1,Wt(He),!Ht)if(Ie(je)!==null)Ht=!0,o(an);else{var Ye=Ie(ot);Ye!==null&&c(xn,Ye.startTime-He)}}function an(He,Ye){Ht=!1,qt&&(qt=!1,m()),Zt=!0;var ut=St;try{for(Wt(Ye),Rt=Ie(je);Rt!==null&&(!(Rt.expirationTime>Ye)||He&&!t.unstable_shouldYield());){var Mt=Rt.callback;if(typeof Mt=="function"){Rt.callback=null,St=Rt.priorityLevel;var Jt=Mt(Rt.expirationTime<=Ye);Ye=t.unstable_now(),typeof Jt=="function"?Rt.callback=Jt:Rt===Ie(je)&&$e(je),Wt(Ye)}else $e(je);Rt=Ie(je)}if(Rt!==null)var Nn=!0;else{var kn=Ie(ot);kn!==null&&c(xn,kn.startTime-Ye),Nn=!1}return Nn}finally{Rt=null,St=ut,Zt=!1}}var Ot=x;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(He){He.callback=null},t.unstable_continueExecution=function(){Ht||Zt||(Ht=!0,o(an))},t.unstable_getCurrentPriorityLevel=function(){return St},t.unstable_getFirstCallbackNode=function(){return Ie(je)},t.unstable_next=function(He){switch(St){case 1:case 2:case 3:var Ye=3;break;default:Ye=St}var ut=St;St=Ye;try{return He()}finally{St=ut}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=Ot,t.unstable_runWithPriority=function(He,Ye){switch(He){case 1:case 2:case 3:case 4:case 5:break;default:He=3}var ut=St;St=He;try{return Ye()}finally{St=ut}},t.unstable_scheduleCallback=function(He,Ye,ut){var Mt=t.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?Mt+ut:Mt):ut=Mt,He){case 1:var Jt=-1;break;case 2:Jt=250;break;case 5:Jt=1073741823;break;case 4:Jt=1e4;break;default:Jt=5e3}return Jt=ut+Jt,He={id:zt++,callback:Ye,priorityLevel:He,startTime:ut,expirationTime:Jt,sortIndex:-1},ut>Mt?(He.sortIndex=ut,Ve(ot,He),Ie(je)===null&&He===Ie(ot)&&(qt?m():qt=!0,c(xn,ut-Mt))):(He.sortIndex=Jt,Ve(je,He),Ht||Zt||(Ht=!0,o(an))),He},t.unstable_wrapCallback=function(He){var Ye=St;return function(){var ut=St;St=Ye;try{return He.apply(this,arguments)}finally{St=ut}}}})(av);sv.exports=av;/** @license React v17.0.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op=Oe.exports,Dn=jx,cr=sv.exports;function Qe(t){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+t,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+t+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!op)throw Error(Qe(227));var lv=new Set,Ru={};function Ea(t,o){Vl(t,o),Vl(t+"Capture",o)}function Vl(t,o){for(Ru[t]=o,t=0;t<o.length;t++)lv.add(o[t])}var Uo=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),GS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cv=Object.prototype.hasOwnProperty,uv={},hv={};function ZS(t){return cv.call(hv,t)?!0:cv.call(uv,t)?!1:GS.test(t)?hv[t]=!0:(uv[t]=!0,!1)}function qS(t,o,c,m){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return m?!1:c!==null?!c.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function WS(t,o,c,m){if(o===null||typeof o=="undefined"||qS(t,o,c,m))return!0;if(m)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Vr(t,o,c,m,x,T,k){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=m,this.attributeNamespace=x,this.mustUseProperty=c,this.propertyName=t,this.type=o,this.sanitizeURL=T,this.removeEmptyString=k}var xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xr[t]=new Vr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var o=t[0];xr[o]=new Vr(o,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xr[t]=new Vr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xr[t]=new Vr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xr[t]=new Vr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xr[t]=new Vr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xr[t]=new Vr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xr[t]=new Vr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xr[t]=new Vr(t,5,!1,t.toLowerCase(),null,!1,!1)});var ig=/[\-:]([a-z])/g;function og(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var o=t.replace(ig,og);xr[o]=new Vr(o,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var o=t.replace(ig,og);xr[o]=new Vr(o,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var o=t.replace(ig,og);xr[o]=new Vr(o,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xr[t]=new Vr(t,1,!1,t.toLowerCase(),null,!1,!1)});xr.xlinkHref=new Vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xr[t]=new Vr(t,1,!1,t.toLowerCase(),null,!0,!0)});function sg(t,o,c,m){var x=xr.hasOwnProperty(o)?xr[o]:null,T=x!==null?x.type===0:m?!1:!(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N");T||(WS(o,c,x,m)&&(c=null),m||x===null?ZS(o)&&(c===null?t.removeAttribute(o):t.setAttribute(o,""+c)):x.mustUseProperty?t[x.propertyName]=c===null?x.type===3?!1:"":c:(o=x.attributeName,m=x.attributeNamespace,c===null?t.removeAttribute(o):(x=x.type,c=x===3||x===4&&c===!0?"":""+c,m?t.setAttributeNS(m,o,c):t.setAttribute(o,c))))}var Ca=op.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lu=60103,ka=60106,bs=60107,ag=60108,Bu=60114,lg=60109,cg=60110,sp=60112,Fu=60113,ap=60120,lp=60115,ug=60116,hg=60121,dg=60128,dv=60129,pg=60130,fg=60131;if(typeof Symbol=="function"&&Symbol.for){var ur=Symbol.for;Lu=ur("react.element"),ka=ur("react.portal"),bs=ur("react.fragment"),ag=ur("react.strict_mode"),Bu=ur("react.profiler"),lg=ur("react.provider"),cg=ur("react.context"),sp=ur("react.forward_ref"),Fu=ur("react.suspense"),ap=ur("react.suspense_list"),lp=ur("react.memo"),ug=ur("react.lazy"),hg=ur("react.block"),ur("react.scope"),dg=ur("react.opaque.id"),dv=ur("react.debug_trace_mode"),pg=ur("react.offscreen"),fg=ur("react.legacy_hidden")}var pv=typeof Symbol=="function"&&Symbol.iterator;function Ou(t){return t===null||typeof t!="object"?null:(t=pv&&t[pv]||t["@@iterator"],typeof t=="function"?t:null)}var mg;function Nu(t){if(mg===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);mg=o&&o[1]||""}return`
`+mg+t}var gg=!1;function cp(t,o){if(!t||gg)return"";gg=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(B){var m=B}Reflect.construct(t,[],o)}else{try{o.call()}catch(B){m=B}t.call(o.prototype)}else{try{throw Error()}catch(B){m=B}t()}}catch(B){if(B&&m&&typeof B.stack=="string"){for(var x=B.stack.split(`
`),T=m.stack.split(`
`),k=x.length-1,a=T.length-1;1<=k&&0<=a&&x[k]!==T[a];)a--;for(;1<=k&&0<=a;k--,a--)if(x[k]!==T[a]){if(k!==1||a!==1)do if(k--,a--,0>a||x[k]!==T[a])return`
`+x[k].replace(" at new "," at ");while(1<=k&&0<=a);break}}}finally{gg=!1,Error.prepareStackTrace=c}return(t=t?t.displayName||t.name:"")?Nu(t):""}function XS(t){switch(t.tag){case 5:return Nu(t.type);case 16:return Nu("Lazy");case 13:return Nu("Suspense");case 19:return Nu("SuspenseList");case 0:case 2:case 15:return t=cp(t.type,!1),t;case 11:return t=cp(t.type.render,!1),t;case 22:return t=cp(t.type._render,!1),t;case 1:return t=cp(t.type,!0),t;default:return""}}function $l(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case bs:return"Fragment";case ka:return"Portal";case Bu:return"Profiler";case ag:return"StrictMode";case Fu:return"Suspense";case ap:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case cg:return(t.displayName||"Context")+".Consumer";case lg:return(t._context.displayName||"Context")+".Provider";case sp:var o=t.render;return o=o.displayName||o.name||"",t.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case lp:return $l(t.type);case hg:return $l(t._render);case ug:o=t._payload,t=t._init;try{return $l(t(o))}catch{}}return null}function Ts(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function fv(t){var o=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function HS(t){var o=fv(t)?"checked":"value",c=Object.getOwnPropertyDescriptor(t.constructor.prototype,o),m=""+t[o];if(!t.hasOwnProperty(o)&&typeof c!="undefined"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,T=c.set;return Object.defineProperty(t,o,{configurable:!0,get:function(){return x.call(this)},set:function(k){m=""+k,T.call(this,k)}}),Object.defineProperty(t,o,{enumerable:c.enumerable}),{getValue:function(){return m},setValue:function(k){m=""+k},stopTracking:function(){t._valueTracker=null,delete t[o]}}}}function up(t){t._valueTracker||(t._valueTracker=HS(t))}function mv(t){if(!t)return!1;var o=t._valueTracker;if(!o)return!0;var c=o.getValue(),m="";return t&&(m=fv(t)?t.checked?"true":"false":t.value),t=m,t!==c?(o.setValue(t),!0):!1}function hp(t){if(t=t||(typeof document!="undefined"?document:void 0),typeof t=="undefined")return null;try{return t.activeElement||t.body}catch{return t.body}}function _g(t,o){var c=o.checked;return Dn({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c!=null?c:t._wrapperState.initialChecked})}function gv(t,o){var c=o.defaultValue==null?"":o.defaultValue,m=o.checked!=null?o.checked:o.defaultChecked;c=Ts(o.value!=null?o.value:c),t._wrapperState={initialChecked:m,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function _v(t,o){o=o.checked,o!=null&&sg(t,"checked",o,!1)}function yg(t,o){_v(t,o);var c=Ts(o.value),m=o.type;if(c!=null)m==="number"?(c===0&&t.value===""||t.value!=c)&&(t.value=""+c):t.value!==""+c&&(t.value=""+c);else if(m==="submit"||m==="reset"){t.removeAttribute("value");return}o.hasOwnProperty("value")?xg(t,o.type,c):o.hasOwnProperty("defaultValue")&&xg(t,o.type,Ts(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(t.defaultChecked=!!o.defaultChecked)}function yv(t,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var m=o.type;if(!(m!=="submit"&&m!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+t._wrapperState.initialValue,c||o===t.value||(t.value=o),t.defaultValue=o}c=t.name,c!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,c!==""&&(t.name=c)}function xg(t,o,c){(o!=="number"||hp(t.ownerDocument)!==t)&&(c==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+c&&(t.defaultValue=""+c))}function KS(t){var o="";return op.Children.forEach(t,function(c){c!=null&&(o+=c)}),o}function vg(t,o){return t=Dn({children:void 0},o),(o=KS(o.children))&&(t.children=o),t}function jl(t,o,c,m){if(t=t.options,o){o={};for(var x=0;x<c.length;x++)o["$"+c[x]]=!0;for(c=0;c<t.length;c++)x=o.hasOwnProperty("$"+t[c].value),t[c].selected!==x&&(t[c].selected=x),x&&m&&(t[c].defaultSelected=!0)}else{for(c=""+Ts(c),o=null,x=0;x<t.length;x++){if(t[x].value===c){t[x].selected=!0,m&&(t[x].defaultSelected=!0);return}o!==null||t[x].disabled||(o=t[x])}o!==null&&(o.selected=!0)}}function wg(t,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Qe(91));return Dn({},o,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xv(t,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(Qe(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(Qe(93));c=c[0]}o=c}o==null&&(o=""),c=o}t._wrapperState={initialValue:Ts(c)}}function vv(t,o){var c=Ts(o.value),m=Ts(o.defaultValue);c!=null&&(c=""+c,c!==t.value&&(t.value=c),o.defaultValue==null&&t.defaultValue!==c&&(t.defaultValue=c)),m!=null&&(t.defaultValue=""+m)}function wv(t){var o=t.textContent;o===t._wrapperState.initialValue&&o!==""&&o!==null&&(t.value=o)}var bg={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function bv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tg(t,o){return t==null||t==="http://www.w3.org/1999/xhtml"?bv(o):t==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var dp,Tv=function(t){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(o,c,m,x){MSApp.execUnsafeLocalFunction(function(){return t(o,c,m,x)})}:t}(function(t,o){if(t.namespaceURI!==bg.svg||"innerHTML"in t)t.innerHTML=o;else{for(dp=dp||document.createElement("div"),dp.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=dp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;o.firstChild;)t.appendChild(o.firstChild)}});function Uu(t,o){if(o){var c=t.firstChild;if(c&&c===t.lastChild&&c.nodeType===3){c.nodeValue=o;return}}t.textContent=o}var Vu={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},YS=["Webkit","ms","Moz","O"];Object.keys(Vu).forEach(function(t){YS.forEach(function(o){o=o+t.charAt(0).toUpperCase()+t.substring(1),Vu[o]=Vu[t]})});function Sv(t,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Vu.hasOwnProperty(t)&&Vu[t]?(""+o).trim():o+"px"}function Ev(t,o){t=t.style;for(var c in o)if(o.hasOwnProperty(c)){var m=c.indexOf("--")===0,x=Sv(c,o[c],m);c==="float"&&(c="cssFloat"),m?t.setProperty(c,x):t[c]=x}}var QS=Dn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sg(t,o){if(o){if(QS[t]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Qe(137,t));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Qe(60));if(!(typeof o.dangerouslySetInnerHTML=="object"&&"__html"in o.dangerouslySetInnerHTML))throw Error(Qe(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Qe(62))}}function Eg(t,o){if(t.indexOf("-")===-1)return typeof o.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Cg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var kg=null,Gl=null,Zl=null;function Cv(t){if(t=sh(t)){if(typeof kg!="function")throw Error(Qe(280));var o=t.stateNode;o&&(o=Mp(o),kg(t.stateNode,t.type,o))}}function kv(t){Gl?Zl?Zl.push(t):Zl=[t]:Gl=t}function Iv(){if(Gl){var t=Gl,o=Zl;if(Zl=Gl=null,Cv(t),o)for(t=0;t<o.length;t++)Cv(o[t])}}function Ig(t,o){return t(o)}function Av(t,o,c,m,x){return t(o,c,m,x)}function Ag(){}var Mv=Ig,Ia=!1,Mg=!1;function zg(){(Gl!==null||Zl!==null)&&(Ag(),Iv())}function JS(t,o,c){if(Mg)return t(o,c);Mg=!0;try{return Mv(t,o,c)}finally{Mg=!1,zg()}}function $u(t,o){var c=t.stateNode;if(c===null)return null;var m=Mp(c);if(m===null)return null;c=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(t=t.type,m=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!m;break e;default:t=!1}if(t)return null;if(c&&typeof c!="function")throw Error(Qe(231,o,typeof c));return c}var Pg=!1;if(Uo)try{var ju={};Object.defineProperty(ju,"passive",{get:function(){Pg=!0}}),window.addEventListener("test",ju,ju),window.removeEventListener("test",ju,ju)}catch{Pg=!1}function eE(t,o,c,m,x,T,k,a,B){var W=Array.prototype.slice.call(arguments,3);try{o.apply(c,W)}catch(ce){this.onError(ce)}}var Gu=!1,pp=null,fp=!1,Dg=null,tE={onError:function(t){Gu=!0,pp=t}};function nE(t,o,c,m,x,T,k,a,B){Gu=!1,pp=null,eE.apply(tE,arguments)}function rE(t,o,c,m,x,T,k,a,B){if(nE.apply(this,arguments),Gu){if(Gu){var W=pp;Gu=!1,pp=null}else throw Error(Qe(198));fp||(fp=!0,Dg=W)}}function Aa(t){var o=t,c=t;if(t.alternate)for(;o.return;)o=o.return;else{t=o;do o=t,(o.flags&1026)!=0&&(c=o.return),t=o.return;while(t)}return o.tag===3?c:null}function zv(t){if(t.tag===13){var o=t.memoizedState;if(o===null&&(t=t.alternate,t!==null&&(o=t.memoizedState)),o!==null)return o.dehydrated}return null}function Pv(t){if(Aa(t)!==t)throw Error(Qe(188))}function iE(t){var o=t.alternate;if(!o){if(o=Aa(t),o===null)throw Error(Qe(188));return o!==t?null:t}for(var c=t,m=o;;){var x=c.return;if(x===null)break;var T=x.alternate;if(T===null){if(m=x.return,m!==null){c=m;continue}break}if(x.child===T.child){for(T=x.child;T;){if(T===c)return Pv(x),t;if(T===m)return Pv(x),o;T=T.sibling}throw Error(Qe(188))}if(c.return!==m.return)c=x,m=T;else{for(var k=!1,a=x.child;a;){if(a===c){k=!0,c=x,m=T;break}if(a===m){k=!0,m=x,c=T;break}a=a.sibling}if(!k){for(a=T.child;a;){if(a===c){k=!0,c=T,m=x;break}if(a===m){k=!0,m=T,c=x;break}a=a.sibling}if(!k)throw Error(Qe(189))}}if(c.alternate!==m)throw Error(Qe(190))}if(c.tag!==3)throw Error(Qe(188));return c.stateNode.current===c?t:o}function Dv(t){if(t=iE(t),!t)return null;for(var o=t;;){if(o.tag===5||o.tag===6)return o;if(o.child)o.child.return=o,o=o.child;else{if(o===t)break;for(;!o.sibling;){if(!o.return||o.return===t)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}}return null}function Rv(t,o){for(var c=t.alternate;o!==null;){if(o===t||o===c)return!0;o=o.return}return!1}var Lv,Rg,Bv,Fv,Lg=!1,co=[],Ss=null,Es=null,Cs=null,Zu=new Map,qu=new Map,Wu=[],Ov="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bg(t,o,c,m,x){return{blockedOn:t,domEventName:o,eventSystemFlags:c|16,nativeEvent:x,targetContainers:[m]}}function Nv(t,o){switch(t){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":Zu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":qu.delete(o.pointerId)}}function Xu(t,o,c,m,x,T){return t===null||t.nativeEvent!==T?(t=Bg(o,c,m,x,T),o!==null&&(o=sh(o),o!==null&&Rg(o)),t):(t.eventSystemFlags|=m,o=t.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),t)}function oE(t,o,c,m,x){switch(o){case"focusin":return Ss=Xu(Ss,t,o,c,m,x),!0;case"dragenter":return Es=Xu(Es,t,o,c,m,x),!0;case"mouseover":return Cs=Xu(Cs,t,o,c,m,x),!0;case"pointerover":var T=x.pointerId;return Zu.set(T,Xu(Zu.get(T)||null,t,o,c,m,x)),!0;case"gotpointercapture":return T=x.pointerId,qu.set(T,Xu(qu.get(T)||null,t,o,c,m,x)),!0}return!1}function sE(t){var o=Ma(t.target);if(o!==null){var c=Aa(o);if(c!==null){if(o=c.tag,o===13){if(o=zv(c),o!==null){t.blockedOn=o,Fv(t.lanePriority,function(){cr.unstable_runWithPriority(t.priority,function(){Bv(c)})});return}}else if(o===3&&c.stateNode.hydrate){t.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mp(t){if(t.blockedOn!==null)return!1;for(var o=t.targetContainers;0<o.length;){var c=$g(t.domEventName,t.eventSystemFlags,o[0],t.nativeEvent);if(c!==null)return o=sh(c),o!==null&&Rg(o),t.blockedOn=c,!1;o.shift()}return!0}function Uv(t,o,c){mp(t)&&c.delete(o)}function aE(){for(Lg=!1;0<co.length;){var t=co[0];if(t.blockedOn!==null){t=sh(t.blockedOn),t!==null&&Lv(t);break}for(var o=t.targetContainers;0<o.length;){var c=$g(t.domEventName,t.eventSystemFlags,o[0],t.nativeEvent);if(c!==null){t.blockedOn=c;break}o.shift()}t.blockedOn===null&&co.shift()}Ss!==null&&mp(Ss)&&(Ss=null),Es!==null&&mp(Es)&&(Es=null),Cs!==null&&mp(Cs)&&(Cs=null),Zu.forEach(Uv),qu.forEach(Uv)}function Hu(t,o){t.blockedOn===o&&(t.blockedOn=null,Lg||(Lg=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,aE)))}function Vv(t){function o(x){return Hu(x,t)}if(0<co.length){Hu(co[0],t);for(var c=1;c<co.length;c++){var m=co[c];m.blockedOn===t&&(m.blockedOn=null)}}for(Ss!==null&&Hu(Ss,t),Es!==null&&Hu(Es,t),Cs!==null&&Hu(Cs,t),Zu.forEach(o),qu.forEach(o),c=0;c<Wu.length;c++)m=Wu[c],m.blockedOn===t&&(m.blockedOn=null);for(;0<Wu.length&&(c=Wu[0],c.blockedOn===null);)sE(c),c.blockedOn===null&&Wu.shift()}function gp(t,o){var c={};return c[t.toLowerCase()]=o.toLowerCase(),c["Webkit"+t]="webkit"+o,c["Moz"+t]="moz"+o,c}var ql={animationend:gp("Animation","AnimationEnd"),animationiteration:gp("Animation","AnimationIteration"),animationstart:gp("Animation","AnimationStart"),transitionend:gp("Transition","TransitionEnd")},Fg={},$v={};Uo&&($v=document.createElement("div").style,"AnimationEvent"in window||(delete ql.animationend.animation,delete ql.animationiteration.animation,delete ql.animationstart.animation),"TransitionEvent"in window||delete ql.transitionend.transition);function _p(t){if(Fg[t])return Fg[t];if(!ql[t])return t;var o=ql[t],c;for(c in o)if(o.hasOwnProperty(c)&&c in $v)return Fg[t]=o[c];return t}var jv=_p("animationend"),Gv=_p("animationiteration"),Zv=_p("animationstart"),qv=_p("transitionend"),Wv=new Map,Og=new Map,lE=["abort","abort",jv,"animationEnd",Gv,"animationIteration",Zv,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",qv,"transitionEnd","waiting","waiting"];function Ng(t,o){for(var c=0;c<t.length;c+=2){var m=t[c],x=t[c+1];x="on"+(x[0].toUpperCase()+x.slice(1)),Og.set(m,o),Wv.set(m,x),Ea(x,[m])}}var cE=cr.unstable_now;cE();var yn=8;function Wl(t){if((1&t)!=0)return yn=15,1;if((2&t)!=0)return yn=14,2;if((4&t)!=0)return yn=13,4;var o=24&t;return o!==0?(yn=12,o):(t&32)!=0?(yn=11,32):(o=192&t,o!==0?(yn=10,o):(t&256)!=0?(yn=9,256):(o=3584&t,o!==0?(yn=8,o):(t&4096)!=0?(yn=7,4096):(o=4186112&t,o!==0?(yn=6,o):(o=62914560&t,o!==0?(yn=5,o):t&67108864?(yn=4,67108864):(t&134217728)!=0?(yn=3,134217728):(o=805306368&t,o!==0?(yn=2,o):(1073741824&t)!=0?(yn=1,1073741824):(yn=8,t))))))}function uE(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function hE(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Qe(358,t))}}function Ku(t,o){var c=t.pendingLanes;if(c===0)return yn=0;var m=0,x=0,T=t.expiredLanes,k=t.suspendedLanes,a=t.pingedLanes;if(T!==0)m=T,x=yn=15;else if(T=c&134217727,T!==0){var B=T&~k;B!==0?(m=Wl(B),x=yn):(a&=T,a!==0&&(m=Wl(a),x=yn))}else T=c&~k,T!==0?(m=Wl(T),x=yn):a!==0&&(m=Wl(a),x=yn);if(m===0)return 0;if(m=31-ks(m),m=c&((0>m?0:1<<m)<<1)-1,o!==0&&o!==m&&(o&k)==0){if(Wl(o),x<=yn)return o;yn=x}if(o=t.entangledLanes,o!==0)for(t=t.entanglements,o&=m;0<o;)c=31-ks(o),x=1<<c,m|=t[c],o&=~x;return m}function Xv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function yp(t,o){switch(t){case 15:return 1;case 14:return 2;case 12:return t=Xl(24&~o),t===0?yp(10,o):t;case 10:return t=Xl(192&~o),t===0?yp(8,o):t;case 8:return t=Xl(3584&~o),t===0&&(t=Xl(4186112&~o),t===0&&(t=512)),t;case 2:return o=Xl(805306368&~o),o===0&&(o=268435456),o}throw Error(Qe(358,t))}function Xl(t){return t&-t}function Ug(t){for(var o=[],c=0;31>c;c++)o.push(t);return o}function xp(t,o,c){t.pendingLanes|=o;var m=o-1;t.suspendedLanes&=m,t.pingedLanes&=m,t=t.eventTimes,o=31-ks(o),t[o]=c}var ks=Math.clz32?Math.clz32:fE,dE=Math.log,pE=Math.LN2;function fE(t){return t===0?32:31-(dE(t)/pE|0)|0}var mE=cr.unstable_UserBlockingPriority,gE=cr.unstable_runWithPriority,vp=!0;function _E(t,o,c,m){Ia||Ag();var x=Vg,T=Ia;Ia=!0;try{Av(x,t,o,c,m)}finally{(Ia=T)||zg()}}function yE(t,o,c,m){gE(mE,Vg.bind(null,t,o,c,m))}function Vg(t,o,c,m){if(vp){var x;if((x=(o&4)==0)&&0<co.length&&-1<Ov.indexOf(t))t=Bg(null,t,o,c,m),co.push(t);else{var T=$g(t,o,c,m);if(T===null)x&&Nv(t,m);else{if(x){if(-1<Ov.indexOf(t)){t=Bg(T,t,o,c,m),co.push(t);return}if(oE(T,t,o,c,m))return;Nv(t,m)}S1(t,o,m,null,c)}}}}function $g(t,o,c,m){var x=Cg(m);if(x=Ma(x),x!==null){var T=Aa(x);if(T===null)x=null;else{var k=T.tag;if(k===13){if(x=zv(T),x!==null)return x;x=null}else if(k===3){if(T.stateNode.hydrate)return T.tag===3?T.stateNode.containerInfo:null;x=null}else T!==x&&(x=null)}}return S1(t,o,m,x,c),null}var Is=null,jg=null,wp=null;function Hv(){if(wp)return wp;var t,o=jg,c=o.length,m,x="value"in Is?Is.value:Is.textContent,T=x.length;for(t=0;t<c&&o[t]===x[t];t++);var k=c-t;for(m=1;m<=k&&o[c-m]===x[T-m];m++);return wp=x.slice(t,1<m?1-m:void 0)}function bp(t){var o=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&o===13&&(t=13)):t=o,t===10&&(t=13),32<=t||t===13?t:0}function Tp(){return!0}function Kv(){return!1}function yi(t){function o(c,m,x,T,k){this._reactName=c,this._targetInst=x,this.type=m,this.nativeEvent=T,this.target=k,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(c=t[a],this[a]=c?c(T):T[a]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Tp:Kv,this.isPropagationStopped=Kv,this}return Dn(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Tp)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Tp)},persist:function(){},isPersistent:Tp}),o}var Hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gg=yi(Hl),Yu=Dn({},Hl,{view:0,detail:0}),xE=yi(Yu),Zg,qg,Qu,Sp=Dn({},Yu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qu&&(Qu&&t.type==="mousemove"?(Zg=t.screenX-Qu.screenX,qg=t.screenY-Qu.screenY):qg=Zg=0,Qu=t),Zg)},movementY:function(t){return"movementY"in t?t.movementY:qg}}),Yv=yi(Sp),vE=Dn({},Sp,{dataTransfer:0}),wE=yi(vE),bE=Dn({},Yu,{relatedTarget:0}),Wg=yi(bE),TE=Dn({},Hl,{animationName:0,elapsedTime:0,pseudoElement:0}),SE=yi(TE),EE=Dn({},Hl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),CE=yi(EE),kE=Dn({},Hl,{data:0}),Qv=yi(kE),IE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ME={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zE(t){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(t):(t=ME[t])?!!o[t]:!1}function Xg(){return zE}var PE=Dn({},Yu,{key:function(t){if(t.key){var o=IE[t.key]||t.key;if(o!=="Unidentified")return o}return t.type==="keypress"?(t=bp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?AE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xg,charCode:function(t){return t.type==="keypress"?bp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),DE=yi(PE),RE=Dn({},Sp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jv=yi(RE),LE=Dn({},Yu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xg}),BE=yi(LE),FE=Dn({},Hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),OE=yi(FE),NE=Dn({},Sp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),UE=yi(NE),VE=[9,13,27,32],Hg=Uo&&"CompositionEvent"in window,Ju=null;Uo&&"documentMode"in document&&(Ju=document.documentMode);var $E=Uo&&"TextEvent"in window&&!Ju,e1=Uo&&(!Hg||Ju&&8<Ju&&11>=Ju),t1=String.fromCharCode(32),n1=!1;function r1(t,o){switch(t){case"keyup":return VE.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Kl=!1;function jE(t,o){switch(t){case"compositionend":return i1(o);case"keypress":return o.which!==32?null:(n1=!0,t1);case"textInput":return t=o.data,t===t1&&n1?null:t;default:return null}}function GE(t,o){if(Kl)return t==="compositionend"||!Hg&&r1(t,o)?(t=Hv(),wp=jg=Is=null,Kl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return e1&&o.locale!=="ko"?null:o.data;default:return null}}var ZE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function o1(t){var o=t&&t.nodeName&&t.nodeName.toLowerCase();return o==="input"?!!ZE[t.type]:o==="textarea"}function s1(t,o,c,m){kv(m),o=Cp(o,"onChange"),0<o.length&&(c=new Gg("onChange","change",null,c,m),t.push({event:c,listeners:o}))}var eh=null,th=null;function qE(t){x1(t,0)}function Ep(t){var o=tc(t);if(mv(o))return t}function WE(t,o){if(t==="change")return o}var a1=!1;if(Uo){var Kg;if(Uo){var Yg="oninput"in document;if(!Yg){var l1=document.createElement("div");l1.setAttribute("oninput","return;"),Yg=typeof l1.oninput=="function"}Kg=Yg}else Kg=!1;a1=Kg&&(!document.documentMode||9<document.documentMode)}function c1(){eh&&(eh.detachEvent("onpropertychange",u1),th=eh=null)}function u1(t){if(t.propertyName==="value"&&Ep(th)){var o=[];if(s1(o,th,t,Cg(t)),t=qE,Ia)t(o);else{Ia=!0;try{Ig(t,o)}finally{Ia=!1,zg()}}}}function XE(t,o,c){t==="focusin"?(c1(),eh=o,th=c,eh.attachEvent("onpropertychange",u1)):t==="focusout"&&c1()}function HE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ep(th)}function KE(t,o){if(t==="click")return Ep(o)}function YE(t,o){if(t==="input"||t==="change")return Ep(o)}function QE(t,o){return t===o&&(t!==0||1/t==1/o)||t!==t&&o!==o}var Mi=typeof Object.is=="function"?Object.is:QE,JE=Object.prototype.hasOwnProperty;function nh(t,o){if(Mi(t,o))return!0;if(typeof t!="object"||t===null||typeof o!="object"||o===null)return!1;var c=Object.keys(t),m=Object.keys(o);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++)if(!JE.call(o,c[m])||!Mi(t[c[m]],o[c[m]]))return!1;return!0}function h1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function d1(t,o){var c=h1(t);t=0;for(var m;c;){if(c.nodeType===3){if(m=t+c.textContent.length,t<=o&&m>=o)return{node:c,offset:o-t};t=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=h1(c)}}function p1(t,o){return t&&o?t===o?!0:t&&t.nodeType===3?!1:o&&o.nodeType===3?p1(t,o.parentNode):"contains"in t?t.contains(o):t.compareDocumentPosition?!!(t.compareDocumentPosition(o)&16):!1:!1}function f1(){for(var t=window,o=hp();o instanceof t.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)t=o.contentWindow;else break;o=hp(t.document)}return o}function Qg(t){var o=t&&t.nodeName&&t.nodeName.toLowerCase();return o&&(o==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||o==="textarea"||t.contentEditable==="true")}var eC=Uo&&"documentMode"in document&&11>=document.documentMode,Yl=null,Jg=null,rh=null,e_=!1;function m1(t,o,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;e_||Yl==null||Yl!==hp(m)||(m=Yl,"selectionStart"in m&&Qg(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),rh&&nh(rh,m)||(rh=m,m=Cp(Jg,"onSelect"),0<m.length&&(o=new Gg("onSelect","select",null,o,c),t.push({event:o,listeners:m}),o.target=Yl)))}Ng("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);Ng("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Ng(lE,2);for(var g1="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),t_=0;t_<g1.length;t_++)Og.set(g1[t_],0);Vl("onMouseEnter",["mouseout","mouseover"]);Vl("onMouseLeave",["mouseout","mouseover"]);Vl("onPointerEnter",["pointerout","pointerover"]);Vl("onPointerLeave",["pointerout","pointerover"]);Ea("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ea("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ea("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ea("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ea("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ea("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ih="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_1=new Set("cancel close invalid load scroll toggle".split(" ").concat(ih));function y1(t,o,c){var m=t.type||"unknown-event";t.currentTarget=c,rE(m,o,void 0,t),t.currentTarget=null}function x1(t,o){o=(o&4)!=0;for(var c=0;c<t.length;c++){var m=t[c],x=m.event;m=m.listeners;e:{var T=void 0;if(o)for(var k=m.length-1;0<=k;k--){var a=m[k],B=a.instance,W=a.currentTarget;if(a=a.listener,B!==T&&x.isPropagationStopped())break e;y1(x,a,W),T=B}else for(k=0;k<m.length;k++){if(a=m[k],B=a.instance,W=a.currentTarget,a=a.listener,B!==T&&x.isPropagationStopped())break e;y1(x,a,W),T=B}}}if(fp)throw t=Dg,fp=!1,Dg=null,t}function Sn(t,o){var c=M1(o),m=t+"__bubble";c.has(m)||(T1(o,t,2,!1),c.add(m))}var v1="_reactListening"+Math.random().toString(36).slice(2);function w1(t){t[v1]||(t[v1]=!0,lv.forEach(function(o){_1.has(o)||b1(o,!1,t,null),b1(o,!0,t,null)}))}function b1(t,o,c,m){var x=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,T=c;if(t==="selectionchange"&&c.nodeType!==9&&(T=c.ownerDocument),m!==null&&!o&&_1.has(t)){if(t!=="scroll")return;x|=2,T=m}var k=M1(T),a=t+"__"+(o?"capture":"bubble");k.has(a)||(o&&(x|=4),T1(T,t,x,o),k.add(a))}function T1(t,o,c,m){var x=Og.get(o);switch(x===void 0?2:x){case 0:x=_E;break;case 1:x=yE;break;default:x=Vg}c=x.bind(null,o,c,t),x=void 0,!Pg||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),m?x!==void 0?t.addEventListener(o,c,{capture:!0,passive:x}):t.addEventListener(o,c,!0):x!==void 0?t.addEventListener(o,c,{passive:x}):t.addEventListener(o,c,!1)}function S1(t,o,c,m,x){var T=m;if((o&1)==0&&(o&2)==0&&m!==null)e:for(;;){if(m===null)return;var k=m.tag;if(k===3||k===4){var a=m.stateNode.containerInfo;if(a===x||a.nodeType===8&&a.parentNode===x)break;if(k===4)for(k=m.return;k!==null;){var B=k.tag;if((B===3||B===4)&&(B=k.stateNode.containerInfo,B===x||B.nodeType===8&&B.parentNode===x))return;k=k.return}for(;a!==null;){if(k=Ma(a),k===null)return;if(B=k.tag,B===5||B===6){m=T=k;continue e}a=a.parentNode}}m=m.return}JS(function(){var W=T,ce=Cg(c),J=[];e:{var q=Wv.get(t);if(q!==void 0){var ve=Gg,Ae=t;switch(t){case"keypress":if(bp(c)===0)break e;case"keydown":case"keyup":ve=DE;break;case"focusin":Ae="focus",ve=Wg;break;case"focusout":Ae="blur",ve=Wg;break;case"beforeblur":case"afterblur":ve=Wg;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=Yv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=wE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=BE;break;case jv:case Gv:case Zv:ve=SE;break;case qv:ve=OE;break;case"scroll":ve=xE;break;case"wheel":ve=UE;break;case"copy":case"cut":case"paste":ve=CE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Jv}var Se=(o&4)!=0,ee=!Se&&t==="scroll",Q=Se?q!==null?q+"Capture":null:q;Se=[];for(var re=W,Te;re!==null;){Te=re;var xe=Te.stateNode;if(Te.tag===5&&xe!==null&&(Te=xe,Q!==null&&(xe=$u(re,Q),xe!=null&&Se.push(oh(re,xe,Te)))),ee)break;re=re.return}0<Se.length&&(q=new ve(q,Ae,null,c,ce),J.push({event:q,listeners:Se}))}}if((o&7)==0){e:{if(q=t==="mouseover"||t==="pointerover",ve=t==="mouseout"||t==="pointerout",q&&(o&16)==0&&(Ae=c.relatedTarget||c.fromElement)&&(Ma(Ae)||Ae[ec]))break e;if((ve||q)&&(q=ce.window===ce?ce:(q=ce.ownerDocument)?q.defaultView||q.parentWindow:window,ve?(Ae=c.relatedTarget||c.toElement,ve=W,Ae=Ae?Ma(Ae):null,Ae!==null&&(ee=Aa(Ae),Ae!==ee||Ae.tag!==5&&Ae.tag!==6)&&(Ae=null)):(ve=null,Ae=W),ve!==Ae)){if(Se=Yv,xe="onMouseLeave",Q="onMouseEnter",re="mouse",(t==="pointerout"||t==="pointerover")&&(Se=Jv,xe="onPointerLeave",Q="onPointerEnter",re="pointer"),ee=ve==null?q:tc(ve),Te=Ae==null?q:tc(Ae),q=new Se(xe,re+"leave",ve,c,ce),q.target=ee,q.relatedTarget=Te,xe=null,Ma(ce)===W&&(Se=new Se(Q,re+"enter",Ae,c,ce),Se.target=Te,Se.relatedTarget=ee,xe=Se),ee=xe,ve&&Ae)t:{for(Se=ve,Q=Ae,re=0,Te=Se;Te;Te=Ql(Te))re++;for(Te=0,xe=Q;xe;xe=Ql(xe))Te++;for(;0<re-Te;)Se=Ql(Se),re--;for(;0<Te-re;)Q=Ql(Q),Te--;for(;re--;){if(Se===Q||Q!==null&&Se===Q.alternate)break t;Se=Ql(Se),Q=Ql(Q)}Se=null}else Se=null;ve!==null&&E1(J,q,ve,Se,!1),Ae!==null&&ee!==null&&E1(J,ee,Ae,Se,!0)}}e:{if(q=W?tc(W):window,ve=q.nodeName&&q.nodeName.toLowerCase(),ve==="select"||ve==="input"&&q.type==="file")var Ve=WE;else if(o1(q))if(a1)Ve=YE;else{Ve=HE;var Ie=XE}else(ve=q.nodeName)&&ve.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(Ve=KE);if(Ve&&(Ve=Ve(t,W))){s1(J,Ve,c,ce);break e}Ie&&Ie(t,q,W),t==="focusout"&&(Ie=q._wrapperState)&&Ie.controlled&&q.type==="number"&&xg(q,"number",q.value)}switch(Ie=W?tc(W):window,t){case"focusin":(o1(Ie)||Ie.contentEditable==="true")&&(Yl=Ie,Jg=W,rh=null);break;case"focusout":rh=Jg=Yl=null;break;case"mousedown":e_=!0;break;case"contextmenu":case"mouseup":case"dragend":e_=!1,m1(J,c,ce);break;case"selectionchange":if(eC)break;case"keydown":case"keyup":m1(J,c,ce)}var $e;if(Hg)e:{switch(t){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Kl?r1(t,c)&&(We="onCompositionEnd"):t==="keydown"&&c.keyCode===229&&(We="onCompositionStart");We&&(e1&&c.locale!=="ko"&&(Kl||We!=="onCompositionStart"?We==="onCompositionEnd"&&Kl&&($e=Hv()):(Is=ce,jg="value"in Is?Is.value:Is.textContent,Kl=!0)),Ie=Cp(W,We),0<Ie.length&&(We=new Qv(We,t,null,c,ce),J.push({event:We,listeners:Ie}),$e?We.data=$e:($e=i1(c),$e!==null&&(We.data=$e)))),($e=$E?jE(t,c):GE(t,c))&&(W=Cp(W,"onBeforeInput"),0<W.length&&(ce=new Qv("onBeforeInput","beforeinput",null,c,ce),J.push({event:ce,listeners:W}),ce.data=$e))}x1(J,o)})}function oh(t,o,c){return{instance:t,listener:o,currentTarget:c}}function Cp(t,o){for(var c=o+"Capture",m=[];t!==null;){var x=t,T=x.stateNode;x.tag===5&&T!==null&&(x=T,T=$u(t,c),T!=null&&m.unshift(oh(t,T,x)),T=$u(t,o),T!=null&&m.push(oh(t,T,x))),t=t.return}return m}function Ql(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function E1(t,o,c,m,x){for(var T=o._reactName,k=[];c!==null&&c!==m;){var a=c,B=a.alternate,W=a.stateNode;if(B!==null&&B===m)break;a.tag===5&&W!==null&&(a=W,x?(B=$u(c,T),B!=null&&k.unshift(oh(c,B,a))):x||(B=$u(c,T),B!=null&&k.push(oh(c,B,a)))),c=c.return}k.length!==0&&t.push({event:o,listeners:k})}function kp(){}var n_=null,r_=null;function C1(t,o){switch(t){case"button":case"input":case"select":case"textarea":return!!o.autoFocus}return!1}function i_(t,o){return t==="textarea"||t==="option"||t==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var k1=typeof setTimeout=="function"?setTimeout:void 0,tC=typeof clearTimeout=="function"?clearTimeout:void 0;function o_(t){t.nodeType===1?t.textContent="":t.nodeType===9&&(t=t.body,t!=null&&(t.textContent=""))}function Jl(t){for(;t!=null;t=t.nextSibling){var o=t.nodeType;if(o===1||o===3)break}return t}function I1(t){t=t.previousSibling;for(var o=0;t;){if(t.nodeType===8){var c=t.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return t;o--}else c==="/$"&&o++}t=t.previousSibling}return null}var s_=0;function nC(t){return{$$typeof:dg,toString:t,valueOf:t}}var Ip=Math.random().toString(36).slice(2),As="__reactFiber$"+Ip,Ap="__reactProps$"+Ip,ec="__reactContainer$"+Ip,A1="__reactEvents$"+Ip;function Ma(t){var o=t[As];if(o)return o;for(var c=t.parentNode;c;){if(o=c[ec]||c[As]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(t=I1(t);t!==null;){if(c=t[As])return c;t=I1(t)}return o}t=c,c=t.parentNode}return null}function sh(t){return t=t[As]||t[ec],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function tc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qe(33))}function Mp(t){return t[Ap]||null}function M1(t){var o=t[A1];return o===void 0&&(o=t[A1]=new Set),o}var a_=[],nc=-1;function Ms(t){return{current:t}}function En(t){0>nc||(t.current=a_[nc],a_[nc]=null,nc--)}function $n(t,o){nc++,a_[nc]=t.current,t.current=o}var zs={},Ir=Ms(zs),ei=Ms(!1),za=zs;function rc(t,o){var c=t.type.contextTypes;if(!c)return zs;var m=t.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===o)return m.__reactInternalMemoizedMaskedChildContext;var x={},T;for(T in c)x[T]=o[T];return m&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=x),x}function ti(t){return t=t.childContextTypes,t!=null}function zp(){En(ei),En(Ir)}function z1(t,o,c){if(Ir.current!==zs)throw Error(Qe(168));$n(Ir,o),$n(ei,c)}function P1(t,o,c){var m=t.stateNode;if(t=o.childContextTypes,typeof m.getChildContext!="function")return c;m=m.getChildContext();for(var x in m)if(!(x in t))throw Error(Qe(108,$l(o)||"Unknown",x));return Dn({},c,m)}function Pp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zs,za=Ir.current,$n(Ir,t),$n(ei,ei.current),!0}function D1(t,o,c){var m=t.stateNode;if(!m)throw Error(Qe(169));c?(t=P1(t,o,za),m.__reactInternalMemoizedMergedChildContext=t,En(ei),En(Ir),$n(Ir,t)):En(ei),$n(ei,c)}var l_=null,Pa=null,rC=cr.unstable_runWithPriority,c_=cr.unstable_scheduleCallback,u_=cr.unstable_cancelCallback,iC=cr.unstable_shouldYield,R1=cr.unstable_requestPaint,h_=cr.unstable_now,oC=cr.unstable_getCurrentPriorityLevel,Dp=cr.unstable_ImmediatePriority,L1=cr.unstable_UserBlockingPriority,B1=cr.unstable_NormalPriority,F1=cr.unstable_LowPriority,O1=cr.unstable_IdlePriority,d_={},sC=R1!==void 0?R1:function(){},Vo=null,Rp=null,p_=!1,N1=h_(),Ar=1e4>N1?h_:function(){return h_()-N1};function ic(){switch(oC()){case Dp:return 99;case L1:return 98;case B1:return 97;case F1:return 96;case O1:return 95;default:throw Error(Qe(332))}}function U1(t){switch(t){case 99:return Dp;case 98:return L1;case 97:return B1;case 96:return F1;case 95:return O1;default:throw Error(Qe(332))}}function Da(t,o){return t=U1(t),rC(t,o)}function ah(t,o,c){return t=U1(t),c_(t,o,c)}function uo(){if(Rp!==null){var t=Rp;Rp=null,u_(t)}V1()}function V1(){if(!p_&&Vo!==null){p_=!0;var t=0;try{var o=Vo;Da(99,function(){for(;t<o.length;t++){var c=o[t];do c=c(!0);while(c!==null)}}),Vo=null}catch(c){throw Vo!==null&&(Vo=Vo.slice(t+1)),c_(Dp,uo),c}finally{p_=!1}}}var aC=Ca.ReactCurrentBatchConfig;function Hi(t,o){if(t&&t.defaultProps){o=Dn({},o),t=t.defaultProps;for(var c in t)o[c]===void 0&&(o[c]=t[c]);return o}return o}var Lp=Ms(null),Bp=null,oc=null,Fp=null;function f_(){Fp=oc=Bp=null}function m_(t){var o=Lp.current;En(Lp),t.type._context._currentValue=o}function $1(t,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&o)===o){if(c===null||(c.childLanes&o)===o)break;c.childLanes|=o}else t.childLanes|=o,c!==null&&(c.childLanes|=o);t=t.return}}function sc(t,o){Bp=t,Fp=oc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&o)!=0&&(Ki=!0),t.firstContext=null)}function zi(t,o){if(Fp!==t&&o!==!1&&o!==0)if((typeof o!="number"||o===1073741823)&&(Fp=t,o=1073741823),o={context:t,observedBits:o,next:null},oc===null){if(Bp===null)throw Error(Qe(308));oc=o,Bp.dependencies={lanes:0,firstContext:o,responders:null}}else oc=oc.next=o;return t._currentValue}var Ps=!1;function g_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function j1(t,o){t=t.updateQueue,o.updateQueue===t&&(o.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ds(t,o){return{eventTime:t,lane:o,tag:0,payload:null,callback:null,next:null}}function Rs(t,o){if(t=t.updateQueue,t!==null){t=t.shared;var c=t.pending;c===null?o.next=o:(o.next=c.next,c.next=o),t.pending=o}}function G1(t,o){var c=t.updateQueue,m=t.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var x=null,T=null;if(c=c.firstBaseUpdate,c!==null){do{var k={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};T===null?x=T=k:T=T.next=k,c=c.next}while(c!==null);T===null?x=T=o:T=T.next=o}else x=T=o;c={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:T,shared:m.shared,effects:m.effects},t.updateQueue=c;return}t=c.lastBaseUpdate,t===null?c.firstBaseUpdate=o:t.next=o,c.lastBaseUpdate=o}function lh(t,o,c,m){var x=t.updateQueue;Ps=!1;var T=x.firstBaseUpdate,k=x.lastBaseUpdate,a=x.shared.pending;if(a!==null){x.shared.pending=null;var B=a,W=B.next;B.next=null,k===null?T=W:k.next=W,k=B;var ce=t.alternate;if(ce!==null){ce=ce.updateQueue;var J=ce.lastBaseUpdate;J!==k&&(J===null?ce.firstBaseUpdate=W:J.next=W,ce.lastBaseUpdate=B)}}if(T!==null){J=x.baseState,k=0,ce=W=B=null;do{a=T.lane;var q=T.eventTime;if((m&a)===a){ce!==null&&(ce=ce.next={eventTime:q,lane:0,tag:T.tag,payload:T.payload,callback:T.callback,next:null});e:{var ve=t,Ae=T;switch(a=o,q=c,Ae.tag){case 1:if(ve=Ae.payload,typeof ve=="function"){J=ve.call(q,J,a);break e}J=ve;break e;case 3:ve.flags=ve.flags&-4097|64;case 0:if(ve=Ae.payload,a=typeof ve=="function"?ve.call(q,J,a):ve,a==null)break e;J=Dn({},J,a);break e;case 2:Ps=!0}}T.callback!==null&&(t.flags|=32,a=x.effects,a===null?x.effects=[T]:a.push(T))}else q={eventTime:q,lane:a,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ce===null?(W=ce=q,B=J):ce=ce.next=q,k|=a;if(T=T.next,T===null){if(a=x.shared.pending,a===null)break;T=a.next,a.next=null,x.lastBaseUpdate=a,x.shared.pending=null}}while(1);ce===null&&(B=J),x.baseState=B,x.firstBaseUpdate=W,x.lastBaseUpdate=ce,vh|=k,t.lanes=k,t.memoizedState=J}}function Z1(t,o,c){if(t=o.effects,o.effects=null,t!==null)for(o=0;o<t.length;o++){var m=t[o],x=m.callback;if(x!==null){if(m.callback=null,m=c,typeof x!="function")throw Error(Qe(191,x));x.call(m)}}}var q1=new op.Component().refs;function Op(t,o,c,m){o=t.memoizedState,c=c(m,o),c=c==null?o:Dn({},o,c),t.memoizedState=c,t.lanes===0&&(t.updateQueue.baseState=c)}var Np={isMounted:function(t){return(t=t._reactInternals)?Aa(t)===t:!1},enqueueSetState:function(t,o,c){t=t._reactInternals;var m=xi(),x=Fs(t),T=Ds(m,x);T.payload=o,c!=null&&(T.callback=c),Rs(t,T),Os(t,x,m)},enqueueReplaceState:function(t,o,c){t=t._reactInternals;var m=xi(),x=Fs(t),T=Ds(m,x);T.tag=1,T.payload=o,c!=null&&(T.callback=c),Rs(t,T),Os(t,x,m)},enqueueForceUpdate:function(t,o){t=t._reactInternals;var c=xi(),m=Fs(t),x=Ds(c,m);x.tag=2,o!=null&&(x.callback=o),Rs(t,x),Os(t,m,c)}};function W1(t,o,c,m,x,T,k){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(m,T,k):o.prototype&&o.prototype.isPureReactComponent?!nh(c,m)||!nh(x,T):!0}function X1(t,o,c){var m=!1,x=zs,T=o.contextType;return typeof T=="object"&&T!==null?T=zi(T):(x=ti(o)?za:Ir.current,m=o.contextTypes,T=(m=m!=null)?rc(t,x):zs),o=new o(c,T),t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Np,t.stateNode=o,o._reactInternals=t,m&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=x,t.__reactInternalMemoizedMaskedChildContext=T),o}function H1(t,o,c,m){t=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,m),o.state!==t&&Np.enqueueReplaceState(o,o.state,null)}function __(t,o,c,m){var x=t.stateNode;x.props=c,x.state=t.memoizedState,x.refs=q1,g_(t);var T=o.contextType;typeof T=="object"&&T!==null?x.context=zi(T):(T=ti(o)?za:Ir.current,x.context=rc(t,T)),lh(t,c,x,m),x.state=t.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(Op(t,o,T,c),x.state=t.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(o=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),o!==x.state&&Np.enqueueReplaceState(x,x.state,null),lh(t,c,x,m),x.state=t.memoizedState),typeof x.componentDidMount=="function"&&(t.flags|=4)}var Up=Array.isArray;function ch(t,o,c){if(t=c.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(Qe(309));var m=c.stateNode}if(!m)throw Error(Qe(147,t));var x=""+t;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===x?o.ref:(o=function(T){var k=m.refs;k===q1&&(k=m.refs={}),T===null?delete k[x]:k[x]=T},o._stringRef=x,o)}if(typeof t!="string")throw Error(Qe(284));if(!c._owner)throw Error(Qe(290,t))}return t}function Vp(t,o){if(t.type!=="textarea")throw Error(Qe(31,Object.prototype.toString.call(o)==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":o))}function K1(t){function o(ee,Q){if(t){var re=ee.lastEffect;re!==null?(re.nextEffect=Q,ee.lastEffect=Q):ee.firstEffect=ee.lastEffect=Q,Q.nextEffect=null,Q.flags=8}}function c(ee,Q){if(!t)return null;for(;Q!==null;)o(ee,Q),Q=Q.sibling;return null}function m(ee,Q){for(ee=new Map;Q!==null;)Q.key!==null?ee.set(Q.key,Q):ee.set(Q.index,Q),Q=Q.sibling;return ee}function x(ee,Q){return ee=Vs(ee,Q),ee.index=0,ee.sibling=null,ee}function T(ee,Q,re){return ee.index=re,t?(re=ee.alternate,re!==null?(re=re.index,re<Q?(ee.flags=2,Q):re):(ee.flags=2,Q)):Q}function k(ee){return t&&ee.alternate===null&&(ee.flags=2),ee}function a(ee,Q,re,Te){return Q===null||Q.tag!==6?(Q=J_(re,ee.mode,Te),Q.return=ee,Q):(Q=x(Q,re),Q.return=ee,Q)}function B(ee,Q,re,Te){return Q!==null&&Q.elementType===re.type?(Te=x(Q,re.props),Te.ref=ch(ee,Q,re),Te.return=ee,Te):(Te=sf(re.type,re.key,re.props,null,ee.mode,Te),Te.ref=ch(ee,Q,re),Te.return=ee,Te)}function W(ee,Q,re,Te){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==re.containerInfo||Q.stateNode.implementation!==re.implementation?(Q=ey(re,ee.mode,Te),Q.return=ee,Q):(Q=x(Q,re.children||[]),Q.return=ee,Q)}function ce(ee,Q,re,Te,xe){return Q===null||Q.tag!==7?(Q=fc(re,ee.mode,Te,xe),Q.return=ee,Q):(Q=x(Q,re),Q.return=ee,Q)}function J(ee,Q,re){if(typeof Q=="string"||typeof Q=="number")return Q=J_(""+Q,ee.mode,re),Q.return=ee,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Lu:return re=sf(Q.type,Q.key,Q.props,null,ee.mode,re),re.ref=ch(ee,null,Q),re.return=ee,re;case ka:return Q=ey(Q,ee.mode,re),Q.return=ee,Q}if(Up(Q)||Ou(Q))return Q=fc(Q,ee.mode,re,null),Q.return=ee,Q;Vp(ee,Q)}return null}function q(ee,Q,re,Te){var xe=Q!==null?Q.key:null;if(typeof re=="string"||typeof re=="number")return xe!==null?null:a(ee,Q,""+re,Te);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Lu:return re.key===xe?re.type===bs?ce(ee,Q,re.props.children,Te,xe):B(ee,Q,re,Te):null;case ka:return re.key===xe?W(ee,Q,re,Te):null}if(Up(re)||Ou(re))return xe!==null?null:ce(ee,Q,re,Te,null);Vp(ee,re)}return null}function ve(ee,Q,re,Te,xe){if(typeof Te=="string"||typeof Te=="number")return ee=ee.get(re)||null,a(Q,ee,""+Te,xe);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case Lu:return ee=ee.get(Te.key===null?re:Te.key)||null,Te.type===bs?ce(Q,ee,Te.props.children,xe,Te.key):B(Q,ee,Te,xe);case ka:return ee=ee.get(Te.key===null?re:Te.key)||null,W(Q,ee,Te,xe)}if(Up(Te)||Ou(Te))return ee=ee.get(re)||null,ce(Q,ee,Te,xe,null);Vp(Q,Te)}return null}function Ae(ee,Q,re,Te){for(var xe=null,Ve=null,Ie=Q,$e=Q=0,We=null;Ie!==null&&$e<re.length;$e++){Ie.index>$e?(We=Ie,Ie=null):We=Ie.sibling;var je=q(ee,Ie,re[$e],Te);if(je===null){Ie===null&&(Ie=We);break}t&&Ie&&je.alternate===null&&o(ee,Ie),Q=T(je,Q,$e),Ve===null?xe=je:Ve.sibling=je,Ve=je,Ie=We}if($e===re.length)return c(ee,Ie),xe;if(Ie===null){for(;$e<re.length;$e++)Ie=J(ee,re[$e],Te),Ie!==null&&(Q=T(Ie,Q,$e),Ve===null?xe=Ie:Ve.sibling=Ie,Ve=Ie);return xe}for(Ie=m(ee,Ie);$e<re.length;$e++)We=ve(Ie,ee,$e,re[$e],Te),We!==null&&(t&&We.alternate!==null&&Ie.delete(We.key===null?$e:We.key),Q=T(We,Q,$e),Ve===null?xe=We:Ve.sibling=We,Ve=We);return t&&Ie.forEach(function(ot){return o(ee,ot)}),xe}function Se(ee,Q,re,Te){var xe=Ou(re);if(typeof xe!="function")throw Error(Qe(150));if(re=xe.call(re),re==null)throw Error(Qe(151));for(var Ve=xe=null,Ie=Q,$e=Q=0,We=null,je=re.next();Ie!==null&&!je.done;$e++,je=re.next()){Ie.index>$e?(We=Ie,Ie=null):We=Ie.sibling;var ot=q(ee,Ie,je.value,Te);if(ot===null){Ie===null&&(Ie=We);break}t&&Ie&&ot.alternate===null&&o(ee,Ie),Q=T(ot,Q,$e),Ve===null?xe=ot:Ve.sibling=ot,Ve=ot,Ie=We}if(je.done)return c(ee,Ie),xe;if(Ie===null){for(;!je.done;$e++,je=re.next())je=J(ee,je.value,Te),je!==null&&(Q=T(je,Q,$e),Ve===null?xe=je:Ve.sibling=je,Ve=je);return xe}for(Ie=m(ee,Ie);!je.done;$e++,je=re.next())je=ve(Ie,ee,$e,je.value,Te),je!==null&&(t&&je.alternate!==null&&Ie.delete(je.key===null?$e:je.key),Q=T(je,Q,$e),Ve===null?xe=je:Ve.sibling=je,Ve=je);return t&&Ie.forEach(function(zt){return o(ee,zt)}),xe}return function(ee,Q,re,Te){var xe=typeof re=="object"&&re!==null&&re.type===bs&&re.key===null;xe&&(re=re.props.children);var Ve=typeof re=="object"&&re!==null;if(Ve)switch(re.$$typeof){case Lu:e:{for(Ve=re.key,xe=Q;xe!==null;){if(xe.key===Ve){switch(xe.tag){case 7:if(re.type===bs){c(ee,xe.sibling),Q=x(xe,re.props.children),Q.return=ee,ee=Q;break e}break;default:if(xe.elementType===re.type){c(ee,xe.sibling),Q=x(xe,re.props),Q.ref=ch(ee,xe,re),Q.return=ee,ee=Q;break e}}c(ee,xe);break}else o(ee,xe);xe=xe.sibling}re.type===bs?(Q=fc(re.props.children,ee.mode,Te,re.key),Q.return=ee,ee=Q):(Te=sf(re.type,re.key,re.props,null,ee.mode,Te),Te.ref=ch(ee,Q,re),Te.return=ee,ee=Te)}return k(ee);case ka:e:{for(xe=re.key;Q!==null;){if(Q.key===xe)if(Q.tag===4&&Q.stateNode.containerInfo===re.containerInfo&&Q.stateNode.implementation===re.implementation){c(ee,Q.sibling),Q=x(Q,re.children||[]),Q.return=ee,ee=Q;break e}else{c(ee,Q);break}else o(ee,Q);Q=Q.sibling}Q=ey(re,ee.mode,Te),Q.return=ee,ee=Q}return k(ee)}if(typeof re=="string"||typeof re=="number")return re=""+re,Q!==null&&Q.tag===6?(c(ee,Q.sibling),Q=x(Q,re),Q.return=ee,ee=Q):(c(ee,Q),Q=J_(re,ee.mode,Te),Q.return=ee,ee=Q),k(ee);if(Up(re))return Ae(ee,Q,re,Te);if(Ou(re))return Se(ee,Q,re,Te);if(Ve&&Vp(ee,re),typeof re=="undefined"&&!xe)switch(ee.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Qe(152,$l(ee.type)||"Component"))}return c(ee,Q)}}var $p=K1(!0),Y1=K1(!1),uh={},ho=Ms(uh),hh=Ms(uh),dh=Ms(uh);function Ra(t){if(t===uh)throw Error(Qe(174));return t}function y_(t,o){switch($n(dh,o),$n(hh,t),$n(ho,uh),t=o.nodeType,t){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Tg(null,"");break;default:t=t===8?o.parentNode:o,o=t.namespaceURI||null,t=t.tagName,o=Tg(o,t)}En(ho),$n(ho,o)}function ac(){En(ho),En(hh),En(dh)}function Q1(t){Ra(dh.current);var o=Ra(ho.current),c=Tg(o,t.type);o!==c&&($n(hh,t),$n(ho,c))}function x_(t){hh.current===t&&(En(ho),En(hh))}var jn=Ms(0);function jp(t){for(var o=t;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&64)!=0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var $o=null,Ls=null,po=!1;function J1(t,o){var c=Ri(5,null,null,0);c.elementType="DELETED",c.type="DELETED",c.stateNode=o,c.return=t,c.flags=8,t.lastEffect!==null?(t.lastEffect.nextEffect=c,t.lastEffect=c):t.firstEffect=t.lastEffect=c}function ew(t,o){switch(t.tag){case 5:var c=t.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(t.stateNode=o,!0):!1;case 6:return o=t.pendingProps===""||o.nodeType!==3?null:o,o!==null?(t.stateNode=o,!0):!1;case 13:return!1;default:return!1}}function v_(t){if(po){var o=Ls;if(o){var c=o;if(!ew(t,o)){if(o=Jl(c.nextSibling),!o||!ew(t,o)){t.flags=t.flags&-1025|2,po=!1,$o=t;return}J1($o,c)}$o=t,Ls=Jl(o.firstChild)}else t.flags=t.flags&-1025|2,po=!1,$o=t}}function tw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$o=t}function Gp(t){if(t!==$o)return!1;if(!po)return tw(t),po=!0,!1;var o=t.type;if(t.tag!==5||o!=="head"&&o!=="body"&&!i_(o,t.memoizedProps))for(o=Ls;o;)J1(t,o),o=Jl(o.nextSibling);if(tw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qe(317));e:{for(t=t.nextSibling,o=0;t;){if(t.nodeType===8){var c=t.data;if(c==="/$"){if(o===0){Ls=Jl(t.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}t=t.nextSibling}Ls=null}}else Ls=$o?Jl(t.stateNode.nextSibling):null;return!0}function w_(){Ls=$o=null,po=!1}var lc=[];function b_(){for(var t=0;t<lc.length;t++)lc[t]._workInProgressVersionPrimary=null;lc.length=0}var ph=Ca.ReactCurrentDispatcher,Pi=Ca.ReactCurrentBatchConfig,fh=0,Gn=null,Mr=null,vr=null,Zp=!1,mh=!1;function ni(){throw Error(Qe(321))}function T_(t,o){if(o===null)return!1;for(var c=0;c<o.length&&c<t.length;c++)if(!Mi(t[c],o[c]))return!1;return!0}function S_(t,o,c,m,x,T){if(fh=T,Gn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ph.current=t===null||t.memoizedState===null?cC:uC,t=c(m,x),mh){T=0;do{if(mh=!1,!(25>T))throw Error(Qe(301));T+=1,vr=Mr=null,o.updateQueue=null,ph.current=hC,t=c(m,x)}while(mh)}if(ph.current=Hp,o=Mr!==null&&Mr.next!==null,fh=0,vr=Mr=Gn=null,Zp=!1,o)throw Error(Qe(300));return t}function La(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?Gn.memoizedState=vr=t:vr=vr.next=t,vr}function Ba(){if(Mr===null){var t=Gn.alternate;t=t!==null?t.memoizedState:null}else t=Mr.next;var o=vr===null?Gn.memoizedState:vr.next;if(o!==null)vr=o,Mr=t;else{if(t===null)throw Error(Qe(310));Mr=t,t={memoizedState:Mr.memoizedState,baseState:Mr.baseState,baseQueue:Mr.baseQueue,queue:Mr.queue,next:null},vr===null?Gn.memoizedState=vr=t:vr=vr.next=t}return vr}function fo(t,o){return typeof o=="function"?o(t):o}function gh(t){var o=Ba(),c=o.queue;if(c===null)throw Error(Qe(311));c.lastRenderedReducer=t;var m=Mr,x=m.baseQueue,T=c.pending;if(T!==null){if(x!==null){var k=x.next;x.next=T.next,T.next=k}m.baseQueue=x=T,c.pending=null}if(x!==null){x=x.next,m=m.baseState;var a=k=T=null,B=x;do{var W=B.lane;if((fh&W)===W)a!==null&&(a=a.next={lane:0,action:B.action,eagerReducer:B.eagerReducer,eagerState:B.eagerState,next:null}),m=B.eagerReducer===t?B.eagerState:t(m,B.action);else{var ce={lane:W,action:B.action,eagerReducer:B.eagerReducer,eagerState:B.eagerState,next:null};a===null?(k=a=ce,T=m):a=a.next=ce,Gn.lanes|=W,vh|=W}B=B.next}while(B!==null&&B!==x);a===null?T=m:a.next=k,Mi(m,o.memoizedState)||(Ki=!0),o.memoizedState=m,o.baseState=T,o.baseQueue=a,c.lastRenderedState=m}return[o.memoizedState,c.dispatch]}function _h(t){var o=Ba(),c=o.queue;if(c===null)throw Error(Qe(311));c.lastRenderedReducer=t;var m=c.dispatch,x=c.pending,T=o.memoizedState;if(x!==null){c.pending=null;var k=x=x.next;do T=t(T,k.action),k=k.next;while(k!==x);Mi(T,o.memoizedState)||(Ki=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),c.lastRenderedState=T}return[T,m]}function nw(t,o,c){var m=o._getVersion;m=m(o._source);var x=o._workInProgressVersionPrimary;if(x!==null?t=x===m:(t=t.mutableReadLanes,(t=(fh&t)===t)&&(o._workInProgressVersionPrimary=m,lc.push(o))),t)return c(o._source);throw lc.push(o),Error(Qe(350))}function rw(t,o,c,m){var x=$r;if(x===null)throw Error(Qe(349));var T=o._getVersion,k=T(o._source),a=ph.current,B=a.useState(function(){return nw(x,o,c)}),W=B[1],ce=B[0];B=vr;var J=t.memoizedState,q=J.refs,ve=q.getSnapshot,Ae=J.source;J=J.subscribe;var Se=Gn;return t.memoizedState={refs:q,source:o,subscribe:m},a.useEffect(function(){q.getSnapshot=c,q.setSnapshot=W;var ee=T(o._source);if(!Mi(k,ee)){ee=c(o._source),Mi(ce,ee)||(W(ee),ee=Fs(Se),x.mutableReadLanes|=ee&x.pendingLanes),ee=x.mutableReadLanes,x.entangledLanes|=ee;for(var Q=x.entanglements,re=ee;0<re;){var Te=31-ks(re),xe=1<<Te;Q[Te]|=ee,re&=~xe}}},[c,o,m]),a.useEffect(function(){return m(o._source,function(){var ee=q.getSnapshot,Q=q.setSnapshot;try{Q(ee(o._source));var re=Fs(Se);x.mutableReadLanes|=re&x.pendingLanes}catch(Te){Q(function(){throw Te})}})},[o,m]),Mi(ve,c)&&Mi(Ae,o)&&Mi(J,m)||(t={pending:null,dispatch:null,lastRenderedReducer:fo,lastRenderedState:ce},t.dispatch=W=I_.bind(null,Gn,t),B.queue=t,B.baseQueue=null,ce=nw(x,o,c),B.memoizedState=B.baseState=ce),ce}function iw(t,o,c){var m=Ba();return rw(m,t,o,c)}function yh(t){var o=La();return typeof t=="function"&&(t=t()),o.memoizedState=o.baseState=t,t=o.queue={pending:null,dispatch:null,lastRenderedReducer:fo,lastRenderedState:t},t=t.dispatch=I_.bind(null,Gn,t),[o.memoizedState,t]}function qp(t,o,c,m){return t={tag:t,create:o,destroy:c,deps:m,next:null},o=Gn.updateQueue,o===null?(o={lastEffect:null},Gn.updateQueue=o,o.lastEffect=t.next=t):(c=o.lastEffect,c===null?o.lastEffect=t.next=t:(m=c.next,c.next=t,t.next=m,o.lastEffect=t)),t}function ow(t){var o=La();return t={current:t},o.memoizedState=t}function Wp(){return Ba().memoizedState}function E_(t,o,c,m){var x=La();Gn.flags|=t,x.memoizedState=qp(1|o,c,void 0,m===void 0?null:m)}function C_(t,o,c,m){var x=Ba();m=m===void 0?null:m;var T=void 0;if(Mr!==null){var k=Mr.memoizedState;if(T=k.destroy,m!==null&&T_(m,k.deps)){qp(o,c,T,m);return}}Gn.flags|=t,x.memoizedState=qp(1|o,c,T,m)}function sw(t,o){return E_(516,4,t,o)}function Xp(t,o){return C_(516,4,t,o)}function aw(t,o){return C_(4,2,t,o)}function lw(t,o){if(typeof o=="function")return t=t(),o(t),function(){o(null)};if(o!=null)return t=t(),o.current=t,function(){o.current=null}}function cw(t,o,c){return c=c!=null?c.concat([t]):null,C_(4,2,lw.bind(null,o,t),c)}function k_(){}function uw(t,o){var c=Ba();o=o===void 0?null:o;var m=c.memoizedState;return m!==null&&o!==null&&T_(o,m[1])?m[0]:(c.memoizedState=[t,o],t)}function hw(t,o){var c=Ba();o=o===void 0?null:o;var m=c.memoizedState;return m!==null&&o!==null&&T_(o,m[1])?m[0]:(t=t(),c.memoizedState=[t,o],t)}function lC(t,o){var c=ic();Da(98>c?98:c,function(){t(!0)}),Da(97<c?97:c,function(){var m=Pi.transition;Pi.transition=1;try{t(!1),o()}finally{Pi.transition=m}})}function I_(t,o,c){var m=xi(),x=Fs(t),T={lane:x,action:c,eagerReducer:null,eagerState:null,next:null},k=o.pending;if(k===null?T.next=T:(T.next=k.next,k.next=T),o.pending=T,k=t.alternate,t===Gn||k!==null&&k===Gn)mh=Zp=!0;else{if(t.lanes===0&&(k===null||k.lanes===0)&&(k=o.lastRenderedReducer,k!==null))try{var a=o.lastRenderedState,B=k(a,c);if(T.eagerReducer=k,T.eagerState=B,Mi(B,a))return}catch{}finally{}Os(t,x,m)}}var Hp={readContext:zi,useCallback:ni,useContext:ni,useEffect:ni,useImperativeHandle:ni,useLayoutEffect:ni,useMemo:ni,useReducer:ni,useRef:ni,useState:ni,useDebugValue:ni,useDeferredValue:ni,useTransition:ni,useMutableSource:ni,useOpaqueIdentifier:ni,unstable_isNewReconciler:!1},cC={readContext:zi,useCallback:function(t,o){return La().memoizedState=[t,o===void 0?null:o],t},useContext:zi,useEffect:sw,useImperativeHandle:function(t,o,c){return c=c!=null?c.concat([t]):null,E_(4,2,lw.bind(null,o,t),c)},useLayoutEffect:function(t,o){return E_(4,2,t,o)},useMemo:function(t,o){var c=La();return o=o===void 0?null:o,t=t(),c.memoizedState=[t,o],t},useReducer:function(t,o,c){var m=La();return o=c!==void 0?c(o):o,m.memoizedState=m.baseState=o,t=m.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:o},t=t.dispatch=I_.bind(null,Gn,t),[m.memoizedState,t]},useRef:ow,useState:yh,useDebugValue:k_,useDeferredValue:function(t){var o=yh(t),c=o[0],m=o[1];return sw(function(){var x=Pi.transition;Pi.transition=1;try{m(t)}finally{Pi.transition=x}},[t]),c},useTransition:function(){var t=yh(!1),o=t[0];return t=lC.bind(null,t[1]),ow(t),[t,o]},useMutableSource:function(t,o,c){var m=La();return m.memoizedState={refs:{getSnapshot:o,setSnapshot:null},source:t,subscribe:c},rw(m,t,o,c)},useOpaqueIdentifier:function(){if(po){var t=!1,o=nC(function(){throw t||(t=!0,c("r:"+(s_++).toString(36))),Error(Qe(355))}),c=yh(o)[1];return(Gn.mode&2)==0&&(Gn.flags|=516,qp(5,function(){c("r:"+(s_++).toString(36))},void 0,null)),o}return o="r:"+(s_++).toString(36),yh(o),o},unstable_isNewReconciler:!1},uC={readContext:zi,useCallback:uw,useContext:zi,useEffect:Xp,useImperativeHandle:cw,useLayoutEffect:aw,useMemo:hw,useReducer:gh,useRef:Wp,useState:function(){return gh(fo)},useDebugValue:k_,useDeferredValue:function(t){var o=gh(fo),c=o[0],m=o[1];return Xp(function(){var x=Pi.transition;Pi.transition=1;try{m(t)}finally{Pi.transition=x}},[t]),c},useTransition:function(){var t=gh(fo)[0];return[Wp().current,t]},useMutableSource:iw,useOpaqueIdentifier:function(){return gh(fo)[0]},unstable_isNewReconciler:!1},hC={readContext:zi,useCallback:uw,useContext:zi,useEffect:Xp,useImperativeHandle:cw,useLayoutEffect:aw,useMemo:hw,useReducer:_h,useRef:Wp,useState:function(){return _h(fo)},useDebugValue:k_,useDeferredValue:function(t){var o=_h(fo),c=o[0],m=o[1];return Xp(function(){var x=Pi.transition;Pi.transition=1;try{m(t)}finally{Pi.transition=x}},[t]),c},useTransition:function(){var t=_h(fo)[0];return[Wp().current,t]},useMutableSource:iw,useOpaqueIdentifier:function(){return _h(fo)[0]},unstable_isNewReconciler:!1},dC=Ca.ReactCurrentOwner,Ki=!1;function ri(t,o,c,m){o.child=t===null?Y1(o,null,c,m):$p(o,t.child,c,m)}function dw(t,o,c,m,x){c=c.render;var T=o.ref;return sc(o,x),m=S_(t,o,c,m,T,x),t!==null&&!Ki?(o.updateQueue=t.updateQueue,o.flags&=-517,t.lanes&=~x,jo(t,o,x)):(o.flags|=1,ri(t,o,m,x),o.child)}function pw(t,o,c,m,x,T){if(t===null){var k=c.type;return typeof k=="function"&&!Y_(k)&&k.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=k,fw(t,o,k,m,x,T)):(t=sf(c.type,null,m,o,o.mode,T),t.ref=o.ref,t.return=o,o.child=t)}return k=t.child,(x&T)==0&&(x=k.memoizedProps,c=c.compare,c=c!==null?c:nh,c(x,m)&&t.ref===o.ref)?jo(t,o,T):(o.flags|=1,t=Vs(k,m),t.ref=o.ref,t.return=o,o.child=t)}function fw(t,o,c,m,x,T){if(t!==null&&nh(t.memoizedProps,m)&&t.ref===o.ref)if(Ki=!1,(T&x)!=0)(t.flags&16384)!=0&&(Ki=!0);else return o.lanes=t.lanes,jo(t,o,T);return M_(t,o,c,m,T)}function A_(t,o,c){var m=o.pendingProps,x=m.children,T=t!==null?t.memoizedState:null;if(m.mode==="hidden"||m.mode==="unstable-defer-without-hiding")if((o.mode&4)==0)o.memoizedState={baseLanes:0},of(o,c);else if((c&1073741824)!=0)o.memoizedState={baseLanes:0},of(o,T!==null?T.baseLanes:c);else return t=T!==null?T.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:t},of(o,t),null;else T!==null?(m=T.baseLanes|c,o.memoizedState=null):m=c,of(o,m);return ri(t,o,x,c),o.child}function mw(t,o){var c=o.ref;(t===null&&c!==null||t!==null&&t.ref!==c)&&(o.flags|=128)}function M_(t,o,c,m,x){var T=ti(c)?za:Ir.current;return T=rc(o,T),sc(o,x),c=S_(t,o,c,m,T,x),t!==null&&!Ki?(o.updateQueue=t.updateQueue,o.flags&=-517,t.lanes&=~x,jo(t,o,x)):(o.flags|=1,ri(t,o,c,x),o.child)}function gw(t,o,c,m,x){if(ti(c)){var T=!0;Pp(o)}else T=!1;if(sc(o,x),o.stateNode===null)t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),X1(o,c,m),__(o,c,m,x),m=!0;else if(t===null){var k=o.stateNode,a=o.memoizedProps;k.props=a;var B=k.context,W=c.contextType;typeof W=="object"&&W!==null?W=zi(W):(W=ti(c)?za:Ir.current,W=rc(o,W));var ce=c.getDerivedStateFromProps,J=typeof ce=="function"||typeof k.getSnapshotBeforeUpdate=="function";J||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(a!==m||B!==W)&&H1(o,k,m,W),Ps=!1;var q=o.memoizedState;k.state=q,lh(o,m,k,x),B=o.memoizedState,a!==m||q!==B||ei.current||Ps?(typeof ce=="function"&&(Op(o,c,ce,m),B=o.memoizedState),(a=Ps||W1(o,c,a,m,q,B,W))?(J||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(o.flags|=4)):(typeof k.componentDidMount=="function"&&(o.flags|=4),o.memoizedProps=m,o.memoizedState=B),k.props=m,k.state=B,k.context=W,m=a):(typeof k.componentDidMount=="function"&&(o.flags|=4),m=!1)}else{k=o.stateNode,j1(t,o),a=o.memoizedProps,W=o.type===o.elementType?a:Hi(o.type,a),k.props=W,J=o.pendingProps,q=k.context,B=c.contextType,typeof B=="object"&&B!==null?B=zi(B):(B=ti(c)?za:Ir.current,B=rc(o,B));var ve=c.getDerivedStateFromProps;(ce=typeof ve=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(a!==J||q!==B)&&H1(o,k,m,B),Ps=!1,q=o.memoizedState,k.state=q,lh(o,m,k,x);var Ae=o.memoizedState;a!==J||q!==Ae||ei.current||Ps?(typeof ve=="function"&&(Op(o,c,ve,m),Ae=o.memoizedState),(W=Ps||W1(o,c,W,m,q,Ae,B))?(ce||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(m,Ae,B),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(m,Ae,B)),typeof k.componentDidUpdate=="function"&&(o.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(o.flags|=256)):(typeof k.componentDidUpdate!="function"||a===t.memoizedProps&&q===t.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&q===t.memoizedState||(o.flags|=256),o.memoizedProps=m,o.memoizedState=Ae),k.props=m,k.state=Ae,k.context=B,m=W):(typeof k.componentDidUpdate!="function"||a===t.memoizedProps&&q===t.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&q===t.memoizedState||(o.flags|=256),m=!1)}return z_(t,o,c,m,T,x)}function z_(t,o,c,m,x,T){mw(t,o);var k=(o.flags&64)!=0;if(!m&&!k)return x&&D1(o,c,!1),jo(t,o,T);m=o.stateNode,dC.current=o;var a=k&&typeof c.getDerivedStateFromError!="function"?null:m.render();return o.flags|=1,t!==null&&k?(o.child=$p(o,t.child,null,T),o.child=$p(o,null,a,T)):ri(t,o,a,T),o.memoizedState=m.state,x&&D1(o,c,!0),o.child}function _w(t){var o=t.stateNode;o.pendingContext?z1(t,o.pendingContext,o.pendingContext!==o.context):o.context&&z1(t,o.context,!1),y_(t,o.containerInfo)}var Kp={dehydrated:null,retryLane:0};function yw(t,o,c){var m=o.pendingProps,x=jn.current,T=!1,k;return(k=(o.flags&64)!=0)||(k=t!==null&&t.memoizedState===null?!1:(x&2)!=0),k?(T=!0,o.flags&=-65):t!==null&&t.memoizedState===null||m.fallback===void 0||m.unstable_avoidThisFallback===!0||(x|=1),$n(jn,x&1),t===null?(m.fallback!==void 0&&v_(o),t=m.children,x=m.fallback,T?(t=xw(o,t,x,c),o.child.memoizedState={baseLanes:c},o.memoizedState=Kp,t):typeof m.unstable_expectedLoadTime=="number"?(t=xw(o,t,x,c),o.child.memoizedState={baseLanes:c},o.memoizedState=Kp,o.lanes=33554432,t):(c=Q_({mode:"visible",children:t},o.mode,c,null),c.return=o,o.child=c)):t.memoizedState!==null?T?(m=ww(t,o,m.children,m.fallback,c),T=o.child,x=t.child.memoizedState,T.memoizedState=x===null?{baseLanes:c}:{baseLanes:x.baseLanes|c},T.childLanes=t.childLanes&~c,o.memoizedState=Kp,m):(c=vw(t,o,m.children,c),o.memoizedState=null,c):T?(m=ww(t,o,m.children,m.fallback,c),T=o.child,x=t.child.memoizedState,T.memoizedState=x===null?{baseLanes:c}:{baseLanes:x.baseLanes|c},T.childLanes=t.childLanes&~c,o.memoizedState=Kp,m):(c=vw(t,o,m.children,c),o.memoizedState=null,c)}function xw(t,o,c,m){var x=t.mode,T=t.child;return o={mode:"hidden",children:o},(x&2)==0&&T!==null?(T.childLanes=0,T.pendingProps=o):T=Q_(o,x,0,null),c=fc(c,x,m,null),T.return=t,c.return=t,T.sibling=c,t.child=T,c}function vw(t,o,c,m){var x=t.child;return t=x.sibling,c=Vs(x,{mode:"visible",children:c}),(o.mode&2)==0&&(c.lanes=m),c.return=o,c.sibling=null,t!==null&&(t.nextEffect=null,t.flags=8,o.firstEffect=o.lastEffect=t),o.child=c}function ww(t,o,c,m,x){var T=o.mode,k=t.child;t=k.sibling;var a={mode:"hidden",children:c};return(T&2)==0&&o.child!==k?(c=o.child,c.childLanes=0,c.pendingProps=a,k=c.lastEffect,k!==null?(o.firstEffect=c.firstEffect,o.lastEffect=k,k.nextEffect=null):o.firstEffect=o.lastEffect=null):c=Vs(k,a),t!==null?m=Vs(t,m):(m=fc(m,T,x,null),m.flags|=2),m.return=o,c.return=o,c.sibling=m,o.child=c,m}function bw(t,o){t.lanes|=o;var c=t.alternate;c!==null&&(c.lanes|=o),$1(t.return,o)}function P_(t,o,c,m,x,T){var k=t.memoizedState;k===null?t.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:x,lastEffect:T}:(k.isBackwards=o,k.rendering=null,k.renderingStartTime=0,k.last=m,k.tail=c,k.tailMode=x,k.lastEffect=T)}function Tw(t,o,c){var m=o.pendingProps,x=m.revealOrder,T=m.tail;if(ri(t,o,m.children,c),m=jn.current,(m&2)!=0)m=m&1|2,o.flags|=64;else{if(t!==null&&(t.flags&64)!=0)e:for(t=o.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bw(t,c);else if(t.tag===19)bw(t,c);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===o)break e;for(;t.sibling===null;){if(t.return===null||t.return===o)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}m&=1}if($n(jn,m),(o.mode&2)==0)o.memoizedState=null;else switch(x){case"forwards":for(c=o.child,x=null;c!==null;)t=c.alternate,t!==null&&jp(t)===null&&(x=c),c=c.sibling;c=x,c===null?(x=o.child,o.child=null):(x=c.sibling,c.sibling=null),P_(o,!1,x,c,T,o.lastEffect);break;case"backwards":for(c=null,x=o.child,o.child=null;x!==null;){if(t=x.alternate,t!==null&&jp(t)===null){o.child=x;break}t=x.sibling,x.sibling=c,c=x,x=t}P_(o,!0,c,null,T,o.lastEffect);break;case"together":P_(o,!1,null,null,void 0,o.lastEffect);break;default:o.memoizedState=null}return o.child}function jo(t,o,c){if(t!==null&&(o.dependencies=t.dependencies),vh|=o.lanes,(c&o.childLanes)!=0){if(t!==null&&o.child!==t.child)throw Error(Qe(153));if(o.child!==null){for(t=o.child,c=Vs(t,t.pendingProps),o.child=c,c.return=o;t.sibling!==null;)t=t.sibling,c=c.sibling=Vs(t,t.pendingProps),c.return=o;c.sibling=null}return o.child}return null}var Sw,D_,Ew,Cw;Sw=function(t,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)t.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}};D_=function(){};Ew=function(t,o,c,m){var x=t.memoizedProps;if(x!==m){t=o.stateNode,Ra(ho.current);var T=null;switch(c){case"input":x=_g(t,x),m=_g(t,m),T=[];break;case"option":x=vg(t,x),m=vg(t,m),T=[];break;case"select":x=Dn({},x,{value:void 0}),m=Dn({},m,{value:void 0}),T=[];break;case"textarea":x=wg(t,x),m=wg(t,m),T=[];break;default:typeof x.onClick!="function"&&typeof m.onClick=="function"&&(t.onclick=kp)}Sg(c,m);var k;c=null;for(W in x)if(!m.hasOwnProperty(W)&&x.hasOwnProperty(W)&&x[W]!=null)if(W==="style"){var a=x[W];for(k in a)a.hasOwnProperty(k)&&(c||(c={}),c[k]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(Ru.hasOwnProperty(W)?T||(T=[]):(T=T||[]).push(W,null));for(W in m){var B=m[W];if(a=x!=null?x[W]:void 0,m.hasOwnProperty(W)&&B!==a&&(B!=null||a!=null))if(W==="style")if(a){for(k in a)!a.hasOwnProperty(k)||B&&B.hasOwnProperty(k)||(c||(c={}),c[k]="");for(k in B)B.hasOwnProperty(k)&&a[k]!==B[k]&&(c||(c={}),c[k]=B[k])}else c||(T||(T=[]),T.push(W,c)),c=B;else W==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,a=a?a.__html:void 0,B!=null&&a!==B&&(T=T||[]).push(W,B)):W==="children"?typeof B!="string"&&typeof B!="number"||(T=T||[]).push(W,""+B):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(Ru.hasOwnProperty(W)?(B!=null&&W==="onScroll"&&Sn("scroll",t),T||a===B||(T=[])):typeof B=="object"&&B!==null&&B.$$typeof===dg?B.toString():(T=T||[]).push(W,B))}c&&(T=T||[]).push("style",c);var W=T;(o.updateQueue=W)&&(o.flags|=4)}};Cw=function(t,o,c,m){c!==m&&(o.flags|=4)};function xh(t,o){if(!po)switch(t.tailMode){case"hidden":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?t.tail=null:c.sibling=null;break;case"collapsed":c=t.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o||t.tail===null?t.tail=null:t.tail.sibling=null:m.sibling=null}}function pC(t,o,c){var m=o.pendingProps;switch(o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ti(o.type)&&zp(),null;case 3:return ac(),En(ei),En(Ir),b_(),m=o.stateNode,m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(t===null||t.child===null)&&(Gp(o)?o.flags|=4:m.hydrate||(o.flags|=256)),D_(o),null;case 5:x_(o);var x=Ra(dh.current);if(c=o.type,t!==null&&o.stateNode!=null)Ew(t,o,c,m,x),t.ref!==o.ref&&(o.flags|=128);else{if(!m){if(o.stateNode===null)throw Error(Qe(166));return null}if(t=Ra(ho.current),Gp(o)){m=o.stateNode,c=o.type;var T=o.memoizedProps;switch(m[As]=o,m[Ap]=T,c){case"dialog":Sn("cancel",m),Sn("close",m);break;case"iframe":case"object":case"embed":Sn("load",m);break;case"video":case"audio":for(t=0;t<ih.length;t++)Sn(ih[t],m);break;case"source":Sn("error",m);break;case"img":case"image":case"link":Sn("error",m),Sn("load",m);break;case"details":Sn("toggle",m);break;case"input":gv(m,T),Sn("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!T.multiple},Sn("invalid",m);break;case"textarea":xv(m,T),Sn("invalid",m)}Sg(c,T),t=null;for(var k in T)T.hasOwnProperty(k)&&(x=T[k],k==="children"?typeof x=="string"?m.textContent!==x&&(t=["children",x]):typeof x=="number"&&m.textContent!==""+x&&(t=["children",""+x]):Ru.hasOwnProperty(k)&&x!=null&&k==="onScroll"&&Sn("scroll",m));switch(c){case"input":up(m),yv(m,T,!0);break;case"textarea":up(m),wv(m);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(m.onclick=kp)}m=t,o.updateQueue=m,m!==null&&(o.flags|=4)}else{switch(k=x.nodeType===9?x:x.ownerDocument,t===bg.html&&(t=bv(c)),t===bg.html?c==="script"?(t=k.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof m.is=="string"?t=k.createElement(c,{is:m.is}):(t=k.createElement(c),c==="select"&&(k=t,m.multiple?k.multiple=!0:m.size&&(k.size=m.size))):t=k.createElementNS(t,c),t[As]=o,t[Ap]=m,Sw(t,o,!1,!1),o.stateNode=t,k=Eg(c,m),c){case"dialog":Sn("cancel",t),Sn("close",t),x=m;break;case"iframe":case"object":case"embed":Sn("load",t),x=m;break;case"video":case"audio":for(x=0;x<ih.length;x++)Sn(ih[x],t);x=m;break;case"source":Sn("error",t),x=m;break;case"img":case"image":case"link":Sn("error",t),Sn("load",t),x=m;break;case"details":Sn("toggle",t),x=m;break;case"input":gv(t,m),x=_g(t,m),Sn("invalid",t);break;case"option":x=vg(t,m);break;case"select":t._wrapperState={wasMultiple:!!m.multiple},x=Dn({},m,{value:void 0}),Sn("invalid",t);break;case"textarea":xv(t,m),x=wg(t,m),Sn("invalid",t);break;default:x=m}Sg(c,x);var a=x;for(T in a)if(a.hasOwnProperty(T)){var B=a[T];T==="style"?Ev(t,B):T==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&Tv(t,B)):T==="children"?typeof B=="string"?(c!=="textarea"||B!=="")&&Uu(t,B):typeof B=="number"&&Uu(t,""+B):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(Ru.hasOwnProperty(T)?B!=null&&T==="onScroll"&&Sn("scroll",t):B!=null&&sg(t,T,B,k))}switch(c){case"input":up(t),yv(t,m,!1);break;case"textarea":up(t),wv(t);break;case"option":m.value!=null&&t.setAttribute("value",""+Ts(m.value));break;case"select":t.multiple=!!m.multiple,T=m.value,T!=null?jl(t,!!m.multiple,T,!1):m.defaultValue!=null&&jl(t,!!m.multiple,m.defaultValue,!0);break;default:typeof x.onClick=="function"&&(t.onclick=kp)}C1(c,m)&&(o.flags|=4)}o.ref!==null&&(o.flags|=128)}return null;case 6:if(t&&o.stateNode!=null)Cw(t,o,t.memoizedProps,m);else{if(typeof m!="string"&&o.stateNode===null)throw Error(Qe(166));c=Ra(dh.current),Ra(ho.current),Gp(o)?(m=o.stateNode,c=o.memoizedProps,m[As]=o,m.nodeValue!==c&&(o.flags|=4)):(m=(c.nodeType===9?c:c.ownerDocument).createTextNode(m),m[As]=o,o.stateNode=m)}return null;case 13:return En(jn),m=o.memoizedState,(o.flags&64)!=0?(o.lanes=c,o):(m=m!==null,c=!1,t===null?o.memoizedProps.fallback!==void 0&&Gp(o):c=t.memoizedState!==null,m&&!c&&(o.mode&2)!=0&&(t===null&&o.memoizedProps.unstable_avoidThisFallback!==!0||(jn.current&1)!=0?wr===0&&(wr=3):((wr===0||wr===3)&&(wr=4),$r===null||(vh&134217727)==0&&(uc&134217727)==0||dc($r,zr))),(m||c)&&(o.flags|=4),null);case 4:return ac(),D_(o),t===null&&w1(o.stateNode.containerInfo),null;case 10:return m_(o),null;case 17:return ti(o.type)&&zp(),null;case 19:if(En(jn),m=o.memoizedState,m===null)return null;if(T=(o.flags&64)!=0,k=m.rendering,k===null)if(T)xh(m,!1);else{if(wr!==0||t!==null&&(t.flags&64)!=0)for(t=o.child;t!==null;){if(k=jp(t),k!==null){for(o.flags|=64,xh(m,!1),T=k.updateQueue,T!==null&&(o.updateQueue=T,o.flags|=4),m.lastEffect===null&&(o.firstEffect=null),o.lastEffect=m.lastEffect,m=c,c=o.child;c!==null;)T=c,t=m,T.flags&=2,T.nextEffect=null,T.firstEffect=null,T.lastEffect=null,k=T.alternate,k===null?(T.childLanes=0,T.lanes=t,T.child=null,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=k.childLanes,T.lanes=k.lanes,T.child=k.child,T.memoizedProps=k.memoizedProps,T.memoizedState=k.memoizedState,T.updateQueue=k.updateQueue,T.type=k.type,t=k.dependencies,T.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),c=c.sibling;return $n(jn,jn.current&1|2),o.child}t=t.sibling}m.tail!==null&&Ar()>G_&&(o.flags|=64,T=!0,xh(m,!1),o.lanes=33554432)}else{if(!T)if(t=jp(k),t!==null){if(o.flags|=64,T=!0,c=t.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),xh(m,!0),m.tail===null&&m.tailMode==="hidden"&&!k.alternate&&!po)return o=o.lastEffect=m.lastEffect,o!==null&&(o.nextEffect=null),null}else 2*Ar()-m.renderingStartTime>G_&&c!==1073741824&&(o.flags|=64,T=!0,xh(m,!1),o.lanes=33554432);m.isBackwards?(k.sibling=o.child,o.child=k):(c=m.last,c!==null?c.sibling=k:o.child=k,m.last=k)}return m.tail!==null?(c=m.tail,m.rendering=c,m.tail=c.sibling,m.lastEffect=o.lastEffect,m.renderingStartTime=Ar(),c.sibling=null,o=jn.current,$n(jn,T?o&1|2:o&1),c):null;case 23:case 24:return K_(),t!==null&&t.memoizedState!==null!=(o.memoizedState!==null)&&m.mode!=="unstable-defer-without-hiding"&&(o.flags|=4),null}throw Error(Qe(156,o.tag))}function fC(t){switch(t.tag){case 1:ti(t.type)&&zp();var o=t.flags;return o&4096?(t.flags=o&-4097|64,t):null;case 3:if(ac(),En(ei),En(Ir),b_(),o=t.flags,(o&64)!=0)throw Error(Qe(285));return t.flags=o&-4097|64,t;case 5:return x_(t),null;case 13:return En(jn),o=t.flags,o&4096?(t.flags=o&-4097|64,t):null;case 19:return En(jn),null;case 4:return ac(),null;case 10:return m_(t),null;case 23:case 24:return K_(),null;default:return null}}function R_(t,o){try{var c="",m=o;do c+=XS(m),m=m.return;while(m);var x=c}catch(T){x=`
Error generating stack: `+T.message+`
`+T.stack}return{value:t,source:o,stack:x}}function L_(t,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var mC=typeof WeakMap=="function"?WeakMap:Map;function kw(t,o,c){c=Ds(-1,c),c.tag=3,c.payload={element:null};var m=o.value;return c.callback=function(){Jp||(Jp=!0,Z_=m),L_(t,o)},c}function Iw(t,o,c){c=Ds(-1,c),c.tag=3;var m=t.type.getDerivedStateFromError;if(typeof m=="function"){var x=o.value;c.payload=function(){return L_(t,o),m(x)}}var T=t.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(c.callback=function(){typeof m!="function"&&(mo===null?mo=new Set([this]):mo.add(this),L_(t,o));var k=o.stack;this.componentDidCatch(o.value,{componentStack:k!==null?k:""})}),c}var gC=typeof WeakSet=="function"?WeakSet:Set;function Aw(t){var o=t.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){Us(t,c)}else o.current=null}function _C(t,o){switch(o.tag){case 0:case 11:case 15:case 22:return;case 1:if(o.flags&256&&t!==null){var c=t.memoizedProps,m=t.memoizedState;t=o.stateNode,o=t.getSnapshotBeforeUpdate(o.elementType===o.type?c:Hi(o.type,c),m),t.__reactInternalSnapshotBeforeUpdate=o}return;case 3:o.flags&256&&o_(o.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(Qe(163))}function yC(t,o,c){switch(c.tag){case 0:case 11:case 15:case 22:if(o=c.updateQueue,o=o!==null?o.lastEffect:null,o!==null){t=o=o.next;do{if((t.tag&3)==3){var m=t.create;t.destroy=m()}t=t.next}while(t!==o)}if(o=c.updateQueue,o=o!==null?o.lastEffect:null,o!==null){t=o=o.next;do{var x=t;m=x.next,x=x.tag,(x&4)!=0&&(x&1)!=0&&(Gw(c,t),CC(c,t)),t=m}while(t!==o)}return;case 1:t=c.stateNode,c.flags&4&&(o===null?t.componentDidMount():(m=c.elementType===c.type?o.memoizedProps:Hi(c.type,o.memoizedProps),t.componentDidUpdate(m,o.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),o=c.updateQueue,o!==null&&Z1(c,o,t);return;case 3:if(o=c.updateQueue,o!==null){if(t=null,c.child!==null)switch(c.child.tag){case 5:t=c.child.stateNode;break;case 1:t=c.child.stateNode}Z1(c,o,t)}return;case 5:t=c.stateNode,o===null&&c.flags&4&&C1(c.type,c.memoizedProps)&&t.focus();return;case 6:return;case 4:return;case 12:return;case 13:c.memoizedState===null&&(c=c.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&Vv(c))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Qe(163))}function Mw(t,o){for(var c=t;;){if(c.tag===5){var m=c.stateNode;if(o)m=m.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{m=c.stateNode;var x=c.memoizedProps.style;x=x!=null&&x.hasOwnProperty("display")?x.display:null,m.style.display=Sv("display",x)}}else if(c.tag===6)c.stateNode.nodeValue=o?"":c.memoizedProps;else if((c.tag!==23&&c.tag!==24||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break;for(;c.sibling===null;){if(c.return===null||c.return===t)return;c=c.return}c.sibling.return=c.return,c=c.sibling}}function zw(t,o){if(Pa&&typeof Pa.onCommitFiberUnmount=="function")try{Pa.onCommitFiberUnmount(l_,o)}catch{}switch(o.tag){case 0:case 11:case 14:case 15:case 22:if(t=o.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var c=t=t.next;do{var m=c,x=m.destroy;if(m=m.tag,x!==void 0)if((m&4)!=0)Gw(o,c);else{m=o;try{x()}catch(T){Us(m,T)}}c=c.next}while(c!==t)}break;case 1:if(Aw(o),t=o.stateNode,typeof t.componentWillUnmount=="function")try{t.props=o.memoizedProps,t.state=o.memoizedState,t.componentWillUnmount()}catch(T){Us(o,T)}break;case 5:Aw(o);break;case 4:Lw(t,o)}}function Pw(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function Dw(t){return t.tag===5||t.tag===3||t.tag===4}function Rw(t){e:{for(var o=t.return;o!==null;){if(Dw(o))break e;o=o.return}throw Error(Qe(160))}var c=o;switch(o=c.stateNode,c.tag){case 5:var m=!1;break;case 3:o=o.containerInfo,m=!0;break;case 4:o=o.containerInfo,m=!0;break;default:throw Error(Qe(161))}c.flags&16&&(Uu(o,""),c.flags&=-17);e:t:for(c=t;;){for(;c.sibling===null;){if(c.return===null||Dw(c.return)){c=null;break e}c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue t;c.child.return=c,c=c.child}if(!(c.flags&2)){c=c.stateNode;break e}}m?B_(t,c,o):F_(t,c,o)}function B_(t,o,c){var m=t.tag,x=m===5||m===6;if(x)t=x?t.stateNode:t.stateNode.instance,o?c.nodeType===8?c.parentNode.insertBefore(t,o):c.insertBefore(t,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(t,c)):(o=c,o.appendChild(t)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=kp));else if(m!==4&&(t=t.child,t!==null))for(B_(t,o,c),t=t.sibling;t!==null;)B_(t,o,c),t=t.sibling}function F_(t,o,c){var m=t.tag,x=m===5||m===6;if(x)t=x?t.stateNode:t.stateNode.instance,o?c.insertBefore(t,o):c.appendChild(t);else if(m!==4&&(t=t.child,t!==null))for(F_(t,o,c),t=t.sibling;t!==null;)F_(t,o,c),t=t.sibling}function Lw(t,o){for(var c=o,m=!1,x,T;;){if(!m){m=c.return;e:for(;;){if(m===null)throw Error(Qe(160));switch(x=m.stateNode,m.tag){case 5:T=!1;break e;case 3:x=x.containerInfo,T=!0;break e;case 4:x=x.containerInfo,T=!0;break e}m=m.return}m=!0}if(c.tag===5||c.tag===6){e:for(var k=t,a=c,B=a;;)if(zw(k,B),B.child!==null&&B.tag!==4)B.child.return=B,B=B.child;else{if(B===a)break e;for(;B.sibling===null;){if(B.return===null||B.return===a)break e;B=B.return}B.sibling.return=B.return,B=B.sibling}T?(k=x,a=c.stateNode,k.nodeType===8?k.parentNode.removeChild(a):k.removeChild(a)):x.removeChild(c.stateNode)}else if(c.tag===4){if(c.child!==null){x=c.stateNode.containerInfo,T=!0,c.child.return=c,c=c.child;continue}}else if(zw(t,c),c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return,c.tag===4&&(m=!1)}c.sibling.return=c.return,c=c.sibling}}function O_(t,o){switch(o.tag){case 0:case 11:case 14:case 15:case 22:var c=o.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do(m.tag&3)==3&&(t=m.destroy,m.destroy=void 0,t!==void 0&&t()),m=m.next;while(m!==c)}return;case 1:return;case 5:if(c=o.stateNode,c!=null){m=o.memoizedProps;var x=t!==null?t.memoizedProps:m;t=o.type;var T=o.updateQueue;if(o.updateQueue=null,T!==null){for(c[Ap]=m,t==="input"&&m.type==="radio"&&m.name!=null&&_v(c,m),Eg(t,x),o=Eg(t,m),x=0;x<T.length;x+=2){var k=T[x],a=T[x+1];k==="style"?Ev(c,a):k==="dangerouslySetInnerHTML"?Tv(c,a):k==="children"?Uu(c,a):sg(c,k,a,o)}switch(t){case"input":yg(c,m);break;case"textarea":vv(c,m);break;case"select":t=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!m.multiple,T=m.value,T!=null?jl(c,!!m.multiple,T,!1):t!==!!m.multiple&&(m.defaultValue!=null?jl(c,!!m.multiple,m.defaultValue,!0):jl(c,!!m.multiple,m.multiple?[]:"",!1))}}}return;case 6:if(o.stateNode===null)throw Error(Qe(162));o.stateNode.nodeValue=o.memoizedProps;return;case 3:c=o.stateNode,c.hydrate&&(c.hydrate=!1,Vv(c.containerInfo));return;case 12:return;case 13:o.memoizedState!==null&&(j_=Ar(),Mw(o.child,!0)),Bw(o);return;case 19:Bw(o);return;case 17:return;case 23:case 24:Mw(o,o.memoizedState!==null);return}throw Error(Qe(163))}function Bw(t){var o=t.updateQueue;if(o!==null){t.updateQueue=null;var c=t.stateNode;c===null&&(c=t.stateNode=new gC),o.forEach(function(m){var x=AC.bind(null,t,m);c.has(m)||(c.add(m),m.then(x,x))})}}function xC(t,o){return t!==null&&(t=t.memoizedState,t===null||t.dehydrated!==null)?(o=o.memoizedState,o!==null&&o.dehydrated===null):!1}var vC=Math.ceil,Yp=Ca.ReactCurrentDispatcher,N_=Ca.ReactCurrentOwner,Tt=0,$r=null,or=null,zr=0,Fa=0,U_=Ms(0),wr=0,Qp=null,cc=0,vh=0,uc=0,V_=0,$_=null,j_=0,G_=1/0;function hc(){G_=Ar()+500}var at=null,Jp=!1,Z_=null,mo=null,Bs=!1,wh=null,bh=90,q_=[],W_=[],Go=null,Th=0,X_=null,ef=-1,Zo=0,tf=0,Sh=null,nf=!1;function xi(){return(Tt&48)!=0?Ar():ef!==-1?ef:ef=Ar()}function Fs(t){if(t=t.mode,(t&2)==0)return 1;if((t&4)==0)return ic()===99?1:2;if(Zo===0&&(Zo=cc),aC.transition!==0){tf!==0&&(tf=$_!==null?$_.pendingLanes:0),t=Zo;var o=4186112&~tf;return o&=-o,o===0&&(t=4186112&~t,o=t&-t,o===0&&(o=8192)),o}return t=ic(),(Tt&4)!=0&&t===98?t=yp(12,Zo):(t=uE(t),t=yp(t,Zo)),t}function Os(t,o,c){if(50<Th)throw Th=0,X_=null,Error(Qe(185));if(t=rf(t,o),t===null)return null;xp(t,o,c),t===$r&&(uc|=o,wr===4&&dc(t,zr));var m=ic();o===1?(Tt&8)!=0&&(Tt&48)==0?H_(t):(Di(t,c),Tt===0&&(hc(),uo())):((Tt&4)==0||m!==98&&m!==99||(Go===null?Go=new Set([t]):Go.add(t)),Di(t,c)),$_=t}function rf(t,o){t.lanes|=o;var c=t.alternate;for(c!==null&&(c.lanes|=o),c=t,t=t.return;t!==null;)t.childLanes|=o,c=t.alternate,c!==null&&(c.childLanes|=o),c=t,t=t.return;return c.tag===3?c.stateNode:null}function Di(t,o){for(var c=t.callbackNode,m=t.suspendedLanes,x=t.pingedLanes,T=t.expirationTimes,k=t.pendingLanes;0<k;){var a=31-ks(k),B=1<<a,W=T[a];if(W===-1){if((B&m)==0||(B&x)!=0){W=o,Wl(B);var ce=yn;T[a]=10<=ce?W+250:6<=ce?W+5e3:-1}}else W<=o&&(t.expiredLanes|=B);k&=~B}if(m=Ku(t,t===$r?zr:0),o=yn,m===0)c!==null&&(c!==d_&&u_(c),t.callbackNode=null,t.callbackPriority=0);else{if(c!==null){if(t.callbackPriority===o)return;c!==d_&&u_(c)}o===15?(c=H_.bind(null,t),Vo===null?(Vo=[c],Rp=c_(Dp,V1)):Vo.push(c),c=d_):o===14?c=ah(99,H_.bind(null,t)):(c=hE(o),c=ah(c,Fw.bind(null,t))),t.callbackPriority=o,t.callbackNode=c}}function Fw(t){if(ef=-1,tf=Zo=0,(Tt&48)!=0)throw Error(Qe(327));var o=t.callbackNode;if(Ns()&&t.callbackNode!==o)return null;var c=Ku(t,t===$r?zr:0);if(c===0)return null;var m=c,x=Tt;Tt|=16;var T=Vw();($r!==t||zr!==m)&&(hc(),pc(t,m));do try{TC();break}catch(a){Uw(t,a)}while(1);if(f_(),Yp.current=T,Tt=x,or!==null?m=0:($r=null,zr=0,m=wr),(cc&uc)!=0)pc(t,0);else if(m!==0){if(m===2&&(Tt|=64,t.hydrate&&(t.hydrate=!1,o_(t.containerInfo)),c=Xv(t),c!==0&&(m=Eh(t,c))),m===1)throw o=Qp,pc(t,0),dc(t,c),Di(t,Ar()),o;switch(t.finishedWork=t.current.alternate,t.finishedLanes=c,m){case 0:case 1:throw Error(Qe(345));case 2:Oa(t);break;case 3:if(dc(t,c),(c&62914560)===c&&(m=j_+500-Ar(),10<m)){if(Ku(t,0)!==0)break;if(x=t.suspendedLanes,(x&c)!==c){xi(),t.pingedLanes|=t.suspendedLanes&x;break}t.timeoutHandle=k1(Oa.bind(null,t),m);break}Oa(t);break;case 4:if(dc(t,c),(c&4186112)===c)break;for(m=t.eventTimes,x=-1;0<c;){var k=31-ks(c);T=1<<k,k=m[k],k>x&&(x=k),c&=~T}if(c=x,c=Ar()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*vC(c/1960))-c,10<c){t.timeoutHandle=k1(Oa.bind(null,t),c);break}Oa(t);break;case 5:Oa(t);break;default:throw Error(Qe(329))}}return Di(t,Ar()),t.callbackNode===o?Fw.bind(null,t):null}function dc(t,o){for(o&=~V_,o&=~uc,t.suspendedLanes|=o,t.pingedLanes&=~o,t=t.expirationTimes;0<o;){var c=31-ks(o),m=1<<c;t[c]=-1,o&=~m}}function H_(t){if((Tt&48)!=0)throw Error(Qe(327));if(Ns(),t===$r&&(t.expiredLanes&zr)!=0){var o=zr,c=Eh(t,o);(cc&uc)!=0&&(o=Ku(t,o),c=Eh(t,o))}else o=Ku(t,0),c=Eh(t,o);if(t.tag!==0&&c===2&&(Tt|=64,t.hydrate&&(t.hydrate=!1,o_(t.containerInfo)),o=Xv(t),o!==0&&(c=Eh(t,o))),c===1)throw c=Qp,pc(t,0),dc(t,o),Di(t,Ar()),c;return t.finishedWork=t.current.alternate,t.finishedLanes=o,Oa(t),Di(t,Ar()),null}function wC(){if(Go!==null){var t=Go;Go=null,t.forEach(function(o){o.expiredLanes|=24&o.pendingLanes,Di(o,Ar())})}uo()}function Ow(t,o){var c=Tt;Tt|=1;try{return t(o)}finally{Tt=c,Tt===0&&(hc(),uo())}}function Nw(t,o){var c=Tt;Tt&=-2,Tt|=8;try{return t(o)}finally{Tt=c,Tt===0&&(hc(),uo())}}function of(t,o){$n(U_,Fa),Fa|=o,cc|=o}function K_(){Fa=U_.current,En(U_)}function pc(t,o){t.finishedWork=null,t.finishedLanes=0;var c=t.timeoutHandle;if(c!==-1&&(t.timeoutHandle=-1,tC(c)),or!==null)for(c=or.return;c!==null;){var m=c;switch(m.tag){case 1:m=m.type.childContextTypes,m!=null&&zp();break;case 3:ac(),En(ei),En(Ir),b_();break;case 5:x_(m);break;case 4:ac();break;case 13:En(jn);break;case 19:En(jn);break;case 10:m_(m);break;case 23:case 24:K_()}c=c.return}$r=t,or=Vs(t.current,null),zr=Fa=cc=o,wr=0,Qp=null,V_=uc=vh=0}function Uw(t,o){do{var c=or;try{if(f_(),ph.current=Hp,Zp){for(var m=Gn.memoizedState;m!==null;){var x=m.queue;x!==null&&(x.pending=null),m=m.next}Zp=!1}if(fh=0,vr=Mr=Gn=null,mh=!1,N_.current=null,c===null||c.return===null){wr=1,Qp=o,or=null;break}e:{var T=t,k=c.return,a=c,B=o;if(o=zr,a.flags|=2048,a.firstEffect=a.lastEffect=null,B!==null&&typeof B=="object"&&typeof B.then=="function"){var W=B;if((a.mode&2)==0){var ce=a.alternate;ce?(a.updateQueue=ce.updateQueue,a.memoizedState=ce.memoizedState,a.lanes=ce.lanes):(a.updateQueue=null,a.memoizedState=null)}var J=(jn.current&1)!=0,q=k;do{var ve;if(ve=q.tag===13){var Ae=q.memoizedState;if(Ae!==null)ve=Ae.dehydrated!==null;else{var Se=q.memoizedProps;ve=Se.fallback===void 0?!1:Se.unstable_avoidThisFallback!==!0?!0:!J}}if(ve){var ee=q.updateQueue;if(ee===null){var Q=new Set;Q.add(W),q.updateQueue=Q}else ee.add(W);if((q.mode&2)==0){if(q.flags|=64,a.flags|=16384,a.flags&=-2981,a.tag===1)if(a.alternate===null)a.tag=17;else{var re=Ds(-1,1);re.tag=2,Rs(a,re)}a.lanes|=1;break e}B=void 0,a=o;var Te=T.pingCache;if(Te===null?(Te=T.pingCache=new mC,B=new Set,Te.set(W,B)):(B=Te.get(W),B===void 0&&(B=new Set,Te.set(W,B))),!B.has(a)){B.add(a);var xe=IC.bind(null,T,W,a);W.then(xe,xe)}q.flags|=4096,q.lanes=o;break e}q=q.return}while(q!==null);B=Error(($l(a.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}wr!==5&&(wr=2),B=R_(B,a),q=k;do{switch(q.tag){case 3:T=B,q.flags|=4096,o&=-o,q.lanes|=o;var Ve=kw(q,T,o);G1(q,Ve);break e;case 1:T=B;var Ie=q.type,$e=q.stateNode;if((q.flags&64)==0&&(typeof Ie.getDerivedStateFromError=="function"||$e!==null&&typeof $e.componentDidCatch=="function"&&(mo===null||!mo.has($e)))){q.flags|=4096,o&=-o,q.lanes|=o;var We=Iw(q,T,o);G1(q,We);break e}}q=q.return}while(q!==null)}jw(c)}catch(je){o=je,or===c&&c!==null&&(or=c=c.return);continue}break}while(1)}function Vw(){var t=Yp.current;return Yp.current=Hp,t===null?Hp:t}function Eh(t,o){var c=Tt;Tt|=16;var m=Vw();$r===t&&zr===o||pc(t,o);do try{bC();break}catch(x){Uw(t,x)}while(1);if(f_(),Tt=c,Yp.current=m,or!==null)throw Error(Qe(261));return $r=null,zr=0,wr}function bC(){for(;or!==null;)$w(or)}function TC(){for(;or!==null&&!iC();)$w(or)}function $w(t){var o=qw(t.alternate,t,Fa);t.memoizedProps=t.pendingProps,o===null?jw(t):or=o,N_.current=null}function jw(t){var o=t;do{var c=o.alternate;if(t=o.return,(o.flags&2048)==0){if(c=pC(c,o,Fa),c!==null){or=c;return}if(c=o,c.tag!==24&&c.tag!==23||c.memoizedState===null||(Fa&1073741824)!=0||(c.mode&4)==0){for(var m=0,x=c.child;x!==null;)m|=x.lanes|x.childLanes,x=x.sibling;c.childLanes=m}t!==null&&(t.flags&2048)==0&&(t.firstEffect===null&&(t.firstEffect=o.firstEffect),o.lastEffect!==null&&(t.lastEffect!==null&&(t.lastEffect.nextEffect=o.firstEffect),t.lastEffect=o.lastEffect),1<o.flags&&(t.lastEffect!==null?t.lastEffect.nextEffect=o:t.firstEffect=o,t.lastEffect=o))}else{if(c=fC(o),c!==null){c.flags&=2047,or=c;return}t!==null&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(o=o.sibling,o!==null){or=o;return}or=o=t}while(o!==null);wr===0&&(wr=5)}function Oa(t){var o=ic();return Da(99,SC.bind(null,t,o)),null}function SC(t,o){do Ns();while(wh!==null);if((Tt&48)!=0)throw Error(Qe(327));var c=t.finishedWork;if(c===null)return null;if(t.finishedWork=null,t.finishedLanes=0,c===t.current)throw Error(Qe(177));t.callbackNode=null;var m=c.lanes|c.childLanes,x=m,T=t.pendingLanes&~x;t.pendingLanes=x,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=x,t.mutableReadLanes&=x,t.entangledLanes&=x,x=t.entanglements;for(var k=t.eventTimes,a=t.expirationTimes;0<T;){var B=31-ks(T),W=1<<B;x[B]=0,k[B]=-1,a[B]=-1,T&=~W}if(Go!==null&&(m&24)==0&&Go.has(t)&&Go.delete(t),t===$r&&(or=$r=null,zr=0),1<c.flags?c.lastEffect!==null?(c.lastEffect.nextEffect=c,m=c.firstEffect):m=c:m=c.firstEffect,m!==null){if(x=Tt,Tt|=32,N_.current=null,n_=vp,k=f1(),Qg(k)){if("selectionStart"in k)a={start:k.selectionStart,end:k.selectionEnd};else e:if(a=(a=k.ownerDocument)&&a.defaultView||window,(W=a.getSelection&&a.getSelection())&&W.rangeCount!==0){a=W.anchorNode,T=W.anchorOffset,B=W.focusNode,W=W.focusOffset;try{a.nodeType,B.nodeType}catch{a=null;break e}var ce=0,J=-1,q=-1,ve=0,Ae=0,Se=k,ee=null;t:for(;;){for(var Q;Se!==a||T!==0&&Se.nodeType!==3||(J=ce+T),Se!==B||W!==0&&Se.nodeType!==3||(q=ce+W),Se.nodeType===3&&(ce+=Se.nodeValue.length),(Q=Se.firstChild)!==null;)ee=Se,Se=Q;for(;;){if(Se===k)break t;if(ee===a&&++ve===T&&(J=ce),ee===B&&++Ae===W&&(q=ce),(Q=Se.nextSibling)!==null)break;Se=ee,ee=Se.parentNode}Se=Q}a=J===-1||q===-1?null:{start:J,end:q}}else a=null;a=a||{start:0,end:0}}else a=null;r_={focusedElem:k,selectionRange:a},vp=!1,Sh=null,nf=!1,at=m;do try{EC()}catch(je){if(at===null)throw Error(Qe(330));Us(at,je),at=at.nextEffect}while(at!==null);Sh=null,at=m;do try{for(k=t;at!==null;){var re=at.flags;if(re&16&&Uu(at.stateNode,""),re&128){var Te=at.alternate;if(Te!==null){var xe=Te.ref;xe!==null&&(typeof xe=="function"?xe(null):xe.current=null)}}switch(re&1038){case 2:Rw(at),at.flags&=-3;break;case 6:Rw(at),at.flags&=-3,O_(at.alternate,at);break;case 1024:at.flags&=-1025;break;case 1028:at.flags&=-1025,O_(at.alternate,at);break;case 4:O_(at.alternate,at);break;case 8:a=at,Lw(k,a);var Ve=a.alternate;Pw(a),Ve!==null&&Pw(Ve)}at=at.nextEffect}}catch(je){if(at===null)throw Error(Qe(330));Us(at,je),at=at.nextEffect}while(at!==null);if(xe=r_,Te=f1(),re=xe.focusedElem,k=xe.selectionRange,Te!==re&&re&&re.ownerDocument&&p1(re.ownerDocument.documentElement,re)){for(k!==null&&Qg(re)&&(Te=k.start,xe=k.end,xe===void 0&&(xe=Te),"selectionStart"in re?(re.selectionStart=Te,re.selectionEnd=Math.min(xe,re.value.length)):(xe=(Te=re.ownerDocument||document)&&Te.defaultView||window,xe.getSelection&&(xe=xe.getSelection(),a=re.textContent.length,Ve=Math.min(k.start,a),k=k.end===void 0?Ve:Math.min(k.end,a),!xe.extend&&Ve>k&&(a=k,k=Ve,Ve=a),a=d1(re,Ve),T=d1(re,k),a&&T&&(xe.rangeCount!==1||xe.anchorNode!==a.node||xe.anchorOffset!==a.offset||xe.focusNode!==T.node||xe.focusOffset!==T.offset)&&(Te=Te.createRange(),Te.setStart(a.node,a.offset),xe.removeAllRanges(),Ve>k?(xe.addRange(Te),xe.extend(T.node,T.offset)):(Te.setEnd(T.node,T.offset),xe.addRange(Te)))))),Te=[],xe=re;xe=xe.parentNode;)xe.nodeType===1&&Te.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof re.focus=="function"&&re.focus(),re=0;re<Te.length;re++)xe=Te[re],xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}vp=!!n_,r_=n_=null,t.current=c,at=m;do try{for(re=t;at!==null;){var Ie=at.flags;if(Ie&36&&yC(re,at.alternate,at),Ie&128){Te=void 0;var $e=at.ref;if($e!==null){var We=at.stateNode;switch(at.tag){case 5:Te=We;break;default:Te=We}typeof $e=="function"?$e(Te):$e.current=Te}}at=at.nextEffect}}catch(je){if(at===null)throw Error(Qe(330));Us(at,je),at=at.nextEffect}while(at!==null);at=null,sC(),Tt=x}else t.current=c;if(Bs)Bs=!1,wh=t,bh=o;else for(at=m;at!==null;)o=at.nextEffect,at.nextEffect=null,at.flags&8&&(Ie=at,Ie.sibling=null,Ie.stateNode=null),at=o;if(m=t.pendingLanes,m===0&&(mo=null),m===1?t===X_?Th++:(Th=0,X_=t):Th=0,c=c.stateNode,Pa&&typeof Pa.onCommitFiberRoot=="function")try{Pa.onCommitFiberRoot(l_,c,void 0,(c.current.flags&64)==64)}catch{}if(Di(t,Ar()),Jp)throw Jp=!1,t=Z_,Z_=null,t;return(Tt&8)!=0||uo(),null}function EC(){for(;at!==null;){var t=at.alternate;nf||Sh===null||((at.flags&8)!=0?Rv(at,Sh)&&(nf=!0):at.tag===13&&xC(t,at)&&Rv(at,Sh)&&(nf=!0));var o=at.flags;(o&256)!=0&&_C(t,at),(o&512)==0||Bs||(Bs=!0,ah(97,function(){return Ns(),null})),at=at.nextEffect}}function Ns(){if(bh!==90){var t=97<bh?97:bh;return bh=90,Da(t,kC)}return!1}function CC(t,o){q_.push(o,t),Bs||(Bs=!0,ah(97,function(){return Ns(),null}))}function Gw(t,o){W_.push(o,t),Bs||(Bs=!0,ah(97,function(){return Ns(),null}))}function kC(){if(wh===null)return!1;var t=wh;if(wh=null,(Tt&48)!=0)throw Error(Qe(331));var o=Tt;Tt|=32;var c=W_;W_=[];for(var m=0;m<c.length;m+=2){var x=c[m],T=c[m+1],k=x.destroy;if(x.destroy=void 0,typeof k=="function")try{k()}catch(B){if(T===null)throw Error(Qe(330));Us(T,B)}}for(c=q_,q_=[],m=0;m<c.length;m+=2){x=c[m],T=c[m+1];try{var a=x.create;x.destroy=a()}catch(B){if(T===null)throw Error(Qe(330));Us(T,B)}}for(a=t.current.firstEffect;a!==null;)t=a.nextEffect,a.nextEffect=null,a.flags&8&&(a.sibling=null,a.stateNode=null),a=t;return Tt=o,uo(),!0}function Zw(t,o,c){o=R_(c,o),o=kw(t,o,1),Rs(t,o),o=xi(),t=rf(t,1),t!==null&&(xp(t,1,o),Di(t,o))}function Us(t,o){if(t.tag===3)Zw(t,t,o);else for(var c=t.return;c!==null;){if(c.tag===3){Zw(c,t,o);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(mo===null||!mo.has(m))){t=R_(o,t);var x=Iw(c,t,1);if(Rs(c,x),x=xi(),c=rf(c,1),c!==null)xp(c,1,x),Di(c,x);else if(typeof m.componentDidCatch=="function"&&(mo===null||!mo.has(m)))try{m.componentDidCatch(o,t)}catch{}break}}c=c.return}}function IC(t,o,c){var m=t.pingCache;m!==null&&m.delete(o),o=xi(),t.pingedLanes|=t.suspendedLanes&c,$r===t&&(zr&c)===c&&(wr===4||wr===3&&(zr&62914560)===zr&&500>Ar()-j_?pc(t,0):V_|=c),Di(t,o)}function AC(t,o){var c=t.stateNode;c!==null&&c.delete(o),o=0,o===0&&(o=t.mode,(o&2)==0?o=1:(o&4)==0?o=ic()===99?1:2:(Zo===0&&(Zo=cc),o=Xl(62914560&~Zo),o===0&&(o=4194304))),c=xi(),t=rf(t,o),t!==null&&(xp(t,o,c),Di(t,c))}var qw;qw=function(t,o,c){var m=o.lanes;if(t!==null)if(t.memoizedProps!==o.pendingProps||ei.current)Ki=!0;else if((c&m)!=0)Ki=(t.flags&16384)!=0;else{switch(Ki=!1,o.tag){case 3:_w(o),w_();break;case 5:Q1(o);break;case 1:ti(o.type)&&Pp(o);break;case 4:y_(o,o.stateNode.containerInfo);break;case 10:m=o.memoizedProps.value;var x=o.type._context;$n(Lp,x._currentValue),x._currentValue=m;break;case 13:if(o.memoizedState!==null)return(c&o.child.childLanes)!=0?yw(t,o,c):($n(jn,jn.current&1),o=jo(t,o,c),o!==null?o.sibling:null);$n(jn,jn.current&1);break;case 19:if(m=(c&o.childLanes)!=0,(t.flags&64)!=0){if(m)return Tw(t,o,c);o.flags|=64}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),$n(jn,jn.current),m)break;return null;case 23:case 24:return o.lanes=0,A_(t,o,c)}return jo(t,o,c)}else Ki=!1;switch(o.lanes=0,o.tag){case 2:if(m=o.type,t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),t=o.pendingProps,x=rc(o,Ir.current),sc(o,c),x=S_(null,o,m,t,x,c),o.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0){if(o.tag=1,o.memoizedState=null,o.updateQueue=null,ti(m)){var T=!0;Pp(o)}else T=!1;o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,g_(o);var k=m.getDerivedStateFromProps;typeof k=="function"&&Op(o,m,k,t),x.updater=Np,o.stateNode=x,x._reactInternals=o,__(o,m,t,c),o=z_(null,o,m,!0,T,c)}else o.tag=0,ri(null,o,x,c),o=o.child;return o;case 16:x=o.elementType;e:{switch(t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),t=o.pendingProps,T=x._init,x=T(x._payload),o.type=x,T=o.tag=zC(x),t=Hi(x,t),T){case 0:o=M_(null,o,x,t,c);break e;case 1:o=gw(null,o,x,t,c);break e;case 11:o=dw(null,o,x,t,c);break e;case 14:o=pw(null,o,x,Hi(x.type,t),m,c);break e}throw Error(Qe(306,x,""))}return o;case 0:return m=o.type,x=o.pendingProps,x=o.elementType===m?x:Hi(m,x),M_(t,o,m,x,c);case 1:return m=o.type,x=o.pendingProps,x=o.elementType===m?x:Hi(m,x),gw(t,o,m,x,c);case 3:if(_w(o),m=o.updateQueue,t===null||m===null)throw Error(Qe(282));if(m=o.pendingProps,x=o.memoizedState,x=x!==null?x.element:null,j1(t,o),lh(o,m,null,c),m=o.memoizedState.element,m===x)w_(),o=jo(t,o,c);else{if(x=o.stateNode,(T=x.hydrate)&&(Ls=Jl(o.stateNode.containerInfo.firstChild),$o=o,T=po=!0),T){if(t=x.mutableSourceEagerHydrationData,t!=null)for(x=0;x<t.length;x+=2)T=t[x],T._workInProgressVersionPrimary=t[x+1],lc.push(T);for(c=Y1(o,null,m,c),o.child=c;c;)c.flags=c.flags&-3|1024,c=c.sibling}else ri(t,o,m,c),w_();o=o.child}return o;case 5:return Q1(o),t===null&&v_(o),m=o.type,x=o.pendingProps,T=t!==null?t.memoizedProps:null,k=x.children,i_(m,x)?k=null:T!==null&&i_(m,T)&&(o.flags|=16),mw(t,o),ri(t,o,k,c),o.child;case 6:return t===null&&v_(o),null;case 13:return yw(t,o,c);case 4:return y_(o,o.stateNode.containerInfo),m=o.pendingProps,t===null?o.child=$p(o,null,m,c):ri(t,o,m,c),o.child;case 11:return m=o.type,x=o.pendingProps,x=o.elementType===m?x:Hi(m,x),dw(t,o,m,x,c);case 7:return ri(t,o,o.pendingProps,c),o.child;case 8:return ri(t,o,o.pendingProps.children,c),o.child;case 12:return ri(t,o,o.pendingProps.children,c),o.child;case 10:e:{m=o.type._context,x=o.pendingProps,k=o.memoizedProps,T=x.value;var a=o.type._context;if($n(Lp,a._currentValue),a._currentValue=T,k!==null)if(a=k.value,T=Mi(a,T)?0:(typeof m._calculateChangedBits=="function"?m._calculateChangedBits(a,T):1073741823)|0,T===0){if(k.children===x.children&&!ei.current){o=jo(t,o,c);break e}}else for(a=o.child,a!==null&&(a.return=o);a!==null;){var B=a.dependencies;if(B!==null){k=a.child;for(var W=B.firstContext;W!==null;){if(W.context===m&&(W.observedBits&T)!=0){a.tag===1&&(W=Ds(-1,c&-c),W.tag=2,Rs(a,W)),a.lanes|=c,W=a.alternate,W!==null&&(W.lanes|=c),$1(a.return,c),B.lanes|=c;break}W=W.next}}else k=a.tag===10&&a.type===o.type?null:a.child;if(k!==null)k.return=a;else for(k=a;k!==null;){if(k===o){k=null;break}if(a=k.sibling,a!==null){a.return=k.return,k=a;break}k=k.return}a=k}ri(t,o,x.children,c),o=o.child}return o;case 9:return x=o.type,T=o.pendingProps,m=T.children,sc(o,c),x=zi(x,T.unstable_observedBits),m=m(x),o.flags|=1,ri(t,o,m,c),o.child;case 14:return x=o.type,T=Hi(x,o.pendingProps),T=Hi(x.type,T),pw(t,o,x,T,m,c);case 15:return fw(t,o,o.type,o.pendingProps,m,c);case 17:return m=o.type,x=o.pendingProps,x=o.elementType===m?x:Hi(m,x),t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),o.tag=1,ti(m)?(t=!0,Pp(o)):t=!1,sc(o,c),X1(o,m,x),__(o,m,x,c),z_(null,o,m,!0,t,c);case 19:return Tw(t,o,c);case 23:return A_(t,o,c);case 24:return A_(t,o,c)}throw Error(Qe(156,o.tag))};function MC(t,o,c,m){this.tag=t,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ri(t,o,c,m){return new MC(t,o,c,m)}function Y_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zC(t){if(typeof t=="function")return Y_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sp)return 11;if(t===lp)return 14}return 2}function Vs(t,o){var c=t.alternate;return c===null?(c=Ri(t.tag,o,t.key,t.mode),c.elementType=t.elementType,c.type=t.type,c.stateNode=t.stateNode,c.alternate=t,t.alternate=c):(c.pendingProps=o,c.type=t.type,c.flags=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null),c.childLanes=t.childLanes,c.lanes=t.lanes,c.child=t.child,c.memoizedProps=t.memoizedProps,c.memoizedState=t.memoizedState,c.updateQueue=t.updateQueue,o=t.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=t.sibling,c.index=t.index,c.ref=t.ref,c}function sf(t,o,c,m,x,T){var k=2;if(m=t,typeof t=="function")Y_(t)&&(k=1);else if(typeof t=="string")k=5;else e:switch(t){case bs:return fc(c.children,x,T,o);case dv:k=8,x|=16;break;case ag:k=8,x|=1;break;case Bu:return t=Ri(12,c,o,x|8),t.elementType=Bu,t.type=Bu,t.lanes=T,t;case Fu:return t=Ri(13,c,o,x),t.type=Fu,t.elementType=Fu,t.lanes=T,t;case ap:return t=Ri(19,c,o,x),t.elementType=ap,t.lanes=T,t;case pg:return Q_(c,x,T,o);case fg:return t=Ri(24,c,o,x),t.elementType=fg,t.lanes=T,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lg:k=10;break e;case cg:k=9;break e;case sp:k=11;break e;case lp:k=14;break e;case ug:k=16,m=null;break e;case hg:k=22;break e}throw Error(Qe(130,t==null?t:typeof t,""))}return o=Ri(k,c,o,x),o.elementType=t,o.type=m,o.lanes=T,o}function fc(t,o,c,m){return t=Ri(7,t,m,o),t.lanes=c,t}function Q_(t,o,c,m){return t=Ri(23,t,m,o),t.elementType=pg,t.lanes=c,t}function J_(t,o,c){return t=Ri(6,t,null,o),t.lanes=c,t}function ey(t,o,c){return o=Ri(4,t.children!==null?t.children:[],t.key,o),o.lanes=c,o.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},o}function PC(t,o,c){this.tag=o,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=c,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ug(0),this.expirationTimes=Ug(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ug(0),this.mutableSourceEagerHydrationData=null}function DC(t,o,c){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ka,key:m==null?null:""+m,children:t,containerInfo:o,implementation:c}}function af(t,o,c,m){var x=o.current,T=xi(),k=Fs(x);e:if(c){c=c._reactInternals;t:{if(Aa(c)!==c||c.tag!==1)throw Error(Qe(170));var a=c;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(ti(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(a!==null);throw Error(Qe(171))}if(c.tag===1){var B=c.type;if(ti(B)){c=P1(c,B,a);break e}}c=a}else c=zs;return o.context===null?o.context=c:o.pendingContext=c,o=Ds(T,k),o.payload={element:t},m=m===void 0?null:m,m!==null&&(o.callback=m),Rs(x,o),Os(x,k,T),k}function ty(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ww(t,o){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var c=t.retryLane;t.retryLane=c!==0&&c<o?c:o}}function ny(t,o){Ww(t,o),(t=t.alternate)&&Ww(t,o)}function RC(){return null}function ry(t,o,c){var m=c!=null&&c.hydrationOptions!=null&&c.hydrationOptions.mutableSources||null;if(c=new PC(t,o,c!=null&&c.hydrate===!0),o=Ri(3,null,null,o===2?7:o===1?3:0),c.current=o,o.stateNode=c,g_(o),t[ec]=c.current,w1(t.nodeType===8?t.parentNode:t),m)for(t=0;t<m.length;t++){o=m[t];var x=o._getVersion;x=x(o._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[o,x]:c.mutableSourceEagerHydrationData.push(o,x)}this._internalRoot=c}ry.prototype.render=function(t){af(t,this._internalRoot,null,null)};ry.prototype.unmount=function(){var t=this._internalRoot,o=t.containerInfo;af(null,t,null,function(){o[ec]=null})};function Ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function LC(t,o){if(o||(o=t?t.nodeType===9?t.documentElement:t.firstChild:null,o=!(!o||o.nodeType!==1||!o.hasAttribute("data-reactroot"))),!o)for(var c;c=t.lastChild;)t.removeChild(c);return new ry(t,0,o?{hydrate:!0}:void 0)}function lf(t,o,c,m,x){var T=c._reactRootContainer;if(T){var k=T._internalRoot;if(typeof x=="function"){var a=x;x=function(){var W=ty(k);a.call(W)}}af(o,k,t,x)}else{if(T=c._reactRootContainer=LC(c,m),k=T._internalRoot,typeof x=="function"){var B=x;x=function(){var W=ty(k);B.call(W)}}Nw(function(){af(o,k,t,x)})}return ty(k)}Lv=function(t){if(t.tag===13){var o=xi();Os(t,4,o),ny(t,4)}};Rg=function(t){if(t.tag===13){var o=xi();Os(t,67108864,o),ny(t,67108864)}};Bv=function(t){if(t.tag===13){var o=xi(),c=Fs(t);Os(t,c,o),ny(t,c)}};Fv=function(t,o){return o()};kg=function(t,o,c){switch(o){case"input":if(yg(t,c),o=c.name,c.type==="radio"&&o!=null){for(c=t;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var m=c[o];if(m!==t&&m.form===t.form){var x=Mp(m);if(!x)throw Error(Qe(90));mv(m),yg(m,x)}}}break;case"textarea":vv(t,c);break;case"select":o=c.value,o!=null&&jl(t,!!c.multiple,o,!1)}};Ig=Ow;Av=function(t,o,c,m,x){var T=Tt;Tt|=4;try{return Da(98,t.bind(null,o,c,m,x))}finally{Tt=T,Tt===0&&(hc(),uo())}};Ag=function(){(Tt&49)==0&&(wC(),Ns())};Mv=function(t,o){var c=Tt;Tt|=2;try{return t(o)}finally{Tt=c,Tt===0&&(hc(),uo())}};function Xw(t,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ch(o))throw Error(Qe(200));return DC(t,o,null,c)}var BC={Events:[sh,tc,Mp,kv,Iv,Ns,{current:!1}]},kh={findFiberByHostInstance:Ma,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},FC={bundleType:kh.bundleType,version:kh.version,rendererPackageName:kh.rendererPackageName,rendererConfig:kh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ca.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Dv(t),t===null?null:t.stateNode},findFiberByHostInstance:kh.findFiberByHostInstance||RC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var cf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cf.isDisabled&&cf.supportsFiber)try{l_=cf.inject(FC),Pa=cf}catch{}}Ai.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BC;Ai.createPortal=Xw;Ai.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var o=t._reactInternals;if(o===void 0)throw typeof t.render=="function"?Error(Qe(188)):Error(Qe(268,Object.keys(t)));return t=Dv(o),t=t===null?null:t.stateNode,t};Ai.flushSync=function(t,o){var c=Tt;if((c&48)!=0)return t(o);Tt|=1;try{if(t)return Da(99,t.bind(null,o))}finally{Tt=c,uo()}};Ai.hydrate=function(t,o,c){if(!Ch(o))throw Error(Qe(200));return lf(null,t,o,!0,c)};Ai.render=function(t,o,c){if(!Ch(o))throw Error(Qe(200));return lf(null,t,o,!1,c)};Ai.unmountComponentAtNode=function(t){if(!Ch(t))throw Error(Qe(40));return t._reactRootContainer?(Nw(function(){lf(null,null,t,!1,function(){t._reactRootContainer=null,t[ec]=null})}),!0):!1};Ai.unstable_batchedUpdates=Ow;Ai.unstable_createPortal=function(t,o){return Xw(t,o,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};Ai.unstable_renderSubtreeIntoContainer=function(t,o,c,m){if(!Ch(c))throw Error(Qe(200));if(t==null||t._reactInternals===void 0)throw Error(Qe(38));return lf(t,o,c,!1,m)};Ai.version="17.0.2";function Hw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hw)}catch(t){console.error(t)}}Hw(),ov.exports=Ai;var xD=ov.exports;function Ke(){return Ke=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var m in c)Object.prototype.hasOwnProperty.call(c,m)&&(t[m]=c[m])}return t},Ke.apply(this,arguments)}function fn(t,o){if(t==null)return{};var c={},m=Object.keys(t),x,T;for(T=0;T<m.length;T++)x=m[T],!(o.indexOf(x)>=0)&&(c[x]=t[x]);return c}function uf(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function qo(t,o,c={clone:!0}){const m=c.clone?Ke({},t):t;return uf(t)&&uf(o)&&Object.keys(o).forEach(x=>{x!=="__proto__"&&(uf(o[x])&&x in t&&uf(t[x])?m[x]=qo(t[x],o[x],c):m[x]=o[x])}),m}var OC="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",NC=OC,UC=NC;function Kw(){}function Yw(){}Yw.resetWarningCache=Kw;var VC=function(){function t(m,x,T,k,a,B){if(B!==UC){var W=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw W.name="Invariant Violation",W}}t.isRequired=t;function o(){return t}var c={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:o,element:t,elementType:t,instanceOf:o,node:t,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:Yw,resetWarningCache:Kw};return c.PropTypes=c,c};VC();function mc(t){let o="https://mui.com/production-error/?code="+t;for(let c=1;c<arguments.length;c+=1)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified MUI error #"+t+"; visit "+o+" for the full message."}function On(t){if(typeof t!="string")throw new Error(mc(7));return t.charAt(0).toUpperCase()+t.slice(1)}function $C(...t){return t.reduce((o,c)=>c==null?o:function(...x){o.apply(this,x),c.apply(this,x)},()=>{})}function Qw(t,o=166){let c;function m(...x){const T=()=>{t.apply(this,x)};clearTimeout(c),c=setTimeout(T,o)}return m.clear=()=>{clearTimeout(c)},m}function jC(t,o){return()=>null}function Jw(t,o){return Oe.exports.isValidElement(t)&&o.indexOf(t.type.muiName)!==-1}function eb(t){return t&&t.ownerDocument||document}function iy(t){return eb(t).defaultView||window}function GC(t,o){return()=>null}function oy(t,o){typeof t=="function"?t(o):t&&(t.current=o)}const ZC=typeof window!="undefined"?Oe.exports.useLayoutEffect:Oe.exports.useEffect;var Ih=ZC;function qC(t){const[o,c]=Oe.exports.useState(t),m=t||o;return Oe.exports.useEffect(()=>{o==null&&c(`mui-${Math.round(Math.random()*1e9)}`)},[o]),m}function WC(t,o,c,m,x){return null}function XC({controlled:t,default:o,name:c,state:m="value"}){const{current:x}=Oe.exports.useRef(t!==void 0),[T,k]=Oe.exports.useState(o),a=x?t:T,B=Oe.exports.useCallback(W=>{x||k(W)},[]);return[a,B]}function Ah(t){const o=Oe.exports.useRef(t);return Ih(()=>{o.current=t}),Oe.exports.useCallback((...c)=>(0,o.current)(...c),[])}function $s(t,o){return Oe.exports.useMemo(()=>t==null&&o==null?null:c=>{oy(t,c),oy(o,c)},[t,o])}let hf=!0,sy=!1,tb=null;const HC={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function KC(t){const{type:o,tagName:c}=t;return!!(c==="INPUT"&&HC[o]&&!t.readOnly||c==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function YC(t){t.metaKey||t.altKey||t.ctrlKey||(hf=!0)}function ay(){hf=!1}function QC(){this.visibilityState==="hidden"&&sy&&(hf=!0)}function JC(t){t.addEventListener("keydown",YC,!0),t.addEventListener("mousedown",ay,!0),t.addEventListener("pointerdown",ay,!0),t.addEventListener("touchstart",ay,!0),t.addEventListener("visibilitychange",QC,!0)}function ek(t){const{target:o}=t;try{return o.matches(":focus-visible")}catch{}return hf||KC(o)}function nb(){const t=Oe.exports.useCallback(x=>{x!=null&&JC(x.ownerDocument)},[]),o=Oe.exports.useRef(!1);function c(){return o.current?(sy=!0,window.clearTimeout(tb),tb=window.setTimeout(()=>{sy=!1},100),o.current=!1,!0):!1}function m(x){return ek(x)?(o.current=!0,!0):!1}return{isFocusVisibleRef:o,onFocus:m,onBlur:c,ref:t}}function rb(t){var o,c,m="";if(typeof t=="string"||typeof t=="number")m+=t;else if(typeof t=="object")if(Array.isArray(t))for(o=0;o<t.length;o++)t[o]&&(c=rb(t[o]))&&(m&&(m+=" "),m+=c);else for(o in t)t[o]&&(m&&(m+=" "),m+=o);return m}function Cn(){for(var t=0,o,c,m="";t<arguments.length;)(o=arguments[t++])&&(c=rb(o))&&(m&&(m+=" "),m+=c);return m}function Li(t,o,c){const m={};return Object.keys(t).forEach(x=>{m[x]=t[x].reduce((T,k)=>(k&&(c&&c[k]&&T.push(c[k]),T.push(o(k))),T),[]).join(" ")}),m}function df(t){return typeof t=="string"}const ib=t=>t,tk=()=>{let t=ib;return{configure(o){t=o},generate(o){return t(o)},reset(){t=ib}}},nk=tk();var ob=nk;const rk={active:"Mui-active",checked:"Mui-checked",completed:"Mui-completed",disabled:"Mui-disabled",error:"Mui-error",expanded:"Mui-expanded",focused:"Mui-focused",focusVisible:"Mui-focusVisible",required:"Mui-required",selected:"Mui-selected"};function vi(t,o){return rk[o]||`${ob.generate(t)}-${o}`}function ii(t,o){const c={};return o.forEach(m=>{c[m]=vi(t,m)}),c}var pf={exports:{}},Mh={};/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ik=Oe.exports,sb=60103;Mh.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var ab=Symbol.for;sb=ab("react.element"),Mh.Fragment=ab("react.fragment")}var ok=ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sk=Object.prototype.hasOwnProperty,ak={key:!0,ref:!0,__self:!0,__source:!0};function lb(t,o,c){var m,x={},T=null,k=null;c!==void 0&&(T=""+c),o.key!==void 0&&(T=""+o.key),o.ref!==void 0&&(k=o.ref);for(m in o)sk.call(o,m)&&!ak.hasOwnProperty(m)&&(x[m]=o[m]);if(t&&t.defaultProps)for(m in o=t.defaultProps,o)x[m]===void 0&&(x[m]=o[m]);return{$$typeof:sb,type:t,key:T,ref:k,props:x,_owner:ok.current}}Mh.jsx=lb;Mh.jsxs=lb;pf.exports=Mh;const Xt=pf.exports.jsx,go=pf.exports.jsxs,lk=pf.exports.Fragment;var ck=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",jsx:Xt,jsxs:go,Fragment:lk});function cb(t){var o=Object.create(null);return function(c){return o[c]===void 0&&(o[c]=t(c)),o[c]}}var uk=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,hk=cb(function(t){return uk.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function dk(t){if(t.sheet)return t.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===t)return document.styleSheets[o]}function pk(t){var o=document.createElement("style");return o.setAttribute("data-emotion",t.key),t.nonce!==void 0&&o.setAttribute("nonce",t.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var ub=function(){function t(c){var m=this;this._insertTag=function(x){var T;m.tags.length===0?T=m.prepend?m.container.firstChild:m.before:T=m.tags[m.tags.length-1].nextSibling,m.container.insertBefore(x,T),m.tags.push(x)},this.isSpeedy=c.speedy===void 0?!0:c.speedy,this.tags=[],this.ctr=0,this.nonce=c.nonce,this.key=c.key,this.container=c.container,this.prepend=c.prepend,this.before=null}var o=t.prototype;return o.hydrate=function(m){m.forEach(this._insertTag)},o.insert=function(m){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(pk(this));var x=this.tags[this.tags.length-1];if(this.isSpeedy){var T=dk(x);try{T.insertRule(m,T.cssRules.length)}catch{}}else x.appendChild(document.createTextNode(m));this.ctr++},o.flush=function(){this.tags.forEach(function(m){return m.parentNode&&m.parentNode.removeChild(m)}),this.tags=[],this.ctr=0},t}(),Pr="-ms-",ff="-moz-",sn="-webkit-",hb="comm",ly="rule",cy="decl",fk="@import",mk="@keyframes",gk=Math.abs,mf=String.fromCharCode;function _k(t,o){return(((o<<2^oi(t,0))<<2^oi(t,1))<<2^oi(t,2))<<2^oi(t,3)}function db(t){return t.trim()}function yk(t,o){return(t=o.exec(t))?t[0]:t}function un(t,o,c){return t.replace(o,c)}function pb(t,o){return t.indexOf(o)}function oi(t,o){return t.charCodeAt(o)|0}function zh(t,o,c){return t.slice(o,c)}function _o(t){return t.length}function uy(t){return t.length}function gf(t,o){return o.push(t),t}function xk(t,o){return t.map(o).join("")}var _f=1,gc=1,fb=0,si=0,Hn=0,_c="";function yf(t,o,c,m,x,T,k){return{value:t,root:o,parent:c,type:m,props:x,children:T,line:_f,column:gc,length:k,return:""}}function Ph(t,o,c){return yf(t,o.root,o.parent,c,o.props,o.children,0)}function vk(){return Hn}function wk(){return Hn=si>0?oi(_c,--si):0,gc--,Hn===10&&(gc=1,_f--),Hn}function wi(){return Hn=si<fb?oi(_c,si++):0,gc++,Hn===10&&(gc=1,_f++),Hn}function yo(){return oi(_c,si)}function xf(){return si}function Dh(t,o){return zh(_c,t,o)}function Rh(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function mb(t){return _f=gc=1,fb=_o(_c=t),si=0,[]}function gb(t){return _c="",t}function hy(t){return db(Dh(si-1,dy(t===91?t+2:t===40?t+1:t)))}function bk(t){for(;(Hn=yo())&&Hn<33;)wi();return Rh(t)>2||Rh(Hn)>3?"":" "}function Tk(t,o){for(;--o&&wi()&&!(Hn<48||Hn>102||Hn>57&&Hn<65||Hn>70&&Hn<97););return Dh(t,xf()+(o<6&&yo()==32&&wi()==32))}function dy(t){for(;wi();)switch(Hn){case t:return si;case 34:case 39:return dy(t===34||t===39?t:Hn);case 40:t===41&&dy(t);break;case 92:wi();break}return si}function Sk(t,o){for(;wi()&&t+Hn!==47+10;)if(t+Hn===42+42&&yo()===47)break;return"/*"+Dh(o,si-1)+"*"+mf(t===47?t:wi())}function Ek(t){for(;!Rh(yo());)wi();return Dh(t,si)}function Ck(t){return gb(vf("",null,null,null,[""],t=mb(t),0,[0],t))}function vf(t,o,c,m,x,T,k,a,B){for(var W=0,ce=0,J=k,q=0,ve=0,Ae=0,Se=1,ee=1,Q=1,re=0,Te="",xe=x,Ve=T,Ie=m,$e=Te;ee;)switch(Ae=re,re=wi()){case 34:case 39:case 91:case 40:$e+=hy(re);break;case 9:case 10:case 13:case 32:$e+=bk(Ae);break;case 92:$e+=Tk(xf()-1,7);continue;case 47:switch(yo()){case 42:case 47:gf(kk(Sk(wi(),xf()),o,c),B);break;default:$e+="/"}break;case 123*Se:a[W++]=_o($e)*Q;case 125*Se:case 59:case 0:switch(re){case 0:case 125:ee=0;case 59+ce:ve>0&&_o($e)-J&&gf(ve>32?yb($e+";",m,c,J-1):yb(un($e," ","")+";",m,c,J-2),B);break;case 59:$e+=";";default:if(gf(Ie=_b($e,o,c,W,ce,x,a,Te,xe=[],Ve=[],J),T),re===123)if(ce===0)vf($e,o,Ie,Ie,xe,T,J,a,Ve);else switch(q){case 100:case 109:case 115:vf(t,Ie,Ie,m&&gf(_b(t,Ie,Ie,0,0,x,a,Te,x,xe=[],J),Ve),x,Ve,J,a,m?xe:Ve);break;default:vf($e,Ie,Ie,Ie,[""],Ve,J,a,Ve)}}W=ce=ve=0,Se=Q=1,Te=$e="",J=k;break;case 58:J=1+_o($e),ve=Ae;default:if(Se<1){if(re==123)--Se;else if(re==125&&Se++==0&&wk()==125)continue}switch($e+=mf(re),re*Se){case 38:Q=ce>0?1:($e+="\f",-1);break;case 44:a[W++]=(_o($e)-1)*Q,Q=1;break;case 64:yo()===45&&($e+=hy(wi())),q=yo(),ce=_o(Te=$e+=Ek(xf())),re++;break;case 45:Ae===45&&_o($e)==2&&(Se=0)}}return T}function _b(t,o,c,m,x,T,k,a,B,W,ce){for(var J=x-1,q=x===0?T:[""],ve=uy(q),Ae=0,Se=0,ee=0;Ae<m;++Ae)for(var Q=0,re=zh(t,J+1,J=gk(Se=k[Ae])),Te=t;Q<ve;++Q)(Te=db(Se>0?q[Q]+" "+re:un(re,/&\f/g,q[Q])))&&(B[ee++]=Te);return yf(t,o,c,x===0?ly:a,B,W,ce)}function kk(t,o,c){return yf(t,o,c,hb,mf(vk()),zh(t,2,-2),0)}function yb(t,o,c,m){return yf(t,o,c,cy,zh(t,0,m),zh(t,m+1,-1),m)}function xb(t,o){switch(_k(t,o)){case 5103:return sn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return sn+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return sn+t+ff+t+Pr+t+t;case 6828:case 4268:return sn+t+Pr+t+t;case 6165:return sn+t+Pr+"flex-"+t+t;case 5187:return sn+t+un(t,/(\w+).+(:[^]+)/,sn+"box-$1$2"+Pr+"flex-$1$2")+t;case 5443:return sn+t+Pr+"flex-item-"+un(t,/flex-|-self/,"")+t;case 4675:return sn+t+Pr+"flex-line-pack"+un(t,/align-content|flex-|-self/,"")+t;case 5548:return sn+t+Pr+un(t,"shrink","negative")+t;case 5292:return sn+t+Pr+un(t,"basis","preferred-size")+t;case 6060:return sn+"box-"+un(t,"-grow","")+sn+t+Pr+un(t,"grow","positive")+t;case 4554:return sn+un(t,/([^-])(transform)/g,"$1"+sn+"$2")+t;case 6187:return un(un(un(t,/(zoom-|grab)/,sn+"$1"),/(image-set)/,sn+"$1"),t,"")+t;case 5495:case 3959:return un(t,/(image-set\([^]*)/,sn+"$1$`$1");case 4968:return un(un(t,/(.+:)(flex-)?(.*)/,sn+"box-pack:$3"+Pr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+sn+t+t;case 4095:case 3583:case 4068:case 2532:return un(t,/(.+)-inline(.+)/,sn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(_o(t)-1-o>6)switch(oi(t,o+1)){case 109:if(oi(t,o+4)!==45)break;case 102:return un(t,/(.+:)(.+)-([^]+)/,"$1"+sn+"$2-$3$1"+ff+(oi(t,o+3)==108?"$3":"$2-$3"))+t;case 115:return~pb(t,"stretch")?xb(un(t,"stretch","fill-available"),o)+t:t}break;case 4949:if(oi(t,o+1)!==115)break;case 6444:switch(oi(t,_o(t)-3-(~pb(t,"!important")&&10))){case 107:return un(t,":",":"+sn)+t;case 101:return un(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+sn+(oi(t,14)===45?"inline-":"")+"box$3$1"+sn+"$2$3$1"+Pr+"$2box$3")+t}break;case 5936:switch(oi(t,o+11)){case 114:return sn+t+Pr+un(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return sn+t+Pr+un(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return sn+t+Pr+un(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return sn+t+Pr+t+t}return t}function Lh(t,o){for(var c="",m=uy(t),x=0;x<m;x++)c+=o(t[x],x,t,o)||"";return c}function Ik(t,o,c,m){switch(t.type){case fk:case cy:return t.return=t.return||t.value;case hb:return"";case ly:t.value=t.props.join(",")}return _o(c=Lh(t.children,m))?t.return=t.value+"{"+c+"}":""}function Ak(t){var o=uy(t);return function(c,m,x,T){for(var k="",a=0;a<o;a++)k+=t[a](c,m,x,T)||"";return k}}function Mk(t){return function(o){o.root||(o=o.return)&&t(o)}}function zk(t,o,c,m){if(!t.return)switch(t.type){case cy:t.return=xb(t.value,t.length);break;case mk:return Lh([Ph(un(t.value,"@","@"+sn),t,"")],m);case ly:if(t.length)return xk(t.props,function(x){switch(yk(x,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Lh([Ph(un(x,/:(read-\w+)/,":"+ff+"$1"),t,"")],m);case"::placeholder":return Lh([Ph(un(x,/:(plac\w+)/,":"+sn+"input-$1"),t,""),Ph(un(x,/:(plac\w+)/,":"+ff+"$1"),t,""),Ph(un(x,/:(plac\w+)/,Pr+"input-$1"),t,"")],m)}return""})}}var Pk=function(o,c,m){for(var x=0,T=0;x=T,T=yo(),x===38&&T===12&&(c[m]=1),!Rh(T);)wi();return Dh(o,si)},Dk=function(o,c){var m=-1,x=44;do switch(Rh(x)){case 0:x===38&&yo()===12&&(c[m]=1),o[m]+=Pk(si-1,c,m);break;case 2:o[m]+=hy(x);break;case 4:if(x===44){o[++m]=yo()===58?"&\f":"",c[m]=o[m].length;break}default:o[m]+=mf(x)}while(x=wi());return o},Rk=function(o,c){return gb(Dk(mb(o),c))},vb=new WeakMap,Lk=function(o){if(!(o.type!=="rule"||!o.parent||!o.length)){for(var c=o.value,m=o.parent,x=o.column===m.column&&o.line===m.line;m.type!=="rule";)if(m=m.parent,!m)return;if(!(o.props.length===1&&c.charCodeAt(0)!==58&&!vb.get(m))&&!x){vb.set(o,!0);for(var T=[],k=Rk(c,T),a=m.props,B=0,W=0;B<k.length;B++)for(var ce=0;ce<a.length;ce++,W++)o.props[W]=T[B]?k[B].replace(/&\f/g,a[ce]):a[ce]+" "+k[B]}}},Bk=function(o){if(o.type==="decl"){var c=o.value;c.charCodeAt(0)===108&&c.charCodeAt(2)===98&&(o.return="",o.value="")}},Fk=[zk],Ok=function(o){var c=o.key;if(c==="css"){var m=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(m,function(Se){var ee=Se.getAttribute("data-emotion");ee.indexOf(" ")!==-1&&(document.head.appendChild(Se),Se.setAttribute("data-s",""))})}var x=o.stylisPlugins||Fk,T={},k,a=[];k=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+c+' "]'),function(Se){for(var ee=Se.getAttribute("data-emotion").split(" "),Q=1;Q<ee.length;Q++)T[ee[Q]]=!0;a.push(Se)});var B,W=[Lk,Bk];{var ce,J=[Ik,Mk(function(Se){ce.insert(Se)})],q=Ak(W.concat(x,J)),ve=function(ee){return Lh(Ck(ee),q)};B=function(ee,Q,re,Te){ce=re,ve(ee?ee+"{"+Q.styles+"}":Q.styles),Te&&(Ae.inserted[Q.name]=!0)}}var Ae={key:c,sheet:new ub({key:c,container:k,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend}),nonce:o.nonce,inserted:T,registered:{},insert:B};return Ae.sheet.hydrate(a),Ae},wb={exports:{}},hn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hr=typeof Symbol=="function"&&Symbol.for,py=hr?Symbol.for("react.element"):60103,fy=hr?Symbol.for("react.portal"):60106,wf=hr?Symbol.for("react.fragment"):60107,bf=hr?Symbol.for("react.strict_mode"):60108,Tf=hr?Symbol.for("react.profiler"):60114,Sf=hr?Symbol.for("react.provider"):60109,Ef=hr?Symbol.for("react.context"):60110,my=hr?Symbol.for("react.async_mode"):60111,Cf=hr?Symbol.for("react.concurrent_mode"):60111,kf=hr?Symbol.for("react.forward_ref"):60112,If=hr?Symbol.for("react.suspense"):60113,Nk=hr?Symbol.for("react.suspense_list"):60120,Af=hr?Symbol.for("react.memo"):60115,Mf=hr?Symbol.for("react.lazy"):60116,Uk=hr?Symbol.for("react.block"):60121,Vk=hr?Symbol.for("react.fundamental"):60117,$k=hr?Symbol.for("react.responder"):60118,jk=hr?Symbol.for("react.scope"):60119;function bi(t){if(typeof t=="object"&&t!==null){var o=t.$$typeof;switch(o){case py:switch(t=t.type,t){case my:case Cf:case wf:case Tf:case bf:case If:return t;default:switch(t=t&&t.$$typeof,t){case Ef:case kf:case Mf:case Af:case Sf:return t;default:return o}}case fy:return o}}}function bb(t){return bi(t)===Cf}hn.AsyncMode=my;hn.ConcurrentMode=Cf;hn.ContextConsumer=Ef;hn.ContextProvider=Sf;hn.Element=py;hn.ForwardRef=kf;hn.Fragment=wf;hn.Lazy=Mf;hn.Memo=Af;hn.Portal=fy;hn.Profiler=Tf;hn.StrictMode=bf;hn.Suspense=If;hn.isAsyncMode=function(t){return bb(t)||bi(t)===my};hn.isConcurrentMode=bb;hn.isContextConsumer=function(t){return bi(t)===Ef};hn.isContextProvider=function(t){return bi(t)===Sf};hn.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===py};hn.isForwardRef=function(t){return bi(t)===kf};hn.isFragment=function(t){return bi(t)===wf};hn.isLazy=function(t){return bi(t)===Mf};hn.isMemo=function(t){return bi(t)===Af};hn.isPortal=function(t){return bi(t)===fy};hn.isProfiler=function(t){return bi(t)===Tf};hn.isStrictMode=function(t){return bi(t)===bf};hn.isSuspense=function(t){return bi(t)===If};hn.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===wf||t===Cf||t===Tf||t===bf||t===If||t===Nk||typeof t=="object"&&t!==null&&(t.$$typeof===Mf||t.$$typeof===Af||t.$$typeof===Sf||t.$$typeof===Ef||t.$$typeof===kf||t.$$typeof===Vk||t.$$typeof===$k||t.$$typeof===jk||t.$$typeof===Uk)};hn.typeOf=bi;wb.exports=hn;var Tb=wb.exports,Gk={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Zk={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Sb={};Sb[Tb.ForwardRef]=Gk;Sb[Tb.Memo]=Zk;var qk=!0;function Wk(t,o,c){var m="";return c.split(" ").forEach(function(x){t[x]!==void 0?o.push(t[x]+";"):m+=x+" "}),m}var Eb=function(o,c,m){var x=o.key+"-"+c.name;if((m===!1||qk===!1)&&o.registered[x]===void 0&&(o.registered[x]=c.styles),o.inserted[c.name]===void 0){var T=c;do o.insert(c===T?"."+x:"",T,o.sheet,!0),T=T.next;while(T!==void 0)}};function Xk(t){for(var o=0,c,m=0,x=t.length;x>=4;++m,x-=4)c=t.charCodeAt(m)&255|(t.charCodeAt(++m)&255)<<8|(t.charCodeAt(++m)&255)<<16|(t.charCodeAt(++m)&255)<<24,c=(c&65535)*1540483477+((c>>>16)*59797<<16),c^=c>>>24,o=(c&65535)*1540483477+((c>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(x){case 3:o^=(t.charCodeAt(m+2)&255)<<16;case 2:o^=(t.charCodeAt(m+1)&255)<<8;case 1:o^=t.charCodeAt(m)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var Hk={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Kk=/[A-Z]|^ms/g,Yk=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Cb=function(o){return o.charCodeAt(1)===45},kb=function(o){return o!=null&&typeof o!="boolean"},gy=cb(function(t){return Cb(t)?t:t.replace(Kk,"-$&").toLowerCase()}),Ib=function(o,c){switch(o){case"animation":case"animationName":if(typeof c=="string")return c.replace(Yk,function(m,x,T){return xo={name:x,styles:T,next:xo},x})}return Hk[o]!==1&&!Cb(o)&&typeof c=="number"&&c!==0?c+"px":c};function Bh(t,o,c){if(c==null)return"";if(c.__emotion_styles!==void 0)return c;switch(typeof c){case"boolean":return"";case"object":{if(c.anim===1)return xo={name:c.name,styles:c.styles,next:xo},c.name;if(c.styles!==void 0){var m=c.next;if(m!==void 0)for(;m!==void 0;)xo={name:m.name,styles:m.styles,next:xo},m=m.next;var x=c.styles+";";return x}return Qk(t,o,c)}case"function":{if(t!==void 0){var T=xo,k=c(t);return xo=T,Bh(t,o,k)}break}}if(o==null)return c;var a=o[c];return a!==void 0?a:c}function Qk(t,o,c){var m="";if(Array.isArray(c))for(var x=0;x<c.length;x++)m+=Bh(t,o,c[x])+";";else for(var T in c){var k=c[T];if(typeof k!="object")o!=null&&o[k]!==void 0?m+=T+"{"+o[k]+"}":kb(k)&&(m+=gy(T)+":"+Ib(T,k)+";");else if(Array.isArray(k)&&typeof k[0]=="string"&&(o==null||o[k[0]]===void 0))for(var a=0;a<k.length;a++)kb(k[a])&&(m+=gy(T)+":"+Ib(T,k[a])+";");else{var B=Bh(t,o,k);switch(T){case"animation":case"animationName":{m+=gy(T)+":"+B+";";break}default:m+=T+"{"+B+"}"}}}return m}var Ab=/label:\s*([^\s;\n{]+)\s*(;|$)/g,xo,_y=function(o,c,m){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var x=!0,T="";xo=void 0;var k=o[0];k==null||k.raw===void 0?(x=!1,T+=Bh(m,c,k)):T+=k[0];for(var a=1;a<o.length;a++)T+=Bh(m,c,o[a]),x&&(T+=k[a]);Ab.lastIndex=0;for(var B="",W;(W=Ab.exec(T))!==null;)B+="-"+W[1];var ce=Xk(T)+B;return{name:ce,styles:T,next:xo}},Mb=Oe.exports.createContext(typeof HTMLElement!="undefined"?Ok({key:"css"}):null);Mb.Provider;var zb=function(o){return Oe.exports.forwardRef(function(c,m){var x=Oe.exports.useContext(Mb);return o(c,x,m)})},yy=Oe.exports.createContext({}),Jk=zb(function(t,o){var c=t.styles,m=_y([c],void 0,Oe.exports.useContext(yy)),x=Oe.exports.useRef();return Oe.exports.useLayoutEffect(function(){var T=o.key+"-global",k=new ub({key:T,nonce:o.sheet.nonce,container:o.sheet.container,speedy:o.sheet.isSpeedy}),a=!1,B=document.querySelector('style[data-emotion="'+T+" "+m.name+'"]');return o.sheet.tags.length&&(k.before=o.sheet.tags[0]),B!==null&&(a=!0,B.setAttribute("data-emotion",T),k.hydrate([B])),x.current=[k,a],function(){k.flush()}},[o]),Oe.exports.useLayoutEffect(function(){var T=x.current,k=T[0],a=T[1];if(a){T[1]=!1;return}if(m.next!==void 0&&Eb(o,m.next,!0),k.tags.length){var B=k.tags[k.tags.length-1].nextElementSibling;k.before=B,k.flush()}o.insert("",m,k,!1)},[o,m.name]),null});function eI(){for(var t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];return _y(o)}var xy=function(){var o=eI.apply(void 0,arguments),c="animation-"+o.name;return{name:c,styles:"@keyframes "+c+"{"+o.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},tI=hk,nI=function(o){return o!=="theme"},Pb=function(o){return typeof o=="string"&&o.charCodeAt(0)>96?tI:nI},Db=function(o,c,m){var x;if(c){var T=c.shouldForwardProp;x=o.__emotion_forwardProp&&T?function(k){return o.__emotion_forwardProp(k)&&T(k)}:T}return typeof x!="function"&&m&&(x=o.__emotion_forwardProp),x},rI=function t(o,c){var m=o.__emotion_real===o,x=m&&o.__emotion_base||o,T,k;c!==void 0&&(T=c.label,k=c.target);var a=Db(o,c,m),B=a||Pb(x),W=!B("as");return function(){var ce=arguments,J=m&&o.__emotion_styles!==void 0?o.__emotion_styles.slice(0):[];if(T!==void 0&&J.push("label:"+T+";"),ce[0]==null||ce[0].raw===void 0)J.push.apply(J,ce);else{J.push(ce[0][0]);for(var q=ce.length,ve=1;ve<q;ve++)J.push(ce[ve],ce[0][ve])}var Ae=zb(function(Se,ee,Q){var re=W&&Se.as||x,Te="",xe=[],Ve=Se;if(Se.theme==null){Ve={};for(var Ie in Se)Ve[Ie]=Se[Ie];Ve.theme=Oe.exports.useContext(yy)}typeof Se.className=="string"?Te=Wk(ee.registered,xe,Se.className):Se.className!=null&&(Te=Se.className+" ");var $e=_y(J.concat(xe),ee.registered,Ve);Eb(ee,$e,typeof re=="string"),Te+=ee.key+"-"+$e.name,k!==void 0&&(Te+=" "+k);var We=W&&a===void 0?Pb(re):B,je={};for(var ot in Se)W&&ot==="as"||We(ot)&&(je[ot]=Se[ot]);je.className=Te,je.ref=Q;var zt=Oe.exports.createElement(re,je);return zt});return Ae.displayName=T!==void 0?T:"Styled("+(typeof x=="string"?x:x.displayName||x.name||"Component")+")",Ae.defaultProps=o.defaultProps,Ae.__emotion_real=Ae,Ae.__emotion_base=x,Ae.__emotion_styles=J,Ae.__emotion_forwardProp=a,Object.defineProperty(Ae,"toString",{value:function(){return"."+k}}),Ae.withComponent=function(Se,ee){return t(Se,Ke({},c,ee,{shouldForwardProp:Db(Ae,ee,!0)})).apply(void 0,J)},Ae}},iI=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],vy=rI.bind();iI.forEach(function(t){vy[t]=vy(t)});var oI=vy;function sI(t){return t==null||Object.keys(t).length===0}function aI(t){const{styles:o,defaultTheme:c={}}=t;return Xt(Jk,{styles:typeof o=="function"?x=>o(sI(x)?c:x):o})}/** @license MUI v5.0.2
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Rb(t,o){return oI(t,o)}function Fh(t,o){return o?qo(t,o,{clone:!1}):t}const wy={xs:0,sm:600,md:900,lg:1200,xl:1536},Lb={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${wy[t]}px)`};function js(t,o,c){const m=t.theme||{};if(Array.isArray(o)){const T=m.breakpoints||Lb;return o.reduce((k,a,B)=>(k[T.up(T.keys[B])]=c(o[B]),k),{})}if(typeof o=="object"){const T=m.breakpoints||Lb;return Object.keys(o).reduce((k,a)=>{if(Object.keys(T.values||wy).indexOf(a)!==-1){const B=T.up(a);k[B]=c(o[a],a)}else{const B=a;k[B]=o[B]}return k},{})}return c(o)}function lI(t={}){var o;return(t==null||(o=t.keys)==null?void 0:o.reduce((m,x)=>{const T=t.up(x);return m[T]={},m},{}))||{}}function cI(t,o){return t.reduce((c,m)=>{const x=c[m];return Object.keys(x).length===0&&delete c[m],c},o)}function by(t,o){return!o||typeof o!="string"?null:o.split(".").reduce((c,m)=>c&&c[m]?c[m]:null,t)}function Bb(t,o,c,m=c){let x;return typeof t=="function"?x=t(c):Array.isArray(t)?x=t[c]||m:x=by(t,c)||m,o&&(x=o(x)),x}function ct(t){const{prop:o,cssProperty:c=t.prop,themeKey:m,transform:x}=t,T=k=>{if(k[o]==null)return null;const a=k[o],B=k.theme,W=by(B,m)||{};return js(k,a,J=>{let q=Bb(W,x,J);return J===q&&typeof J=="string"&&(q=Bb(W,x,`${o}${J==="default"?"":On(J)}`,J)),c===!1?q:{[c]:q}})};return T.propTypes={},T.filterProps=[o],T}function Gs(...t){const o=t.reduce((m,x)=>(x.filterProps.forEach(T=>{m[T]=x}),m),{}),c=m=>Object.keys(m).reduce((x,T)=>o[T]?Fh(x,o[T](m)):x,{});return c.propTypes={},c.filterProps=t.reduce((m,x)=>m.concat(x.filterProps),[]),c}function uI(t){const o={};return c=>(o[c]===void 0&&(o[c]=t(c)),o[c])}const hI={m:"margin",p:"padding"},dI={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Fb={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},pI=uI(t=>{if(t.length>2)if(Fb[t])t=Fb[t];else return[t];const[o,c]=t.split(""),m=hI[o],x=dI[c]||"";return Array.isArray(x)?x.map(T=>m+T):[m+x]}),fI=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],mI=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Ob=[...fI,...mI];function Oh(t,o,c,m){const x=by(t,o)||c;return typeof x=="number"?T=>typeof T=="string"?T:x*T:Array.isArray(x)?T=>typeof T=="string"?T:x[T]:typeof x=="function"?x:()=>{}}function Nb(t){return Oh(t,"spacing",8)}function Nh(t,o){if(typeof o=="string"||o==null)return o;const c=Math.abs(o),m=t(c);return o>=0?m:typeof m=="number"?-m:`-${m}`}function gI(t,o){return c=>t.reduce((m,x)=>(m[x]=Nh(o,c),m),{})}function _I(t,o,c,m){if(o.indexOf(c)===-1)return null;const x=pI(c),T=gI(x,m),k=t[c];return js(t,k,T)}function yI(t,o){const c=Nb(t.theme);return Object.keys(t).map(m=>_I(t,o,m,c)).reduce(Fh,{})}function zf(t){return yI(t,Ob)}zf.propTypes={};zf.filterProps=Ob;function Uh(t){return typeof t!="number"?t:`${t}px solid`}const xI=ct({prop:"border",themeKey:"borders",transform:Uh}),vI=ct({prop:"borderTop",themeKey:"borders",transform:Uh}),wI=ct({prop:"borderRight",themeKey:"borders",transform:Uh}),bI=ct({prop:"borderBottom",themeKey:"borders",transform:Uh}),TI=ct({prop:"borderLeft",themeKey:"borders",transform:Uh}),SI=ct({prop:"borderColor",themeKey:"palette"}),EI=ct({prop:"borderTopColor",themeKey:"palette"}),CI=ct({prop:"borderRightColor",themeKey:"palette"}),kI=ct({prop:"borderBottomColor",themeKey:"palette"}),II=ct({prop:"borderLeftColor",themeKey:"palette"}),Ty=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const o=Oh(t.theme,"shape.borderRadius",4),c=m=>({borderRadius:Nh(o,m)});return js(t,t.borderRadius,c)}return null};Ty.propTypes={};Ty.filterProps=["borderRadius"];const AI=Gs(xI,vI,wI,bI,TI,SI,EI,CI,kI,II,Ty);var Ub=AI;const MI=ct({prop:"displayPrint",cssProperty:!1,transform:t=>({"@media print":{display:t}})}),zI=ct({prop:"display"}),PI=ct({prop:"overflow"}),DI=ct({prop:"textOverflow"}),RI=ct({prop:"visibility"}),LI=ct({prop:"whiteSpace"});var Vb=Gs(MI,zI,PI,DI,RI,LI);const BI=ct({prop:"flexBasis"}),FI=ct({prop:"flexDirection"}),OI=ct({prop:"flexWrap"}),NI=ct({prop:"justifyContent"}),UI=ct({prop:"alignItems"}),VI=ct({prop:"alignContent"}),$I=ct({prop:"order"}),jI=ct({prop:"flex"}),GI=ct({prop:"flexGrow"}),ZI=ct({prop:"flexShrink"}),qI=ct({prop:"alignSelf"}),WI=ct({prop:"justifyItems"}),XI=ct({prop:"justifySelf"}),HI=Gs(BI,FI,OI,NI,UI,VI,$I,jI,GI,ZI,qI,WI,XI);var $b=HI;const Sy=t=>{if(t.gap!==void 0&&t.gap!==null){const o=Oh(t.theme,"spacing",8),c=m=>({gap:Nh(o,m)});return js(t,t.gap,c)}return null};Sy.propTypes={};Sy.filterProps=["gap"];const Ey=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const o=Oh(t.theme,"spacing",8),c=m=>({columnGap:Nh(o,m)});return js(t,t.columnGap,c)}return null};Ey.propTypes={};Ey.filterProps=["columnGap"];const Cy=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const o=Oh(t.theme,"spacing",8),c=m=>({rowGap:Nh(o,m)});return js(t,t.rowGap,c)}return null};Cy.propTypes={};Cy.filterProps=["rowGap"];const KI=ct({prop:"gridColumn"}),YI=ct({prop:"gridRow"}),QI=ct({prop:"gridAutoFlow"}),JI=ct({prop:"gridAutoColumns"}),eA=ct({prop:"gridAutoRows"}),tA=ct({prop:"gridTemplateColumns"}),nA=ct({prop:"gridTemplateRows"}),rA=ct({prop:"gridTemplateAreas"}),iA=ct({prop:"gridArea"}),oA=Gs(Sy,Ey,Cy,KI,YI,QI,JI,eA,tA,nA,rA,iA);var jb=oA;const sA=ct({prop:"color",themeKey:"palette"}),aA=ct({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),lA=ct({prop:"backgroundColor",themeKey:"palette"}),cA=Gs(sA,aA,lA);var Gb=cA;const uA=ct({prop:"position"}),hA=ct({prop:"zIndex",themeKey:"zIndex"}),dA=ct({prop:"top"}),pA=ct({prop:"right"}),fA=ct({prop:"bottom"}),mA=ct({prop:"left"});var Zb=Gs(uA,hA,dA,pA,fA,mA);const gA=ct({prop:"boxShadow",themeKey:"shadows"});var qb=gA;function Zs(t){return t<=1&&t!==0?`${t*100}%`:t}const _A=ct({prop:"width",transform:Zs}),Wb=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const o=c=>{var m,x,T;return{maxWidth:((m=t.theme)==null||(x=m.breakpoints)==null||(T=x.values)==null?void 0:T[c])||wy[c]||Zs(c)}};return js(t,t.maxWidth,o)}return null};Wb.filterProps=["maxWidth"];const yA=ct({prop:"minWidth",transform:Zs}),xA=ct({prop:"height",transform:Zs}),vA=ct({prop:"maxHeight",transform:Zs}),wA=ct({prop:"minHeight",transform:Zs});ct({prop:"size",cssProperty:"width",transform:Zs});ct({prop:"size",cssProperty:"height",transform:Zs});const bA=ct({prop:"boxSizing"}),TA=Gs(_A,Wb,yA,xA,vA,wA,bA);var Xb=TA;const SA=ct({prop:"fontFamily",themeKey:"typography"}),EA=ct({prop:"fontSize",themeKey:"typography"}),CA=ct({prop:"fontStyle",themeKey:"typography"}),kA=ct({prop:"fontWeight",themeKey:"typography"}),IA=ct({prop:"letterSpacing"}),AA=ct({prop:"lineHeight"}),MA=ct({prop:"textAlign"}),zA=ct({prop:"typography",cssProperty:!1,themeKey:"typography"}),PA=Gs(zA,SA,EA,CA,kA,IA,AA,MA);var Hb=PA;const Kb={borders:Ub.filterProps,display:Vb.filterProps,flexbox:$b.filterProps,grid:jb.filterProps,positions:Zb.filterProps,palette:Gb.filterProps,shadows:qb.filterProps,sizing:Xb.filterProps,spacing:zf.filterProps,typography:Hb.filterProps},DA={borders:Ub,display:Vb,flexbox:$b,grid:jb,positions:Zb,palette:Gb,shadows:qb,sizing:Xb,spacing:zf,typography:Hb},ky=Object.keys(Kb).reduce((t,o)=>(Kb[o].forEach(c=>{t[c]=DA[o]}),t),{});function Yb(t,o,c){const m={[t]:o,theme:c},x=ky[t];return x?x(m):{[t]:o}}function RA(...t){const o=t.reduce((m,x)=>m.concat(Object.keys(x)),[]),c=new Set(o);return t.every(m=>c.size===Object.keys(m).length)}function LA(t,o){return typeof t=="function"?t(o):t}function Pf(t){const{sx:o,theme:c={}}=t||{};if(!o)return null;let m=o;if(typeof o=="function")m=o(c);else if(typeof o!="object")return o;const x=lI(c.breakpoints),T=Object.keys(x);let k=x;return Object.keys(m).forEach(a=>{const B=LA(m[a],c);if(typeof B=="object")if(ky[a])k=Fh(k,Yb(a,B,c));else{const W=js({theme:c},B,ce=>({[a]:ce}));RA(W,B)?k[a]=Pf({sx:B,theme:c}):k=Fh(k,W)}else k=Fh(k,Yb(a,B,c))}),cI(T,k)}Pf.filterProps=["sx"];const BA=["sx"],FA=t=>{const o={systemProps:{},otherProps:{}};return Object.keys(t).forEach(c=>{ky[c]?o.systemProps[c]=t[c]:o.otherProps[c]=t[c]}),o};function Qb(t){const{sx:o}=t,c=fn(t,BA),{systemProps:m,otherProps:x}=FA(c);return Ke({},x,{sx:Ke({},m,o)})}const OA=["values","unit","step"];function NA(t){const{values:o={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:c="px",step:m=5}=t,x=fn(t,OA),T=Object.keys(o);function k(ce){return`@media (min-width:${typeof o[ce]=="number"?o[ce]:ce}${c})`}function a(ce){return`@media (max-width:${(typeof o[ce]=="number"?o[ce]:ce)-m/100}${c})`}function B(ce,J){const q=T.indexOf(J);return`@media (min-width:${typeof o[ce]=="number"?o[ce]:ce}${c}) and (max-width:${(q!==-1&&typeof o[T[q]]=="number"?o[T[q]]:J)-m/100}${c})`}function W(ce){return T.indexOf(ce)+1<T.length?B(ce,T[T.indexOf(ce)+1]):k(ce)}return Ke({keys:T,values:o,up:k,down:a,between:B,only:W,unit:c},x)}const UA={borderRadius:4};var VA=UA;function $A(t=8){if(t.mui)return t;const o=Nb({spacing:t}),c=(...m)=>(m.length===0?[1]:m).map(T=>{const k=o(T);return typeof k=="number"?`${k}px`:k}).join(" ");return c.mui=!0,c}const jA=["breakpoints","palette","spacing","shape"];function Iy(t={},...o){const{breakpoints:c={},palette:m={},spacing:x,shape:T={}}=t,k=fn(t,jA),a=NA(c),B=$A(x);let W=qo({breakpoints:a,direction:"ltr",components:{},palette:Ke({mode:"light"},m),spacing:B,shape:Ke({},VA,T)},k);return W=o.reduce((ce,J)=>qo(ce,J),W),W}const GA=Oe.exports.createContext(null);var Jb=GA;function e2(){return Oe.exports.useContext(Jb)}const ZA=typeof Symbol=="function"&&Symbol.for;var qA=ZA?Symbol.for("mui.nested"):"__THEME_NESTED__";function WA(t,o){return typeof o=="function"?o(t):Ke({},t,o)}function XA(t){const{children:o,theme:c}=t,m=e2(),x=Oe.exports.useMemo(()=>{const T=m===null?c:WA(m,c);return T!=null&&(T[qA]=m!==null),T},[c,m]);return Xt(Jb.Provider,{value:x,children:o})}function HA(t){return Object.keys(t).length===0}function KA(t=null){const o=e2();return!o||HA(o)?t:o}const YA=Iy();function Ay(t=YA){return KA(t)}const QA=["className","component"];function JA(t={}){const{defaultTheme:o}=t,c=Rb("div")(Pf);return Oe.exports.forwardRef(function(T,k){const a=Ay(o),B=Qb(T),{className:W,component:ce="div"}=B,J=fn(B,QA);return Xt(c,Ke({as:ce,ref:k,className:Cn(W,"MuiBox-root"),theme:a},J))})}const eM=["variant"];function t2(t){return t.length===0}function n2(t){const{variant:o}=t,c=fn(t,eM);let m=o||"";return Object.keys(c).sort().forEach(x=>{x==="color"?m+=t2(m)?t[x]:On(t[x]):m+=`${t2(m)?x:On(x)}${On(t[x].toString())}`}),m}const tM=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],nM=["theme"],rM=["theme"];function Vh(t){return Object.keys(t).length===0}const iM=(t,o)=>o.components&&o.components[t]&&o.components[t].styleOverrides?o.components[t].styleOverrides:null,oM=(t,o)=>{let c=[];o&&o.components&&o.components[t]&&o.components[t].variants&&(c=o.components[t].variants);const m={};return c.forEach(x=>{const T=n2(x.props);m[T]=x.style}),m},sM=(t,o,c,m)=>{var x,T;const{ownerState:k={}}=t,a=[],B=c==null||(x=c.components)==null||(T=x[m])==null?void 0:T.variants;return B&&B.forEach(W=>{let ce=!0;Object.keys(W.props).forEach(J=>{k[J]!==W.props[J]&&t[J]!==W.props[J]&&(ce=!1)}),ce&&a.push(o[n2(W.props)])}),a};function Df(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const aM=Iy();function lM(t={}){const{defaultTheme:o=aM,rootShouldForwardProp:c=Df,slotShouldForwardProp:m=Df}=t;return(x,T={})=>{const{name:k,slot:a,skipVariantsResolver:B,skipSx:W,overridesResolver:ce}=T,J=fn(T,tM),q=B!==void 0?B:a&&a!=="Root"||!1,ve=W||!1;let Ae,Se=Df;a==="Root"?Se=c:a&&(Se=m);const ee=Rb(x,Ke({shouldForwardProp:Se,label:Ae},J));return(re,...Te)=>{const xe=Te?Te.map(We=>typeof We=="function"&&We.__emotion_real!==We?je=>{let{theme:ot}=je,zt=fn(je,nM);return We(Ke({theme:Vh(ot)?o:ot},zt))}:We):[];let Ve=re;k&&ce&&xe.push(We=>{const je=Vh(We.theme)?o:We.theme,ot=iM(k,je);return ot?ce(We,ot):null}),k&&!q&&xe.push(We=>{const je=Vh(We.theme)?o:We.theme;return sM(We,oM(k,je),je,k)}),ve||xe.push(We=>{const je=Vh(We.theme)?o:We.theme;return Pf(Ke({},We,{theme:je}))});const Ie=xe.length-Te.length;if(Array.isArray(re)&&Ie>0){const We=new Array(Ie).fill("");Ve=[...re,...We],Ve.raw=[...re.raw,...We]}else typeof re=="function"&&(Ve=We=>{let{theme:je}=We,ot=fn(We,rM);return re(Ke({theme:Vh(je)?o:je},ot))});return ee(Ve,...xe)}}}function cM(t){const{theme:o,name:c,props:m}=t;if(!o||!o.components||!o.components[c]||!o.components[c].defaultProps)return m;const x=Ke({},m),T=o.components[c].defaultProps;let k;for(k in T)x[k]===void 0&&(x[k]=T[k]);return x}function uM({props:t,name:o,defaultTheme:c}){const m=Ay(c);return cM({theme:m,name:o,props:t})}function My(t,o=0,c=1){return Math.min(Math.max(o,t),c)}function hM(t){t=t.substr(1);const o=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let c=t.match(o);return c&&c[0].length===1&&(c=c.map(m=>m+m)),c?`rgb${c.length===4?"a":""}(${c.map((m,x)=>x<3?parseInt(m,16):Math.round(parseInt(m,16)/255*1e3)/1e3).join(", ")})`:""}function Na(t){if(t.type)return t;if(t.charAt(0)==="#")return Na(hM(t));const o=t.indexOf("("),c=t.substring(0,o);if(["rgb","rgba","hsl","hsla","color"].indexOf(c)===-1)throw new Error(mc(9,t));let m=t.substring(o+1,t.length-1),x;if(c==="color"){if(m=m.split(" "),x=m.shift(),m.length===4&&m[3].charAt(0)==="/"&&(m[3]=m[3].substr(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(x)===-1)throw new Error(mc(10,x))}else m=m.split(",");return m=m.map(T=>parseFloat(T)),{type:c,values:m,colorSpace:x}}function Rf(t){const{type:o,colorSpace:c}=t;let{values:m}=t;return o.indexOf("rgb")!==-1?m=m.map((x,T)=>T<3?parseInt(x,10):x):o.indexOf("hsl")!==-1&&(m[1]=`${m[1]}%`,m[2]=`${m[2]}%`),o.indexOf("color")!==-1?m=`${c} ${m.join(" ")}`:m=`${m.join(", ")}`,`${o}(${m})`}function dM(t){t=Na(t);const{values:o}=t,c=o[0],m=o[1]/100,x=o[2]/100,T=m*Math.min(x,1-x),k=(W,ce=(W+c/30)%12)=>x-T*Math.max(Math.min(ce-3,9-ce,1),-1);let a="rgb";const B=[Math.round(k(0)*255),Math.round(k(8)*255),Math.round(k(4)*255)];return t.type==="hsla"&&(a+="a",B.push(o[3])),Rf({type:a,values:B})}function r2(t){t=Na(t);let o=t.type==="hsl"?Na(dM(t)).values:t.values;return o=o.map(c=>(t.type!=="color"&&(c/=255),c<=.03928?c/12.92:((c+.055)/1.055)**2.4)),Number((.2126*o[0]+.7152*o[1]+.0722*o[2]).toFixed(3))}function pM(t,o){const c=r2(t),m=r2(o);return(Math.max(c,m)+.05)/(Math.min(c,m)+.05)}function qs(t,o){return t=Na(t),o=My(o),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${o}`:t.values[3]=o,Rf(t)}function fM(t,o){if(t=Na(t),o=My(o),t.type.indexOf("hsl")!==-1)t.values[2]*=1-o;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let c=0;c<3;c+=1)t.values[c]*=1-o;return Rf(t)}function mM(t,o){if(t=Na(t),o=My(o),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*o;else if(t.type.indexOf("rgb")!==-1)for(let c=0;c<3;c+=1)t.values[c]+=(255-t.values[c])*o;else if(t.type.indexOf("color")!==-1)for(let c=0;c<3;c+=1)t.values[c]+=(1-t.values[c])*o;return Rf(t)}function gM(t){const o=Ay();return Xt(yy.Provider,{value:typeof o=="object"?o:{},children:t.children})}function vD(t){const{children:o,theme:c}=t;return Xt(XA,{theme:c,children:Xt(gM,{children:o})})}const _M=["onChange","maxRows","minRows","style","value"];function Lf(t,o){return parseInt(t[o],10)||0}const yM={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},xM=Oe.exports.forwardRef(function(o,c){const{onChange:m,maxRows:x,minRows:T=1,style:k,value:a}=o,B=fn(o,_M),{current:W}=Oe.exports.useRef(a!=null),ce=Oe.exports.useRef(null),J=$s(c,ce),q=Oe.exports.useRef(null),ve=Oe.exports.useRef(0),[Ae,Se]=Oe.exports.useState({}),ee=Oe.exports.useCallback(()=>{const re=ce.current,xe=iy(re).getComputedStyle(re);if(xe.width==="0px")return;const Ve=q.current;Ve.style.width=xe.width,Ve.value=re.value||o.placeholder||"x",Ve.value.slice(-1)===`
`&&(Ve.value+=" ");const Ie=xe["box-sizing"],$e=Lf(xe,"padding-bottom")+Lf(xe,"padding-top"),We=Lf(xe,"border-bottom-width")+Lf(xe,"border-top-width"),je=Ve.scrollHeight;Ve.value="x";const ot=Ve.scrollHeight;let zt=je;T&&(zt=Math.max(Number(T)*ot,zt)),x&&(zt=Math.min(Number(x)*ot,zt)),zt=Math.max(zt,ot);const Rt=zt+(Ie==="border-box"?$e+We:0),St=Math.abs(zt-je)<=1;Se(Zt=>ve.current<20&&(Rt>0&&Math.abs((Zt.outerHeightStyle||0)-Rt)>1||Zt.overflow!==St)?(ve.current+=1,{overflow:St,outerHeightStyle:Rt}):Zt)},[x,T,o.placeholder]);Oe.exports.useEffect(()=>{const re=Qw(()=>{ve.current=0,ee()}),Te=iy(ce.current);Te.addEventListener("resize",re);let xe;return typeof ResizeObserver!="undefined"&&(xe=new ResizeObserver(re),xe.observe(ce.current)),()=>{re.clear(),Te.removeEventListener("resize",re),xe&&xe.disconnect()}},[ee]),Ih(()=>{ee()}),Oe.exports.useEffect(()=>{ve.current=0},[a]);const Q=re=>{ve.current=0,W||ee(),m&&m(re)};return go(Oe.exports.Fragment,{children:[Xt("textarea",Ke({value:a,onChange:Q,ref:J,rows:T,style:Ke({height:Ae.outerHeightStyle,overflow:Ae.overflow?"hidden":null},k)},B)),Xt("textarea",{"aria-hidden":!0,className:o.className,readOnly:!0,ref:q,tabIndex:-1,style:Ke({},yM.shadow,k,{padding:0})})]})});var vM=xM;function wM(t,o,c){return Ke({toolbar:{minHeight:56,[`${t.up("xs")} and (orientation: landscape)`]:{minHeight:48},[t.up("sm")]:{minHeight:64}}},c)}const bM={black:"#000",white:"#fff"};var $h=bM;const TM={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};var SM=TM;const EM={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"};var yc=EM;const CM={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"};var xc=CM;const kM={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"};var jh=kM;const IM={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"};var vc=IM;const AM={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"};var wc=AM;const MM={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};var bc=MM;const zM=["mode","contrastThreshold","tonalOffset"],i2={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:$h.white,default:$h.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},zy={text:{primary:$h.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:$h.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function o2(t,o,c,m){const x=m.light||m,T=m.dark||m*1.5;t[o]||(t.hasOwnProperty(c)?t[o]=t[c]:o==="light"?t.light=mM(t.main,x):o==="dark"&&(t.dark=fM(t.main,T)))}function PM(t="light"){return t==="dark"?{main:vc[200],light:vc[50],dark:vc[400]}:{main:vc[700],light:vc[400],dark:vc[800]}}function DM(t="light"){return t==="dark"?{main:yc[200],light:yc[50],dark:yc[400]}:{main:yc[500],light:yc[300],dark:yc[700]}}function RM(t="light"){return t==="dark"?{main:xc[500],light:xc[300],dark:xc[700]}:{main:xc[700],light:xc[400],dark:xc[800]}}function LM(t="light"){return t==="dark"?{main:wc[400],light:wc[300],dark:wc[700]}:{main:wc[700],light:wc[500],dark:wc[900]}}function BM(t="light"){return t==="dark"?{main:bc[400],light:bc[300],dark:bc[700]}:{main:bc[800],light:bc[500],dark:bc[900]}}function FM(t="light"){return t==="dark"?{main:jh[400],light:jh[300],dark:jh[700]}:{main:"#ED6C02",light:jh[500],dark:jh[900]}}function OM(t){const{mode:o="light",contrastThreshold:c=3,tonalOffset:m=.2}=t,x=fn(t,zM),T=t.primary||PM(o),k=t.secondary||DM(o),a=t.error||RM(o),B=t.info||LM(o),W=t.success||BM(o),ce=t.warning||FM(o);function J(Se){return pM(Se,zy.text.primary)>=c?zy.text.primary:i2.text.primary}const q=({color:Se,name:ee,mainShade:Q=500,lightShade:re=300,darkShade:Te=700})=>{if(Se=Ke({},Se),!Se.main&&Se[Q]&&(Se.main=Se[Q]),!Se.hasOwnProperty("main"))throw new Error(mc(11,ee?` (${ee})`:"",Q));if(typeof Se.main!="string")throw new Error(mc(12,ee?` (${ee})`:"",JSON.stringify(Se.main)));return o2(Se,"light",re,m),o2(Se,"dark",Te,m),Se.contrastText||(Se.contrastText=J(Se.main)),Se},ve={dark:zy,light:i2};return qo(Ke({common:$h,mode:o,primary:q({color:T,name:"primary"}),secondary:q({color:k,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:q({color:a,name:"error"}),warning:q({color:ce,name:"warning"}),info:q({color:B,name:"info"}),success:q({color:W,name:"success"}),grey:SM,contrastThreshold:c,getContrastText:J,augmentColor:q,tonalOffset:m},ve[o]),x)}const NM=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function UM(t){return Math.round(t*1e5)/1e5}const s2={textTransform:"uppercase"},a2='"Roboto", "Helvetica", "Arial", sans-serif';function VM(t,o){const c=typeof o=="function"?o(t):o,{fontFamily:m=a2,fontSize:x=14,fontWeightLight:T=300,fontWeightRegular:k=400,fontWeightMedium:a=500,fontWeightBold:B=700,htmlFontSize:W=16,allVariants:ce,pxToRem:J}=c,q=fn(c,NM),ve=x/14,Ae=J||(Q=>`${Q/W*ve}rem`),Se=(Q,re,Te,xe,Ve)=>Ke({fontFamily:m,fontWeight:Q,fontSize:Ae(re),lineHeight:Te},m===a2?{letterSpacing:`${UM(xe/re)}em`}:{},Ve,ce),ee={h1:Se(T,96,1.167,-1.5),h2:Se(T,60,1.2,-.5),h3:Se(k,48,1.167,0),h4:Se(k,34,1.235,.25),h5:Se(k,24,1.334,0),h6:Se(a,20,1.6,.15),subtitle1:Se(k,16,1.75,.15),subtitle2:Se(a,14,1.57,.1),body1:Se(k,16,1.5,.15),body2:Se(k,14,1.43,.15),button:Se(a,14,1.75,.4,s2),caption:Se(k,12,1.66,.4),overline:Se(k,12,2.66,1,s2)};return qo(Ke({htmlFontSize:W,pxToRem:Ae,fontFamily:m,fontSize:x,fontWeightLight:T,fontWeightRegular:k,fontWeightMedium:a,fontWeightBold:B},ee),q,{clone:!1})}const $M=.2,jM=.14,GM=.12;function Rn(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${$M})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${jM})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${GM})`].join(",")}const ZM=["none",Rn(0,2,1,-1,0,1,1,0,0,1,3,0),Rn(0,3,1,-2,0,2,2,0,0,1,5,0),Rn(0,3,3,-2,0,3,4,0,0,1,8,0),Rn(0,2,4,-1,0,4,5,0,0,1,10,0),Rn(0,3,5,-1,0,5,8,0,0,1,14,0),Rn(0,3,5,-1,0,6,10,0,0,1,18,0),Rn(0,4,5,-2,0,7,10,1,0,2,16,1),Rn(0,5,5,-3,0,8,10,1,0,3,14,2),Rn(0,5,6,-3,0,9,12,1,0,3,16,2),Rn(0,6,6,-3,0,10,14,1,0,4,18,3),Rn(0,6,7,-4,0,11,15,1,0,4,20,3),Rn(0,7,8,-4,0,12,17,2,0,5,22,4),Rn(0,7,8,-4,0,13,19,2,0,5,24,4),Rn(0,7,9,-4,0,14,21,2,0,5,26,4),Rn(0,8,9,-5,0,15,22,2,0,6,28,5),Rn(0,8,10,-5,0,16,24,2,0,6,30,5),Rn(0,8,11,-5,0,17,26,2,0,6,32,5),Rn(0,9,11,-5,0,18,28,2,0,7,34,6),Rn(0,9,12,-6,0,19,29,2,0,7,36,6),Rn(0,10,13,-6,0,20,31,3,0,8,38,7),Rn(0,10,13,-6,0,21,33,3,0,8,40,7),Rn(0,10,14,-6,0,22,35,3,0,8,42,7),Rn(0,11,14,-7,0,23,36,3,0,9,44,8),Rn(0,11,15,-7,0,24,38,3,0,9,46,8)];var qM=ZM;const WM=["duration","easing","delay"],XM={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},HM={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function l2(t){return`${Math.round(t)}ms`}function KM(t){if(!t)return 0;const o=t/36;return Math.round((4+15*o**.25+o/5)*10)}function YM(t){const o=Ke({},XM,t.easing),c=Ke({},HM,t.duration);return Ke({getAutoHeightDuration:KM,create:(x=["all"],T={})=>{const{duration:k=c.standard,easing:a=o.easeInOut,delay:B=0}=T;return fn(T,WM),(Array.isArray(x)?x:[x]).map(W=>`${W} ${typeof k=="string"?k:l2(k)} ${a} ${typeof B=="string"?B:l2(B)}`).join(",")}},t,{easing:o,duration:c})}const QM={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};var JM=QM;const ez=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function c2(t={},...o){const{mixins:c={},palette:m={},transitions:x={},typography:T={}}=t,k=fn(t,ez),a=OM(m),B=Iy(t);let W=qo(B,{mixins:wM(B.breakpoints,B.spacing,c),palette:a,shadows:qM.slice(),typography:VM(a,T),transitions:YM(x),zIndex:Ke({},JM)});return W=qo(W,k),W=o.reduce((ce,J)=>qo(ce,J),W),W}var u2={exports:{}};(function(t,o){(function(c,m){t.exports=m()})(RS,function(){var c,m,x;function T(a,B){if(!c)c=B;else if(!m)m=B;else{var W="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+c+")(sharedChunk); ("+m+")(sharedChunk); self.onerror = null;",ce={};c(ce),x=B(ce),typeof window!="undefined"&&(x.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}}T(["exports"],function(a){var B="2.5.1",W=ce;function ce(r,e,i,s){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=i,this.p2y=s}ce.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},ce.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},ce.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},ce.prototype.solveCurveX=function(r,e){var i,s,u,p,f;for(e===void 0&&(e=1e-6),u=r,f=0;f<8;f++){if(p=this.sampleCurveX(u)-r,Math.abs(p)<e)return u;var y=this.sampleCurveDerivativeX(u);if(Math.abs(y)<1e-6)break;u-=p/y}if((u=r)<(i=0))return i;if(u>(s=1))return s;for(;i<s;){if(p=this.sampleCurveX(u),Math.abs(p-r)<e)return u;r>p?i=u:s=u,u=.5*(s-i)+i}return u},ce.prototype.solve=function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))};var J=q;function q(r,e){this.x=r,this.y=e}q.prototype={clone:function(){return new q(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,i=r.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),i=Math.sin(r),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(r,e){var i=Math.cos(r),s=Math.sin(r),u=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},q.convert=function(r){return r instanceof q?r:Array.isArray(r)?new q(r[0],r[1]):r};var ve=typeof self!="undefined"?self:{};const Ae=Math.pow(2,53)-1,Se=Math.PI/180,ee=180/Math.PI;function Q(r){return r*Se}const re=[[0,0],[1,0],[1,1],[0,1]];function Te(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,i=e*r;return 4*(r<.5?i:3*(r-e)+i-.75)}function xe(r,e,i,s){const u=new W(r,e,i,s);return function(p){return u.solve(p)}}const Ve=xe(.25,.1,.25,1);function Ie(r,e,i){return Math.min(i,Math.max(e,r))}function $e(r,e,i){const s=i-e,u=((r-e)%s+s)%s+e;return u===e?i:u}function We(r,e,i){if(!r.length)return i(null,[]);let s=r.length;const u=new Array(r.length);let p=null;r.forEach((f,y)=>{e(f,(v,b)=>{v&&(p=v),u[y]=b,--s==0&&i(p,u)})})}function je(r){const e=[];for(const i in r)e.push(r[i]);return e}function ot(r,...e){for(const i of e)for(const s in i)r[s]=i[s];return r}let zt=1;function Rt(){return zt++}function St(){return function r(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function Zt(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Ht(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function qt(r,e){r.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function Wt(r,e){return r.indexOf(e,r.length-e.length)!==-1}function xn(r,e,i){const s={};for(const u in r)s[u]=e.call(i||this,r[u],u,r);return s}function an(r,e,i){const s={};for(const u in r)e.call(i||this,r[u],u,r)&&(s[u]=r[u]);return s}function Ot(r){return Array.isArray(r)?r.map(Ot):typeof r=="object"&&r?xn(r,Ot):r}const He={};function Ye(r){He[r]||(typeof console!="undefined"&&console.warn(r),He[r]=!0)}function ut(r,e,i){return(i.y-r.y)*(e.x-r.x)>(e.y-r.y)*(i.x-r.x)}function Mt(r){let e=0;for(let i,s,u=0,p=r.length,f=p-1;u<p;f=u++)i=r[u],s=r[f],e+=(s.x-i.x)*(i.y+s.y);return e}function Jt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Nn(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,s,u,p)=>{const f=u||p;return e[s]=!f||f.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let kn,_t,Ft,Un=null;function ai(r){if(Un==null){const e=r.navigator?r.navigator.userAgent:null;Un=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Un}function li(r){try{const e=ve[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const Ln={now:()=>Ft!==void 0?Ft:ve.performance.now(),setNow(r){Ft=r},restoreNow(){Ft=void 0},frame(r){const e=ve.requestAnimationFrame(r);return{cancel:()=>ve.cancelAnimationFrame(e)}},getImageData(r,e=0){const i=ve.document.createElement("canvas"),s=i.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return i.width=r.width,i.height=r.height,s.drawImage(r,0,0,r.width,r.height),s.getImageData(-e,-e,r.width+2*e,r.height+2*e)},resolveURL:r=>(kn||(kn=ve.document.createElement("a")),kn.href=r,kn.href),get devicePixelRatio(){return ve.devicePixelRatio},get prefersReducedMotion(){return!!ve.matchMedia&&(_t==null&&(_t=ve.matchMedia("(prefers-reduced-motion: reduce)")),_t.matches)}};let Rr;const At={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(Rr==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Rr={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{Rr=r}}return Rr},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},sr={supported:!1,testSupport:function(r){!In&&dr&&(Gr?pr(r):jr=r)}};let jr,dr,In=!1,Gr=!1;function pr(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,dr),r.isContextLost())return;sr.supported=!0}catch{}r.deleteTexture(e),In=!0}ve.document&&(dr=ve.document.createElement("img"),dr.onload=function(){jr&&pr(jr),jr=null,Gr=!0},dr.onerror=function(){In=!0,jr=null},dr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ci="01",Zr="NO_ACCESS_TOKEN";function Kn(r){return r.indexOf("mapbox:")===0}function Lr(r){return At.API_URL_REGEX.test(r)}const en=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Yn(r){const e=r.match(en);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function ft(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}function fr(r){if(!r)return null;const e=r.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(ve.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class vo{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=fr(At.ACCESS_TOKEN);let s="";return s=i&&i.u?ve.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(u,p)=>String.fromCharCode(Number("0x"+p)))):At.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=li("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const u=ve.localStorage.getItem(i);u&&(this.eventData=JSON.parse(u));const p=ve.localStorage.getItem(s);p&&(this.anonId=p)}catch{Ye("Unable to read from LocalStorage")}}saveEventData(){const e=li("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{ve.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&ve.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Ye("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,s,u){if(!At.EVENTS_URL)return;const p=Yn(At.EVENTS_URL);p.params.push(`access_token=${u||At.ACCESS_TOKEN||""}`);const f={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:B,skuId:ci,userId:this.anonId},y=i?ot(f,i):f,v={url:ft(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=L(v,b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(u)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const Yi=new class extends vo{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){At.EVENTS_URL&&At.ACCESS_TOKEN&&Array.isArray(r)&&r.some(i=>Kn(i)||Lr(i))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=fr(At.ACCESS_TOKEN),i=e?e.u:At.ACCESS_TOKEN;let s=i!==this.eventData.tokenU;Ht(this.anonId)||(this.anonId=St(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),f=new Date(u),y=(u-this.eventData.lastSuccess)/864e5;s=s||y>=1||y<-1||p.getDate()!==f.getDate()}else s=!0;if(!s)return this.processRequests();this.postEvent(u,{"enabled.telemetry":!1},p=>{p||(this.eventData.lastSuccess=u,this.eventData.tokenU=i)},r)}},Ws=Yi.postTurnstileEvent.bind(Yi),Wo=new class extends vo{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,i,s){this.skuToken=e,this.errorCb=s,At.EVENTS_URL&&(i||At.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(Zr)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Ht(this.anonId)||(this.anonId=St()),this.postEvent(i,{skuToken:this.skuToken},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},r))}},Xs=Wo.postMapLoadEvent.bind(Wo),Va=new class extends vo{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,i,s){if(!At.API_URL||!At.SESSION_PATH)return;const u=Yn(At.API_URL+At.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||At.ACCESS_TOKEN||""}`);const p={url:ft(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=j(p,f=>{this.pendingRequest=null,i(f),this.saveEventData(),this.processRequests(s)})}getSessionAPI(r,e,i,s){this.skuToken=e,this.errorCb=s,At.SESSION_PATH&&At.API_URL&&(i||At.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(Zr)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},r)}},Ec=Va.getSessionAPI.bind(Va),wo=new Set,Xo="mapbox-tiles";let qr,Qi,$a=500,Hs=50;function Ji(){ve.caches&&!qr&&(qr=ve.caches.open(Xo))}function bo(r){const e=r.indexOf("?");return e<0?r:r.slice(0,e)}let To=1/0;const So={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(So);class Ho extends Error{constructor(e,i,s){i===401&&Lr(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Si=Jt()?()=>self.worker&&self.worker.referrer:()=>(ve.location.protocol==="blob:"?ve.parent:ve).location.href,$=function(r,e){if(!(/^file:/.test(i=r.url)||/^file:/.test(Si())&&!/^\w+:/.test(i))){if(ve.fetch&&ve.Request&&ve.AbortController&&ve.Request.prototype.hasOwnProperty("signal"))return function(s,u){const p=new ve.AbortController,f=new ve.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Si(),signal:p.signal});let y=!1,v=!1;const b=(E=f.url).indexOf("sku=")>0&&Lr(E);var E;s.type==="json"&&f.headers.set("Accept","application/json");const I=(P,N,U)=>{if(v)return;if(P&&P.message!=="SecurityError"&&Ye(P),N&&U)return A(N);const K=Date.now();ve.fetch(f).then(ie=>{if(ie.ok){const he=b?ie.clone():null;return A(ie,he,K)}return u(new Ho(ie.statusText,ie.status,s.url))}).catch(ie=>{ie.code!==20&&u(new Error(ie.message))})},A=(P,N,U)=>{(s.type==="arrayBuffer"?P.arrayBuffer():s.type==="json"?P.json():P.text()).then(K=>{v||(N&&U&&function(ie,he,_e){if(Ji(),!qr)return;const ye={status:he.status,statusText:he.statusText,headers:new ve.Headers};he.headers.forEach((be,Me)=>ye.headers.set(Me,be));const we=Nn(he.headers.get("Cache-Control")||"");we["no-store"]||(we["max-age"]&&ye.headers.set("Expires",new Date(_e+1e3*we["max-age"]).toUTCString()),new Date(ye.headers.get("Expires")).getTime()-_e<42e4||function(be,Me){if(Qi===void 0)try{new Response(new ReadableStream),Qi=!0}catch{Qi=!1}Qi?Me(be.body):be.blob().then(Me)}(he,be=>{const Me=new ve.Response(be,ye);Ji(),qr&&qr.then(Fe=>Fe.put(bo(ie.url),Me)).catch(Fe=>Ye(Fe.message))}))}(f,N,U),y=!0,u(null,K,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(K=>{v||u(new Error(K.message))})};return b?function(P,N){if(Ji(),!qr)return N(null);const U=bo(P.url);qr.then(K=>{K.match(U).then(ie=>{const he=function(_e){if(!_e)return!1;const ye=new Date(_e.headers.get("Expires")||0),we=Nn(_e.headers.get("Cache-Control")||"");return ye>Date.now()&&!we["no-cache"]}(ie);K.delete(U),he&&K.put(U,ie.clone()),N(null,ie,he)}).catch(N)}).catch(N)}(f,I):I(null,null),{cancel:()=>{v=!0,y||p.abort()}}}(r,e);if(Jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var i;return function(s,u){const p=new ve.XMLHttpRequest;p.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const f in s.headers)p.setRequestHeader(f,s.headers[f]);return s.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=s.credentials==="include",p.onerror=()=>{u(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let f=p.response;if(s.type==="json")try{f=JSON.parse(p.response)}catch(y){return u(y)}u(null,f,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else u(new Ho(p.statusText,p.status,s.url))},p.send(s.body),{cancel:()=>p.abort()}}(r,e)},D=function(r,e){return $(ot(r,{type:"arrayBuffer"}),e)},L=function(r,e){return $(ot(r,{method:"POST"}),e)},j=function(r,e){return $(ot(r,{method:"GET"}),e)};function H(r){const e=ve.document.createElement("a");return e.href=r,e.protocol===ve.document.location.protocol&&e.host===ve.document.location.host}const oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fe,me;fe=[],me=0;const le=function(r,e){if(sr.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),me>=At.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return fe.push(p),p}me++;let i=!1;const s=()=>{if(!i)for(i=!0,me--;fe.length&&me<At.MAX_PARALLEL_IMAGE_REQUESTS;){const p=fe.shift(),{requestParameters:f,callback:y,cancelled:v}=p;v||(p.cancel=le(f,y).cancel)}},u=D(r,(p,f,y,v)=>{s(),p?e(p):f&&(ve.createImageBitmap?function(b,E){const I=new ve.Blob([new Uint8Array(b)],{type:"image/png"});ve.createImageBitmap(I).then(A=>{E(null,A)}).catch(A=>{E(new Error(`Could not load image because of ${A.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(f,(b,E)=>e(b,E,y,v)):function(b,E){const I=new ve.Image,A=ve.URL;I.onload=()=>{E(null,I),A.revokeObjectURL(I.src),I.onload=null,ve.requestAnimationFrame(()=>{I.src=oe})},I.onerror=()=>E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const P=new ve.Blob([new Uint8Array(b)],{type:"image/png"});I.src=b.byteLength?A.createObjectURL(P):oe}(f,(b,E)=>e(b,E,y,v)))});return{cancel:()=>{u.cancel(),s()}}};function ge(r,e,i){i[r]&&i[r].indexOf(e)!==-1||(i[r]=i[r]||[],i[r].push(e))}function ze(r,e,i){if(i&&i[r]){const s=i[r].indexOf(e);s!==-1&&i[r].splice(s,1)}}class Ze{constructor(e,i={}){ot(this,i),this.type=e}}class Le extends Ze{constructor(e,i={}){super("error",ot({error:e},i))}}class st{on(e,i){return this._listeners=this._listeners||{},ge(e,i,this._listeners),this}off(e,i){return ze(e,i,this._listeners),ze(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},ge(e,i,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,i){typeof e=="string"&&(e=new Ze(e,i||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const y of u)y.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const y of p)ze(s,y,this._oneTimeListeners),y.call(this,e);const f=this._eventedParent;f&&(ot(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),f.fire(e))}else e instanceof Le&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Ce{constructor(e,i,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}function dt(r){const e=r.value;return e?[new Ce(r.key,e,"constants have been deprecated as of v8")]:[]}function vt(r,...e){for(const i of e)for(const s in i)r[s]=i[s];return r}function yt(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Nt(r){if(Array.isArray(r))return r.map(Nt);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const i in r)e[i]=Nt(r[i]);return e}return yt(r)}class Pt extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class ln{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[s,u]of i)this.bindings[s]=u}concat(e){return new ln(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Fi={kind:"null"},Xe={kind:"number"},Et={kind:"string"},wt={kind:"boolean"},ui={kind:"color"},Qn={kind:"object"},Ct={kind:"value"},ja={kind:"collator"},Ks={kind:"formatted"},Ko={kind:"resolvedImage"};function Br(r,e){return{kind:"array",itemType:r,N:e}}function mn(r){if(r.kind==="array"){const e=mn(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Gh=[Fi,Xe,Et,wt,ui,Ks,Qn,Br(Ct),Ko];function Yo(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Yo(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const i of Gh)if(!Yo(i,e))return null}}return`Expected ${mn(r)} but found ${mn(e)} instead.`}function Qo(r,e){return e.some(i=>i.kind===r.kind)}function Ys(r,e){return e.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}function Oi(r){var e={exports:{}};return r(e,e.exports),e.exports}var Cc=Oi(function(r,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(y){return(y=Math.round(y))<0?0:y>255?255:y}function u(y){return s(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function p(y){return(v=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:v>1?1:v;var v}function f(y,v,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?y+(v-y)*b*6:2*b<1?v:3*b<2?y+(v-y)*(2/3-b)*6:y}try{e.parseCSSColor=function(y){var v,b=y.replace(/ /g,"").toLowerCase();if(b in i)return i[b].slice();if(b[0]==="#")return b.length===4?(v=parseInt(b.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:b.length===7&&(v=parseInt(b.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var E=b.indexOf("("),I=b.indexOf(")");if(E!==-1&&I+1===b.length){var A=b.substr(0,E),P=b.substr(E+1,I-(E+1)).split(","),N=1;switch(A){case"rgba":if(P.length!==4)return null;N=p(P.pop());case"rgb":return P.length!==3?null:[u(P[0]),u(P[1]),u(P[2]),N];case"hsla":if(P.length!==4)return null;N=p(P.pop());case"hsl":if(P.length!==3)return null;var U=(parseFloat(P[0])%360+360)%360/360,K=p(P[1]),ie=p(P[2]),he=ie<=.5?ie*(K+1):ie+K-ie*K,_e=2*ie-he;return[s(255*f(_e,he,U+1/3)),s(255*f(_e,he,U)),s(255*f(_e,he,U-1/3)),N];default:return null}}return null}}catch{}});class bt{constructor(e,i,s,u=1){this.r=e,this.g=i,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof bt)return e;if(typeof e!="string")return;const i=Cc.parseCSSColor(e);return i?new bt(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,s,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(s)},${u})`}toArray(){const{r:e,g:i,b:s,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*i/u,255*s/u,u]}}bt.black=new bt(0,0,0,1),bt.white=new bt(1,1,1,1),bt.transparent=new bt(0,0,0,0),bt.red=new bt(1,0,0,1),bt.blue=new bt(0,0,1,1);class kc{constructor(e,i,s){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ga{constructor(e,i,s,u,p){this.text=e,this.image=i,this.scale=s,this.fontStack=u,this.textColor=p}}class Zn{constructor(e){this.sections=e}static fromString(e){return new Zn([new Ga(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Zn?e:Zn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const s={};i.fontStack&&(s["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(s["font-scale"]=i.scale),i.textColor&&(s["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(s)}return e}}class Fr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Fr({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Zh(r,e,i,s){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,e,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,e,i,s]:[r,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Za(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof bt||r instanceof kc||r instanceof Zn||r instanceof Fr)return!0;if(Array.isArray(r)){for(const e of r)if(!Za(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Za(r[e]))return!1;return!0}return!1}function Vn(r){if(r===null)return Fi;if(typeof r=="string")return Et;if(typeof r=="boolean")return wt;if(typeof r=="number")return Xe;if(r instanceof bt)return ui;if(r instanceof kc)return ja;if(r instanceof Zn)return Ks;if(r instanceof Fr)return Ko;if(Array.isArray(r)){const e=r.length;let i;for(const s of r){const u=Vn(s);if(i){if(i===u)continue;i=Ct;break}i=u}return Br(i||Ct,e)}return Qn}function Jo(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof bt||r instanceof Zn||r instanceof Fr?r.toString():JSON.stringify(r)}class Ni{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Za(e[1]))return i.error("invalid value");const s=e[1];let u=Vn(s);const p=i.expectedType;return u.kind!=="array"||u.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(u=p),new Ni(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof bt?["rgba"].concat(this.value.toArray()):this.value instanceof Zn?this.value.serialize():this.value}}class Jn{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const es={string:Et,number:Xe,boolean:wt,object:Qn};class hi{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let s,u=1;const p=e[0];if(p==="array"){let y,v;if(e.length>2){const b=e[1];if(typeof b!="string"||!(b in es)||b==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);y=es[b],u++}else y=Ct;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);v=e[2],u++}s=Br(y,v)}else s=es[p];const f=[];for(;u<e.length;u++){const y=i.parse(e[u],u,Ct);if(!y)return null;f.push(y)}return new hi(s,f)}evaluate(e){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(e);if(!Yo(this.type,Vn(s)))return s;if(i===this.args.length-1)throw new Jn(`Expected value to be of type ${mn(this.type)}, but found ${mn(Vn(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const s=e.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){i.push(s.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&i.push(u)}}return i.concat(this.args.map(s=>s.serialize()))}}class Qs{constructor(e){this.type=Ks,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&typeof s=="object")return i.error("First argument must be an image or text section.");const u=[];let p=!1;for(let f=1;f<=e.length-1;++f){const y=e[f];if(p&&typeof y=="object"&&!Array.isArray(y)){p=!1;let v=null;if(y["font-scale"]&&(v=i.parse(y["font-scale"],1,Xe),!v))return null;let b=null;if(y["text-font"]&&(b=i.parse(y["text-font"],1,Br(Et)),!b))return null;let E=null;if(y["text-color"]&&(E=i.parse(y["text-color"],1,ui),!E))return null;const I=u[u.length-1];I.scale=v,I.font=b,I.textColor=E}else{const v=i.parse(e[f],1,Ct);if(!v)return null;const b=v.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new Qs(u)}evaluate(e){return new Zn(this.sections.map(i=>{const s=i.content.evaluate(e);return Vn(s)===Ko?new Ga("",s,null,null,null):new Ga(Jo(s),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const s={};i.scale&&(s["font-scale"]=i.scale.serialize()),i.font&&(s["text-font"]=i.font.serialize()),i.textColor&&(s["text-color"]=i.textColor.serialize()),e.push(s)}return e}}class qa{constructor(e){this.type=Ko,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Et);return s?new qa(s):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),s=Fr.fromString(i);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(i)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Uf={"to-boolean":wt,"to-color":ui,"to-number":Xe,"to-string":Et};class eo{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[0];if((s==="to-boolean"||s==="to-string")&&e.length!==2)return i.error("Expected one argument.");const u=Uf[s],p=[];for(let f=1;f<e.length;f++){const y=i.parse(e[f],f,Ct);if(!y)return null;p.push(y)}return new eo(u,p)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let i,s;for(const u of this.args){if(i=u.evaluate(e),s=null,i instanceof bt)return i;if(typeof i=="string"){const p=e.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Zh(i[0],i[1],i[2],i[3]),!s))return new bt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Jn(s||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const s of this.args){if(i=s.evaluate(e),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Jn(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Zn.fromString(Jo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Fr.fromString(Jo(this.args[0].evaluate(e))):Jo(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new qa(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Vf=["Unknown","Point","LineString","Polygon"];class qh{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Vf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=bt.parse(e)),i}}class Or{constructor(e,i,s,u){this.name=e,this.type=i,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const s=e[0],u=Or.definitions[s];if(!u)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(u)?u[0]:u.type,f=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=f.filter(([b])=>!Array.isArray(b)||b.length===e.length-1);let v=null;for(const[b,E]of y){v=new Ha(i.registry,i.path,null,i.scope);const I=[];let A=!1;for(let P=1;P<e.length;P++){const N=e[P],U=Array.isArray(b)?b[P-1]:b.type,K=v.parse(N,1+I.length,U);if(!K){A=!0;break}I.push(K)}if(!A)if(Array.isArray(b)&&b.length!==I.length)v.error(`Expected ${b.length} arguments, but found ${I.length} instead.`);else{for(let P=0;P<I.length;P++){const N=Array.isArray(b)?b[P]:b.type,U=I[P];v.concat(P+1).checkSubtype(N,U.type)}if(v.errors.length===0)return new Or(s,p,E,I)}}if(y.length===1)i.errors.push(...v.errors);else{const b=(y.length?y:f).map(([I])=>{return A=I,Array.isArray(A)?`(${A.map(mn).join(", ")})`:`(${mn(A.type)}...)`;var A}).join(" | "),E=[];for(let I=1;I<e.length;I++){const A=i.parse(e[I],1+E.length);if(!A)return null;E.push(mn(A.type))}i.error(`Expected arguments of type ${b}, but found (${E.join(", ")}) instead.`)}return null}static register(e,i){Or.definitions=i;for(const s in i)e[s]=Or}}class Eo{constructor(e,i,s){this.type=ja,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const s=e[1];if(typeof s!="object"||Array.isArray(s))return i.error("Collator options argument must be an object.");const u=i.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,wt);if(!u)return null;const p=i.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,wt);if(!p)return null;let f=null;return s.locale&&(f=i.parse(s.locale,1,Et),!f)?null:new Eo(u,p,f)}evaluate(e){return new kc(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const to=8192;function Ic(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Wa(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function $f(r,e){const i=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*to),Math.round(s*u*to)]}function jf(r,e,i){const s=r[0]-e[0],u=r[1]-e[1],p=r[0]-i[0],f=r[1]-i[1];return s*f-p*u==0&&s*p<=0&&u*f<=0}function Ac(r,e){let i=!1;for(let f=0,y=e.length;f<y;f++){const v=e[f];for(let b=0,E=v.length;b<E-1;b++){if(jf(r,v[b],v[b+1]))return!1;(u=v[b])[1]>(s=r)[1]!=(p=v[b+1])[1]>s[1]&&s[0]<(p[0]-u[0])*(s[1]-u[1])/(p[1]-u[1])+u[0]&&(i=!i)}}var s,u,p;return i}function Wh(r,e){for(let i=0;i<e.length;i++)if(Ac(r,e[i]))return!0;return!1}function Js(r,e,i,s){const u=s[0]-i[0],p=s[1]-i[1],f=(r[0]-i[0])*p-u*(r[1]-i[1]),y=(e[0]-i[0])*p-u*(e[1]-i[1]);return f>0&&y<0||f<0&&y>0}function Gf(r,e,i){for(const b of i)for(let E=0;E<b.length-1;++E)if((y=[(f=b[E+1])[0]-(p=b[E])[0],f[1]-p[1]])[0]*(v=[(u=e)[0]-(s=r)[0],u[1]-s[1]])[1]-y[1]*v[0]!=0&&Js(s,u,p,f)&&Js(p,f,s,u))return!0;var s,u,p,f,y,v;return!1}function Xh(r,e){for(let i=0;i<r.length;++i)if(!Ac(r[i],e))return!1;for(let i=0;i<r.length-1;++i)if(Gf(r[i],r[i+1],e))return!1;return!0}function Zf(r,e){for(let i=0;i<e.length;i++)if(Xh(r,e[i]))return!0;return!1}function Mc(r,e,i){const s=[];for(let u=0;u<r.length;u++){const p=[];for(let f=0;f<r[u].length;f++){const y=$f(r[u][f],i);Ic(e,y),p.push(y)}s.push(p)}return s}function di(r,e,i){const s=[];for(let u=0;u<r.length;u++){const p=Mc(r[u],e,i);s.push(p)}return s}function zc(r,e,i,s){if(r[0]<i[0]||r[0]>i[2]){const u=.5*s;let p=r[0]-i[0]>u?-s:i[0]-r[0]>u?s:0;p===0&&(p=r[0]-i[2]>u?-s:i[2]-r[0]>u?s:0),r[0]+=p}Ic(e,r)}function Pc(r,e,i,s){const u=Math.pow(2,s.z)*to,p=[s.x*to,s.y*to],f=[];for(const y of r)for(const v of y){const b=[v.x+p[0],v.y+p[1]];zc(b,e,i,u),f.push(b)}return f}function ea(r,e,i,s){const u=Math.pow(2,s.z)*to,p=[s.x*to,s.y*to],f=[];for(const v of r){const b=[];for(const E of v){const I=[E.x+p[0],E.y+p[1]];Ic(e,I),b.push(I)}f.push(b)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const v of f)for(const b of v)zc(b,e,i,u)}var y;return f}class pi{constructor(e,i){this.type=wt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Za(e[1])){const s=e[1];if(s.type==="FeatureCollection")for(let u=0;u<s.features.length;++u){const p=s.features[u].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new pi(s,s.features[u].geometry)}else if(s.type==="Feature"){const u=s.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new pi(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new pi(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,s){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],f=i.canonicalID();if(s.type==="Polygon"){const y=Mc(s.coordinates,p,f),v=Pc(i.geometry(),u,p,f);if(!Wa(u,p))return!1;for(const b of v)if(!Ac(b,y))return!1}if(s.type==="MultiPolygon"){const y=di(s.coordinates,p,f),v=Pc(i.geometry(),u,p,f);if(!Wa(u,p))return!1;for(const b of v)if(!Wh(b,y))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,s){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],f=i.canonicalID();if(s.type==="Polygon"){const y=Mc(s.coordinates,p,f),v=ea(i.geometry(),u,p,f);if(!Wa(u,p))return!1;for(const b of v)if(!Xh(b,y))return!1}if(s.type==="MultiPolygon"){const y=di(s.coordinates,p,f),v=ea(i.geometry(),u,p,f);if(!Wa(u,p))return!1;for(const b of v)if(!Zf(b,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function ta(r){if(r instanceof Or&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof pi)return!1;let e=!0;return r.eachChild(i=>{e&&!ta(i)&&(e=!1)}),e}function ts(r){if(r instanceof Or&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(i=>{e&&!ts(i)&&(e=!1)}),e}function Xa(r,e){if(r instanceof Or&&e.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(s=>{i&&!Xa(s,e)&&(i=!1)}),i}class Lt{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const s=e[1];return i.scope.has(s)?new Lt(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ha{constructor(e,i=[],s,u=new ln,p=[]){this.registry=e,this.path=i,this.key=i.map(f=>`[${f}]`).join(""),this.scope=u,this.errors=p,this.expectedType=s}parse(e,i,s,u,p={}){return i?this.concat(i,s,u)._parse(e,p):this._parse(e,p)}_parse(e,i){function s(u,p,f){return f==="assert"?new hi(p,[u]):f==="coerce"?new eo(p,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[u];if(p){let f=p.parse(e,this);if(!f)return null;if(this.expectedType){const y=this.expectedType,v=f.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||v.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||v.kind!=="value"&&v.kind!=="string"){if(this.checkSubtype(y,v))return null}else f=s(f,y,i.typeAnnotation||"coerce");else f=s(f,y,i.typeAnnotation||"assert")}if(!(f instanceof Ni)&&f.type.kind!=="resolvedImage"&&Dc(f)){const y=new qh;try{f=new Ni(f.type,f.evaluate(y))}catch(v){return this.error(v.message),null}}return f}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,s){const u=typeof e=="number"?this.path.concat(e):this.path,p=s?this.scope.concat(s):this.scope;return new Ha(this.registry,u,i||null,p,this.errors)}error(e,...i){const s=`${this.key}${i.map(u=>`[${u}]`).join("")}`;this.errors.push(new Pt(s,e))}checkSubtype(e,i){const s=Yo(e,i);return s&&this.error(s),s}}function Dc(r){if(r instanceof Lt)return Dc(r.boundExpression);if(r instanceof Or&&r.name==="error"||r instanceof Eo||r instanceof pi)return!1;const e=r instanceof eo||r instanceof hi;let i=!0;return r.eachChild(s=>{i=e?i&&Dc(s):i&&s instanceof Ni}),!!i&&ta(r)&&Xa(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function Ka(r,e){const i=r.length-1;let s,u,p=0,f=i,y=0;for(;p<=f;)if(y=Math.floor((p+f)/2),s=r[y],u=r[y+1],s<=e){if(y===i||e<u)return y;p=y+1}else{if(!(s>e))throw new Jn("Input is not a number.");f=y-1}return 0}class ns{constructor(e,i,s){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,p]of s)this.labels.push(u),this.outputs.push(p)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(e[1],1,Xe);if(!s)return null;const u=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let f=1;f<e.length;f+=2){const y=f===1?-1/0:e[f],v=e[f+1],b=f,E=f+1;if(typeof y!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(u.length&&u[u.length-1][0]>=y)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const I=i.parse(v,E,p);if(!I)return null;p=p||I.type,u.push([y,I])}return new ns(p,s,u)}evaluate(e){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return s[0].evaluate(e);const p=i.length;return u>=i[p-1]?s[p-1].evaluate(e):s[Ka(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}function Ut(r,e,i){return r*(1-i)+e*i}var na=Object.freeze({__proto__:null,number:Ut,color:function(r,e,i){return new bt(Ut(r.r,e.r,i),Ut(r.g,e.g,i),Ut(r.b,e.b,i),Ut(r.a,e.a,i))},array:function(r,e,i){return r.map((s,u)=>Ut(s,e[u],i))}});const Rc=.95047,Ya=1.08883,Lc=4/29,Bc=6/29,Qa=3*Bc*Bc,Hh=Math.PI/180,qf=180/Math.PI;function Ja(r){return r>.008856451679035631?Math.pow(r,1/3):r/Qa+Lc}function Fc(r){return r>Bc?r*r*r:Qa*(r-Lc)}function el(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function tl(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Oc(r){const e=tl(r.r),i=tl(r.g),s=tl(r.b),u=Ja((.4124564*e+.3575761*i+.1804375*s)/Rc),p=Ja((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*p-16,a:500*(u-p),b:200*(p-Ja((.0193339*e+.119192*i+.9503041*s)/Ya)),alpha:r.a}}function Nc(r){let e=(r.l+16)/116,i=isNaN(r.a)?e:e+r.a/500,s=isNaN(r.b)?e:e-r.b/200;return e=1*Fc(e),i=Rc*Fc(i),s=Ya*Fc(s),new bt(el(3.2404542*i-1.5371385*e-.4985314*s),el(-.969266*i+1.8760108*e+.041556*s),el(.0556434*i-.2040259*e+1.0572252*s),r.alpha)}function Wf(r,e,i){const s=e-r;return r+i*(s>180||s<-180?s-360*Math.round(s/360):s)}const rs={forward:Oc,reverse:Nc,interpolate:function(r,e,i){return{l:Ut(r.l,e.l,i),a:Ut(r.a,e.a,i),b:Ut(r.b,e.b,i),alpha:Ut(r.alpha,e.alpha,i)}}},is={forward:function(r){const{l:e,a:i,b:s}=Oc(r),u=Math.atan2(s,i)*qf;return{h:u<0?u+360:u,c:Math.sqrt(i*i+s*s),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Hh,i=r.c;return Nc({l:r.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:r.alpha})},interpolate:function(r,e,i){return{h:Wf(r.h,e.h,i),c:Ut(r.c,e.c,i),l:Ut(r.l,e.l,i),alpha:Ut(r.alpha,e.alpha,i)}}};var Kh=Object.freeze({__proto__:null,lab:rs,hcl:is});class Nr{constructor(e,i,s,u,p){this.type=e,this.operator=i,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[f,y]of p)this.labels.push(f),this.outputs.push(y)}static interpolationFactor(e,i,s,u){let p=0;if(e.name==="exponential")p=Uc(i,e.base,s,u);else if(e.name==="linear")p=Uc(i,1,s,u);else if(e.name==="cubic-bezier"){const f=e.controlPoints;p=new W(f[0],f[1],f[2],f[3]).solve(Uc(i,1,s,u))}return p}static parse(e,i){let[s,u,p,...f]=e;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const b=u[1];if(typeof b!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:b}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const b=u.slice(1);if(b.length!==4||b.some(E=>typeof E!="number"||E<0||E>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:b}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,Xe),!p)return null;const y=[];let v=null;s==="interpolate-hcl"||s==="interpolate-lab"?v=ui:i.expectedType&&i.expectedType.kind!=="value"&&(v=i.expectedType);for(let b=0;b<f.length;b+=2){const E=f[b],I=f[b+1],A=b+3,P=b+4;if(typeof E!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(y.length&&y[y.length-1][0]>=E)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',A);const N=i.parse(I,P,v);if(!N)return null;v=v||N.type,y.push([E,N])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new Nr(v,s,u,p,y):i.error(`Type ${mn(v)} is not interpolatable.`)}evaluate(e){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return s[0].evaluate(e);const p=i.length;if(u>=i[p-1])return s[p-1].evaluate(e);const f=Ka(i,u),y=Nr.interpolationFactor(this.interpolation,u,i[f],i[f+1]),v=s[f].evaluate(e),b=s[f+1].evaluate(e);return this.operator==="interpolate"?na[this.type.kind.toLowerCase()](v,b,y):this.operator==="interpolate-hcl"?is.reverse(is.interpolate(is.forward(v),is.forward(b),y)):rs.reverse(rs.interpolate(rs.forward(v),rs.forward(b),y))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)i.push(this.labels[s],this.outputs[s].serialize());return i}}function Uc(r,e,i,s){const u=s-i,p=r-i;return u===0?0:e===1?p/u:(Math.pow(e,p)-1)/(Math.pow(e,u)-1)}class nl{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let s=null;const u=i.expectedType;u&&u.kind!=="value"&&(s=u);const p=[];for(const y of e.slice(1)){const v=i.parse(y,1+p.length,s,void 0,{typeAnnotation:"omit"});if(!v)return null;s=s||v.type,p.push(v)}const f=u&&p.some(y=>Yo(u,y.type));return new nl(f?Ct:s,p)}evaluate(e){let i,s=null,u=0;for(const p of this.args)if(u++,s=p.evaluate(e),s&&s instanceof Fr&&!s.available&&(i||(i=s.name),s=null,u===this.args.length&&(s=i)),s!==null)break;return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class rl{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let p=1;p<e.length-1;p+=2){const f=e[p];if(typeof f!="string")return i.error(`Expected string, but found ${typeof f} instead.`,p);if(/[^a-zA-Z0-9_]/.test(f))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const y=i.parse(e[p+1],p+1);if(!y)return null;s.push([f,y])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,s);return u?new rl(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,s]of this.bindings)e.push(i,s.serialize());return e.push(this.result.serialize()),e}}class il{constructor(e,i,s){this.type=e,this.index=i,this.input=s}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Xe),u=i.parse(e[2],2,Br(i.expectedType||Ct));return s&&u?new il(u.type.itemType,s,u):null}evaluate(e){const i=this.index.evaluate(e),s=this.input.evaluate(e);if(i<0)throw new Jn(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new Jn(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new Jn(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Vc{constructor(e,i){this.type=wt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Ct),u=i.parse(e[2],2,Ct);return s&&u?Qo(s.type,[wt,Et,Xe,Fi,Ct])?new Vc(s,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${mn(s.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!Ys(i,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${mn(Vn(i))} instead.`);if(!Ys(s,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${mn(Vn(s))} instead.`);return s.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ol{constructor(e,i,s){this.type=Xe,this.needle=e,this.haystack=i,this.fromIndex=s}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Ct),u=i.parse(e[2],2,Ct);if(!s||!u)return null;if(!Qo(s.type,[wt,Et,Xe,Fi,Ct]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${mn(s.type)} instead`);if(e.length===4){const p=i.parse(e[3],3,Xe);return p?new ol(s,u,p):null}return new ol(s,u)}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!Ys(i,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${mn(Vn(i))} instead.`);if(!Ys(s,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${mn(Vn(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return s.indexOf(i,u)}return s.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class $c{constructor(e,i,s,u,p,f){this.inputType=e,this.type=i,this.input=s,this.cases=u,this.outputs=p,this.otherwise=f}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let s,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const p={},f=[];for(let b=2;b<e.length-1;b+=2){let E=e[b];const I=e[b+1];Array.isArray(E)||(E=[E]);const A=i.concat(b);if(E.length===0)return A.error("Expected at least one branch label.");for(const N of E){if(typeof N!="number"&&typeof N!="string")return A.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return A.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return A.error("Numeric branch labels must be integer values.");if(s){if(A.checkSubtype(s,Vn(N)))return null}else s=Vn(N);if(p[String(N)]!==void 0)return A.error("Branch labels must be unique.");p[String(N)]=f.length}const P=i.parse(I,b,u);if(!P)return null;u=u||P.type,f.push(P)}const y=i.parse(e[1],1,Ct);if(!y)return null;const v=i.parse(e[e.length-1],e.length-1,u);return v?y.type.kind!=="value"&&i.concat(1).checkSubtype(s,y.type)?null:new $c(s,u,y,p,f,v):null}evaluate(e){const i=this.input.evaluate(e);return(Vn(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),s=[],u={};for(const f of i){const y=u[this.cases[f]];y===void 0?(u[this.cases[f]]=s.length,s.push([this.cases[f],[f]])):s[y][1].push(f)}const p=f=>this.inputType.kind==="number"?Number(f):f;for(const[f,y]of s)e.push(y.length===1?p(y[0]):y.map(p)),e.push(this.outputs[f].serialize());return e.push(this.otherwise.serialize()),e}}class sl{constructor(e,i,s){this.type=e,this.branches=i,this.otherwise=s}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&i.expectedType.kind!=="value"&&(s=i.expectedType);const u=[];for(let f=1;f<e.length-1;f+=2){const y=i.parse(e[f],f,wt);if(!y)return null;const v=i.parse(e[f+1],f+1,s);if(!v)return null;u.push([y,v]),s=s||v.type}const p=i.parse(e[e.length-1],e.length-1,s);return p?new sl(s,u,p):null}evaluate(e){for(const[i,s]of this.branches)if(i.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,s]of this.branches)e(i),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class ra{constructor(e,i,s,u){this.type=e,this.input=i,this.beginIndex=s,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Ct),u=i.parse(e[2],2,Xe);if(!s||!u)return null;if(!Qo(s.type,[Br(Ct),Et,Ct]))return i.error(`Expected first argument to be of type array or string, but found ${mn(s.type)} instead`);if(e.length===4){const p=i.parse(e[3],3,Xe);return p?new ra(s.type,s,u,p):null}return new ra(s.type,s,u)}evaluate(e){const i=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!Ys(i,["string","array"]))throw new Jn(`Expected first argument to be of type array or string, but found ${mn(Vn(i))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return i.slice(s,u)}return i.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Yh(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function jc(r,e,i,s){return s.compare(e,i)===0}function os(r,e,i){const s=r!=="=="&&r!=="!=";return class h2{constructor(p,f,y){this.type=wt,this.lhs=p,this.rhs=f,this.collator=y,this.hasUntypedArgument=p.type.kind==="value"||f.type.kind==="value"}static parse(p,f){if(p.length!==3&&p.length!==4)return f.error("Expected two or three arguments.");const y=p[0];let v=f.parse(p[1],1,Ct);if(!v)return null;if(!Yh(y,v.type))return f.concat(1).error(`"${y}" comparisons are not supported for type '${mn(v.type)}'.`);let b=f.parse(p[2],2,Ct);if(!b)return null;if(!Yh(y,b.type))return f.concat(2).error(`"${y}" comparisons are not supported for type '${mn(b.type)}'.`);if(v.type.kind!==b.type.kind&&v.type.kind!=="value"&&b.type.kind!=="value")return f.error(`Cannot compare types '${mn(v.type)}' and '${mn(b.type)}'.`);s&&(v.type.kind==="value"&&b.type.kind!=="value"?v=new hi(b.type,[v]):v.type.kind!=="value"&&b.type.kind==="value"&&(b=new hi(v.type,[b])));let E=null;if(p.length===4){if(v.type.kind!=="string"&&b.type.kind!=="string"&&v.type.kind!=="value"&&b.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(E=f.parse(p[3],3,ja),!E)return null}return new h2(v,b,E)}evaluate(p){const f=this.lhs.evaluate(p),y=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){const v=Vn(f),b=Vn(y);if(v.kind!==b.kind||v.kind!=="string"&&v.kind!=="number")throw new Jn(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${v.kind}, ${b.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const v=Vn(f),b=Vn(y);if(v.kind!=="string"||b.kind!=="string")return e(p,f,y)}return this.collator?i(p,f,y,this.collator.evaluate(p)):e(p,f,y)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[r];return this.eachChild(f=>{p.push(f.serialize())}),p}}}const Xf=os("==",function(r,e,i){return e===i},jc),Qh=os("!=",function(r,e,i){return e!==i},function(r,e,i,s){return!jc(0,e,i,s)}),Jh=os("<",function(r,e,i){return e<i},function(r,e,i,s){return s.compare(e,i)<0}),Hf=os(">",function(r,e,i){return e>i},function(r,e,i,s){return s.compare(e,i)>0}),Kf=os("<=",function(r,e,i){return e<=i},function(r,e,i,s){return s.compare(e,i)<=0}),Yf=os(">=",function(r,e,i){return e>=i},function(r,e,i,s){return s.compare(e,i)>=0});class Gc{constructor(e,i,s,u,p){this.type=Et,this.number=e,this.locale=i,this.currency=s,this.minFractionDigits=u,this.maxFractionDigits=p}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Xe);if(!s)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let p=null;if(u.locale&&(p=i.parse(u.locale,1,Et),!p))return null;let f=null;if(u.currency&&(f=i.parse(u.currency,1,Et),!f))return null;let y=null;if(u["min-fraction-digits"]&&(y=i.parse(u["min-fraction-digits"],1,Xe),!y))return null;let v=null;return u["max-fraction-digits"]&&(v=i.parse(u["max-fraction-digits"],1,Xe),!v)?null:new Gc(s,p,f,y,v)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class ss{constructor(e){this.type=Xe,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=i.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${mn(s.type)} instead.`):new ss(s):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Jn(`Expected value to be of type string or array, but found ${mn(Vn(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Co={"==":Xf,"!=":Qh,">":Hf,"<":Jh,">=":Yf,"<=":Kf,array:hi,at:il,boolean:hi,case:sl,coalesce:nl,collator:Eo,format:Qs,image:qa,in:Vc,"index-of":ol,interpolate:Nr,"interpolate-hcl":Nr,"interpolate-lab":Nr,length:ss,let:rl,literal:Ni,match:$c,number:hi,"number-format":Gc,object:hi,slice:ra,step:ns,string:hi,"to-boolean":eo,"to-color":eo,"to-number":eo,"to-string":eo,var:Lt,within:pi};function Zc(r,[e,i,s,u]){e=e.evaluate(r),i=i.evaluate(r),s=s.evaluate(r);const p=u?u.evaluate(r):1,f=Zh(e,i,s,p);if(f)throw new Jn(f);return new bt(e/255*p,i/255*p,s/255*p,p)}function ed(r,e){return r in e}function qc(r,e){const i=e[r];return i===void 0?null:i}function ko(r){return{type:r}}function Wc(r){return{result:"success",value:r}}function Io(r){return{result:"error",value:r}}function Ao(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function al(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Xc(r){return!!r.expression&&r.expression.interpolated}function Vt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function ll(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Qf(r){return r}function td(r,e){const i=e.type==="color",s=r.stops&&typeof r.stops[0][0]=="object",u=s||!(s||r.property!==void 0),p=r.type||(Xc(e)?"exponential":"interval");if(i&&((r=vt({},r)).stops&&(r.stops=r.stops.map(b=>[b[0],bt.parse(b[1])])),r.default=bt.parse(r.default?r.default:e.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!Kh[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let f,y,v;if(p==="exponential")f=oa;else if(p==="interval")f=rd;else if(p==="categorical"){f=nd,y=Object.create(null);for(const b of r.stops)y[b[0]]=b[1];v=typeof r.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);f=Jf}if(s){const b={},E=[];for(let P=0;P<r.stops.length;P++){const N=r.stops[P],U=N[0].zoom;b[U]===void 0&&(b[U]={zoom:U,type:r.type,property:r.property,default:r.default,stops:[]},E.push(U)),b[U].stops.push([N[0].value,N[1]])}const I=[];for(const P of E)I.push([b[P].zoom,td(b[P],e)]);const A={name:"linear"};return{kind:"composite",interpolationType:A,interpolationFactor:Nr.interpolationFactor.bind(void 0,A),zoomStops:I.map(P=>P[0]),evaluate:({zoom:P},N)=>oa({stops:I,base:r.base},e,P).evaluate(P,N)}}if(u){const b=p==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:Nr.interpolationFactor.bind(void 0,b),zoomStops:r.stops.map(E=>E[0]),evaluate:({zoom:E})=>f(r,e,E,y,v)}}return{kind:"source",evaluate(b,E){const I=E&&E.properties?E.properties[r.property]:void 0;return I===void 0?ia(r.default,e.default):f(r,e,I,y,v)}}}function ia(r,e,i){return r!==void 0?r:e!==void 0?e:i!==void 0?i:void 0}function nd(r,e,i,s,u){return ia(typeof i===u?s[i]:void 0,r.default,e.default)}function rd(r,e,i){if(Vt(i)!=="number")return ia(r.default,e.default);const s=r.stops.length;if(s===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[s-1][0])return r.stops[s-1][1];const u=Ka(r.stops.map(p=>p[0]),i);return r.stops[u][1]}function oa(r,e,i){const s=r.base!==void 0?r.base:1;if(Vt(i)!=="number")return ia(r.default,e.default);const u=r.stops.length;if(u===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[u-1][0])return r.stops[u-1][1];const p=Ka(r.stops.map(E=>E[0]),i),f=function(E,I,A,P){const N=P-A,U=E-A;return N===0?0:I===1?U/N:(Math.pow(I,U)-1)/(Math.pow(I,N)-1)}(i,s,r.stops[p][0],r.stops[p+1][0]),y=r.stops[p][1],v=r.stops[p+1][1];let b=na[e.type]||Qf;if(r.colorSpace&&r.colorSpace!=="rgb"){const E=Kh[r.colorSpace];b=(I,A)=>E.reverse(E.interpolate(E.forward(I),E.forward(A),f))}return typeof y.evaluate=="function"?{evaluate(...E){const I=y.evaluate.apply(void 0,E),A=v.evaluate.apply(void 0,E);if(I!==void 0&&A!==void 0)return b(I,A,f)}}:b(y,v,f)}function Jf(r,e,i){return e.type==="color"?i=bt.parse(i):e.type==="formatted"?i=Zn.fromString(i.toString()):e.type==="resolvedImage"?i=Fr.fromString(i.toString()):Vt(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),ia(i,r.default,e.default)}Or.register(Co,{error:[{kind:"error"},[Et],(r,[e])=>{throw new Jn(e.evaluate(r))}],typeof:[Et,[Ct],(r,[e])=>mn(Vn(e.evaluate(r)))],"to-rgba":[Br(Xe,4),[ui],(r,[e])=>e.evaluate(r).toArray()],rgb:[ui,[Xe,Xe,Xe],Zc],rgba:[ui,[Xe,Xe,Xe,Xe],Zc],has:{type:wt,overloads:[[[Et],(r,[e])=>ed(e.evaluate(r),r.properties())],[[Et,Qn],(r,[e,i])=>ed(e.evaluate(r),i.evaluate(r))]]},get:{type:Ct,overloads:[[[Et],(r,[e])=>qc(e.evaluate(r),r.properties())],[[Et,Qn],(r,[e,i])=>qc(e.evaluate(r),i.evaluate(r))]]},"feature-state":[Ct,[Et],(r,[e])=>qc(e.evaluate(r),r.featureState||{})],properties:[Qn,[],r=>r.properties()],"geometry-type":[Et,[],r=>r.geometryType()],id:[Ct,[],r=>r.id()],zoom:[Xe,[],r=>r.globals.zoom],"heatmap-density":[Xe,[],r=>r.globals.heatmapDensity||0],"line-progress":[Xe,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[Xe,[],r=>r.globals.skyRadialProgress||0],accumulated:[Ct,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Xe,ko(Xe),(r,e)=>{let i=0;for(const s of e)i+=s.evaluate(r);return i}],"*":[Xe,ko(Xe),(r,e)=>{let i=1;for(const s of e)i*=s.evaluate(r);return i}],"-":{type:Xe,overloads:[[[Xe,Xe],(r,[e,i])=>e.evaluate(r)-i.evaluate(r)],[[Xe],(r,[e])=>-e.evaluate(r)]]},"/":[Xe,[Xe,Xe],(r,[e,i])=>e.evaluate(r)/i.evaluate(r)],"%":[Xe,[Xe,Xe],(r,[e,i])=>e.evaluate(r)%i.evaluate(r)],ln2:[Xe,[],()=>Math.LN2],pi:[Xe,[],()=>Math.PI],e:[Xe,[],()=>Math.E],"^":[Xe,[Xe,Xe],(r,[e,i])=>Math.pow(e.evaluate(r),i.evaluate(r))],sqrt:[Xe,[Xe],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Xe,[Xe],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Xe,[Xe],(r,[e])=>Math.log(e.evaluate(r))],log2:[Xe,[Xe],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Xe,[Xe],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Xe,[Xe],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Xe,[Xe],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Xe,[Xe],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Xe,[Xe],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Xe,[Xe],(r,[e])=>Math.atan(e.evaluate(r))],min:[Xe,ko(Xe),(r,e)=>Math.min(...e.map(i=>i.evaluate(r)))],max:[Xe,ko(Xe),(r,e)=>Math.max(...e.map(i=>i.evaluate(r)))],abs:[Xe,[Xe],(r,[e])=>Math.abs(e.evaluate(r))],round:[Xe,[Xe],(r,[e])=>{const i=e.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[Xe,[Xe],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Xe,[Xe],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[wt,[Et,Ct],(r,[e,i])=>r.properties()[e.value]===i.value],"filter-id-==":[wt,[Ct],(r,[e])=>r.id()===e.value],"filter-type-==":[wt,[Et],(r,[e])=>r.geometryType()===e.value],"filter-<":[wt,[Et,Ct],(r,[e,i])=>{const s=r.properties()[e.value],u=i.value;return typeof s==typeof u&&s<u}],"filter-id-<":[wt,[Ct],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i<s}],"filter->":[wt,[Et,Ct],(r,[e,i])=>{const s=r.properties()[e.value],u=i.value;return typeof s==typeof u&&s>u}],"filter-id->":[wt,[Ct],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i>s}],"filter-<=":[wt,[Et,Ct],(r,[e,i])=>{const s=r.properties()[e.value],u=i.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[wt,[Ct],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i<=s}],"filter->=":[wt,[Et,Ct],(r,[e,i])=>{const s=r.properties()[e.value],u=i.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[wt,[Ct],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i>=s}],"filter-has":[wt,[Ct],(r,[e])=>e.value in r.properties()],"filter-has-id":[wt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[wt,[Br(Et)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[wt,[Br(Ct)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[wt,[Et,Br(Ct)],(r,[e,i])=>i.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[wt,[Et,Br(Ct)],(r,[e,i])=>function(s,u,p,f){for(;p<=f;){const y=p+f>>1;if(u[y]===s)return!0;u[y]>s?f=y-1:p=y+1}return!1}(r.properties()[e.value],i.value,0,i.value.length-1)],all:{type:wt,overloads:[[[wt,wt],(r,[e,i])=>e.evaluate(r)&&i.evaluate(r)],[ko(wt),(r,e)=>{for(const i of e)if(!i.evaluate(r))return!1;return!0}]]},any:{type:wt,overloads:[[[wt,wt],(r,[e,i])=>e.evaluate(r)||i.evaluate(r)],[ko(wt),(r,e)=>{for(const i of e)if(i.evaluate(r))return!0;return!1}]]},"!":[wt,[wt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[wt,[Et],(r,[e])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(e.evaluate(r))}],upcase:[Et,[Et],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Et,[Et],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Et,ko(Ct),(r,e)=>e.map(i=>Jo(i.evaluate(r))).join("")],"resolved-locale":[Et,[ja],(r,[e])=>e.evaluate(r).resolvedLocale()]});class Hc{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new qh,this._defaultValue=i?function(s){return s.type==="color"&&ll(s.default)?new bt(0,0,0,0):s.type==="color"?bt.parse(s.default)||null:s.default===void 0?null:s.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,s,u,p,f){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=f,this.expression.evaluate(this._evaluator)}evaluate(e,i,s,u,p,f){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=f||null;try{const y=this.expression.evaluate(this._evaluator);if(y==null||typeof y=="number"&&y!=y)return this._defaultValue;if(this._enumValues&&!(y in this._enumValues))throw new Jn(`Expected value to be one of ${Object.keys(this._enumValues).map(v=>JSON.stringify(v)).join(", ")}, but found ${JSON.stringify(y)} instead.`);return y}catch(y){return this._warningHistory[y.message]||(this._warningHistory[y.message]=!0,typeof console!="undefined"&&console.warn(y.message)),this._defaultValue}}}function cl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Co}function fi(r,e){const i=new Ha(Co,[],e?function(u){const p={color:ui,string:Et,number:Xe,enum:Et,boolean:wt,formatted:Ks,resolvedImage:Ko};return u.type==="array"?Br(p[u.value]||Ct,u.length):p[u.type]}(e):void 0),s=i.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?Wc(new Hc(s,e)):Io(i.errors)}class ul{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!ts(i.expression)}evaluateWithoutErrorHandling(e,i,s,u,p,f){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,u,p,f)}evaluate(e,i,s,u,p,f){return this._styleExpression.evaluate(e,i,s,u,p,f)}}class no{constructor(e,i,s,u){this.kind=e,this.zoomStops=s,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!ts(i.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,i,s,u,p,f){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,u,p,f)}evaluate(e,i,s,u,p,f){return this._styleExpression.evaluate(e,i,s,u,p,f)}interpolationFactor(e,i,s){return this.interpolationType?Nr.interpolationFactor(this.interpolationType,e,i,s):0}}function Kc(r,e){if((r=fi(r,e)).result==="error")return r;const i=r.value.expression,s=ta(i);if(!s&&!Ao(e))return Io([new Pt("","data expressions not supported")]);const u=Xa(i,["zoom"]);if(!u&&!al(e))return Io([new Pt("","zoom expressions not supported")]);const p=as(i);return p||u?p instanceof Pt?Io([p]):p instanceof Nr&&!Xc(e)?Io([new Pt("",'"interpolate" expressions cannot be used with this property')]):Wc(p?new no(s?"camera":"composite",r.value,p.labels,p instanceof Nr?p.interpolation:void 0):new ul(s?"constant":"source",r.value)):Io([new Pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class hl{constructor(e,i){this._parameters=e,this._specification=i,vt(this,td(this._parameters,this._specification))}static deserialize(e){return new hl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function as(r){let e=null;if(r instanceof rl)e=as(r.result);else if(r instanceof nl){for(const i of r.args)if(e=as(i),e)break}else(r instanceof ns||r instanceof Nr)&&r.input instanceof Or&&r.input.name==="zoom"&&(e=r);return e instanceof Pt||r.eachChild(i=>{const s=as(i);s instanceof Pt?e=s:!e&&s?e=new Pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Pt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function mr(r){const e=r.key,i=r.value,s=r.valueSpec||{},u=r.objectElementValidators||{},p=r.style,f=r.styleSpec;let y=[];const v=Vt(i);if(v!=="object")return[new Ce(e,i,`object expected, ${v} found`)];for(const b in i){const E=b.split(".")[0],I=s[E]||s["*"];let A;if(u[E])A=u[E];else if(s[E])A=gr;else if(u["*"])A=u["*"];else{if(!s["*"]){y.push(new Ce(e,i[b],`unknown property "${b}"`));continue}A=gr}y=y.concat(A({key:(e&&`${e}.`)+b,value:i[b],valueSpec:I,style:p,styleSpec:f,object:i,objectKey:b},i))}for(const b in s)u[b]||s[b].required&&s[b].default===void 0&&i[b]===void 0&&y.push(new Ce(e,i,`missing required property "${b}"`));return y}function Yc(r){const e=r.value,i=r.valueSpec,s=r.style,u=r.styleSpec,p=r.key,f=r.arrayElementValidator||gr;if(Vt(e)!=="array")return[new Ce(p,e,`array expected, ${Vt(e)} found`)];if(i.length&&e.length!==i.length)return[new Ce(p,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Ce(p,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let y={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum};u.$version<7&&(y.function=i.function),Vt(i.value)==="object"&&(y=i.value);let v=[];for(let b=0;b<e.length;b++)v=v.concat(f({array:e,arrayIndex:b,value:e[b],valueSpec:y,style:s,styleSpec:u,key:`${p}[${b}]`}));return v}function dl(r){const e=r.key,i=r.value,s=r.valueSpec;let u=Vt(i);if(u==="number"&&i!=i&&(u="NaN"),u!=="number")return[new Ce(e,i,`number expected, ${u} found`)];if("minimum"in s){let p=s.minimum;if(Vt(s.minimum)==="array"&&(p=s.minimum[r.arrayIndex]),i<p)return[new Ce(e,i,`${i} is less than the minimum value ${p}`)]}if("maximum"in s){let p=s.maximum;if(Vt(s.maximum)==="array"&&(p=s.maximum[r.arrayIndex]),i>p)return[new Ce(e,i,`${i} is greater than the maximum value ${p}`)]}return[]}function Qc(r){const e=r.valueSpec,i=yt(r.value.type);let s,u,p,f={};const y=i!=="categorical"&&r.value.property===void 0,v=!y,b=Vt(r.value.stops)==="array"&&Vt(r.value.stops[0])==="array"&&Vt(r.value.stops[0][0])==="object",E=mr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(P){if(i==="identity")return[new Ce(P.key,P.value,'identity function may not have a "stops" property')];let N=[];const U=P.value;return N=N.concat(Yc({key:P.key,value:U,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:I})),Vt(U)==="array"&&U.length===0&&N.push(new Ce(P.key,U,"array must have at least one stop")),N},default:function(P){return gr({key:P.key,value:P.value,valueSpec:e,style:P.style,styleSpec:P.styleSpec})}}});return i==="identity"&&y&&E.push(new Ce(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||E.push(new Ce(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!Xc(r.valueSpec)&&E.push(new Ce(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(v&&!Ao(r.valueSpec)?E.push(new Ce(r.key,r.value,"property functions not supported")):y&&!al(r.valueSpec)&&E.push(new Ce(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!b||r.value.property!==void 0||E.push(new Ce(r.key,r.value,'"property" property is required')),E;function I(P){let N=[];const U=P.value,K=P.key;if(Vt(U)!=="array")return[new Ce(K,U,`array expected, ${Vt(U)} found`)];if(U.length!==2)return[new Ce(K,U,`array length 2 expected, length ${U.length} found`)];if(b){if(Vt(U[0])!=="object")return[new Ce(K,U,`object expected, ${Vt(U[0])} found`)];if(U[0].zoom===void 0)return[new Ce(K,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new Ce(K,U,"object stop key must have value")];if(p&&p>yt(U[0].zoom))return[new Ce(K,U[0].zoom,"stop zoom values must appear in ascending order")];yt(U[0].zoom)!==p&&(p=yt(U[0].zoom),u=void 0,f={}),N=N.concat(mr({key:`${K}[0]`,value:U[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:dl,value:A}}))}else N=N.concat(A({key:`${K}[0]`,value:U[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},U));return cl(Nt(U[1]))?N.concat([new Ce(`${K}[1]`,U[1],"expressions are not allowed in function stops.")]):N.concat(gr({key:`${K}[1]`,value:U[1],valueSpec:e,style:P.style,styleSpec:P.styleSpec}))}function A(P,N){const U=Vt(P.value),K=yt(P.value),ie=P.value!==null?P.value:N;if(s){if(U!==s)return[new Ce(P.key,ie,`${U} stop domain type must match previous stop domain type ${s}`)]}else s=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new Ce(P.key,ie,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&i!=="categorical"){let he=`number expected, ${U} found`;return Ao(e)&&i===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ce(P.key,ie,he)]}return i!=="categorical"||U!=="number"||isFinite(K)&&Math.floor(K)===K?i!=="categorical"&&U==="number"&&u!==void 0&&K<u?[new Ce(P.key,ie,"stop domain values must appear in ascending order")]:(u=K,i==="categorical"&&K in f?[new Ce(P.key,ie,"stop domain values must be unique")]:(f[K]=!0,[])):[new Ce(P.key,ie,`integer expected, found ${K}`)]}}function ro(r){const e=(r.expressionContext==="property"?Kc:fi)(Nt(r.value),r.valueSpec);if(e.result==="error")return e.value.map(s=>new Ce(`${r.key}${s.key}`,r.value,s.message));const i=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new Ce(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ts(i))return[new Ce(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!ts(i))return[new Ce(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Xa(i,["zoom","feature-state"]))return[new Ce(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!ta(i))return[new Ce(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ls(r){const e=r.key,i=r.value,s=r.valueSpec,u=[];return Array.isArray(s.values)?s.values.indexOf(yt(i))===-1&&u.push(new Ce(e,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(s.values).indexOf(yt(i))===-1&&u.push(new Ce(e,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function pl(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!pl(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Jc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cs(r){if(r==null)return{filter:()=>!0,needGeometry:!1};pl(r)||(r=Mo(r));const e=fi(r,Jc);if(e.result==="error")throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,s,u)=>e.value.evaluate(i,s,{},u),needGeometry:od(r)}}function id(r,e){return r<e?-1:r>e?1:0}function od(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(od(r[e]))return!0;return!1}function Mo(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?eu(r[1],r[2],"=="):e==="!="?fl(eu(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?eu(r[1],r[2],e):e==="any"?(i=r.slice(1),["any"].concat(i.map(Mo))):e==="all"?["all"].concat(r.slice(1).map(Mo)):e==="none"?["all"].concat(r.slice(1).map(Mo).map(fl)):e==="in"?sd(r[1],r.slice(2)):e==="!in"?fl(sd(r[1],r.slice(2))):e==="has"?ad(r[1]):e==="!has"?fl(ad(r[1])):e!=="within"||r;var i}function eu(r,e,i){switch(r){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,r,e]}}function sd(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",r,["literal",e.sort(id)]]:["filter-in-small",r,["literal",e]]}}function ad(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function fl(r){return["!",r]}function tu(r){return pl(Nt(r.value))?ro(vt({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):sa(r)}function sa(r){const e=r.value,i=r.key;if(Vt(e)!=="array")return[new Ce(i,e,`array expected, ${Vt(e)} found`)];const s=r.styleSpec;let u,p=[];if(e.length<1)return[new Ce(i,e,"filter array must have at least 1 element")];switch(p=p.concat(ls({key:`${i}[0]`,value:e[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),yt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&yt(e[1])==="$type"&&p.push(new Ce(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&p.push(new Ce(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Vt(e[1]),u!=="string"&&p.push(new Ce(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let f=2;f<e.length;f++)u=Vt(e[f]),yt(e[1])==="$type"?p=p.concat(ls({key:`${i}[${f}]`,value:e[f],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&p.push(new Ce(`${i}[${f}]`,e[f],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let f=1;f<e.length;f++)p=p.concat(sa({key:`${i}[${f}]`,value:e[f],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":u=Vt(e[1]),e.length!==2?p.push(new Ce(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&p.push(new Ce(`${i}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Vt(e[1]),e.length!==2?p.push(new Ce(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&p.push(new Ce(`${i}[1]`,e[1],`object expected, ${u} found`))}return p}function aa(r,e){const i=r.key,s=r.style,u=r.styleSpec,p=r.value,f=r.objectKey,y=u[`${e}_${r.layerType}`];if(!y)return[];const v=f.match(/^(.*)-transition$/);if(e==="paint"&&v&&y[v[1]]&&y[v[1]].transition)return gr({key:i,value:p,valueSpec:u.transition,style:s,styleSpec:u});const b=r.valueSpec||y[f];if(!b)return[new Ce(i,p,`unknown property "${f}"`)];let E;if(Vt(p)==="string"&&Ao(b)&&!b.tokens&&(E=/^{([^}]+)}$/.exec(p)))return[new Ce(i,p,`"${f}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(E[1])} }\`.`)];const I=[];return r.layerType==="symbol"&&(f==="text-field"&&s&&!s.glyphs&&I.push(new Ce(i,p,'use of "text-field" requires a style "glyphs" property')),f==="text-font"&&ll(Nt(p))&&yt(p.type)==="identity"&&I.push(new Ce(i,p,'"text-font" does not support identity functions'))),I.concat(gr({key:r.key,value:p,valueSpec:b,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:f}))}function br(r){return aa(r,"paint")}function la(r){return aa(r,"layout")}function ld(r){let e=[];const i=r.value,s=r.key,u=r.style,p=r.styleSpec;i.type||i.ref||e.push(new Ce(s,i,'either "type" or "ref" is required'));let f=yt(i.type);const y=yt(i.ref);if(i.id){const v=yt(i.id);for(let b=0;b<r.arrayIndex;b++){const E=u.layers[b];yt(E.id)===v&&e.push(new Ce(s,i.id,`duplicate layer id "${i.id}", previously used at line ${E.id.__line__}`))}}if("ref"in i){let v;["type","source","source-layer","filter","layout"].forEach(b=>{b in i&&e.push(new Ce(s,i[b],`"${b}" is prohibited for ref layers`))}),u.layers.forEach(b=>{yt(b.id)===y&&(v=b)}),v?v.ref?e.push(new Ce(s,i.ref,"ref cannot reference another ref layer")):f=yt(v.type):e.push(new Ce(s,i.ref,`ref layer "${y}" not found`))}else if(f!=="background"&&f!=="sky")if(i.source){const v=u.sources&&u.sources[i.source],b=v&&yt(v.type);v?b==="vector"&&f==="raster"?e.push(new Ce(s,i.source,`layer "${i.id}" requires a raster source`)):b==="raster"&&f!=="raster"?e.push(new Ce(s,i.source,`layer "${i.id}" requires a vector source`)):b!=="vector"||i["source-layer"]?b==="raster-dem"&&f!=="hillshade"?e.push(new Ce(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):f!=="line"||!i.paint||!i.paint["line-gradient"]||b==="geojson"&&v.lineMetrics||e.push(new Ce(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ce(s,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Ce(s,i.source,`source "${i.source}" not found`))}else e.push(new Ce(s,i,'missing required property "source"'));return e=e.concat(mr({key:s,value:i,valueSpec:p.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gr({key:`${s}.type`,value:i.type,valueSpec:p.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:tu,layout:v=>mr({layer:i,key:v.key,value:v.value,style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>la(vt({layerType:f},b))}}),paint:v=>mr({layer:i,key:v.key,value:v.value,style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>br(vt({layerType:f},b))}})}})),e}function us(r){const e=r.value,i=r.key,s=Vt(e);return s!=="string"?[new Ce(i,e,`string expected, ${s} found`)]:[]}const cd={promoteId:function({key:r,value:e}){if(Vt(e)==="string")return us({key:r,value:e});{const i=[];for(const s in e)i.push(...us({key:`${r}.${s}`,value:e[s]}));return i}}};function ud(r){const e=r.value,i=r.key,s=r.styleSpec,u=r.style;if(!e.type)return[new Ce(i,e,'"type" is required')];const p=yt(e.type);let f;switch(p){case"vector":case"raster":case"raster-dem":return f=mr({key:i,value:e,valueSpec:s[`source_${p.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:cd}),f;case"geojson":if(f=mr({key:i,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:cd}),e.cluster)for(const y in e.clusterProperties){const[v,b]=e.clusterProperties[y],E=typeof v=="string"?[v,["accumulated"],["get",y]]:v;f.push(...ro({key:`${i}.${y}.map`,value:b,expressionContext:"cluster-map"})),f.push(...ro({key:`${i}.${y}.reduce`,value:E,expressionContext:"cluster-reduce"}))}return f;case"video":return mr({key:i,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return mr({key:i,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new Ce(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ls({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:s})}}function ml(r){const e=r.value,i=r.styleSpec,s=i.light,u=r.style;let p=[];const f=Vt(e);if(e===void 0)return p;if(f!=="object")return p=p.concat([new Ce("light",e,`object expected, ${f} found`)]),p;for(const y in e){const v=y.match(/^(.*)-transition$/);p=p.concat(v&&s[v[1]]&&s[v[1]].transition?gr({key:y,value:e[y],valueSpec:i.transition,style:u,styleSpec:i}):s[y]?gr({key:y,value:e[y],valueSpec:s[y],style:u,styleSpec:i}):[new Ce(y,e[y],`unknown property "${y}"`)])}return p}function hd(r){const e=r.value,i=r.key,s=r.style,u=r.styleSpec,p=u.terrain;let f=[];const y=Vt(e);if(e===void 0)return f;if(y!=="object")return f=f.concat([new Ce("terrain",e,`object expected, ${y} found`)]),f;for(const v in e){const b=v.match(/^(.*)-transition$/);f=f.concat(b&&p[b[1]]&&p[b[1]].transition?gr({key:v,value:e[v],valueSpec:u.transition,style:s,styleSpec:u}):p[v]?gr({key:v,value:e[v],valueSpec:p[v],style:s,styleSpec:u}):[new Ce(v,e[v],`unknown property "${v}"`)])}if(e.source){const v=s.sources&&s.sources[e.source],b=v&&yt(v.type);v?b!=="raster-dem"&&f.push(new Ce(i,e.source,`terrain cannot be used with a source of type ${b}, it only be used with a "raster-dem" source type`)):f.push(new Ce(i,e.source,`source "${e.source}" not found`))}else f.push(new Ce(i,e,'terrain is missing required property "source"'));return f}function gl(r){const e=r.value,i=r.style,s=r.styleSpec,u=s.fog;let p=[];const f=Vt(e);if(e===void 0)return p;if(f!=="object")return p=p.concat([new Ce("fog",e,`object expected, ${f} found`)]),p;for(const y in e){const v=y.match(/^(.*)-transition$/);p=p.concat(v&&u[v[1]]&&u[v[1]].transition?gr({key:y,value:e[y],valueSpec:s.transition,style:i,styleSpec:s}):u[y]?gr({key:y,value:e[y],valueSpec:u[y],style:i,styleSpec:s}):[new Ce(y,e[y],`unknown property "${y}"`)])}return p}const dd={"*":()=>[],array:Yc,boolean:function(r){const e=r.value,i=r.key,s=Vt(e);return s!=="boolean"?[new Ce(i,e,`boolean expected, ${s} found`)]:[]},number:dl,color:function(r){const e=r.key,i=r.value,s=Vt(i);return s!=="string"?[new Ce(e,i,`color expected, ${s} found`)]:Cc.parseCSSColor(i)===null?[new Ce(e,i,`color expected, "${i}" found`)]:[]},constants:dt,enum:ls,filter:tu,function:Qc,layer:ld,object:mr,source:ud,light:ml,terrain:hd,fog:gl,string:us,formatted:function(r){return us(r).length===0?[]:ro(r)},resolvedImage:function(r){return us(r).length===0?[]:ro(r)}};function gr(r){const e=r.value,i=r.valueSpec,s=r.styleSpec;return i.expression&&ll(yt(e))?Qc(r):i.expression&&cl(Nt(e))?ro(r):i.type&&dd[i.type]?dd[i.type](r):mr(vt({},r,{valueSpec:i.type?s[i.type]:i}))}function nu(r){const e=r.value,i=r.key,s=us(r);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new Ce(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new Ce(i,e,'"glyphs" url must include a "{range}" token'))),s}function Ui(r,e=ae){let i=[];return i=i.concat(gr({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:nu,"*":()=>[]}})),r.constants&&(i=i.concat(dt({key:"constants",value:r.constants,style:r,styleSpec:e}))),ru(i)}function ru(r){return[].concat(r).sort((e,i)=>e.line-i.line)}function Vi(r){return function(...e){return ru(r.apply(this,e))}}Ui.source=Vi(ud),Ui.light=Vi(ml),Ui.terrain=Vi(hd),Ui.fog=Vi(gl),Ui.layer=Vi(ld),Ui.filter=Vi(tu),Ui.paintProperty=Vi(br),Ui.layoutProperty=Vi(la);const hs=Ui,iu=hs.light,_l=hs.fog,pd=hs.paintProperty,em=hs.layoutProperty;function ou(r,e){let i=!1;if(e&&e.length)for(const s of e)r.fire(new Le(new Error(s.message))),i=!0;return i}var ca=Wr;function Wr(r,e,i){var s=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var u=new Int32Array(this.arrayBuffer);r=u[0],this.d=(e=u[1])+2*(i=u[2]);for(var p=0;p<this.d*this.d;p++){var f=u[3+p],y=u[3+p+1];s.push(f===y?null:u.subarray(f,y))}var v=u[3+s.length+1];this.keys=u.subarray(u[3+s.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var b=0;b<this.d*this.d;b++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=i,this.scale=e/r,this.uid=0;var E=i/e*r;this.min=-E,this.max=r+E}Wr.prototype.insert=function(r,e,i,s,u){this._forEachCell(e,i,s,u,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(u)},Wr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Wr.prototype._insertCell=function(r,e,i,s,u,p){this.cells[u].push(p)},Wr.prototype.query=function(r,e,i,s,u){var p=this.min,f=this.max;if(r<=p&&e<=p&&f<=i&&f<=s&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(r,e,i,s,this._queryCell,y,{},u),y},Wr.prototype._queryCell=function(r,e,i,s,u,p,f,y){var v=this.cells[u];if(v!==null)for(var b=this.keys,E=this.bboxes,I=0;I<v.length;I++){var A=v[I];if(f[A]===void 0){var P=4*A;(y?y(E[P+0],E[P+1],E[P+2],E[P+3]):r<=E[P+2]&&e<=E[P+3]&&i>=E[P+0]&&s>=E[P+1])?(f[A]=!0,p.push(b[A])):f[A]=!1}}},Wr.prototype._forEachCell=function(r,e,i,s,u,p,f,y){for(var v=this._convertToCellCoord(r),b=this._convertToCellCoord(e),E=this._convertToCellCoord(i),I=this._convertToCellCoord(s),A=v;A<=E;A++)for(var P=b;P<=I;P++){var N=this.d*P+A;if((!y||y(this._convertFromCellCoord(A),this._convertFromCellCoord(P),this._convertFromCellCoord(A+1),this._convertFromCellCoord(P+1)))&&u.call(this,r,e,i,s,N,p,f,y))return}},Wr.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},Wr.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},Wr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var u=new Int32Array(e+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var p=e,f=0;f<r.length;f++){var y=r[f];u[3+f]=p,u.set(y,p),p+=y.length}return u[3+r.length]=p,u.set(this.keys,p),u[3+r.length+1]=p+=this.keys.length,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer};const{ImageData:fd,ImageBitmap:md}=ve,ua={};function rt(r,e,i={}){Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),ua[r]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}rt("Object",Object),ca.serialize=function(r,e){const i=r.toArrayBuffer();return e&&e.push(i),{buffer:i}},ca.deserialize=function(r){return new ca(r.buffer)},rt("Grid",ca),rt("Color",bt),rt("Error",Error),rt("ResolvedImage",Fr),rt("StylePropertyFunction",hl),rt("StyleExpression",Hc,{omit:["_evaluator"]}),rt("ZoomDependentExpression",no),rt("ZoomConstantExpression",ul),rt("CompoundExpression",Or,{omit:["_evaluate"]});for(const r in Co)Co[r]._classRegistryKey||rt(`Expression_${r}`,Co[r]);function su(r){return r&&typeof ArrayBuffer!="undefined"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function gd(r){return md&&r instanceof md}function ha(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(su(r)||gd(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const i=r;return e&&e.push(i.buffer),i}if(r instanceof fd)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const s of r)i.push(ha(s,e));return i}if(typeof r=="object"){const i=r.constructor,s=i._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");const u=i.serialize?i.serialize(r,e):{};if(!i.serialize){for(const p in r){if(!r.hasOwnProperty(p)||ua[s].omit.indexOf(p)>=0)continue;const f=r[p];u[p]=ua[s].shallow.indexOf(p)>=0?f:ha(f,e)}r instanceof Error&&(u.message=r.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof r)}function da(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||su(r)||gd(r)||ArrayBuffer.isView(r)||r instanceof fd)return r;if(Array.isArray(r))return r.map(da);if(typeof r=="object"){const e=r.$name||"Object",{klass:i}=ua[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(r);const s=Object.create(i.prototype);for(const u of Object.keys(r)){if(u==="$name")continue;const p=r[u];s[u]=ua[e].shallow.indexOf(u)>=0?p:da(p)}return s}throw new Error("can't deserialize object of type "+typeof r)}class _d{constructor(){this.first=!0}update(e,i){const s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))}}const yd=r=>r>=1536&&r<=1791,xd=r=>r>=1872&&r<=1919,vd=r=>r>=2208&&r<=2303,pa=r=>r>=11904&&r<=12031,wd=r=>r>=12032&&r<=12255,bd=r=>r>=12272&&r<=12287,zo=r=>r>=12288&&r<=12351,au=r=>r>=12352&&r<=12447,yl=r=>r>=12448&&r<=12543,lu=r=>r>=12544&&r<=12591,cu=r=>r>=12704&&r<=12735,uu=r=>r>=12736&&r<=12783,hu=r=>r>=12784&&r<=12799,xl=r=>r>=12800&&r<=13055,vl=r=>r>=13056&&r<=13311,Td=r=>r>=13312&&r<=19903,du=r=>r>=19968&&r<=40959,fa=r=>r>=40960&&r<=42127,Sd=r=>r>=42128&&r<=42191,Po=r=>r>=44032&&r<=55215,Ed=r=>r>=63744&&r<=64255,ma=r=>r>=64336&&r<=65023,Cd=r=>r>=65040&&r<=65055,pu=r=>r>=65072&&r<=65103,kd=r=>r>=65104&&r<=65135,io=r=>r>=65136&&r<=65279,ds=r=>r>=65280&&r<=65519;function Do(r){for(const e of r)if(Ro(e.charCodeAt(0)))return!0;return!1}function tm(r){for(const e of r)if(!Id(e.charCodeAt(0)))return!1;return!0}function Id(r){return!(yd(r)||xd(r)||vd(r)||ma(r)||io(r))}function Ro(r){return!(r!==746&&r!==747&&(r<4352||!(cu(r)||lu(r)||pu(r)&&!(r>=65097&&r<=65103)||Ed(r)||vl(r)||pa(r)||uu(r)||!(!zo(r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Td(r)||du(r)||xl(r)||(e=>e>=12592&&e<=12687)(r)||(e=>e>=43360&&e<=43391)(r)||(e=>e>=55216&&e<=55295)(r)||(e=>e>=4352&&e<=4607)(r)||Po(r)||au(r)||bd(r)||(e=>e>=12688&&e<=12703)(r)||wd(r)||hu(r)||yl(r)&&r!==12540||!(!ds(r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!kd(r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||(e=>e>=5120&&e<=5759)(r)||(e=>e>=6320&&e<=6399)(r)||Cd(r)||(e=>e>=19904&&e<=19967)(r)||fa(r)||Sd(r))))}function Ad(r){return!(Ro(r)||function(e){return!!((i=>i>=128&&i<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(i=>i>=8192&&i<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&e!==9251||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||zo(e)||yl(e)||(i=>i>=57344&&i<=63743)(e)||pu(e)||kd(e)||ds(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function Md(r){return r>=1424&&r<=2303||ma(r)||io(r)}function wl(r,e){return!(!e&&Md(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||(i=>i>=6016&&i<=6143)(r))}function h(r){for(const e of r)if(Md(e.charCodeAt(0)))return!0;return!1}const n="deferred",l="loading",d="loaded";let g=null,_="unavailable",w=null;const S=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(_="error"),g&&g(r)};function C(){M.fire(new Ze("pluginStateChange",{pluginStatus:_,pluginURL:w}))}const M=new st,z=function(){return _},R=function(){if(_!==n||!w)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_=l,C(),w&&D({url:w},r=>{r?S(r):(_=d,C())})},F={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_===d||F.applyArabicShaping!=null,isLoading:()=>_===l,setState(r){_=r.pluginStatus,w=r.pluginURL},isParsed:()=>F.applyArabicShaping!=null&&F.processBidirectionalText!=null&&F.processStyledBidirectionalText!=null,getPluginURL:()=>w};class O{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new _d,this.transition={})}isSupportedScript(e){return function(i,s){for(const u of i)if(!wl(u.charCodeAt(0),s))return!1;return!0}(e,F.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*i}}}class G{constructor(e,i){this.property=e,this.value=i,this.expression=function(s,u){if(ll(s))return new hl(s,u);if(cl(s)){const p=Kc(s,u);if(p.result==="error")throw new Error(p.value.map(f=>`${f.key}: ${f.message}`).join(", "));return p.value}{let p=s;return typeof s=="string"&&u.type==="color"&&(p=bt.parse(s)),{kind:"constant",evaluate:()=>p}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,s){return this.property.possiblyEvaluate(this,e,i,s)}}class Z{constructor(e){this.property=e,this.value=new G(e,void 0)}transitioned(e,i){return new V(this.property,this.value,i,ot({},e.transition,this.transition),e.now)}untransitioned(){return new V(this.property,this.value,null,{},0)}}class ne{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ot(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Z(this._values[e].property)),this._values[e].value=new G(this._values[e].property,i===null?void 0:Ot(i))}getTransition(e){return Ot(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Z(this._values[e].property)),this._values[e].transition=Ot(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(e[i]=s);const u=this.getTransition(i);u!==void 0&&(e[`${i}-transition`]=u)}return e}transitioned(e,i){const s=new X(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,i._values[u]);return s}untransitioned(){const e=new X(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class V{constructor(e,i,s,u,p){const f=u.delay||0,y=u.duration||0;p=p||0,this.property=e,this.value=i,this.begin=p+f,this.end=this.begin+y,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,i,s){const u=e.now||0,p=this.value.possiblyEvaluate(e,i,s),f=this.prior;if(f){if(u>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(u<this.begin)return f.possiblyEvaluate(e,i,s);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(e,i,s),p,Te(y))}}return p}}class X{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,s){const u=new ue(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,i,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class te{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Ot(this._values[e].value)}setValue(e,i){this._values[e]=new G(this._values[e].property,i===null?void 0:Ot(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(e[i]=s)}return e}possiblyEvaluate(e,i,s){const u=new ue(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,i,s);return u}}class se{constructor(e,i,s){this.property=e,this.value=i,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,s,u){return this.property.evaluate(this.value,this.parameters,e,i,s,u)}}class ue{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Y{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,s){const u=na[this.specification.type];return u?u(e,i,s):e}}class pe{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,s,u){return new se(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},s,u)}:e.expression,i)}interpolate(e,i,s){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new se(this,{kind:"constant",value:void 0},e.parameters);const u=na[this.specification.type];return u?new se(this,{kind:"constant",value:u(e.value.value,i.value.value,s)},e.parameters):e}evaluate(e,i,s,u,p,f){return e.kind==="constant"?e.value:e.evaluate(i,s,u,p,f)}}class ke extends pe{possiblyEvaluate(e,i,s,u){if(e.value===void 0)return new se(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const p=e.expression.evaluate(i,null,{},s,u),f=e.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,y=this._calculate(f,f,f,i);return new se(this,{kind:"constant",value:y},i)}if(e.expression.kind==="camera"){const p=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new se(this,{kind:"constant",value:p},i)}return new se(this,e.expression,i)}evaluate(e,i,s,u,p,f){if(e.kind==="source"){const y=e.evaluate(i,s,u,p,f);return this._calculate(y,y,y,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},s,u),e.evaluate({zoom:Math.floor(i.zoom)},s,u),e.evaluate({zoom:Math.floor(i.zoom)+1},s,u),i):e.value}_calculate(e,i,s,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i,other:s}:{from:s,to:i,other:e}}interpolate(e){return e}}class De{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const p=e.expression.evaluate(i,null,{},s,u);return this._calculate(p,p,p,i)}return this._calculate(e.expression.evaluate(new O(Math.floor(i.zoom-1),i)),e.expression.evaluate(new O(Math.floor(i.zoom),i)),e.expression.evaluate(new O(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,s,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:s,to:i}}interpolate(e){return e}}class de{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,u){return!!e.expression.evaluate(i,null,{},s,u)}interpolate(){return!1}}class Ee{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const s=e[i];s.specification.overridable&&this.overridableProperties.push(i);const u=this.defaultPropertyValues[i]=new G(s,void 0),p=this.defaultTransitionablePropertyValues[i]=new Z(s);this.defaultTransitioningPropertyValues[i]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=u.possiblyEvaluate({})}}}function Je(r,e){return 256*(r=Ie(Math.floor(r),0,255))+Ie(Math.floor(e),0,255)}rt("DataDrivenProperty",pe),rt("DataConstantProperty",Y),rt("CrossFadedDataDrivenProperty",ke),rt("CrossFadedProperty",De),rt("ColorRampProperty",de);const tt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class et{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ue{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function it(r,e=1){let i=0,s=0;return{members:r.map(u=>{const p=tt[u.type].BYTES_PER_ELEMENT,f=i=kt(i,Math.max(e,p)),y=u.components||1;return s=Math.max(s,p),i+=p*y,{name:u.name,type:u.type,components:y,offset:f}}),size:kt(i,Math.max(s,e)),alignment:e}}function kt(r,e){return Math.ceil(r/e)*e}class gt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=s,e}}gt.prototype.bytesPerElement=4,rt("StructArrayLayout2i4",gt);class vn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,s,u)}emplace(e,i,s,u,p){const f=4*e;return this.int16[f+0]=i,this.int16[f+1]=s,this.int16[f+2]=u,this.int16[f+3]=p,e}}vn.prototype.bytesPerElement=8,rt("StructArrayLayout4i8",vn);class dn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,s,u,p,f,y)}emplace(e,i,s,u,p,f,y,v){const b=6*e,E=12*e,I=3*e;return this.int16[b+0]=i,this.int16[b+1]=s,this.uint8[E+4]=u,this.uint8[E+5]=p,this.uint8[E+6]=f,this.uint8[E+7]=y,this.float32[I+2]=v,e}}dn.prototype.bytesPerElement=12,rt("StructArrayLayout2i4ub1f12",dn);class xt extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,s)}emplace(e,i,s,u){const p=3*e;return this.float32[p+0]=i,this.float32[p+1]=s,this.float32[p+2]=u,e}}xt.prototype.bytesPerElement=12,rt("StructArrayLayout3f12",xt);class It extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y,v,b,E){const I=this.length;return this.resize(I+1),this.emplace(I,e,i,s,u,p,f,y,v,b,E)}emplace(e,i,s,u,p,f,y,v,b,E,I){const A=10*e;return this.uint16[A+0]=i,this.uint16[A+1]=s,this.uint16[A+2]=u,this.uint16[A+3]=p,this.uint16[A+4]=f,this.uint16[A+5]=y,this.uint16[A+6]=v,this.uint16[A+7]=b,this.uint16[A+8]=E,this.uint16[A+9]=I,e}}It.prototype.bytesPerElement=20,rt("StructArrayLayout10ui20",It);class gn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,s,u,p,f,y,v)}emplace(e,i,s,u,p,f,y,v,b){const E=8*e;return this.uint16[E+0]=i,this.uint16[E+1]=s,this.uint16[E+2]=u,this.uint16[E+3]=p,this.uint16[E+4]=f,this.uint16[E+5]=y,this.uint16[E+6]=v,this.uint16[E+7]=b,e}}gn.prototype.bytesPerElement=16,rt("StructArrayLayout8ui16",gn);class Xr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K){const ie=this.length;return this.resize(ie+1),this.emplace(ie,e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K)}emplace(e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie){const he=16*e;return this.int16[he+0]=i,this.int16[he+1]=s,this.int16[he+2]=u,this.int16[he+3]=p,this.uint16[he+4]=f,this.uint16[he+5]=y,this.uint16[he+6]=v,this.uint16[he+7]=b,this.int16[he+8]=E,this.int16[he+9]=I,this.int16[he+10]=A,this.int16[he+11]=P,this.int16[he+12]=N,this.int16[he+13]=U,this.int16[he+14]=K,this.int16[he+15]=ie,e}}Xr.prototype.bytesPerElement=32,rt("StructArrayLayout4i4ui4i4i32",Xr);class Ei extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Ei.prototype.bytesPerElement=4,rt("StructArrayLayout1ul4",Ei);class ar extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y,v,b,E,I,A,P){const N=this.length;return this.resize(N+1),this.emplace(N,e,i,s,u,p,f,y,v,b,E,I,A,P)}emplace(e,i,s,u,p,f,y,v,b,E,I,A,P,N){const U=20*e,K=10*e;return this.int16[U+0]=i,this.int16[U+1]=s,this.int16[U+2]=u,this.int16[U+3]=p,this.int16[U+4]=f,this.float32[K+3]=y,this.float32[K+4]=v,this.float32[K+5]=b,this.float32[K+6]=E,this.int16[U+14]=I,this.uint32[K+8]=A,this.uint16[U+18]=P,this.uint16[U+19]=N,e}}ar.prototype.bytesPerElement=40,rt("StructArrayLayout5i4f1i1ul2ui40",ar);class Tr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,s,u,p,f,y)}emplace(e,i,s,u,p,f,y,v){const b=8*e;return this.int16[b+0]=i,this.int16[b+1]=s,this.int16[b+2]=u,this.int16[b+4]=p,this.int16[b+5]=f,this.int16[b+6]=y,this.int16[b+7]=v,e}}Tr.prototype.bytesPerElement=16,rt("StructArrayLayout3i2i2i16",Tr);class Ci extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u,p)}emplace(e,i,s,u,p,f){const y=4*e,v=8*e;return this.float32[y+0]=i,this.float32[y+1]=s,this.float32[y+2]=u,this.int16[v+6]=p,this.int16[v+7]=f,e}}Ci.prototype.bytesPerElement=16,rt("StructArrayLayout2f1f2i16",Ci);class $i extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,s,u)}emplace(e,i,s,u,p){const f=12*e,y=3*e;return this.uint8[f+0]=i,this.uint8[f+1]=s,this.float32[y+1]=u,this.float32[y+2]=p,e}}$i.prototype.bytesPerElement=12,rt("StructArrayLayout2ub2f12",$i);class nn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,s)}emplace(e,i,s,u){const p=3*e;return this.uint16[p+0]=i,this.uint16[p+1]=s,this.uint16[p+2]=u,e}}nn.prototype.bytesPerElement=6,rt("StructArrayLayout3ui6",nn);class _n extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie,he,_e,ye,we){const be=this.length;return this.resize(be+1),this.emplace(be,e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie,he,_e,ye,we)}emplace(e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie,he,_e,ye,we,be){const Me=30*e,Fe=15*e,Ne=60*e;return this.int16[Me+0]=i,this.int16[Me+1]=s,this.int16[Me+2]=u,this.float32[Fe+2]=p,this.float32[Fe+3]=f,this.uint16[Me+8]=y,this.uint16[Me+9]=v,this.uint32[Fe+5]=b,this.uint32[Fe+6]=E,this.uint32[Fe+7]=I,this.uint16[Me+16]=A,this.uint16[Me+17]=P,this.uint16[Me+18]=N,this.float32[Fe+10]=U,this.float32[Fe+11]=K,this.uint8[Ne+48]=ie,this.uint8[Ne+49]=he,this.uint8[Ne+50]=_e,this.uint32[Fe+13]=ye,this.int16[Me+28]=we,this.uint8[Ne+58]=be,e}}_n.prototype.bytesPerElement=60,rt("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",_n);class $t extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie,he,_e,ye,we,be,Me,Fe,Ne,Ge,Pe,Be,qe,Re){const ht=this.length;return this.resize(ht+1),this.emplace(ht,e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie,he,_e,ye,we,be,Me,Fe,Ne,Ge,Pe,Be,qe,Re)}emplace(e,i,s,u,p,f,y,v,b,E,I,A,P,N,U,K,ie,he,_e,ye,we,be,Me,Fe,Ne,Ge,Pe,Be,qe,Re,ht){const nt=38*e,jt=19*e;return this.int16[nt+0]=i,this.int16[nt+1]=s,this.int16[nt+2]=u,this.float32[jt+2]=p,this.float32[jt+3]=f,this.int16[nt+8]=y,this.int16[nt+9]=v,this.int16[nt+10]=b,this.int16[nt+11]=E,this.int16[nt+12]=I,this.int16[nt+13]=A,this.uint16[nt+14]=P,this.uint16[nt+15]=N,this.uint16[nt+16]=U,this.uint16[nt+17]=K,this.uint16[nt+18]=ie,this.uint16[nt+19]=he,this.uint16[nt+20]=_e,this.uint16[nt+21]=ye,this.uint16[nt+22]=we,this.uint16[nt+23]=be,this.uint16[nt+24]=Me,this.uint16[nt+25]=Fe,this.uint16[nt+26]=Ne,this.uint16[nt+27]=Ge,this.uint16[nt+28]=Pe,this.uint32[jt+15]=Be,this.float32[jt+16]=qe,this.float32[jt+17]=Re,this.float32[jt+18]=ht,e}}$t.prototype.bytesPerElement=76,rt("StructArrayLayout3i2f6i15ui1ul3f76",$t);class wn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}wn.prototype.bytesPerElement=4,rt("StructArrayLayout1f4",wn);class Sr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,s)}emplace(e,i,s,u){const p=3*e;return this.int16[p+0]=i,this.int16[p+1]=s,this.int16[p+2]=u,e}}Sr.prototype.bytesPerElement=6,rt("StructArrayLayout3i6",Sr);class cn extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,s,u)}emplace(e,i,s,u,p){const f=6*e;return this.uint32[3*e+0]=i,this.uint16[f+2]=s,this.uint16[f+3]=u,this.uint16[f+4]=p,e}}cn.prototype.bytesPerElement=12,rt("StructArrayLayout1ul3ui12",cn);class er extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=s,e}}er.prototype.bytesPerElement=4,rt("StructArrayLayout2ui4",er);class Hr extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}Hr.prototype.bytesPerElement=2,rt("StructArrayLayout1ui2",Hr);class ki extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,p){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u,p)}emplace(e,i,s,u,p,f){const y=5*e;return this.float32[y+0]=i,this.float32[y+1]=s,this.float32[y+2]=u,this.float32[y+3]=p,this.float32[y+4]=f,e}}ki.prototype.bytesPerElement=20,rt("StructArrayLayout5f20",ki);class bl extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=s,e}}bl.prototype.bytesPerElement=8,rt("StructArrayLayout2f8",bl);class fu extends Ue{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,s,u)}emplace(e,i,s,u,p){const f=4*e;return this.float32[f+0]=i,this.float32[f+1]=s,this.float32[f+2]=u,this.float32[f+3]=p,e}}fu.prototype.bytesPerElement=16,rt("StructArrayLayout4f16",fu);class Tl extends et{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Tl.prototype.size=40;class Lo extends ar{get(e){return new Tl(this,e)}}rt("CollisionBoxArray",Lo);class zd extends et{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}zd.prototype.size=60;class ga extends _n{get(e){return new zd(this,e)}}rt("PlacedSymbolArray",ga);class Sl extends et{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Sl.prototype.size=76;class $y extends $t{get(e){return new Sl(this,e)}}rt("SymbolInstanceArray",$y);class jy extends wn{getoffsetX(e){return this.float32[1*e+0]}}rt("GlyphOffsetArray",jy);class Gy extends Sr{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}rt("SymbolLineVertexArray",Gy);class Zy extends et{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Zy.prototype.size=12;class qy extends cn{get(e){return new Zy(this,e)}}rt("FeatureIndexArray",qy);class Wy extends et{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Wy.prototype.size=4;class Xy extends er{get(e){return new Wy(this,e)}}rt("FillExtrusionCentroidArray",Xy);const C2=it([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),k2=it([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Hy=Oi(function(r){r.exports=function(e,i){var s,u,p,f,y,v,b,E;for(u=e.length-(s=3&e.length),p=i,y=3432918353,v=461845907,E=0;E<u;)b=255&e.charCodeAt(E)|(255&e.charCodeAt(++E))<<8|(255&e.charCodeAt(++E))<<16|(255&e.charCodeAt(++E))<<24,++E,p=27492+(65535&(f=5*(65535&(p=(p^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(b=0,s){case 3:b^=(255&e.charCodeAt(E+2))<<16;case 2:b^=(255&e.charCodeAt(E+1))<<8;case 1:p^=b=(65535&(b=(b=(65535&(b^=255&e.charCodeAt(E)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),I2=Oi(function(r){r.exports=function(e,i){for(var s,u=e.length,p=i^u,f=0;u>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),u-=4,++f;switch(u){case 3:p^=(255&e.charCodeAt(f+2))<<16;case 2:p^=(255&e.charCodeAt(f+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(f)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),mu=Hy,A2=I2;mu.murmur3=Hy,mu.murmur2=A2;class Pd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,s,u){this.ids.push(Ky(e)),this.positions.push(i,s,u)}getPositions(e){const i=Ky(e);let s=0,u=this.ids.length-1;for(;s<u;){const f=s+u>>1;this.ids[f]>=i?u=f:s=f+1}const p=[];for(;this.ids[s]===i;)p.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return p}static serialize(e,i){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return nm(s,u,0,s.length-1),i&&i.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const i=new Pd;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Ky(r){const e=+r;return!isNaN(e)&&e<=Ae?e:mu(String(r))}function nm(r,e,i,s){for(;i<s;){const u=r[i+s>>1];let p=i-1,f=s+1;for(;;){do p++;while(r[p]<u);do f--;while(r[f]>u);if(p>=f)break;Dd(r,p,f),Dd(e,3*p,3*f),Dd(e,3*p+1,3*f+1),Dd(e,3*p+2,3*f+2)}f-i<s-f?(nm(r,e,i,f),i=f+1):(nm(r,e,f+1,s),s=f)}}function Dd(r,e,i){const s=r[e];r[e]=r[i],r[i]=s}rt("FeaturePositionMap",Pd);class ps{constructor(e,i){this.gl=e.gl,this.location=i}}class Rd extends ps{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Yy extends ps{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Qy extends ps{constructor(e,i){super(e,i),this.current=bt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const M2=new Float32Array(16),z2=new Float32Array(9);function rm(r){return[Je(255*r.r,255*r.g),Je(255*r.b,255*r.a)]}class gu{constructor(e,i,s){this.value=e,this.uniformNames=i.map(u=>`u_${u}`),this.type=s}setUniform(e,i,s){e.set(s.constantOr(this.value))}getBinding(e,i,s){return this.type==="color"?new Qy(e,i):new Rd(e,i)}}class El{constructor(e,i){this.uniformNames=i.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tl.concat(i.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,i,s,u){const p=u==="u_pattern_to"||u==="u_dash_to"?this.patternTo:u==="u_pattern_from"||u==="u_dash_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)}getBinding(e,i,s){return s==="u_pattern_from"||s==="u_pattern_to"||s==="u_dash_from"||s==="u_dash_to"?new Yy(e,i):new Rd(e,i)}}class Bo{constructor(e,i,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,i,s,u,p){const f=this.paintVertexArray.length,y=this.expression.evaluate(new O(0),i,{},u,[],p);this.paintVertexArray.resize(e),this._setPaintValue(f,e,y)}updatePaintArray(e,i,s,u){const p=this.expression.evaluate({zoom:0},s,u);this._setPaintValue(e,i,p)}_setPaintValue(e,i,s){if(this.type==="color"){const u=rm(s);for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ji{constructor(e,i,s,u,p,f){this.expression=e,this.uniformNames=i.map(y=>`u_${y}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map(y=>({name:`a_${y}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,i,s,u,p){const f=this.expression.evaluate(new O(this.zoom),i,{},u,[],p),y=this.expression.evaluate(new O(this.zoom+1),i,{},u,[],p),v=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(v,e,f,y)}updatePaintArray(e,i,s,u){const p=this.expression.evaluate({zoom:this.zoom},s,u),f=this.expression.evaluate({zoom:this.zoom+1},s,u);this._setPaintValue(e,i,p,f)}_setPaintValue(e,i,s,u){if(this.type==="color"){const p=rm(s),f=rm(u);for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,p[0],p[1],f[0],f[1])}else{for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const s=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,u=Ie(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,i,s){return new Rd(e,i)}}class fs{constructor(e,i,s,u,p,f,y){this.expression=e,this.type=s,this.useIntegerZoom=u,this.zoom=p,this.layerId=y,this.paintVertexAttributes=(s==="array"?k2:C2).members;for(let v=0;v<i.length;++v);this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(e,i,s){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(e,i,s,u,p){this._setPaintValues(e,i,s.patterns&&s.patterns[this.layerId],p)}_setPaintValues(e,i,s,u){if(!u||!s)return;const{min:p,mid:f,max:y}=s,v=u[p],b=u[f],E=u[y];if(v&&b&&E)for(let I=e;I<i;I++)this._setPaintValue(this.zoomInPaintVertexArray,I,b,v),this._setPaintValue(this.zoomOutPaintVertexArray,I,b,E)}_setPaintValue(e,i,s,u){e.emplace(i,s.tl[0],s.tl[1],s.br[0],s.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],s.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Fo{constructor(e,i,s=()=>!0){this.binders={},this._buffers=[];const u=[];for(const p in e.paint._values){if(!s(p))continue;const f=e.paint.get(p);if(!(f instanceof se&&Ao(f.property.specification)))continue;const y=D2(p,e.type),v=f.value,b=f.property.specification.type,E=f.property.useIntegerZoom,I=f.property.specification["property-type"],A=I==="cross-faded"||I==="cross-faded-data-driven",P=String(p)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||P)if(v.kind==="source"||P||A){const N=Jy(p,b,"source");this.binders[p]=A?new fs(v,y,b,E,i,N,e.id):new Bo(v,y,b,N),u.push(`/a_${p}`)}else{const N=Jy(p,b,"composite");this.binders[p]=new ji(v,y,b,E,i,N),u.push(`/z_${p}`)}else this.binders[p]=A?new El(v.value,y):new gu(v.value,y,b),u.push(`/u_${p}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Bo||i instanceof ji?i.maxValue:0}populatePaintArrays(e,i,s,u,p){for(const f in this.binders){const y=this.binders[f];(y instanceof Bo||y instanceof ji||y instanceof fs)&&y.populatePaintArray(e,i,s,u,p)}}setConstantPatternPositions(e,i){for(const s in this.binders){const u=this.binders[s];u instanceof El&&u.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,s,u,p){let f=!1;for(const y in e){const v=i.getPositions(y);for(const b of v){const E=s.feature(b.index);for(const I in this.binders){const A=this.binders[I];if((A instanceof Bo||A instanceof ji||A instanceof fs)&&A.expression.isStateDependent===!0){const P=u.paint.get(I);A.expression=P.value,A.updatePaintArray(b.start,b.end,E,e[y],p),f=!0}}}}return f}defines(){const e=[];for(const i in this.binders){const s=this.binders[i];(s instanceof gu||s instanceof El)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Bo||s instanceof ji||s instanceof fs)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof gu||s instanceof El||s instanceof ji)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof gu||p instanceof El||p instanceof ji){for(const f of p.uniformNames)if(i[f]){const y=p.getBinding(e,i[f],f);s.push({name:f,property:u,binding:y})}}}return s}setUniforms(e,i,s,u){for(const{name:p,property:f,binding:y}of i)this.binders[f].setUniform(y,u,s.get(f),p)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const s=this.binders[i];if(e&&s instanceof fs){const u=e.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(s instanceof Bo||s instanceof ji)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(e){for(const i in this.binders){const s=this.binders[i];(s instanceof Bo||s instanceof ji||s instanceof fs)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Bo||i instanceof ji||i instanceof fs)&&i.destroy()}}}class _a{constructor(e,i,s=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Fo(u,i,s);this.needsUpload=!1,this._featureMap=new Pd,this._bufferOffset=0}populatePaintArrays(e,i,s,u,p,f){for(const y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,i,u,p,f);i.id!==void 0&&this._featureMap.add(i.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,s,u){for(const p of s)this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(e,this._featureMap,i,p,u)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const P2={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function D2(r,e){return P2[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const R2={"line-pattern":{source:It,composite:It},"fill-pattern":{source:It,composite:It},"fill-extrusion-pattern":{source:It,composite:It},"line-dasharray":{source:gn,composite:gn}},L2={color:{source:bl,composite:fu},number:{source:wn,composite:bl}};function Jy(r,e,i){const s=R2[r];return s&&s[i]||L2[e][i]}rt("ConstantBinder",gu),rt("CrossFadedConstantBinder",El),rt("SourceExpressionBinder",Bo),rt("CrossFadedCompositeBinder",fs),rt("CompositeExpressionBinder",ji),rt("ProgramConfiguration",Fo,{omit:["_buffers"]}),rt("ProgramConfigurationSet",_a);const Ld="-transition";class Gi extends st{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new te(i.layout)),i.paint)){this._transitionablePaint=new ne(i.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ue(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,s={}){i!=null&&this._validate(em,`layers.${this.id}.layout.${e}`,e,i,s)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return Wt(e,Ld)?this._transitionablePaint.getTransition(e.slice(0,-Ld.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,s={}){if(i!=null&&this._validate(pd,`layers.${this.id}.paint.${e}`,e,i,s))return!1;if(Wt(e,Ld))return this._transitionablePaint.setTransition(e.slice(0,-Ld.length),i||void 0),!1;{const u=this._transitionablePaint._values[e],p=u.property.specification["property-type"]==="cross-faded-data-driven",f=u.value.isDataDriven(),y=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const v=this._transitionablePaint._values[e].value;return v.isDataDriven()||f||p||this._handleOverridablePaintPropertyUpdate(e,y,v)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),an(e,(i,s)=>!(i===void 0||s==="layout"&&!Object.keys(i).length||s==="paint"&&!Object.keys(i).length))}_validate(e,i,s,u,p={}){return(!p||p.validate!==!1)&&ou(this,e.call(hs,{key:i,layerType:this.type,objectKey:s,value:u,styleSpec:ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof se&&Ao(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const B2=it([{name:"a_pos",components:2,type:"Int16"}],4),{members:F2}=B2;class _r{constructor(e=[]){this.segments=e}prepareSegment(e,i,s,u){let p=this.segments[this.segments.length-1];return e>_r.MAX_VERTEX_ARRAY_LENGTH&&Ye(`Max vertices per segment is ${_r.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!p||p.vertexLength+e>_r.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==u)&&(p={vertexOffset:i.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},u!==void 0&&(p.sortKey=u),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,s,u){return new _r([{vertexOffset:e,primitiveOffset:i,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}_r.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,rt("SegmentVector",_r);var Kt=8192;const im=Math.pow(2,14)-1,e0=-im-1;function ya(r){const e=Kt/r.extent,i=r.loadGeometry();for(let s=0;s<i.length;s++){const u=i[s];for(let p=0;p<u.length;p++){const f=u[p],y=Math.round(f.x*e),v=Math.round(f.y*e);f.x=Ie(y,e0,im),f.y=Ie(v,e0,im),(y<f.x||y>f.x+1||v<f.y||v>f.y+1)&&Ye("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function xa(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?ya(r):[]}}function Bd(r,e,i,s,u){r.emplaceBack(2*e+(s+1)/2,2*i+(u+1)/2)}class om{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new gt,this.indexArray=new nn,this.segments=new _r,this.programConfigurations=new _a(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){const u=this.layers[0],p=[];let f=null;u.type==="circle"&&(f=u.layout.get("circle-sort-key"));for(const{feature:y,id:v,index:b,sourceLayerIndex:E}of e){const I=this.layers[0]._featureFilter.needGeometry,A=xa(y,I);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),A,s))continue;const P=f?f.evaluate(A,{},s):void 0,N={id:v,properties:y.properties,type:y.type,sourceLayerIndex:E,index:b,geometry:I?A.geometry:ya(y),patterns:{},sortKey:P};p.push(N)}f&&p.sort((y,v)=>y.sortKey-v.sortKey);for(const y of p){const{geometry:v,index:b,sourceLayerIndex:E}=y,I=e[b].feature;this.addFeature(y,v,b,s),i.featureIndex.insert(I,v,b,E,this.index)}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,F2),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,u){for(const p of i)for(const f of p){const y=f.x,v=f.y;if(y<0||y>=Kt||v<0||v>=Kt)continue;const b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),E=b.vertexLength;Bd(this.layoutVertexArray,y,v,-1,-1),Bd(this.layoutVertexArray,y,v,1,-1),Bd(this.layoutVertexArray,y,v,1,1),Bd(this.layoutVertexArray,y,v,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),b.vertexLength+=4,b.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u)}}function t0(r,e){for(let i=0;i<r.length;i++)if(Cl(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Cl(r,e[i]))return!0;return!!sm(r,e)}function O2(r,e,i){return!!Cl(r,e)||!!am(e,r,i)}function n0(r,e){if(r.length===1)return i0(e,r[0]);for(let i=0;i<e.length;i++){const s=e[i];for(let u=0;u<s.length;u++)if(Cl(r,s[u]))return!0}for(let i=0;i<r.length;i++)if(i0(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(sm(r,e[i]))return!0;return!1}function N2(r,e,i){if(r.length>1){if(sm(r,e))return!0;for(let s=0;s<e.length;s++)if(am(e[s],r,i))return!0}for(let s=0;s<r.length;s++)if(am(r[s],e,i))return!0;return!1}function sm(r,e){if(r.length===0||e.length===0)return!1;for(let i=0;i<r.length-1;i++){const s=r[i],u=r[i+1];for(let p=0;p<e.length-1;p++)if(U2(s,u,e[p],e[p+1]))return!0}return!1}function U2(r,e,i,s){return ut(r,i,s)!==ut(e,i,s)&&ut(r,e,i)!==ut(r,e,s)}function am(r,e,i){const s=i*i;if(e.length===1)return r.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(r0(r,e[u-1],e[u])<s)return!0;return!1}function r0(r,e,i){const s=e.distSqr(i);if(s===0)return r.distSqr(e);const u=((r.x-e.x)*(i.x-e.x)+(r.y-e.y)*(i.y-e.y))/s;return r.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function i0(r,e){let i,s,u,p=!1;for(let f=0;f<r.length;f++){i=r[f];for(let y=0,v=i.length-1;y<i.length;v=y++)s=i[y],u=i[v],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(p=!p)}return p}function Cl(r,e){let i=!1;for(let s=0,u=r.length-1;s<r.length;u=s++){const p=r[s],f=r[u];p.y>e.y!=f.y>e.y&&e.x<(f.x-p.x)*(e.y-p.y)/(f.y-p.y)+p.x&&(i=!i)}return i}function o0(r,e,i,s,u){for(const f of r)if(e<=f.x&&i<=f.y&&s>=f.x&&u>=f.y)return!0;const p=[new J(e,i),new J(e,u),new J(s,u),new J(s,i)];if(r.length>2){for(const f of p)if(Cl(r,f))return!0}for(let f=0;f<r.length-1;f++)if(V2(r[f],r[f+1],p))return!0;return!1}function V2(r,e,i){const s=i[0],u=i[2];if(r.x<s.x&&e.x<s.x||r.x>u.x&&e.x>u.x||r.y<s.y&&e.y<s.y||r.y>u.y&&e.y>u.y)return!1;const p=ut(r,e,i[0]);return p!==ut(r,e,i[1])||p!==ut(r,e,i[2])||p!==ut(r,e,i[3])}function kl(r,e,i){const s=e.paint.get(r).value;return s.kind==="constant"?s.value:i.programConfigurations.get(e.id).getMaxValue(r)}function Fd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function s0(r,e,i,s,u){if(!e[0]&&!e[1])return r;const p=J.convert(e)._mult(u);i==="viewport"&&p._rotate(-s);const f=[];for(let y=0;y<r.length;y++)f.push(r[y].sub(p));return f}function a0(r,e,i,s){const u=J.convert(r)._mult(s);return e==="viewport"&&u._rotate(-i),u}rt("CircleBucket",om,{omit:["layers"]});const $2=new Ee({"circle-sort-key":new pe(ae.layout_circle["circle-sort-key"])});var j2={paint:new Ee({"circle-radius":new pe(ae.paint_circle["circle-radius"]),"circle-color":new pe(ae.paint_circle["circle-color"]),"circle-blur":new pe(ae.paint_circle["circle-blur"]),"circle-opacity":new pe(ae.paint_circle["circle-opacity"]),"circle-translate":new Y(ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Y(ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Y(ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Y(ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pe(ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pe(ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pe(ae.paint_circle["circle-stroke-opacity"])}),layout:$2},Kr=typeof Float32Array!="undefined"?Float32Array:Array;function l0(){var r=new Kr(9);return Kr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function lm(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function c0(r,e,i){var s=e[0],u=e[1],p=e[2],f=e[3],y=e[4],v=e[5],b=e[6],E=e[7],I=e[8],A=e[9],P=e[10],N=e[11],U=e[12],K=e[13],ie=e[14],he=e[15],_e=i[0],ye=i[1],we=i[2],be=i[3];return r[0]=_e*s+ye*y+we*I+be*U,r[1]=_e*u+ye*v+we*A+be*K,r[2]=_e*p+ye*b+we*P+be*ie,r[3]=_e*f+ye*E+we*N+be*he,r[4]=(_e=i[4])*s+(ye=i[5])*y+(we=i[6])*I+(be=i[7])*U,r[5]=_e*u+ye*v+we*A+be*K,r[6]=_e*p+ye*b+we*P+be*ie,r[7]=_e*f+ye*E+we*N+be*he,r[8]=(_e=i[8])*s+(ye=i[9])*y+(we=i[10])*I+(be=i[11])*U,r[9]=_e*u+ye*v+we*A+be*K,r[10]=_e*p+ye*b+we*P+be*ie,r[11]=_e*f+ye*E+we*N+be*he,r[12]=(_e=i[12])*s+(ye=i[13])*y+(we=i[14])*I+(be=i[15])*U,r[13]=_e*u+ye*v+we*A+be*K,r[14]=_e*p+ye*b+we*P+be*ie,r[15]=_e*f+ye*E+we*N+be*he,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var G2=c0;function Od(){var r=new Kr(3);return Kr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function u0(r){return Math.hypot(r[0],r[1],r[2])}function Il(r,e,i){var s=new Kr(3);return s[0]=r,s[1]=e,s[2]=i,s}function h0(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r}function d0(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r}function p0(r,e,i,s){return r[0]=e[0]+i[0]*s,r[1]=e[1]+i[1]*s,r[2]=e[2]+i[2]*s,r}function f0(r,e){var i=e[0],s=e[1],u=e[2],p=i*i+s*s+u*u;return p>0&&(p=1/Math.sqrt(p)),r[0]=e[0]*p,r[1]=e[1]*p,r[2]=e[2]*p,r}function m0(r,e,i){var s=i[0],u=i[1],p=i[2],f=e[0],y=e[1],v=e[2],b=u*v-p*y,E=p*f-s*v,I=s*y-u*f,A=u*I-p*E,P=p*b-s*I,N=s*E-u*b,U=2*i[3];return E*=U,I*=U,P*=2,N*=2,r[0]=f+(b*=U)+(A*=2),r[1]=y+E+P,r[2]=v+I+N,r}var _u,Z2=h0,q2=d0,W2=u0;function yu(r,e,i){var s=e[0],u=e[1],p=e[2],f=e[3];return r[0]=i[0]*s+i[4]*u+i[8]*p+i[12]*f,r[1]=i[1]*s+i[5]*u+i[9]*p+i[13]*f,r[2]=i[2]*s+i[6]*u+i[10]*p+i[14]*f,r[3]=i[3]*s+i[7]*u+i[11]*p+i[15]*f,r}function cm(){var r=new Kr(4);return Kr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function g0(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function _0(r,e,i){i*=.5;var s=e[0],u=e[1],p=e[2],f=e[3],y=Math.sin(i),v=Math.cos(i);return r[0]=s*v+f*y,r[1]=u*v+p*y,r[2]=p*v-u*y,r[3]=f*v-s*y,r}function y0(r,e,i,s,u,p,f,y,v){if(p&&r.queryGeometry.isAboveHorizon)return!1;p&&(v*=r.pixelToTileUnitsFactor);for(const b of e)for(const E of b){const I=E.add(y),A=u&&i.elevation?i.elevation.exaggeration()*u.getElevationAt(I.x,I.y,!0):0,P=p?I:X2(I,A,s),N=p?r.tilespaceRays.map(K=>K2(K,A)):r.queryGeometry.screenGeometry,U=yu([],[E.x,E.y,A,1],s);if(!f&&p?v*=U[3]/i.cameraToCenterDistance:f&&!p&&(v*=i.cameraToCenterDistance/U[3]),O2(N,P,v))return!0}return!1}function X2(r,e,i){const s=yu([],[r.x,r.y,e,1],i);return new J(s[0]/s[3],s[1]/s[3])}Od(),_u=new Kr(4),Kr!=Float32Array&&(_u[0]=0,_u[1]=0,_u[2]=0,_u[3]=0),Od(),Il(1,0,0),Il(0,1,0),cm(),cm(),l0();const x0=Il(0,0,0),H2=Il(0,0,1);function K2(r,e){const i=Od();return x0[2]=e,r.intersectsPlane(x0,H2,i),new J(i[0],i[1])}class v0 extends om{}function um(r,{width:e,height:i},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*i*s);return r.width=e,r.height=i,r.data=u,r}function w0(r,{width:e,height:i},s){if(e===r.width&&i===r.height)return;const u=um({},{width:e,height:i},s);hm(r,u,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,i)},s),r.width=e,r.height=i,r.data=u.data}function hm(r,e,i,s,u,p){if(u.width===0||u.height===0)return e;if(u.width>r.width||u.height>r.height||i.x>r.width-u.width||i.y>r.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const f=r.data,y=e.data;for(let v=0;v<u.height;v++){const b=((i.y+v)*r.width+i.x)*p,E=((s.y+v)*e.width+s.x)*p;for(let I=0;I<u.width*p;I++)y[E+I]=f[b+I]}return e}rt("HeatmapBucket",v0,{omit:["layers"]});class ms{constructor(e,i){um(this,e,1,i)}resize(e){w0(this,e,1)}clone(){return new ms({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,u,p){hm(e,i,s,u,p,1)}}class mi{constructor(e,i){um(this,e,4,i)}resize(e){w0(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new mi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,u,p){hm(e,i,s,u,p,4)}}rt("AlphaImage",ms),rt("RGBAImage",mi);var Y2={paint:new Ee({"heatmap-radius":new pe(ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pe(ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Y(ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new de(ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Y(ae.paint_heatmap["heatmap-opacity"])})};function dm(r){const e={},i=r.resolution||256,s=r.clips?r.clips.length:1,u=r.image||new mi({width:i,height:s}),p=(f,y,v)=>{e[r.evaluationKey]=v;const b=r.expression.evaluate(e);u.data[f+y+0]=Math.floor(255*b.r/b.a),u.data[f+y+1]=Math.floor(255*b.g/b.a),u.data[f+y+2]=Math.floor(255*b.b/b.a),u.data[f+y+3]=Math.floor(255*b.a)};if(r.clips)for(let f=0,y=0;f<s;++f,y+=4*i)for(let v=0,b=0;v<i;v++,b+=4){const E=v/(i-1),{start:I,end:A}=r.clips[f];p(y,b,I*(1-E)+A*E)}else for(let f=0,y=0;f<i;f++,y+=4)p(0,y,f/(i-1));return u}var Q2={paint:new Ee({"hillshade-illumination-direction":new Y(ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Y(ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Y(ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Y(ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Y(ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Y(ae.paint_hillshade["hillshade-accent-color"])})};const J2=it([{name:"a_pos",components:2,type:"Int16"}],4),{members:eT}=J2;var pm=Nd,tT=Nd;function Nd(r,e,i){i=i||2;var s,u,p,f,y,v,b,E=e&&e.length,I=E?e[0]*i:r.length,A=b0(r,0,I,i,!0),P=[];if(!A||A.next===A.prev)return P;if(E&&(A=function(U,K,ie,he){var _e,ye,we,be=[];for(_e=0,ye=K.length;_e<ye;_e++)(we=b0(U,K[_e]*he,_e<ye-1?K[_e+1]*he:U.length,he,!1))===we.next&&(we.steiner=!0),be.push(cT(we));for(be.sort(sT),_e=0;_e<be.length;_e++)aT(be[_e],ie),ie=gs(ie,ie.next);return ie}(r,e,A,i)),r.length>80*i){s=p=r[0],u=f=r[1];for(var N=i;N<I;N+=i)(y=r[N])<s&&(s=y),(v=r[N+1])<u&&(u=v),y>p&&(p=y),v>f&&(f=v);b=(b=Math.max(p-s,f-u))!==0?1/b:0}return xu(A,P,i,s,u,b),P}function b0(r,e,i,s,u){var p,f;if(u===gm(r,e,i,s)>0)for(p=e;p<i;p+=s)f=E0(p,r[p],r[p+1],f);else for(p=i-s;p>=e;p-=s)f=E0(p,r[p],r[p+1],f);return f&&Ud(f,f.next)&&(wu(f),f=f.next),f}function gs(r,e){if(!r)return r;e||(e=r);var i,s=r;do if(i=!1,s.steiner||!Ud(s,s.next)&&Bn(s.prev,s,s.next)!==0)s=s.next;else{if(wu(s),(s=e=s.prev)===s.next)break;i=!0}while(i||s!==e);return e}function xu(r,e,i,s,u,p,f){if(r){!f&&p&&function(E,I,A,P){var N=E;do N.z===null&&(N.z=fm(N.x,N.y,I,A,P)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==E);N.prevZ.nextZ=null,N.prevZ=null,function(U){var K,ie,he,_e,ye,we,be,Me,Fe=1;do{for(ie=U,U=null,ye=null,we=0;ie;){for(we++,he=ie,be=0,K=0;K<Fe&&(be++,he=he.nextZ);K++);for(Me=Fe;be>0||Me>0&&he;)be!==0&&(Me===0||!he||ie.z<=he.z)?(_e=ie,ie=ie.nextZ,be--):(_e=he,he=he.nextZ,Me--),ye?ye.nextZ=_e:U=_e,_e.prevZ=ye,ye=_e;ie=he}ye.nextZ=null,Fe*=2}while(we>1)}(N)}(r,s,u,p);for(var y,v,b=r;r.prev!==r.next;)if(y=r.prev,v=r.next,p?rT(r,s,u,p):nT(r))e.push(y.i/i),e.push(r.i/i),e.push(v.i/i),wu(r),r=v.next,b=v.next;else if((r=v)===b){f?f===1?xu(r=iT(gs(r),e,i),e,i,s,u,p,2):f===2&&oT(r,e,i,s,u,p):xu(gs(r),e,i,s,u,p,1);break}}}function nT(r){var e=r.prev,i=r,s=r.next;if(Bn(e,i,s)>=0)return!1;for(var u=r.next.next;u!==r.prev;){if(Al(e.x,e.y,i.x,i.y,s.x,s.y,u.x,u.y)&&Bn(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function rT(r,e,i,s){var u=r.prev,p=r,f=r.next;if(Bn(u,p,f)>=0)return!1;for(var y=u.x>p.x?u.x>f.x?u.x:f.x:p.x>f.x?p.x:f.x,v=u.y>p.y?u.y>f.y?u.y:f.y:p.y>f.y?p.y:f.y,b=fm(u.x<p.x?u.x<f.x?u.x:f.x:p.x<f.x?p.x:f.x,u.y<p.y?u.y<f.y?u.y:f.y:p.y<f.y?p.y:f.y,e,i,s),E=fm(y,v,e,i,s),I=r.prevZ,A=r.nextZ;I&&I.z>=b&&A&&A.z<=E;){if(I!==r.prev&&I!==r.next&&Al(u.x,u.y,p.x,p.y,f.x,f.y,I.x,I.y)&&Bn(I.prev,I,I.next)>=0||(I=I.prevZ,A!==r.prev&&A!==r.next&&Al(u.x,u.y,p.x,p.y,f.x,f.y,A.x,A.y)&&Bn(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;I&&I.z>=b;){if(I!==r.prev&&I!==r.next&&Al(u.x,u.y,p.x,p.y,f.x,f.y,I.x,I.y)&&Bn(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;A&&A.z<=E;){if(A!==r.prev&&A!==r.next&&Al(u.x,u.y,p.x,p.y,f.x,f.y,A.x,A.y)&&Bn(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function iT(r,e,i){var s=r;do{var u=s.prev,p=s.next.next;!Ud(u,p)&&T0(u,s,s.next,p)&&vu(u,p)&&vu(p,u)&&(e.push(u.i/i),e.push(s.i/i),e.push(p.i/i),wu(s),wu(s.next),s=r=p),s=s.next}while(s!==r);return gs(s)}function oT(r,e,i,s,u,p){var f=r;do{for(var y=f.next.next;y!==f.prev;){if(f.i!==y.i&&uT(f,y)){var v=S0(f,y);return f=gs(f,f.next),v=gs(v,v.next),xu(f,e,i,s,u,p),void xu(v,e,i,s,u,p)}y=y.next}f=f.next}while(f!==r)}function sT(r,e){return r.x-e.x}function aT(r,e){if(e=function(s,u){var p,f=u,y=s.x,v=s.y,b=-1/0;do{if(v<=f.y&&v>=f.next.y&&f.next.y!==f.y){var E=f.x+(v-f.y)*(f.next.x-f.x)/(f.next.y-f.y);if(E<=y&&E>b){if(b=E,E===y){if(v===f.y)return f;if(v===f.next.y)return f.next}p=f.x<f.next.x?f:f.next}}f=f.next}while(f!==u);if(!p)return null;if(y===b)return p;var I,A=p,P=p.x,N=p.y,U=1/0;f=p;do y>=f.x&&f.x>=P&&y!==f.x&&Al(v<N?y:b,v,P,N,v<N?b:y,v,f.x,f.y)&&(I=Math.abs(v-f.y)/(y-f.x),vu(f,s)&&(I<U||I===U&&(f.x>p.x||f.x===p.x&&lT(p,f)))&&(p=f,U=I)),f=f.next;while(f!==A);return p}(r,e)){var i=S0(e,r);gs(e,e.next),gs(i,i.next)}}function lT(r,e){return Bn(r.prev,r,e.prev)<0&&Bn(e.next,r,r.next)<0}function fm(r,e,i,s,u){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-i)*u)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*u)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function cT(r){var e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function Al(r,e,i,s,u,p,f,y){return(u-f)*(e-y)-(r-f)*(p-y)>=0&&(r-f)*(s-y)-(i-f)*(e-y)>=0&&(i-f)*(p-y)-(u-f)*(s-y)>=0}function uT(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(i,s){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==s.i&&u.next.i!==s.i&&T0(u,u.next,i,s))return!0;u=u.next}while(u!==i);return!1}(r,e)&&(vu(r,e)&&vu(e,r)&&function(i,s){var u=i,p=!1,f=(i.x+s.x)/2,y=(i.y+s.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&f<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next;while(u!==i);return p}(r,e)&&(Bn(r.prev,r,e.prev)||Bn(r,e.prev,e))||Ud(r,e)&&Bn(r.prev,r,r.next)>0&&Bn(e.prev,e,e.next)>0)}function Bn(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function Ud(r,e){return r.x===e.x&&r.y===e.y}function T0(r,e,i,s){var u=$d(Bn(r,e,i)),p=$d(Bn(r,e,s)),f=$d(Bn(i,s,r)),y=$d(Bn(i,s,e));return u!==p&&f!==y||!(u!==0||!Vd(r,i,e))||!(p!==0||!Vd(r,s,e))||!(f!==0||!Vd(i,r,s))||!(y!==0||!Vd(i,e,s))}function Vd(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function $d(r){return r>0?1:r<0?-1:0}function vu(r,e){return Bn(r.prev,r,r.next)<0?Bn(r,e,r.next)>=0&&Bn(r,r.prev,e)>=0:Bn(r,e,r.prev)<0||Bn(r,r.next,e)<0}function S0(r,e){var i=new mm(r.i,r.x,r.y),s=new mm(e.i,e.x,e.y),u=r.next,p=e.prev;return r.next=e,e.prev=r,i.next=u,u.prev=i,s.next=i,i.prev=s,p.next=s,s.prev=p,s}function E0(r,e,i,s){var u=new mm(r,e,i);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function wu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function mm(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function gm(r,e,i,s){for(var u=0,p=e,f=i-s;p<i;p+=s)u+=(r[f]-r[p])*(r[p+1]+r[f+1]),f=p;return u}function hT(r,e,i,s,u){C0(r,e,i||0,s||r.length-1,u||dT)}function C0(r,e,i,s,u){for(;s>i;){if(s-i>600){var p=s-i+1,f=e-i+1,y=Math.log(p),v=.5*Math.exp(2*y/3),b=.5*Math.sqrt(y*v*(p-v)/p)*(f-p/2<0?-1:1);C0(r,e,Math.max(i,Math.floor(e-f*v/p+b)),Math.min(s,Math.floor(e+(p-f)*v/p+b)),u)}var E=r[e],I=i,A=s;for(bu(r,i,e),u(r[s],E)>0&&bu(r,i,s);I<A;){for(bu(r,I,A),I++,A--;u(r[I],E)<0;)I++;for(;u(r[A],E)>0;)A--}u(r[i],E)===0?bu(r,i,A):bu(r,++A,s),A<=e&&(i=A+1),e<=A&&(s=A-1)}}function bu(r,e,i){var s=r[e];r[e]=r[i],r[i]=s}function dT(r,e){return r<e?-1:r>e?1:0}function _m(r,e){const i=r.length;if(i<=1)return[r];const s=[];let u,p;for(let f=0;f<i;f++){const y=Mt(r[f]);y!==0&&(r[f].area=Math.abs(y),p===void 0&&(p=y<0),p===y<0?(u&&s.push(u),u=[r[f]]):u.push(r[f]))}if(u&&s.push(u),e>1)for(let f=0;f<s.length;f++)s[f].length<=e||(hT(s[f],e,1,s[f].length-1,pT),s[f]=s[f].slice(0,e));return s}function pT(r,e){return e.area-r.area}function ym(r,e,i){const s=i.patternDependencies;let u=!1;for(const p of e){const f=p.paint.get(`${r}-pattern`);f.isConstant()||(u=!0);const y=f.constantOr(null);y&&(u=!0,s[y.to]=!0,s[y.from]=!0)}return u}function xm(r,e,i,s,u){const p=u.patternDependencies;for(const f of e){const y=f.paint.get(`${r}-pattern`).value;if(y.kind!=="constant"){let v=y.evaluate({zoom:s-1},i,{},u.availableImages),b=y.evaluate({zoom:s},i,{},u.availableImages),E=y.evaluate({zoom:s+1},i,{},u.availableImages);v=v&&v.name?v.name:v,b=b&&b.name?b.name:b,E=E&&E.name?E.name:E,p[v]=!0,p[b]=!0,p[E]=!0,i.patterns[f.id]={min:v,mid:b,max:E}}}return i}Nd.deviation=function(r,e,i,s){var u=e&&e.length,p=Math.abs(gm(r,0,u?e[0]*i:r.length,i));if(u)for(var f=0,y=e.length;f<y;f++)p-=Math.abs(gm(r,e[f]*i,f<y-1?e[f+1]*i:r.length,i));var v=0;for(f=0;f<s.length;f+=3){var b=s[f]*i,E=s[f+1]*i,I=s[f+2]*i;v+=Math.abs((r[b]-r[I])*(r[E+1]-r[b+1])-(r[b]-r[E])*(r[I+1]-r[b+1]))}return p===0&&v===0?0:Math.abs((v-p)/p)},Nd.flatten=function(r){for(var e=r[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,u=0;u<r.length;u++){for(var p=0;p<r[u].length;p++)for(var f=0;f<e;f++)i.vertices.push(r[u][p][f]);u>0&&i.holes.push(s+=r[u-1].length)}return i},pm.default=tT;class vm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gt,this.indexArray=new nn,this.indexArray2=new er,this.programConfigurations=new _a(e.layers,e.zoom),this.segments=new _r,this.segments2=new _r,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){this.hasPattern=ym("fill",this.layers,i);const u=this.layers[0].layout.get("fill-sort-key"),p=[];for(const{feature:f,id:y,index:v,sourceLayerIndex:b}of e){const E=this.layers[0]._featureFilter.needGeometry,I=xa(f,E);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),I,s))continue;const A=u?u.evaluate(I,{},s,i.availableImages):void 0,P={id:y,properties:f.properties,type:f.type,sourceLayerIndex:b,index:v,geometry:E?I.geometry:ya(f),patterns:{},sortKey:A};p.push(P)}u&&p.sort((f,y)=>f.sortKey-y.sortKey);for(const f of p){const{geometry:y,index:v,sourceLayerIndex:b}=f;if(this.hasPattern){const E=xm("fill",this.layers,f,this.zoom,i);this.patternFeatures.push(E)}else this.addFeature(f,y,v,s,{});i.featureIndex.insert(e[v].feature,y,v,b,this.index)}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}addFeatures(e,i,s){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,i,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,eT),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,s,u,p){for(const f of _m(i,500)){let y=0;for(const P of f)y+=P.length;const v=this.segments.prepareSegment(y,this.layoutVertexArray,this.indexArray),b=v.vertexLength,E=[],I=[];for(const P of f){if(P.length===0)continue;P!==f[0]&&I.push(E.length/2);const N=this.segments2.prepareSegment(P.length,this.layoutVertexArray,this.indexArray2),U=N.vertexLength;this.layoutVertexArray.emplaceBack(P[0].x,P[0].y),this.indexArray2.emplaceBack(U+P.length-1,U),E.push(P[0].x),E.push(P[0].y);for(let K=1;K<P.length;K++)this.layoutVertexArray.emplaceBack(P[K].x,P[K].y),this.indexArray2.emplaceBack(U+K-1,U+K),E.push(P[K].x),E.push(P[K].y);N.vertexLength+=P.length,N.primitiveLength+=P.length}const A=pm(E,I);for(let P=0;P<A.length;P+=3)this.indexArray.emplaceBack(b+A[P],b+A[P+1],b+A[P+2]);v.vertexLength+=y,v.primitiveLength+=A.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,u)}}rt("FillBucket",vm,{omit:["layers","patternFeatures"]});const fT=new Ee({"fill-sort-key":new pe(ae.layout_fill["fill-sort-key"])});var mT={paint:new Ee({"fill-antialias":new Y(ae.paint_fill["fill-antialias"]),"fill-opacity":new pe(ae.paint_fill["fill-opacity"]),"fill-color":new pe(ae.paint_fill["fill-color"]),"fill-outline-color":new pe(ae.paint_fill["fill-outline-color"]),"fill-translate":new Y(ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Y(ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new ke(ae.paint_fill["fill-pattern"])}),layout:fT};const gT=it([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),_T=it([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:yT}=gT;var k0=Ml;function Ml(r,e,i,s,u){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=s,this._values=u,r.readFields(xT,this,e)}function xT(r,e,i){r==1?e.id=i.readVarint():r==2?function(s,u){for(var p=s.readVarint()+s.pos;s.pos<p;){var f=u._keys[s.readVarint()],y=u._values[s.readVarint()];u.properties[f]=y}}(i,e):r==3?e.type=i.readVarint():r==4&&(e._geometry=i.pos)}function vT(r){for(var e,i,s=0,u=0,p=r.length,f=p-1;u<p;f=u++)s+=((i=r[f]).x-(e=r[u]).x)*(e.y+i.y);return s}Ml.types=["Unknown","Point","LineString","Polygon"],Ml.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,i=r.readVarint()+r.pos,s=1,u=0,p=0,f=0,y=[];r.pos<i;){if(u<=0){var v=r.readVarint();s=7&v,u=v>>3}if(u--,s===1||s===2)p+=r.readSVarint(),f+=r.readSVarint(),s===1&&(e&&y.push(e),e=[]),e.push(new J(p,f));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&y.push(e),y},Ml.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,i=1,s=0,u=0,p=0,f=1/0,y=-1/0,v=1/0,b=-1/0;r.pos<e;){if(s<=0){var E=r.readVarint();i=7&E,s=E>>3}if(s--,i===1||i===2)(u+=r.readSVarint())<f&&(f=u),u>y&&(y=u),(p+=r.readSVarint())<v&&(v=p),p>b&&(b=p);else if(i!==7)throw new Error("unknown command "+i)}return[f,v,y,b]},Ml.prototype.toGeoJSON=function(r,e,i){var s,u,p=this.extent*Math.pow(2,i),f=this.extent*r,y=this.extent*e,v=this.loadGeometry(),b=Ml.types[this.type];function E(P){for(var N=0;N<P.length;N++){var U=P[N];P[N]=[360*(U.x+f)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+y)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(s=0;s<v.length;s++)I[s]=v[s][0];E(v=I);break;case 2:for(s=0;s<v.length;s++)E(v[s]);break;case 3:for(v=function(P){var N=P.length;if(N<=1)return[P];for(var U,K,ie=[],he=0;he<N;he++){var _e=vT(P[he]);_e!==0&&(K===void 0&&(K=_e<0),K===_e<0?(U&&ie.push(U),U=[P[he]]):U.push(P[he]))}return U&&ie.push(U),ie}(v),s=0;s<v.length;s++)for(u=0;u<v[s].length;u++)E(v[s][u])}v.length===1?v=v[0]:b="Multi"+b;var A={type:"Feature",geometry:{type:b,coordinates:v},properties:this.properties};return"id"in this&&(A.id=this.id),A};var I0=A0;function A0(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(wT,this,e),this.length=this._features.length}function wT(r,e,i){r===15?e.version=i.readVarint():r===1?e.name=i.readString():r===5?e.extent=i.readVarint():r===2?e._features.push(i.pos):r===3?e._keys.push(i.readString()):r===4&&e._values.push(function(s){for(var u=null,p=s.readVarint()+s.pos;s.pos<p;){var f=s.readVarint()>>3;u=f===1?s.readString():f===2?s.readFloat():f===3?s.readDouble():f===4?s.readVarint64():f===5?s.readVarint():f===6?s.readSVarint():f===7?s.readBoolean():null}return u}(i))}function bT(r,e,i){if(r===3){var s=new I0(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}A0.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new k0(this._pbf,e,this.extent,this._keys,this._values)};var va={VectorTile:function(r,e){this.layers=r.readFields(bT,{},e)},VectorTileFeature:k0,VectorTileLayer:I0};const TT=va.VectorTileFeature.types,ST=Math.pow(2,13);function Tu(r,e,i,s,u,p,f,y){r.emplaceBack((e<<1)+f,(i<<1)+p,(Math.floor(s*ST)<<1)+u,Math.round(y))}class M0{constructor(){this.acc=new J(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new J(e.x,e.y),this.max=new J(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);let s=!!this.borders;const u=this.min,p=this.max;e.x<u.x?(u.x=e.x,s=!0):e.x>p.x&&(p.x=e.x,s=!0),e.y<u.y?(u.y=e.y,s=!0):e.y>p.y&&(p.y=e.y,s=!0),((e.x===0||e.x===Kt)&&e.x===i.x)!=((e.y===0||e.y===Kt)&&e.y===i.y)&&this.processBorderOverlap(e,i),s&&this.checkBorderIntersection(e,i)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,Ut(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Kt!=e.x>Kt&&this.addBorderIntersection(1,Ut(i.y,e.y,(Kt-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Ut(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Kt!=e.y>Kt&&this.addBorderIntersection(3,Ut(i.x,e.x,(Kt-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];i<s[0]&&(s[0]=i),i>s[1]&&(s[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const s=e.x===0?0:1;this.addBorderIntersection(s,i.y),this.addBorderIntersection(s,e.y)}else{const s=e.y===0?2:3;this.addBorderIntersection(s,i.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((i,s)=>i+s.edges,0);return e!==0?this.acc.div(e)._round():new J(0,0)}span(){return new J(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class wm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new vn,this.centroidVertexArray=new Xy,this.indexArray=new nn,this.programConfigurations=new _a(e.layers,e.zoom),this.segments=new _r,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,s){this.features=[],this.hasPattern=ym("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(u){const p=Math.exp(Math.PI*(1-u.y/(1<<u.z)*2));return 80150034*p/(p*p+1)/Kt/(1<<u.z)}(s);for(const{feature:u,id:p,index:f,sourceLayerIndex:y}of e){const v=this.layers[0]._featureFilter.needGeometry,b=xa(u,v);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),b,s))continue;const E={id:p,sourceLayerIndex:y,index:f,geometry:v?b.geometry:ya(u),properties:u.properties,type:u.type,patterns:{}},I=this.layoutVertexArray.length;this.hasPattern?this.features.push(xm("fill-extrusion",this.layers,E,this.zoom,i)):this.addFeature(E,E.geometry,f,s,{}),i.featureIndex.insert(u,E.geometry,f,y,this.index,I)}this.sortBorders()}addFeatures(e,i,s){for(const u of this.features){const{geometry:p}=u;this.addFeature(u,p,u.index,i,s)}this.sortBorders()}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,yT),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,_T.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,u,p){const f=this.enableTerrain?new M0:null;for(const v of _m(i,500)){let b=0,E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(v.length===0||(y=v[0]).every(U=>U.x<=0)||y.every(U=>U.x>=Kt)||y.every(U=>U.y<=0)||y.every(U=>U.y>=Kt))continue;for(let U=0;U<v.length;U++){const K=v[U];if(K.length===0)continue;b+=K.length;let ie=0;f&&f.startRing(K[0]);for(let he=0;he<K.length;he++){const _e=K[he];if(he>=1){const ye=K[he-1];if(!ET(_e,ye)){f&&f.append(_e,ye),E.vertexLength+4>_r.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const we=_e.sub(ye)._perp(),be=we.x/(Math.abs(we.x)+Math.abs(we.y)),Me=we.y>0?1:0,Fe=ye.dist(_e);ie+Fe>32768&&(ie=0),Tu(this.layoutVertexArray,_e.x,_e.y,be,Me,0,0,ie),Tu(this.layoutVertexArray,_e.x,_e.y,be,Me,0,1,ie),ie+=Fe,Tu(this.layoutVertexArray,ye.x,ye.y,be,Me,0,0,ie),Tu(this.layoutVertexArray,ye.x,ye.y,be,Me,0,1,ie);const Ne=E.vertexLength;this.indexArray.emplaceBack(Ne,Ne+2,Ne+1),this.indexArray.emplaceBack(Ne+1,Ne+2,Ne+3),E.vertexLength+=4,E.primitiveLength+=2}}}}if(E.vertexLength+b>_r.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),TT[e.type]!=="Polygon")continue;const I=[],A=[],P=E.vertexLength;for(let U=0;U<v.length;U++){const K=v[U];if(K.length!==0){K!==v[0]&&A.push(I.length/2);for(let ie=0;ie<K.length;ie++){const he=K[ie];Tu(this.layoutVertexArray,he.x,he.y,0,0,1,1,0),I.push(he.x),I.push(he.y),f&&f.currentPolyCount.top++}}}const N=pm(I,A);for(let U=0;U<N.length;U+=3)this.indexArray.emplaceBack(P+N[U],P+N[U+2],P+N[U+1]);E.primitiveLength+=N.length/3,E.vertexLength+=b}var y;if(f&&f.polyCount.length>0){if(f.borders){f.vertexArrayOffset=this.centroidVertexArray.length;const v=f.borders,b=this.featuresOnBorder.push(f)-1;for(let E=0;E<4;E++)v[E][0]!==Number.MAX_VALUE&&this.borders[E].push(b)}this.encodeCentroid(f.borders?void 0:f.centroid(),f)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,s)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,i,s=!0){let u,p;if(e)if(e.y!==0){const y=i.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),p=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else u=Math.ceil(7*(e.x+450)),p=0;else u=0,p=+s;let f=s?this.centroidVertexArray.length:i.vertexArrayOffset;for(const y of i.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let v=0;v<2*y.edges;v++)this.centroidVertexArray.emplace(f++,0,p),this.centroidVertexArray.emplace(f++,u,p);for(let v=0;v<y.top;v++)this.centroidVertexArray.emplace(f++,u,p)}}}function ET(r,e){return r.x===e.x&&(r.x<0||r.x>Kt)||r.y===e.y&&(r.y<0||r.y>Kt)}rt("FillExtrusionBucket",wm,{omit:["layers","features"]}),rt("PartMetadata",M0);var CT={paint:new Ee({"fill-extrusion-opacity":new Y(ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pe(ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Y(ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Y(ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ke(ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pe(ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pe(ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Y(ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Su(r,e){return r.x*e.x+r.y*e.y}function z0(r,e){if(r.length===1){let i=0;const s=e[i++];let u;for(;!u||s.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const p=e[i],f=r[0],y=u.sub(s),v=p.sub(s),b=f.sub(s),E=Su(y,y),I=Su(y,v),A=Su(v,v),P=Su(b,y),N=Su(b,v),U=E*A-I*I,K=(A*P-I*N)/U,ie=(E*N-I*P)/U,he=s.z*(1-K-ie)+u.z*K+p.z*ie;if(isFinite(he))return he}return 1/0}{let i=1/0;for(const s of e)i=Math.min(i,s.z);return i}}function P0(r){const e=new J(r[0],r[1]);return e.z=r[2],e}function kT(r,e,i,s,u,p,f,y){const v=f*u.getElevationAt(r,e,!0,!0),b=p[0]!==0,E=b?p[1]===0?f*(p[0]/7-450):f*function(I,A,P){const N=Math.floor(A[0]/8),U=Math.floor(A[1]/8),K=10*(A[0]-8*N),ie=10*(A[1]-8*U),he=I.getElevationAt(N,U,!0,!0),_e=I.getMeterToDEM(P),ye=Math.floor(.5*(K*_e-1)),we=Math.floor(.5*(ie*_e-1)),be=I.tileCoordToPixel(N,U),Me=2*ye+1,Fe=2*we+1,Ne=function(ht,nt,jt,pt,Dt){return[ht.getElevationAtPixel(nt,jt,!0),ht.getElevationAtPixel(nt+Dt,jt,!0),ht.getElevationAtPixel(nt,jt+Dt,!0),ht.getElevationAtPixel(nt+pt,jt+Dt,!0)]}(I,be.x-ye,be.y-we,Me,Fe),Ge=Math.abs(Ne[0]-Ne[1]),Pe=Math.abs(Ne[2]-Ne[3]),Be=Math.abs(Ne[0]-Ne[2])+Math.abs(Ne[1]-Ne[3]),qe=Math.min(.25,.5*_e*(Ge+Pe)/Me),Re=Math.min(.25,.5*_e*Be/Fe);return he+Math.max(qe*K,Re*ie)}(u,p,y):v;return{base:v+(i===0)?-1:i,top:b?Math.max(E+s,v+i+2):v+s}}const IT=it([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:AT}=IT,MT=it([{name:"a_packed",components:3,type:"Float32"}]),{members:zT}=MT,PT=va.VectorTileFeature.types,DT=Math.cos(Math.PI/180*37.5);class bm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new dn,this.layoutVertexArray2=new xt,this.indexArray=new nn,this.programConfigurations=new _a(e.layers,e.zoom),this.segments=new _r,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){this.hasPattern=ym("line",this.layers,i);const u=this.layers[0].layout.get("line-sort-key"),p=[];for(const{feature:b,id:E,index:I,sourceLayerIndex:A}of e){const P=this.layers[0]._featureFilter.needGeometry,N=xa(b,P);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),N,s))continue;const U=u?u.evaluate(N,{},s):void 0,K={id:E,properties:b.properties,type:b.type,sourceLayerIndex:A,index:I,geometry:P?N.geometry:ya(b),patterns:{},sortKey:U};p.push(K)}u&&p.sort((b,E)=>b.sortKey-E.sortKey);const{lineAtlas:f,featureIndex:y}=i,v=this.addConstantDashes(f);for(const b of p){const{geometry:E,index:I,sourceLayerIndex:A}=b;if(v&&this.addFeatureDashes(b,f),this.hasPattern){const P=xm("line",this.layers,b,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(b,E,I,s,f.positions);y.insert(e[I].feature,E,I,A,this.index)}}addConstantDashes(e){let i=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,p=s.layout.get("line-cap").value;if(u.kind!=="constant"||p.kind!=="constant")i=!0;else{const f=p.value,y=u.value;if(!y)continue;e.addDash(y.from,f),e.addDash(y.to,f),y.other&&e.addDash(y.other,f)}}return i}addFeatureDashes(e,i){const s=this.zoom;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,f=u.layout.get("line-cap").value;if(p.kind==="constant"&&f.kind==="constant")continue;let y,v,b,E,I,A;if(p.kind==="constant"){const K=p.value;if(!K)continue;y=K.other||K.to,v=K.to,b=K.from}else y=p.evaluate({zoom:s-1},e),v=p.evaluate({zoom:s},e),b=p.evaluate({zoom:s+1},e);f.kind==="constant"?E=I=A=f.value:(E=f.evaluate({zoom:s-1},e),I=f.evaluate({zoom:s},e),A=f.evaluate({zoom:s+1},e)),i.addDash(y,E),i.addDash(v,I),i.addDash(b,A);const P=i.getKey(y,E),N=i.getKey(v,I),U=i.getKey(b,A);e.patterns[u.id]={min:P,mid:N,max:U}}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}addFeatures(e,i,s){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,i,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,zT)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,AT),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,s,u,p){const f=this.layers[0].layout,y=f.get("line-join").evaluate(e,{}),v=f.get("line-cap").evaluate(e,{}),b=f.get("line-miter-limit"),E=f.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const I of i)this.addLine(I,e,y,v,b,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,u)}addLine(e,i,s,u,p,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<e.length-1;ie++)this.totalDistance+=e[ie].dist(e[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=PT[i.type]==="Polygon";let v=e.length;for(;v>=2&&e[v-1].equals(e[v-2]);)v--;let b=0;for(;b<v-1&&e[b].equals(e[b+1]);)b++;if(v<(y?3:2))return;s==="bevel"&&(p=1.05);const E=this.overscaling<=16?122880/(512*this.overscaling):0,I=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let A,P,N,U,K;this.e1=this.e2=-1,y&&(A=e[v-2],K=e[b].sub(A)._unit()._perp());for(let ie=b;ie<v;ie++){if(N=ie===v-1?y?e[b+1]:void 0:e[ie+1],N&&e[ie].equals(N))continue;K&&(U=K),A&&(P=A),A=e[ie],K=N?N.sub(A)._unit()._perp():U,U=U||K;let he=U.add(K);he.x===0&&he.y===0||he._unit();const _e=U.x*K.x+U.y*K.y,ye=he.x*K.x+he.y*K.y,we=ye!==0?1/ye:1/0,be=2*Math.sqrt(2-2*ye),Me=ye<DT&&P&&N,Fe=U.x*K.y-U.y*K.x>0;if(Me&&ie>b){const Pe=A.dist(P);if(Pe>2*E){const Be=A.sub(A.sub(P)._mult(E/Pe)._round());this.updateDistance(P,Be),this.addCurrentVertex(Be,U,0,0,I),P=Be}}const Ne=P&&N;let Ge=Ne?s:y?"butt":u;if(Ne&&Ge==="round"&&(we<f?Ge="miter":we<=2&&(Ge="fakeround")),Ge==="miter"&&we>p&&(Ge="bevel"),Ge==="bevel"&&(we>2&&(Ge="flipbevel"),we<p&&(Ge="miter")),P&&this.updateDistance(P,A),Ge==="miter")he._mult(we),this.addCurrentVertex(A,he,0,0,I);else if(Ge==="flipbevel"){if(we>100)he=K.mult(-1);else{const Pe=we*U.add(K).mag()/U.sub(K).mag();he._perp()._mult(Pe*(Fe?-1:1))}this.addCurrentVertex(A,he,0,0,I),this.addCurrentVertex(A,he.mult(-1),0,0,I)}else if(Ge==="bevel"||Ge==="fakeround"){const Pe=-Math.sqrt(we*we-1),Be=Fe?Pe:0,qe=Fe?0:Pe;if(P&&this.addCurrentVertex(A,U,Be,qe,I),Ge==="fakeround"){const Re=Math.round(180*be/Math.PI/20);for(let ht=1;ht<Re;ht++){let nt=ht/Re;if(nt!==.5){const pt=nt-.5;nt+=nt*pt*(nt-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*pt*pt+(.848013+_e*(.215638*_e-1.06021)))}const jt=K.sub(U)._mult(nt)._add(U)._unit()._mult(Fe?-1:1);this.addHalfVertex(A,jt.x,jt.y,!1,Fe,0,I)}}N&&this.addCurrentVertex(A,K,-Be,-qe,I)}else if(Ge==="butt")this.addCurrentVertex(A,he,0,0,I);else if(Ge==="square"){const Pe=P?1:-1;P||this.addCurrentVertex(A,he,Pe,Pe,I),this.addCurrentVertex(A,he,0,0,I),P&&this.addCurrentVertex(A,he,Pe,Pe,I)}else Ge==="round"&&(P&&(this.addCurrentVertex(A,U,0,0,I),this.addCurrentVertex(A,U,1,1,I,!0)),N&&(this.addCurrentVertex(A,K,-1,-1,I,!0),this.addCurrentVertex(A,K,0,0,I)));if(Me&&ie<v-1){const Pe=A.dist(N);if(Pe>2*E){const Be=A.add(N.sub(A)._mult(E/Pe)._round());this.updateDistance(A,Be),this.addCurrentVertex(Be,K,0,0,I),A=Be}}}}addCurrentVertex(e,i,s,u,p,f=!1){const y=i.y*u-i.x,v=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*s,i.y-i.x*s,f,!1,s,p),this.addHalfVertex(e,y,v,f,!0,-u,p)}addHalfVertex({x:e,y:i},s,u,p,f,y,v){this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(i<<1)+(f?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const b=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),v.primitiveLength++),f?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}rt("LineBucket",bm,{omit:["layers","patternFeatures"]});const RT=new Ee({"line-cap":new pe(ae.layout_line["line-cap"]),"line-join":new pe(ae.layout_line["line-join"]),"line-miter-limit":new Y(ae.layout_line["line-miter-limit"]),"line-round-limit":new Y(ae.layout_line["line-round-limit"]),"line-sort-key":new pe(ae.layout_line["line-sort-key"])});var D0={paint:new Ee({"line-opacity":new pe(ae.paint_line["line-opacity"]),"line-color":new pe(ae.paint_line["line-color"]),"line-translate":new Y(ae.paint_line["line-translate"]),"line-translate-anchor":new Y(ae.paint_line["line-translate-anchor"]),"line-width":new pe(ae.paint_line["line-width"]),"line-gap-width":new pe(ae.paint_line["line-gap-width"]),"line-offset":new pe(ae.paint_line["line-offset"]),"line-blur":new pe(ae.paint_line["line-blur"]),"line-dasharray":new ke(ae.paint_line["line-dasharray"]),"line-pattern":new ke(ae.paint_line["line-pattern"]),"line-gradient":new de(ae.paint_line["line-gradient"])}),layout:RT};const R0=new class extends pe{possiblyEvaluate(r,e){return e=new O(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,i,s){return e=ot({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,i,s)}}(D0.paint.properties["line-width"].specification);function L0(r,e){return e>0?e+2*r:r}R0.useIntegerZoom=!0;const LT=it([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),BT=it([{name:"a_projected_pos",components:3,type:"Float32"}],4);it([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const FT=it([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),OT=it([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);it([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const B0=it([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),NT=it([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);it([{name:"triangle",components:3,type:"Uint16"}]),it([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),it([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),it([{type:"Float32",name:"offsetX"}]),it([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var lr=24;const oo=128;function Tm(r,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new O(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:u}=i;let p=0;for(;p<s.length&&s[p]<=r;)p++;p=Math.max(0,p-1);let f=p;for(;f<s.length&&s[f]<r+1;)f++;f=Math.min(s.length-1,f);const y=s[p],v=s[f];return i.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:v,minSize:i.evaluate(new O(y)),maxSize:i.evaluate(new O(v)),interpolationType:u}}}function jd(r,{uSize:e,uSizeT:i},{lowerSize:s,upperSize:u}){return r.kind==="source"?s/oo:r.kind==="composite"?Ut(s/oo,u/oo,i):e}function zl(r,e){let i=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:u,minZoom:p,maxZoom:f}=r,y=u?Ie(Nr.interpolationFactor(u,e,p,f),0,1):0;r.kind==="camera"?s=Ut(r.minSize,r.maxSize,y):i=y}return{uSizeT:i,uSize:s}}var UT=Object.freeze({__proto__:null,getSizeData:Tm,evaluateSizeForFeature:jd,evaluateSizeForZoom:zl,SIZE_PACK_FACTOR:oo});function VT(r,e,i){return r.sections.forEach(s=>{s.text=function(u,p,f){const y=p.layout.get("text-transform").evaluate(f,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),F.applyArabicShaping&&(u=F.applyArabicShaping(u)),u}(s.text,e,i)}),r}const Eu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function $T(r){return r==="\uFE36"||r==="\uFE48"||r==="\uFE38"||r==="\uFE44"||r==="\uFE42"||r==="\uFE3E"||r==="\uFE3C"||r==="\uFE3A"||r==="\uFE18"||r==="\uFE40"||r==="\uFE10"||r==="\uFE13"||r==="\uFE14"||r==="\uFF40"||r==="\uFFE3"||r==="\uFE11"||r==="\uFE12"}function jT(r){return r==="\uFE35"||r==="\uFE47"||r==="\uFE37"||r==="\uFE43"||r==="\uFE41"||r==="\uFE3D"||r==="\uFE3B"||r==="\uFE39"||r==="\uFE17"||r==="\uFE3F"}var F0=function(r,e,i,s,u){var p,f,y=8*u-s-1,v=(1<<y)-1,b=v>>1,E=-7,I=i?u-1:0,A=i?-1:1,P=r[e+I];for(I+=A,p=P&(1<<-E)-1,P>>=-E,E+=y;E>0;p=256*p+r[e+I],I+=A,E-=8);for(f=p&(1<<-E)-1,p>>=-E,E+=s;E>0;f=256*f+r[e+I],I+=A,E-=8);if(p===0)p=1-b;else{if(p===v)return f?NaN:1/0*(P?-1:1);f+=Math.pow(2,s),p-=b}return(P?-1:1)*f*Math.pow(2,p-s)},O0=function(r,e,i,s,u,p){var f,y,v,b=8*p-u-1,E=(1<<b)-1,I=E>>1,A=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=s?0:p-1,N=s?1:-1,U=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,f=E):(f=Math.floor(Math.log(e)/Math.LN2),e*(v=Math.pow(2,-f))<1&&(f--,v*=2),(e+=f+I>=1?A/v:A*Math.pow(2,1-I))*v>=2&&(f++,v/=2),f+I>=E?(y=0,f=E):f+I>=1?(y=(e*v-1)*Math.pow(2,u),f+=I):(y=e*Math.pow(2,I-1)*Math.pow(2,u),f=0));u>=8;r[i+P]=255&y,P+=N,y/=256,u-=8);for(f=f<<u|y,b+=u;b>0;r[i+P]=255&f,P+=N,f/=256,b-=8);r[i+P-N]|=128*U},Cu=rn;function rn(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}rn.Varint=0,rn.Fixed64=1,rn.Bytes=2,rn.Fixed32=5;var Sm=4294967296,N0=1/Sm,U0=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Oo(r){return r.type===rn.Bytes?r.readVarint()+r.pos:r.pos+1}function Pl(r,e,i){return i?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function V0(r,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var u=i.pos-1;u>=r;u--)i.buf[u+s]=i.buf[u]}function GT(r,e){for(var i=0;i<r.length;i++)e.writeVarint(r[i])}function ZT(r,e){for(var i=0;i<r.length;i++)e.writeSVarint(r[i])}function qT(r,e){for(var i=0;i<r.length;i++)e.writeFloat(r[i])}function WT(r,e){for(var i=0;i<r.length;i++)e.writeDouble(r[i])}function XT(r,e){for(var i=0;i<r.length;i++)e.writeBoolean(r[i])}function HT(r,e){for(var i=0;i<r.length;i++)e.writeFixed32(r[i])}function KT(r,e){for(var i=0;i<r.length;i++)e.writeSFixed32(r[i])}function YT(r,e){for(var i=0;i<r.length;i++)e.writeFixed64(r[i])}function QT(r,e){for(var i=0;i<r.length;i++)e.writeSFixed64(r[i])}function Gd(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Dl(r,e,i){r[i]=e,r[i+1]=e>>>8,r[i+2]=e>>>16,r[i+3]=e>>>24}function $0(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function JT(r,e,i){e.glyphs=[],r===1&&i.readMessage(eS,e)}function eS(r,e,i){if(r===3){const{id:s,bitmap:u,width:p,height:f,left:y,top:v,advance:b}=i.readMessage(tS,{});e.glyphs.push({id:s,bitmap:new ms({width:p+6,height:f+6},u),metrics:{width:p,height:f,left:y,top:v,advance:b}})}else r===4?e.ascender=i.readSVarint():r===5&&(e.descender=i.readSVarint())}function tS(r,e,i){r===1?e.id=i.readVarint():r===2?e.bitmap=i.readBytes():r===3?e.width=i.readVarint():r===4?e.height=i.readVarint():r===5?e.left=i.readSVarint():r===6?e.top=i.readSVarint():r===7&&(e.advance=i.readVarint())}function Em(r){let e=0,i=0;for(const f of r)e+=f.w*f.h,i=Math.max(i,f.w);r.sort((f,y)=>y.h-f.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,p=0;for(const f of r)for(let y=s.length-1;y>=0;y--){const v=s[y];if(!(f.w>v.w||f.h>v.h)){if(f.x=v.x,f.y=v.y,p=Math.max(p,f.y+f.h),u=Math.max(u,f.x+f.w),f.w===v.w&&f.h===v.h){const b=s.pop();y<s.length&&(s[y]=b)}else f.h===v.h?(v.x+=f.w,v.w-=f.w):f.w===v.w?(v.y+=f.h,v.h-=f.h):(s.push({x:v.x+f.w,y:v.y,w:v.w-f.w,h:f.h}),v.y+=f.h,v.h-=f.h);break}}return{w:u,h:p,fill:e/(u*p)||0}}rn.prototype={destroy:function(){this.buf=null},readFields:function(r,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),u=s>>3,p=this.pos;this.type=7&s,r(u,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Gd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=$0(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Gd(this.buf,this.pos)+Gd(this.buf,this.pos+4)*Sm;return this.pos+=8,r},readSFixed64:function(){var r=Gd(this.buf,this.pos)+$0(this.buf,this.pos+4)*Sm;return this.pos+=8,r},readFloat:function(){var r=F0(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=F0(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(u,p,f){var y,v,b=f.buf;if(y=(112&(v=b[f.pos++]))>>4,v<128||(y|=(127&(v=b[f.pos++]))<<3,v<128)||(y|=(127&(v=b[f.pos++]))<<10,v<128)||(y|=(127&(v=b[f.pos++]))<<17,v<128)||(y|=(127&(v=b[f.pos++]))<<24,v<128)||(y|=(1&(v=b[f.pos++]))<<31,v<128))return Pl(u,y,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&U0?function(i,s,u){return U0.decode(i.subarray(s,u))}(this.buf,e,r):function(i,s,u){for(var p="",f=s;f<u;){var y,v,b,E=i[f],I=null,A=E>239?4:E>223?3:E>191?2:1;if(f+A>u)break;A===1?E<128&&(I=E):A===2?(192&(y=i[f+1]))==128&&(I=(31&E)<<6|63&y)<=127&&(I=null):A===3?(v=i[f+2],(192&(y=i[f+1]))==128&&(192&v)==128&&((I=(15&E)<<12|(63&y)<<6|63&v)<=2047||I>=55296&&I<=57343)&&(I=null)):A===4&&(v=i[f+2],b=i[f+3],(192&(y=i[f+1]))==128&&(192&v)==128&&(192&b)==128&&((I=(15&E)<<18|(63&y)<<12|(63&v)<<6|63&b)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,A=1):I>65535&&(I-=65536,p+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),p+=String.fromCharCode(I),f+=A}return p}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==rn.Bytes)return r.push(this.readVarint(e));var i=Oo(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==rn.Bytes)return r.push(this.readSVarint());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==rn.Bytes)return r.push(this.readBoolean());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==rn.Bytes)return r.push(this.readFloat());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==rn.Bytes)return r.push(this.readDouble());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==rn.Bytes)return r.push(this.readFixed32());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==rn.Bytes)return r.push(this.readSFixed32());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==rn.Bytes)return r.push(this.readFixed64());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==rn.Bytes)return r.push(this.readSFixed64());var e=Oo(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===rn.Varint)for(;this.buf[this.pos++]>127;);else if(e===rn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===rn.Fixed32)this.pos+=4;else{if(e!==rn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Dl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Dl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Dl(this.buf,-1&r,this.pos),Dl(this.buf,Math.floor(r*N0),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Dl(this.buf,-1&r,this.pos),Dl(this.buf,Math.floor(r*N0),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,i){var s,u;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,f,y){y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,y.buf[y.pos]=127&(p>>>=7)}(s,0,i),function(p,f){var y=(7&p)<<4;f.buf[f.pos++]|=y|((p>>>=3)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p)))))}(u,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(s,u,p){for(var f,y,v=0;v<u.length;v++){if((f=u.charCodeAt(v))>55295&&f<57344){if(!y){f>56319||v+1===u.length?(s[p++]=239,s[p++]=191,s[p++]=189):y=f;continue}if(f<56320){s[p++]=239,s[p++]=191,s[p++]=189,y=f;continue}f=y-55296<<10|f-56320|65536,y=null}else y&&(s[p++]=239,s[p++]=191,s[p++]=189,y=null);f<128?s[p++]=f:(f<2048?s[p++]=f>>6|192:(f<65536?s[p++]=f>>12|224:(s[p++]=f>>18|240,s[p++]=f>>12&63|128),s[p++]=f>>6&63|128),s[p++]=63&f|128)}return p}(this.buf,r,this.pos);var i=this.pos-e;i>=128&&V0(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),O0(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),O0(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,e){this.pos++;var i=this.pos;r(e,this);var s=this.pos-i;s>=128&&V0(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(r,e,i){this.writeTag(r,rn.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,GT,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,ZT,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,XT,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,qT,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,WT,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,HT,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,KT,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,YT,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,QT,e)},writeBytesField:function(r,e){this.writeTag(r,rn.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,rn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,rn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,rn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,rn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,rn.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,rn.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,rn.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,rn.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,rn.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};class Cm{constructor(e,{pixelRatio:i,version:s,stretchX:u,stretchY:p,content:f}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=p,this.content=f,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class j0{constructor(e,i){const s={},u={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,s,p),this.addImages(i,u,p);const{w:f,h:y}=Em(p),v=new mi({width:f||1,height:y||1});for(const b in e){const E=e[b],I=s[b].paddedRect;mi.copy(E.data,v,{x:0,y:0},{x:I.x+1,y:I.y+1},E.data)}for(const b in i){const E=i[b],I=u[b].paddedRect,A=I.x+1,P=I.y+1,N=E.data.width,U=E.data.height;mi.copy(E.data,v,{x:0,y:0},{x:A,y:P},E.data),mi.copy(E.data,v,{x:0,y:U-1},{x:A,y:P-1},{width:N,height:1}),mi.copy(E.data,v,{x:0,y:0},{x:A,y:P+U},{width:N,height:1}),mi.copy(E.data,v,{x:N-1,y:0},{x:A-1,y:P},{width:1,height:U}),mi.copy(E.data,v,{x:0,y:0},{x:A+N,y:P},{width:1,height:U})}this.image=v,this.iconPositions=s,this.patternPositions=u}addImages(e,i,s){for(const u in e){const p=e[u],f={x:0,y:0,w:p.data.width+2,h:p.data.height+2};s.push(f),i[u]=new Cm(f,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),i),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),i)}patchUpdatedImage(e,i,s){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,p]=e.tl;s.update(i.data,void 0,{x:u,y:p})}}rt("ImagePosition",Cm),rt("ImageAtlas",j0);const gi={horizontal:1,vertical:2,horizontalOnly:3};class ku{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const s=new ku;return s.scale=e||1,s.fontStack=i,s}static forImage(e){const i=new ku;return i.imageName=e,i}}class Rl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const s=new Rl;for(let u=0;u<e.sections.length;u++){const p=e.sections[u];p.image?s.addImageSection(p):s.addTextSection(p,i)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,s){let u="";for(let p=0;p<i.length;p++){const f=i.charCodeAt(p+1)||null,y=i.charCodeAt(p-1)||null;u+=!s&&(f&&Ad(f)&&!Eu[i[p+1]]||y&&Ad(y)&&!Eu[i[p-1]])||!Eu[i[p]]?i[p]:Eu[i[p]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&Zd[this.text.charCodeAt(s)];s++)e++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&Zd[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const s=new Rl;return s.text=this.text.substring(e,i),s.sectionIndex=this.sectionIndex.slice(e,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(ku.forText(e.scale,e.fontStack||i));const s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void Ye("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(ku.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Ye("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function km(r,e,i,s,u,p,f,y,v,b,E,I,A,P,N,U){const K=Rl.fromFeature(r,u);let ie;I===gi.vertical&&K.verticalizePunctuation(A);const{processBidirectionalText:he,processStyledBidirectionalText:_e}=F;if(he&&K.sections.length===1){ie=[];const be=he(K.toString(),Im(K,b,p,e,s,P,N));for(const Me of be){const Fe=new Rl;Fe.text=Me,Fe.sections=K.sections;for(let Ne=0;Ne<Me.length;Ne++)Fe.sectionIndex.push(0);ie.push(Fe)}}else if(_e){ie=[];const be=_e(K.text,K.sectionIndex,Im(K,b,p,e,s,P,N));for(const Me of be){const Fe=new Rl;Fe.text=Me[0],Fe.sectionIndex=Me[1],Fe.sections=K.sections,ie.push(Fe)}}else ie=function(be,Me){const Fe=[],Ne=be.text;let Ge=0;for(const Pe of Me)Fe.push(be.substring(Ge,Pe)),Ge=Pe;return Ge<Ne.length&&Fe.push(be.substring(Ge,Ne.length)),Fe}(K,Im(K,b,p,e,s,P,N));const ye=[],we={positionedLines:ye,text:K.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(be,Me,Fe,Ne,Ge,Pe,Be,qe,Re,ht,nt,jt){let pt=0,Dt=0,lt=0;const mt=qe==="right"?1:qe==="left"?0:.5;let Bt=!1;for(const Yt of Ge){const tn=Yt.getSections();for(const nr of tn){if(nr.imageName)continue;const zn=Me[nr.fontStack];if(zn&&(Bt=zn.ascender!==void 0&&zn.descender!==void 0,!Bt))break}if(!Bt)break}let tr=0;for(const Yt of Ge){Yt.trim();const tn=Yt.getMaxScale(),nr=(tn-1)*lr,zn={positionedGlyphs:[],lineOffset:0};be.positionedLines[tr]=zn;const rr=zn.positionedGlyphs;let Xn=0;if(!Yt.length()){Dt+=Pe,++tr;continue}let on=0,Er=0;for(let pn=0;pn<Yt.length();pn++){const Pn=Yt.getSection(pn),Cr=Yt.getSectionIndex(pn),ir=Yt.getCharCode(pn);let Fn=Pn.scale,Gt=null,kr=null,Yr=null,qi=lr,Ii=0;const Wi=!(Re===gi.horizontal||!nt&&!Ro(ir)||nt&&(Zd[ir]||(bn=ir,yd(bn)||xd(bn)||vd(bn)||ma(bn)||io(bn))));if(Pn.imageName){const ao=Ne[Pn.imageName];if(!ao)continue;Yr=Pn.imageName,be.iconsInText=be.iconsInText||!0,kr=ao.paddedRect;const yr=ao.displaySize;Fn=Fn*lr/jt,Gt={width:yr[0],height:yr[1],left:1,top:-3,advance:Wi?yr[1]:yr[0],localGlyph:!1},Ii=Bt?-Gt.height*Fn:tn*lr-17-yr[1]*Fn,qi=Gt.advance;const lo=(Wi?yr[0]:yr[1])*Fn-lr*tn;lo>0&&lo>Xn&&(Xn=lo)}else{const ao=Fe[Pn.fontStack];if(!ao)continue;ao[ir]&&(kr=ao[ir]);const yr=Me[Pn.fontStack];if(!yr)continue;const lo=yr.glyphs[ir];if(!lo)continue;if(Gt=lo.metrics,qi=ir!==8203?lr:0,Bt){const Ta=yr.ascender!==void 0?Math.abs(yr.ascender):0,_i=yr.descender!==void 0?Math.abs(yr.descender):0,Mu=(Ta+_i)*Fn;on<Mu&&(on=Mu,Er=(Ta-_i)/2*Fn),Ii=-Ta*Fn}else Ii=(tn-Fn)*lr-17}Wi?(be.verticalizable=!0,rr.push({glyph:ir,imageName:Yr,x:pt,y:Dt+Ii,vertical:Wi,scale:Fn,localGlyph:Gt.localGlyph,fontStack:Pn.fontStack,sectionIndex:Cr,metrics:Gt,rect:kr}),pt+=qi*Fn+ht):(rr.push({glyph:ir,imageName:Yr,x:pt,y:Dt+Ii,vertical:Wi,scale:Fn,localGlyph:Gt.localGlyph,fontStack:Pn.fontStack,sectionIndex:Cr,metrics:Gt,rect:kr}),pt+=Gt.advance*Fn+ht)}rr.length!==0&&(lt=Math.max(pt-ht,lt),Bt?X0(rr,mt,Xn,Er,Pe*tn/2):X0(rr,mt,Xn,0,Pe/2)),pt=0;const Tn=Pe*tn+Xn;zn.lineOffset=Math.max(Xn,nr),Dt+=Tn,++tr}var bn;const qn=Dt,{horizontalAlign:Wn,verticalAlign:Mn}=Am(Be);(function(Yt,tn,nr,zn,rr,Xn){const on=(tn-nr)*rr,Er=-Xn*zn;for(const Tn of Yt)for(const pn of Tn.positionedGlyphs)pn.x+=on,pn.y+=Er})(be.positionedLines,mt,Wn,Mn,lt,qn),be.top+=-Mn*qn,be.bottom=be.top+qn,be.left+=-Wn*lt,be.right=be.left+lt,be.hasBaseline=Bt}(we,e,i,s,ie,f,y,v,I,b,A,U),!function(be){for(const Me of be)if(Me.positionedGlyphs.length!==0)return!1;return!0}(ye)&&we}const Zd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nS={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function G0(r,e,i,s,u,p){if(e.imageName){const f=s[e.imageName];return f?f.displaySize[0]*e.scale*lr/p+u:0}{const f=i[e.fontStack],y=f&&f.glyphs[r];return y?y.metrics.advance*e.scale+u:0}}function Z0(r,e,i,s){const u=Math.pow(r-e,2);return s?r<e?u/2:2*u:u+Math.abs(i)*i}function rS(r,e,i){let s=0;return r===10&&(s-=1e4),i&&(s+=150),r!==40&&r!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function q0(r,e,i,s,u,p){let f=null,y=Z0(e,i,u,p);for(const v of s){const b=Z0(e-v.x,i,u,p)+v.badness;b<=y&&(f=v,y=b)}return{index:r,x:e,priorBreak:f,badness:y}}function W0(r){return r?W0(r.priorBreak).concat(r.index):[]}function Im(r,e,i,s,u,p,f){if(p!=="point")return[];if(!r)return[];const y=[],v=function(A,P,N,U,K,ie){let he=0;for(let _e=0;_e<A.length();_e++){const ye=A.getSection(_e);he+=G0(A.getCharCode(_e),ye,U,K,P,ie)}return he/Math.max(1,Math.ceil(he/N))}(r,e,i,s,u,f),b=r.text.indexOf("\u200B")>=0;let E=0;for(let A=0;A<r.length();A++){const P=r.getSection(A),N=r.getCharCode(A);if(Zd[N]||(E+=G0(N,P,s,u,e,f)),A<r.length()-1){const U=!((I=N)<11904||!(cu(I)||lu(I)||pu(I)||Ed(I)||vl(I)||pa(I)||uu(I)||zo(I)||Td(I)||du(I)||xl(I)||ds(I)||au(I)||bd(I)||wd(I)||hu(I)||yl(I)||Cd(I)||Sd(I)||fa(I)));(nS[N]||U||P.imageName)&&y.push(q0(A+1,E,v,y,rS(N,r.getCharCode(A+1),U&&b),!1))}}var I;return W0(q0(r.length(),E,v,y,0,!0))}function Am(r){let e=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function X0(r,e,i,s,u){if(!(e||i||s||u))return;const p=r.length-1,f=r[p],y=(f.x+f.metrics.advance*f.scale)*e;for(let v=0;v<=p;v++)r[v].x-=y,r[v].y+=i+s+u}function iS(r,e,i){const{horizontalAlign:s,verticalAlign:u}=Am(i),p=e[0]-r.displaySize[0]*s,f=e[1]-r.displaySize[1]*u;return{image:r,top:f,bottom:f+r.displaySize[1],left:p,right:p+r.displaySize[0]}}function H0(r,e,i,s,u,p){const f=r.image;let y;if(f.content){const K=f.content,ie=f.pixelRatio||1;y=[K[0]/ie,K[1]/ie,f.displaySize[0]-K[2]/ie,f.displaySize[1]-K[3]/ie]}const v=e.left*p,b=e.right*p;let E,I,A,P;i==="width"||i==="both"?(P=u[0]+v-s[3],I=u[0]+b+s[1]):(P=u[0]+(v+b-f.displaySize[0])/2,I=P+f.displaySize[0]);const N=e.top*p,U=e.bottom*p;return i==="height"||i==="both"?(E=u[1]+N-s[0],A=u[1]+U+s[2]):(E=u[1]+(N+U-f.displaySize[1])/2,A=E+f.displaySize[1]),{image:f,top:E,right:I,bottom:A,left:P,collisionPadding:y}}class _s extends J{constructor(e,i,s,u,p){super(e,i),this.angle=u,this.z=s,p!==void 0&&(this.segment=p)}clone(){return new _s(this.x,this.y,this.z,this.angle,this.segment)}}function K0(r,e,i,s,u){if(e.segment===void 0)return!0;let p=e,f=e.segment+1,y=0;for(;y>-i/2;){if(f--,f<0)return!1;y-=r[f].dist(p),p=r[f]}y+=r[f].dist(r[f+1]),f++;const v=[];let b=0;for(;y<i/2;){const E=r[f],I=r[f+1];if(!I)return!1;let A=r[f-1].angleTo(E)-E.angleTo(I);for(A=Math.abs((A+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:y,angleDelta:A}),b+=A;y-v[0].distance>s;)b-=v.shift().angleDelta;if(b>u)return!1;f++,y+=E.dist(I)}return!0}function Y0(r){let e=0;for(let i=0;i<r.length-1;i++)e+=r[i].dist(r[i+1]);return e}function Q0(r,e,i){return r?.6*e*i:0}function J0(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function oS(r,e,i,s,u,p){const f=Q0(i,u,p),y=J0(i,s)*p;let v=0;const b=Y0(r)/2;for(let E=0;E<r.length-1;E++){const I=r[E],A=r[E+1],P=I.dist(A);if(v+P>b){const N=(b-v)/P,U=Ut(I.x,A.x,N),K=Ut(I.y,A.y,N),ie=new _s(U,K,0,A.angleTo(I),E);return!f||K0(r,ie,y,f,e)?ie:void 0}v+=P}}function sS(r,e,i,s,u,p,f,y,v){const b=Q0(s,p,f),E=J0(s,u),I=E*f,A=r[0].x===0||r[0].x===v||r[0].y===0||r[0].y===v;return e-I<e/4&&(e=I+e/4),ex(r,A?e/2*y%e:(E/2+2*p)*f*y%e,e,b,i,I,A,!1,v)}function ex(r,e,i,s,u,p,f,y,v){const b=p/2,E=Y0(r);let I=0,A=e-i,P=[];for(let N=0;N<r.length-1;N++){const U=r[N],K=r[N+1],ie=U.dist(K),he=K.angleTo(U);for(;A+i<I+ie;){A+=i;const _e=(A-I)/ie,ye=Ut(U.x,K.x,_e),we=Ut(U.y,K.y,_e);if(ye>=0&&ye<v&&we>=0&&we<v&&A-b>=0&&A+b<=E){const be=new _s(ye,we,0,he,N);be._round(),s&&!K0(r,be,p,s,u)||P.push(be)}}I+=ie}return y||P.length||f||(P=ex(r,I/2,i,s,u,p,f,!0,v)),P}function tx(r,e,i,s,u){const p=[];for(let f=0;f<r.length;f++){const y=r[f];let v;for(let b=0;b<y.length-1;b++){let E=y[b],I=y[b+1];E.x<e&&I.x<e||(E.x<e?E=new J(e,E.y+(e-E.x)/(I.x-E.x)*(I.y-E.y))._round():I.x<e&&(I=new J(e,E.y+(e-E.x)/(I.x-E.x)*(I.y-E.y))._round()),E.y<i&&I.y<i||(E.y<i?E=new J(E.x+(i-E.y)/(I.y-E.y)*(I.x-E.x),i)._round():I.y<i&&(I=new J(E.x+(i-E.y)/(I.y-E.y)*(I.x-E.x),i)._round()),E.x>=s&&I.x>=s||(E.x>=s?E=new J(s,E.y+(s-E.x)/(I.x-E.x)*(I.y-E.y))._round():I.x>=s&&(I=new J(s,E.y+(s-E.x)/(I.x-E.x)*(I.y-E.y))._round()),E.y>=u&&I.y>=u||(E.y>=u?E=new J(E.x+(u-E.y)/(I.y-E.y)*(I.x-E.x),u)._round():I.y>=u&&(I=new J(E.x+(u-E.y)/(I.y-E.y)*(I.x-E.x),u)._round()),v&&E.equals(v[v.length-1])||(v=[E],p.push(v)),v.push(I)))))}}return p}rt("Anchor",_s);const Iu=1e20;function nx(r,e,i,s,u,p,f,y,v){for(let b=e;b<e+s;b++)rx(r,i*p+b,p,u,f,y,v);for(let b=i;b<i+u;b++)rx(r,b*p+e,1,s,f,y,v)}function rx(r,e,i,s,u,p,f){p[0]=0,f[0]=-Iu,f[1]=Iu,u[0]=r[e];for(let y=1,v=0,b=0;y<s;y++){u[y]=r[e+y*i];const E=y*y;do{const I=p[v];b=(u[y]-u[I]+E-I*I)/(y-I)/2}while(b<=f[v]&&--v>-1);v++,p[v]=y,f[v]=b,f[v+1]=Iu}for(let y=0,v=0;y<s;y++){for(;f[v+1]<y;)v++;const b=p[v],E=y-b;r[e+y*i]=u[b]+E*E}}const Mm={none:0,ideographs:1,all:2};class Ll{constructor(e,i,s){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const s=[];for(const u in e)for(const p of e[u])s.push({stack:u,id:p});We(s,({stack:u,id:p},f)=>{let y=this.entries[u];y||(y=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let v=y.glyphs[p];if(v!==void 0)return void f(null,{stack:u,id:p,glyph:v});if(v=this._tinySDF(y,u,p),v)return y.glyphs[p]=v,void f(null,{stack:u,id:p,glyph:v});const b=Math.floor(p/256);if(256*b>65535)return void f(new Error("glyphs > 65535 not supported"));if(y.ranges[b])return void f(null,{stack:u,id:p,glyph:v});let E=y.requests[b];E||(E=y.requests[b]=[],Ll.loadGlyphRange(u,b,this.url,this.requestManager,(I,A)=>{if(A){y.ascender=A.ascender,y.descender=A.descender;for(const P in A.glyphs)this._doesCharSupportLocalGlyph(+P)||(y.glyphs[+P]=A.glyphs[+P]);y.ranges[b]=!0}for(const P of E)P(I,A);delete y.requests[b]})),E.push((I,A)=>{I?f(I):A&&f(null,{stack:u,id:p,glyph:A.glyphs[p]||null})})},(u,p)=>{if(u)i(u);else if(p){const f={};for(const{stack:y,id:v,glyph:b}of p)f[y]===void 0&&(f[y]={}),f[y].glyphs===void 0&&(f[y].glyphs={}),f[y].glyphs[v]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics},f[y].ascender=this.entries[y].ascender,f[y].descender=this.entries[y].descender;i(null,f)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Mm.none&&(this.localGlyphMode===Mm.all?!!this.localFontFamily:!!this.localFontFamily&&(du(e)||Po(e)||au(e)||yl(e))||zo(e))}_tinySDF(e,i,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let p=e.tinySDF;if(!p){let U="400";/bold/i.test(i)?U="900":/medium/i.test(i)?U="500":/light/i.test(i)&&(U="200"),p=e.tinySDF=new Ll.TinySDF({fontFamily:u,fontWeight:U,fontSize:48,buffer:6,radius:16}),p.fontWeight=U}if(this.localGlyphs[p.fontWeight][s])return this.localGlyphs[p.fontWeight][s];const f=String.fromCharCode(s),{data:y,width:v,height:b,glyphWidth:E,glyphHeight:I,glyphLeft:A,glyphTop:P,glyphAdvance:N}=p.draw(f);return this.localGlyphs[p.fontWeight][s]={id:s,bitmap:new ms({width:v,height:b},y),metrics:{width:E/2,height:I/2,left:A/2,top:P/2-27,advance:N/2,localGlyph:!0}}}}function ix(r,e,i,s){const u=[],p=r.image,f=p.pixelRatio,y=p.paddedRect.w-2,v=p.paddedRect.h-2,b=r.right-r.left,E=r.bottom-r.top,I=p.stretchX||[[0,y]],A=p.stretchY||[[0,v]],P=(Pe,Be)=>Pe+Be[1]-Be[0],N=I.reduce(P,0),U=A.reduce(P,0),K=y-N,ie=v-U;let he=0,_e=N,ye=0,we=U,be=0,Me=K,Fe=0,Ne=ie;if(p.content&&s){const Pe=p.content;he=qd(I,0,Pe[0]),ye=qd(A,0,Pe[1]),_e=qd(I,Pe[0],Pe[2]),we=qd(A,Pe[1],Pe[3]),be=Pe[0]-he,Fe=Pe[1]-ye,Me=Pe[2]-Pe[0]-_e,Ne=Pe[3]-Pe[1]-we}const Ge=(Pe,Be,qe,Re)=>{const ht=Wd(Pe.stretch-he,_e,b,r.left),nt=Xd(Pe.fixed-be,Me,Pe.stretch,N),jt=Wd(Be.stretch-ye,we,E,r.top),pt=Xd(Be.fixed-Fe,Ne,Be.stretch,U),Dt=Wd(qe.stretch-he,_e,b,r.left),lt=Xd(qe.fixed-be,Me,qe.stretch,N),mt=Wd(Re.stretch-ye,we,E,r.top),Bt=Xd(Re.fixed-Fe,Ne,Re.stretch,U),tr=new J(ht,jt),bn=new J(Dt,jt),qn=new J(Dt,mt),Wn=new J(ht,mt),Mn=new J(nt/f,pt/f),Yt=new J(lt/f,Bt/f),tn=e*Math.PI/180;if(tn){const rr=Math.sin(tn),Xn=Math.cos(tn),on=[Xn,-rr,rr,Xn];tr._matMult(on),bn._matMult(on),Wn._matMult(on),qn._matMult(on)}const nr=Pe.stretch+Pe.fixed,zn=Be.stretch+Be.fixed;return{tl:tr,tr:bn,bl:Wn,br:qn,tex:{x:p.paddedRect.x+1+nr,y:p.paddedRect.y+1+zn,w:qe.stretch+qe.fixed-nr,h:Re.stretch+Re.fixed-zn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mn,pixelOffsetBR:Yt,minFontScaleX:Me/f/b,minFontScaleY:Ne/f/E,isSDF:i}};if(s&&(p.stretchX||p.stretchY)){const Pe=ox(I,K,N),Be=ox(A,ie,U);for(let qe=0;qe<Pe.length-1;qe++){const Re=Pe[qe],ht=Pe[qe+1];for(let nt=0;nt<Be.length-1;nt++)u.push(Ge(Re,Be[nt],ht,Be[nt+1]))}}else u.push(Ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:v+1}));return u}function qd(r,e,i){let s=0;for(const u of r)s+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return s}function ox(r,e,i){const s=[{fixed:-1,stretch:0}];for(const[u,p]of r){const f=s[s.length-1];s.push({fixed:u-f.stretch,stretch:f.stretch}),s.push({fixed:u-f.stretch,stretch:f.stretch+(p-u)})}return s.push({fixed:e+1,stretch:i}),s}function Wd(r,e,i,s){return r/e*i+s}function Xd(r,e,i,s){return r-e*i/s}function aS(r,e,i,s){const u=e+r.positionedLines[s].lineOffset;return s===0?i+u/2:i+(u+(e+r.positionedLines[s-1].lineOffset))/2}Ll.loadGlyphRange=function(r,e,i,s,u){const p=256*e,f=p+255,y=s.transformRequest(s.normalizeGlyphsURL(i).replace("{fontstack}",r).replace("{range}",`${p}-${f}`),So.Glyphs);D(y,(v,b)=>{if(v)u(v);else if(b){const E={},I=function(A){return new Cu(A).readFields(JT,{})}(b);for(const A of I.glyphs)E[A.id]=A;u(null,{glyphs:E,ascender:I.ascender,descender:I.descender})}})},Ll.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:i=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:f="normal"}){this.buffer=e,this.cutoff=s,this.radius=i;const y=this.size=r+4*e,v=this._createCanvas(y),b=this.ctx=v.getContext("2d",{willReadFrequently:!0});b.font=`${f} ${p} ${r}px ${u}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(r),f=Math.floor(i),y=Math.min(this.size-this.buffer,Math.ceil(p-u)),v=Math.min(this.size-this.buffer,Math.ceil(i)+Math.ceil(s)),b=y+2*this.buffer,E=v+2*this.buffer,I=b*E,A=new Uint8ClampedArray(I),P={data:A,width:b,height:E,glyphWidth:y,glyphHeight:v,glyphTop:f,glyphLeft:0,glyphAdvance:e};if(y===0||v===0)return P;const{ctx:N,buffer:U,gridInner:K,gridOuter:ie}=this;N.clearRect(U,U,y,v),N.fillText(r,U,U+f+1);const he=N.getImageData(U,U,y,v);ie.fill(Iu,0,I),K.fill(0,0,I);for(let _e=0;_e<v;_e++)for(let ye=0;ye<y;ye++){const we=he.data[4*(_e*y+ye)+3]/255;if(we===0)continue;const be=(_e+U)*b+ye+U;if(we===1)ie[be]=0,K[be]=Iu;else{const Me=.5-we;ie[be]=Me>0?Me*Me:0,K[be]=Me<0?Me*Me:0}}nx(ie,0,0,b,E,b,this.f,this.v,this.z),nx(K,U,U,y,v,b,this.f,this.v,this.z);for(let _e=0;_e<I;_e++){const ye=Math.sqrt(ie[_e])-Math.sqrt(K[_e]);A[_e]=Math.round(255-255*(ye/this.radius+this.cutoff))}return P}};class lS{constructor(e=[],i=cS){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:s}=this,u=i[e];for(;e>0;){const p=e-1>>1,f=i[p];if(s(u,f)>=0)break;i[e]=f,e=p}i[e]=u}_down(e){const{data:i,compare:s}=this,u=this.length>>1,p=i[e];for(;e<u;){let f=1+(e<<1),y=i[f];const v=f+1;if(v<this.length&&s(i[v],y)<0&&(f=v,y=i[v]),s(y,p)>=0)break;i[e]=y,e=f}i[e]=p}}function cS(r,e){return r<e?-1:r>e?1:0}function uS(r,e=1,i=!1){let s=1/0,u=1/0,p=-1/0,f=-1/0;const y=r[0];for(let P=0;P<y.length;P++){const N=y[P];(!P||N.x<s)&&(s=N.x),(!P||N.y<u)&&(u=N.y),(!P||N.x>p)&&(p=N.x),(!P||N.y>f)&&(f=N.y)}const v=Math.min(p-s,f-u);let b=v/2;const E=new lS([],hS);if(v===0)return new J(s,u);for(let P=s;P<p;P+=v)for(let N=u;N<f;N+=v)E.push(new Bl(P+b,N+b,b,r));let I=function(P){let N=0,U=0,K=0;const ie=P[0];for(let he=0,_e=ie.length,ye=_e-1;he<_e;ye=he++){const we=ie[he],be=ie[ye],Me=we.x*be.y-be.x*we.y;U+=(we.x+be.x)*Me,K+=(we.y+be.y)*Me,N+=3*Me}return new Bl(U/N,K/N,0,P)}(r),A=E.length;for(;E.length;){const P=E.pop();(P.d>I.d||!I.d)&&(I=P,i&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,A)),P.max-I.d<=e||(b=P.h/2,E.push(new Bl(P.p.x-b,P.p.y-b,b,r)),E.push(new Bl(P.p.x+b,P.p.y-b,b,r)),E.push(new Bl(P.p.x-b,P.p.y+b,b,r)),E.push(new Bl(P.p.x+b,P.p.y+b,b,r)),A+=4)}return i&&(console.log(`num probes: ${A}`),console.log(`best distance: ${I.d}`)),I.p}function hS(r,e){return e.max-r.max}function Bl(r,e,i,s){this.p=new J(r,e),this.h=i,this.d=function(u,p){let f=!1,y=1/0;for(let v=0;v<p.length;v++){const b=p[v];for(let E=0,I=b.length,A=I-1;E<I;A=E++){const P=b[E],N=b[A];P.y>u.y!=N.y>u.y&&u.x<(N.x-P.x)*(u.y-P.y)/(N.y-P.y)+P.x&&(f=!f),y=Math.min(y,r0(u,P,N))}}return(f?1:-1)*Math.sqrt(y)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const zm=Number.POSITIVE_INFINITY,dS=Math.sqrt(2);function sx(r,e){return e[1]!==zm?function(i,s,u){let p=0,f=0;switch(s=Math.abs(s),u=Math.abs(u),i){case"top-right":case"top-left":case"top":f=u-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-u}switch(i){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,f]}(r,e[0],e[1]):function(i,s){let u=0,p=0;s<0&&(s=0);const f=s/dS;switch(i){case"top-right":case"top-left":p=f-7;break;case"bottom-right":case"bottom-left":p=7-f;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(i){case"top-right":case"bottom-right":u=-f;break;case"top-left":case"bottom-left":u=f;break;case"left":u=s;break;case"right":u=-s}return[u,p]}(r,e[0])}function pS(r,e,i,s,u,p,f,y){r.createArrays(),r.tilePixelRatio=Kt/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const v=r.layers[0].layout,b=r.layers[0]._unevaluatedLayout._values,E={};if(r.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:N}=r.textSizeData;E.compositeTextSizes=[b["text-size"].possiblyEvaluate(new O(P),f),b["text-size"].possiblyEvaluate(new O(N),f)]}if(r.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:N}=r.iconSizeData;E.compositeIconSizes=[b["icon-size"].possiblyEvaluate(new O(P),f),b["icon-size"].possiblyEvaluate(new O(N),f)]}E.layoutTextSize=b["text-size"].possiblyEvaluate(new O(y+1),f),E.layoutIconSize=b["icon-size"].possiblyEvaluate(new O(y+1),f),E.textMaxSize=b["text-size"].possiblyEvaluate(new O(18),f);const I=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point",A=v.get("text-size");for(const P of r.features){const N=v.get("text-font").evaluate(P,{},f).join(","),U=A.evaluate(P,{},f),K=E.layoutTextSize.evaluate(P,{},f),ie=(E.layoutIconSize.evaluate(P,{},f),{horizontal:{},vertical:void 0}),he=P.text;let _e,ye=[0,0];if(he){const Me=he.toString(),Fe=v.get("text-letter-spacing").evaluate(P,{},f)*lr,Ne=v.get("text-line-height").evaluate(P,{},f)*lr,Ge=tm(Me)?Fe:0,Pe=v.get("text-anchor").evaluate(P,{},f),Be=v.get("text-variable-anchor");if(!Be){const pt=v.get("text-radial-offset").evaluate(P,{},f);ye=pt?sx(Pe,[pt*lr,zm]):v.get("text-offset").evaluate(P,{},f).map(Dt=>Dt*lr)}let qe=I?"center":v.get("text-justify").evaluate(P,{},f);const Re=v.get("symbol-placement"),ht=Re==="point",nt=Re==="point"?v.get("text-max-width").evaluate(P,{},f)*lr:0,jt=pt=>{r.allowVerticalPlacement&&Do(Me)&&(ie.vertical=km(he,e,i,u,N,nt,Ne,Pe,pt,Ge,ye,gi.vertical,!0,Re,K,U))};if(!I&&Be){const pt=qe==="auto"?Be.map(lt=>Pm(lt)):[qe];let Dt=!1;for(let lt=0;lt<pt.length;lt++){const mt=pt[lt];if(!ie.horizontal[mt])if(Dt)ie.horizontal[mt]=ie.horizontal[0];else{const Bt=km(he,e,i,u,N,nt,Ne,"center",mt,Ge,ye,gi.horizontal,!1,Re,K,U);Bt&&(ie.horizontal[mt]=Bt,Dt=Bt.positionedLines.length===1)}}jt("left")}else{if(qe==="auto"&&(qe=Pm(Pe)),ht||v.get("text-writing-mode").indexOf("horizontal")>=0||!Do(Me)){const pt=km(he,e,i,u,N,nt,Ne,Pe,qe,Ge,ye,gi.horizontal,!1,Re,K,U);pt&&(ie.horizontal[qe]=pt)}jt(Re==="point"?"left":qe)}}let we=!1;if(P.icon&&P.icon.name){const Me=s[P.icon.name];Me&&(_e=iS(u[P.icon.name],v.get("icon-offset").evaluate(P,{},f),v.get("icon-anchor").evaluate(P,{},f)),we=Me.sdf,r.sdfIcons===void 0?r.sdfIcons=Me.sdf:r.sdfIcons!==Me.sdf&&Ye("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Me.pixelRatio!==r.pixelRatio||v.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const be=lx(ie.horizontal)||ie.vertical;r.iconsInText||(r.iconsInText=!!be&&be.iconsInText),(be||_e)&&fS(r,P,ie,_e,s,E,K,0,ye,we,f)}p&&r.generateCollisionDebugBuffers(y,r.collisionBoxArray)}function Pm(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function fS(r,e,i,s,u,p,f,y,v,b,E){let I=p.textMaxSize.evaluate(e,{},E);I===void 0&&(I=f);const A=r.layers[0].layout,P=A.get("icon-offset").evaluate(e,{},E),N=lx(i.horizontal)||i.vertical,U=f/24,K=r.tilePixelRatio*I/24,ie=r.tilePixelRatio*A.get("symbol-spacing"),he=A.get("text-padding")*r.tilePixelRatio,_e=A.get("icon-padding")*r.tilePixelRatio,ye=Q(A.get("text-max-angle")),we=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",be=A.get("icon-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",Me=A.get("symbol-placement"),Fe=ie/2,Ne=A.get("icon-text-fit");let Ge;s&&Ne!=="none"&&(r.allowVerticalPlacement&&i.vertical&&(Ge=H0(s,i.vertical,Ne,A.get("icon-text-fit-padding"),P,U)),N&&(s=H0(s,N,Ne,A.get("icon-text-fit-padding"),P,U)));const Pe=(Be,qe)=>{qe.x<0||qe.x>=Kt||qe.y<0||qe.y>=Kt||function(Re,ht,nt,jt,pt,Dt,lt,mt,Bt,tr,bn,qn,Wn,Mn,Yt,tn,nr,zn,rr,Xn,on,Er,Tn,pn){const Pn=Re.addToLineVertexArray(ht,jt);let Cr,ir,Fn,Gt,kr,Yr,qi,Ii=0,Wi=0,ao=0,yr=0,lo=-1,Ta=-1;const _i={};let Mu=mu(""),Xm=0,Hm=0;if(Bt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Xm,Hm]=Bt.layout.get("text-offset").evaluate(on,{},pn).map(Qr=>Qr*lr):(Xm=Bt.layout.get("text-radial-offset").evaluate(on,{},pn)*lr,Hm=zm),Re.allowVerticalPlacement&&pt.vertical){const Qr=pt.vertical;if(Yt)Yr=Dm(Qr),mt&&(qi=Dm(mt));else{const Jr=Bt.layout.get("text-rotate").evaluate(on,{},pn)+90;Fn=Hd(tr,nt,ht,bn,qn,Wn,Qr,Mn,Jr,tn),mt&&(Gt=Hd(tr,nt,ht,bn,qn,Wn,mt,zn,Jr))}}if(Dt){const Qr=Bt.layout.get("icon-rotate").evaluate(on,{},pn),Jr=Bt.layout.get("icon-text-fit")!=="none",zu=ix(Dt,Qr,Tn,Jr),Ym=mt?ix(mt,Qr,Tn,Jr):void 0;ir=Hd(tr,nt,ht,bn,qn,Wn,Dt,zn,Qr),Ii=4*zu.length;const Ux=Re.iconSizeData;let Sa=null;Ux.kind==="source"?(Sa=[oo*Bt.layout.get("icon-size").evaluate(on,{},pn)],Sa[0]>ys&&Ye(`${Re.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ux.kind==="composite"&&(Sa=[oo*Er.compositeIconSizes[0].evaluate(on,{},pn),oo*Er.compositeIconSizes[1].evaluate(on,{},pn)],(Sa[0]>ys||Sa[1]>ys)&&Ye(`${Re.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Re.addSymbols(Re.icon,zu,Sa,Xn,rr,on,!1,nt,ht,Pn.lineStartIndex,Pn.lineLength,-1,pn),lo=Re.icon.placedSymbolArray.length-1,Ym&&(Wi=4*Ym.length,Re.addSymbols(Re.icon,Ym,Sa,Xn,rr,on,gi.vertical,nt,ht,Pn.lineStartIndex,Pn.lineLength,-1,pn),Ta=Re.icon.placedSymbolArray.length-1)}for(const Qr in pt.horizontal){const Jr=pt.horizontal[Qr];Cr||(Mu=mu(Jr.text),Yt?kr=Dm(Jr):Cr=Hd(tr,nt,ht,bn,qn,Wn,Jr,Mn,Bt.layout.get("text-rotate").evaluate(on,{},pn),tn));const zu=Jr.positionedLines.length===1;if(ao+=ax(Re,nt,ht,Jr,lt,Bt,Yt,on,tn,Pn,pt.vertical?gi.horizontal:gi.horizontalOnly,zu?Object.keys(pt.horizontal):[Qr],_i,lo,Er,pn),zu)break}pt.vertical&&(yr+=ax(Re,nt,ht,pt.vertical,lt,Bt,Yt,on,tn,Pn,gi.vertical,["vertical"],_i,Ta,Er,pn));let ws=-1;const Km=(Qr,Jr)=>Qr?Math.max(Qr,Jr):Jr;ws=Km(kr,ws),ws=Km(Yr,ws),ws=Km(qi,ws);const DS=ws>-1?1:0;Re.glyphOffsetArray.length>=xs.MAX_GLYPHS&&Ye("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),on.sortKey!==void 0&&Re.addToSortKeyRanges(Re.symbolInstances.length,on.sortKey),Re.symbolInstances.emplaceBack(nt.x,nt.y,nt.z,ht.x,ht.y,_i.right>=0?_i.right:-1,_i.center>=0?_i.center:-1,_i.left>=0?_i.left:-1,_i.vertical>=0?_i.vertical:-1,lo,Ta,Mu,Cr!==void 0?Cr:Re.collisionBoxArray.length,Cr!==void 0?Cr+1:Re.collisionBoxArray.length,Fn!==void 0?Fn:Re.collisionBoxArray.length,Fn!==void 0?Fn+1:Re.collisionBoxArray.length,ir!==void 0?ir:Re.collisionBoxArray.length,ir!==void 0?ir+1:Re.collisionBoxArray.length,Gt||Re.collisionBoxArray.length,Gt?Gt+1:Re.collisionBoxArray.length,bn,ao,yr,Ii,Wi,DS,0,Xm,Hm,ws)}(r,qe,qe,Be,i,s,u,Ge,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,he,we,v,0,_e,be,P,e,p,b,E)};if(Me==="line")for(const Be of tx(e.geometry,0,0,Kt,Kt)){const qe=sS(Be,ie,ye,i.vertical||N,s,24,K,r.overscaling,Kt);for(const Re of qe){const ht=N;ht&&mS(r,ht.text,Fe,Re)||Pe(Be,Re)}}else if(Me==="line-center"){for(const Be of e.geometry)if(Be.length>1){const qe=oS(Be,ye,i.vertical||N,s,24,K);qe&&Pe(Be,qe)}}else if(e.type==="Polygon")for(const Be of _m(e.geometry,0)){const qe=uS(Be,16);Pe(Be[0],new _s(qe.x,qe.y,0,0,void 0))}else if(e.type==="LineString")for(const Be of e.geometry)Pe(Be,new _s(Be[0].x,Be[0].y,0,0,void 0));else if(e.type==="Point")for(const Be of e.geometry)for(const qe of Be)Pe([qe],new _s(qe.x,qe.y,0,0,void 0))}const ys=32640;function ax(r,e,i,s,u,p,f,y,v,b,E,I,A,P,N,U){const K=function(_e,ye,we,be,Me,Fe,Ne,Ge){const Pe=[];if(ye.positionedLines.length===0)return Pe;const Be=be.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,qe=function(pt){const Dt=pt[0],lt=pt[1],mt=Dt*lt;return mt>0?[Dt,-lt]:mt<0?[-Dt,lt]:Dt===0?[lt,Dt]:[lt,-Dt]}(we);let Re=Math.abs(ye.top-ye.bottom);for(const pt of ye.positionedLines)Re-=pt.lineOffset;const ht=ye.positionedLines.length,nt=Re/ht;let jt=ye.top-we[1];for(let pt=0;pt<ht;++pt){const Dt=ye.positionedLines[pt];jt=aS(ye,nt,jt,pt);for(const lt of Dt.positionedGlyphs){if(!lt.rect)continue;const mt=lt.rect||{};let Bt=4,tr=!0,bn=1,qn=0;if(lt.imageName){const Gt=Ne[lt.imageName];if(!Gt)continue;if(Gt.sdf){Ye("SDF images are not supported in formatted text and will be ignored.");continue}tr=!1,bn=Gt.pixelRatio,Bt=1/bn}const Wn=(Me||Ge)&&lt.vertical,Mn=lt.metrics.advance*lt.scale/2,Yt=lt.metrics,tn=lt.rect;if(tn===null)continue;Ge&&ye.verticalizable&&(qn=lt.imageName?Mn-lt.metrics.width*lt.scale/2:0);const nr=Me?[lt.x+Mn,lt.y]:[0,0];let zn=[0,0],rr=[0,0],Xn=!1;Me||(Wn?(rr=[lt.x+Mn+qe[0],lt.y+qe[1]-qn],Xn=!0):zn=[lt.x+Mn+we[0],lt.y+we[1]-qn]);const on=tn.w*lt.scale/(bn*(lt.localGlyph?2:1)),Er=tn.h*lt.scale/(bn*(lt.localGlyph?2:1));let Tn,pn,Pn,Cr;if(Wn){const Gt=lt.y-jt,kr=new J(-Mn,Mn-Gt),Yr=-Math.PI/2,qi=new J(...rr);Tn=new J(-Mn+zn[0],zn[1]),Tn._rotateAround(Yr,kr)._add(qi),Tn.x+=-Gt+Mn,Tn.y-=(Yt.left-Bt)*lt.scale;const Ii=lt.imageName?Yt.advance*lt.scale:lr*lt.scale,Wi=String.fromCharCode(lt.glyph);$T(Wi)?Tn.x+=(1-Bt)*lt.scale:jT(Wi)?Tn.x+=Ii-Yt.height*lt.scale+(-Bt-1)*lt.scale:Tn.x+=lt.imageName||Yt.width+2*Bt===tn.w&&Yt.height+2*Bt===tn.h?(Ii-Er)/2:(Ii-(Yt.height+2*Bt)*lt.scale)/2,pn=new J(Tn.x,Tn.y-on),Pn=new J(Tn.x+Er,Tn.y),Cr=new J(Tn.x+Er,Tn.y-on)}else{const Gt=(Yt.left-Bt)*lt.scale-Mn+zn[0],kr=(-Yt.top-Bt)*lt.scale+zn[1],Yr=Gt+on,qi=kr+Er;Tn=new J(Gt,kr),pn=new J(Yr,kr),Pn=new J(Gt,qi),Cr=new J(Yr,qi)}if(Be){let Gt;Gt=Me?new J(0,0):Xn?new J(qe[0],qe[1]):new J(we[0],we[1]),Tn._rotateAround(Be,Gt),pn._rotateAround(Be,Gt),Pn._rotateAround(Be,Gt),Cr._rotateAround(Be,Gt)}const ir=new J(0,0),Fn=new J(0,0);Pe.push({tl:Tn,tr:pn,bl:Pn,br:Cr,tex:mt,writingMode:ye.writingMode,glyphOffset:nr,sectionIndex:lt.sectionIndex,isSDF:tr,pixelOffsetTL:ir,pixelOffsetBR:Fn,minFontScaleX:0,minFontScaleY:0})}}return Pe}(0,s,v,p,f,y,u,r.allowVerticalPlacement),ie=r.textSizeData;let he=null;ie.kind==="source"?(he=[oo*p.layout.get("text-size").evaluate(y,{},U)],he[0]>ys&&Ye(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ie.kind==="composite"&&(he=[oo*N.compositeTextSizes[0].evaluate(y,{},U),oo*N.compositeTextSizes[1].evaluate(y,{},U)],(he[0]>ys||he[1]>ys)&&Ye(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,K,he,v,f,y,E,e,i,b.lineStartIndex,b.lineLength,P,U);for(const _e of I)A[_e]=r.text.placedSymbolArray.length-1;return 4*K.length}function lx(r){for(const e in r)return r[e];return null}function Hd(r,e,i,s,u,p,f,y,v,b){let E=f.top,I=f.bottom,A=f.left,P=f.right;const N=f.collisionPadding;if(N&&(A-=N[0],E-=N[1],P+=N[2],I+=N[3]),v){const U=new J(A,E),K=new J(P,E),ie=new J(A,I),he=new J(P,I),_e=Q(v);let ye=new J(0,0);b&&(ye=new J(b[0],b[1])),U._rotateAround(_e,ye),K._rotateAround(_e,ye),ie._rotateAround(_e,ye),he._rotateAround(_e,ye),A=Math.min(U.x,K.x,ie.x,he.x),P=Math.max(U.x,K.x,ie.x,he.x),E=Math.min(U.y,K.y,ie.y,he.y),I=Math.max(U.y,K.y,ie.y,he.y)}return r.emplaceBack(e.x,e.y,e.z,i.x,i.y,A,E,P,I,y,s,u,p),r.length-1}function Dm(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function mS(r,e,i,s){const u=r.compareText;if(e in u){const p=u[e];for(let f=p.length-1;f>=0;f--)if(s.dist(p[f])<i)return!0}else u[e]=[];return u[e].push(s),!1}const gS=va.VectorTileFeature.types,_S=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kd(r,e,i,s,u,p,f,y,v,b,E,I,A,P,N,U){const K=E?Math.min(ys,Math.round(E[0])):0,ie=E?Math.min(ys,Math.round(E[1])):0;r.emplaceBack(e,i,Math.round(32*f),Math.round(32*y),v,b,(K<<1)+(I?1:0),ie,16*A,16*P,256*N,256*U,s,u,p,0)}function Rm(r,e,i){r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i)}function yS(r){for(const e of r.sections)if(h(e.text))return!0;return!1}class Lm{constructor(e){this.layoutVertexArray=new Xr,this.indexArray=new nn,this.programConfigurations=e,this.segments=new _r,this.dynamicLayoutVertexArray=new xt,this.opacityVertexArray=new Ei,this.placedSymbolArray=new ga}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,LT.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,BT.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,_S,!0),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}rt("SymbolBuffers",Lm);class Bm{constructor(e,i,s){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new s,this.segments=new _r,this.collisionVertexArray=new $i,this.collisionVertexArrayExt=new xt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,FT.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,OT.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}rt("CollisionBuffers",Bm);class xs{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(f=>f.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=lm([]),this.placementViewportMatrix=lm([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tm(this.zoom,i["text-size"]),this.iconSizeData=Tm(this.zoom,i["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),p=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(f=>gi[f]),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.sourceID=e.sourceID}createArrays(){this.text=new Lm(new _a(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Lm(new _a(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new jy,this.lineVertexArray=new Gy,this.symbolInstances=new $y}calculateGlyphDependencies(e,i,s,u,p){for(let f=0;f<e.length;f++)if(i[e.charCodeAt(f)]=!0,u&&p){const y=Eu[e.charAt(f)];y&&(i[y.charCodeAt(0)]=!0)}}populate(e,i,s){const u=this.layers[0],p=u.layout,f=p.get("text-font"),y=p.get("text-field"),v=p.get("icon-image"),b=(y.value.kind!=="constant"||y.value.value instanceof Zn&&!y.value.value.isEmpty()||y.value.value.toString().length>0)&&(f.value.kind!=="constant"||f.value.value.length>0),E=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,I=p.get("symbol-sort-key");if(this.features=[],!b&&!E)return;const A=i.iconDependencies,P=i.glyphDependencies,N=i.availableImages,U=new O(this.zoom);for(const{feature:K,id:ie,index:he,sourceLayerIndex:_e}of e){const ye=u._featureFilter.needGeometry,we=xa(K,ye);if(!u._featureFilter.filter(U,we,s))continue;let be,Me;if(ye||(we.geometry=ya(K)),b){const Ne=u.getValueAndResolveTokens("text-field",we,s,N),Ge=Zn.factory(Ne);yS(Ge)&&(this.hasRTLText=!0),(!this.hasRTLText||z()==="unavailable"||this.hasRTLText&&F.isParsed())&&(be=VT(Ge,u,we))}if(E){const Ne=u.getValueAndResolveTokens("icon-image",we,s,N);Me=Ne instanceof Fr?Ne:Fr.fromString(Ne)}if(!be&&!Me)continue;const Fe=this.sortFeaturesByKey?I.evaluate(we,{},s):void 0;if(this.features.push({id:ie,text:be,icon:Me,index:he,sourceLayerIndex:_e,geometry:we.geometry,properties:K.properties,type:gS[K.type],sortKey:Fe}),Me&&(A[Me.name]=!0),be){const Ne=f.evaluate(we,{},s).join(","),Ge=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(gi.vertical)>=0;for(const Pe of be.sections)if(Pe.image)A[Pe.image.name]=!0;else{const Be=Do(be.toString()),qe=Pe.fontStack||Ne,Re=P[qe]=P[qe]||{};this.calculateGlyphDependencies(Pe.text,Re,Ge,this.allowVerticalPlacement,Be)}}}p.get("symbol-placement")==="line"&&(this.features=function(K){const ie={},he={},_e=[];let ye=0;function we(Ne){_e.push(K[Ne]),ye++}function be(Ne,Ge,Pe){const Be=he[Ne];return delete he[Ne],he[Ge]=Be,_e[Be].geometry[0].pop(),_e[Be].geometry[0]=_e[Be].geometry[0].concat(Pe[0]),Be}function Me(Ne,Ge,Pe){const Be=ie[Ge];return delete ie[Ge],ie[Ne]=Be,_e[Be].geometry[0].shift(),_e[Be].geometry[0]=Pe[0].concat(_e[Be].geometry[0]),Be}function Fe(Ne,Ge,Pe){const Be=Pe?Ge[0][Ge[0].length-1]:Ge[0][0];return`${Ne}:${Be.x}:${Be.y}`}for(let Ne=0;Ne<K.length;Ne++){const Ge=K[Ne],Pe=Ge.geometry,Be=Ge.text?Ge.text.toString():null;if(!Be){we(Ne);continue}const qe=Fe(Be,Pe),Re=Fe(Be,Pe,!0);if(qe in he&&Re in ie&&he[qe]!==ie[Re]){const ht=Me(qe,Re,Pe),nt=be(qe,Re,_e[ht].geometry);delete ie[qe],delete he[Re],he[Fe(Be,_e[nt].geometry,!0)]=nt,_e[ht].geometry=null}else qe in he?be(qe,Re,Pe):Re in ie?Me(qe,Re,Pe):(we(Ne),ie[qe]=ye-1,he[Re]=ye-1)}return _e.filter(Ne=>Ne.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((K,ie)=>K.sortKey-ie.sortKey)}update(e,i,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,s),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const s=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(i[e.segment+1]),p=e.dist(i[e.segment]);const f={};for(let y=e.segment+1;y<i.length;y++)f[y]={x:i[y].x,y:i[y].y,tileUnitDistanceFromAnchor:u},y<i.length-1&&(u+=i[y+1].dist(i[y]));for(let y=e.segment||0;y>=0;y--)f[y]={x:i[y].x,y:i[y].y,tileUnitDistanceFromAnchor:p},y>0&&(p+=i[y-1].dist(i[y]));for(let y=0;y<i.length;y++){const v=f[y];this.lineVertexArray.emplaceBack(v.x,v.y,v.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,i,s,u,p,f,y,v,b,E,I,A,P){const N=e.indexArray,U=e.layoutVertexArray,K=e.segments.prepareSegment(4*i.length,U,N,this.canOverlap?f.sortKey:void 0),ie=this.glyphOffsetArray.length,he=K.vertexLength,_e=this.allowVerticalPlacement&&y===gi.vertical?Math.PI/2:0,ye=f.text&&f.text.sections;for(let we=0;we<i.length;we++){const{tl:be,tr:Me,bl:Fe,br:Ne,tex:Ge,pixelOffsetTL:Pe,pixelOffsetBR:Be,minFontScaleX:qe,minFontScaleY:Re,glyphOffset:ht,isSDF:nt,sectionIndex:jt}=i[we],pt=K.vertexLength,Dt=ht[1];Kd(U,v.x,v.y,v.z,b.x,b.y,be.x,Dt+be.y,Ge.x,Ge.y,s,nt,Pe.x,Pe.y,qe,Re),Kd(U,v.x,v.y,v.z,b.x,b.y,Me.x,Dt+Me.y,Ge.x+Ge.w,Ge.y,s,nt,Be.x,Pe.y,qe,Re),Kd(U,v.x,v.y,v.z,b.x,b.y,Fe.x,Dt+Fe.y,Ge.x,Ge.y+Ge.h,s,nt,Pe.x,Be.y,qe,Re),Kd(U,v.x,v.y,v.z,b.x,b.y,Ne.x,Dt+Ne.y,Ge.x+Ge.w,Ge.y+Ge.h,s,nt,Be.x,Be.y,qe,Re),Rm(e.dynamicLayoutVertexArray,v,_e),N.emplaceBack(pt,pt+1,pt+2),N.emplaceBack(pt+1,pt+2,pt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ht[0]),we!==i.length-1&&jt===i[we+1].sectionIndex||e.programConfigurations.populatePaintArrays(U.length,f,f.index,{},P,ye&&ye[jt])}e.placedSymbolArray.emplaceBack(v.x,v.y,v.z,b.x,b.y,ie,this.glyphOffsetArray.length-ie,he,E,I,b.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],y,0,!1,0,A,0)}_commitLayoutVertex(e,i,s,u,p,f,y){e.emplaceBack(i,s,u,p,f,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,i,s,u,p,f,y){const v=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),b=v.vertexLength,E=y.tileAnchorX,I=y.tileAnchorY;for(let P=0;P<4;P++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,u,p,f,E,I,new J(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,p,f,E,I,new J(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,p,f,E,I,new J(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,p,f,E,I,new J(e.x1,e.y2)),v.vertexLength+=4;const A=s.indexArray;A.emplaceBack(b,b+1),A.emplaceBack(b+1,b+2),A.emplaceBack(b+2,b+3),A.emplaceBack(b+3,b),v.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,s,u,p,f){for(let y=u;y<p;y++){const v=s.get(y),b=this.getSymbolInstanceTextSize(e,f,i,y);this._addCollisionDebugVertices(v,b,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,f)}}_addIconDebugCollisionBoxes(e,i,s,u,p,f){for(let y=u;y<p;y++){const v=s.get(y),b=this.getSymbolInstanceIconSize(e,i,y);this._addCollisionDebugVertices(v,b,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,f)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Bm(Tr,B0.members,er),this.iconCollisionBox=new Bm(Tr,B0.members,er);const s=zl(this.iconSizeData,e),u=zl(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const f=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(u,e,i,f.textBoxStartIndex,f.textBoxEndIndex,f),this._addTextDebugCollisionBoxes(u,e,i,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,e,i,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,e,i,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}}getSymbolInstanceTextSize(e,i,s,u){const p=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:u),f=jd(this.textSizeData,e,p)/lr;return this.tilePixelRatio*f}getSymbolInstanceIconSize(e,i,s){const u=this.icon.placedSymbolArray.get(s),p=jd(this.iconSizeData,e,u);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(e,i,s){e.emplaceBack(i,-s,-s),e.emplaceBack(i,s,-s),e.emplaceBack(i,s,s),e.emplaceBack(i,-s,s)}_updateTextDebugCollisionBoxes(e,i,s,u,p,f){for(let y=u;y<p;y++){const v=s.get(y),b=this.getSymbolInstanceTextSize(e,f,i,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,v.padding)}}_updateIconDebugCollisionBoxes(e,i,s,u,p){for(let f=u;f<p;f++){const y=s.get(f),v=this.getSymbolInstanceIconSize(e,i,f);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,v,y.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=zl(this.iconSizeData,e),u=zl(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const f=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(u,e,i,f.textBoxStartIndex,f.textBoxEndIndex,f),this._updateTextDebugCollisionBoxes(u,e,i,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,e,i,f.iconBoxStartIndex,f.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(s,e,i,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,s,u,p,f,y,v,b){const E={};for(let I=i;I<s;I++){const A=e.get(I);E.textBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,padding:A.padding,projectedAnchorX:A.projectedAnchorX,projectedAnchorY:A.projectedAnchorY,projectedAnchorZ:A.projectedAnchorZ,tileAnchorX:A.tileAnchorX,tileAnchorY:A.tileAnchorY},E.textFeatureIndex=A.featureIndex;break}for(let I=u;I<p;I++){const A=e.get(I);E.verticalTextBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,padding:A.padding,projectedAnchorX:A.projectedAnchorX,projectedAnchorY:A.projectedAnchorY,projectedAnchorZ:A.projectedAnchorZ,tileAnchorX:A.tileAnchorX,tileAnchorY:A.tileAnchorY},E.verticalTextFeatureIndex=A.featureIndex;break}for(let I=f;I<y;I++){const A=e.get(I);E.iconBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,padding:A.padding,projectedAnchorX:A.projectedAnchorX,projectedAnchorY:A.projectedAnchorY,projectedAnchorZ:A.projectedAnchorZ,tileAnchorX:A.tileAnchorX,tileAnchorY:A.tileAnchorY},E.iconFeatureIndex=A.featureIndex;break}for(let I=v;I<b;I++){const A=e.get(I);E.verticalIconBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,padding:A.padding,projectedAnchorX:A.projectedAnchorX,projectedAnchorY:A.projectedAnchorY,projectedAnchorZ:A.projectedAnchorZ,tileAnchorX:A.tileAnchorX,tileAnchorY:A.tileAnchorY},E.verticalIconFeatureIndex=A.featureIndex;break}return E}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const s=e.placedSymbolArray.get(i),u=s.vertexStartIndex+4*s.numGlyphs;for(let p=s.vertexStartIndex;p<u;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),s=Math.cos(e),u=[],p=[],f=[];for(let y=0;y<this.symbolInstances.length;++y){f.push(y);const v=this.symbolInstances.get(y);u.push(0|Math.round(i*v.tileAnchorX+s*v.tileAnchorY)),p.push(v.featureIndex)}return f.sort((y,v)=>u[y]-u[v]||p[v]-p[y]),f}addToSortKeyRanges(e,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((u,p,f)=>{u>=0&&f.indexOf(u)===p&&this.addIndicesForPlacedSymbol(this.text,u)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}rt("SymbolBucket",xs,{omit:["layers","collisionBoxArray","features","compareText"]}),xs.MAX_GLYPHS=65535,xs.addDynamicAttributes=Rm;const xS=new Ee({"symbol-placement":new Y(ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Y(ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Y(ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pe(ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Y(ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Y(ae.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Y(ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Y(ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Y(ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new pe(ae.layout_symbol["icon-size"]),"icon-text-fit":new Y(ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Y(ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new pe(ae.layout_symbol["icon-image"]),"icon-rotate":new pe(ae.layout_symbol["icon-rotate"]),"icon-padding":new Y(ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Y(ae.layout_symbol["icon-keep-upright"]),"icon-offset":new pe(ae.layout_symbol["icon-offset"]),"icon-anchor":new pe(ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Y(ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Y(ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Y(ae.layout_symbol["text-rotation-alignment"]),"text-field":new pe(ae.layout_symbol["text-field"]),"text-font":new pe(ae.layout_symbol["text-font"]),"text-size":new pe(ae.layout_symbol["text-size"]),"text-max-width":new pe(ae.layout_symbol["text-max-width"]),"text-line-height":new pe(ae.layout_symbol["text-line-height"]),"text-letter-spacing":new pe(ae.layout_symbol["text-letter-spacing"]),"text-justify":new pe(ae.layout_symbol["text-justify"]),"text-radial-offset":new pe(ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Y(ae.layout_symbol["text-variable-anchor"]),"text-anchor":new pe(ae.layout_symbol["text-anchor"]),"text-max-angle":new Y(ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Y(ae.layout_symbol["text-writing-mode"]),"text-rotate":new pe(ae.layout_symbol["text-rotate"]),"text-padding":new Y(ae.layout_symbol["text-padding"]),"text-keep-upright":new Y(ae.layout_symbol["text-keep-upright"]),"text-transform":new pe(ae.layout_symbol["text-transform"]),"text-offset":new pe(ae.layout_symbol["text-offset"]),"text-allow-overlap":new Y(ae.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Y(ae.layout_symbol["text-ignore-placement"]),"text-optional":new Y(ae.layout_symbol["text-optional"])});var Fm={paint:new Ee({"icon-opacity":new pe(ae.paint_symbol["icon-opacity"]),"icon-color":new pe(ae.paint_symbol["icon-color"]),"icon-halo-color":new pe(ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new pe(ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pe(ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Y(ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Y(ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new pe(ae.paint_symbol["text-opacity"]),"text-color":new pe(ae.paint_symbol["text-color"],{runtimeType:ui,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new pe(ae.paint_symbol["text-halo-color"]),"text-halo-width":new pe(ae.paint_symbol["text-halo-width"]),"text-halo-blur":new pe(ae.paint_symbol["text-halo-blur"]),"text-translate":new Y(ae.paint_symbol["text-translate"]),"text-translate-anchor":new Y(ae.paint_symbol["text-translate-anchor"])}),layout:xS};class cx{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Fi,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}rt("FormatSectionOverride",cx,{omit:["defaultValue"]});class Yd extends Gi{constructor(e){super(e,Fm)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const p of s)u.indexOf(p)<0&&u.push(p);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,s,u){const p=this.layout.get(e).evaluate(i,{},s,u),f=this._unevaluatedLayout._values[e];return f.isDataDriven()||cl(f.value)||!p?p:function(y,v){return v.replace(/{([^{}]+)}/g,(b,E)=>E in y?String(y[E]):"")}(i.properties,p)}createBucket(e){return new xs(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Fm.paint.overridableProperties){if(!Yd.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),s=new cx(i),u=new Hc(s,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new ul("source",u):new no("composite",u,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new se(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&Yd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const s=e.get("text-field"),u=Fm.paint.properties[i];let p=!1;const f=y=>{for(const v of y)if(u.overrides&&u.overrides.hasOverride(v))return void(p=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Zn)f(s.value.value.sections);else if(s.value.kind==="source"){const y=b=>{p||(b instanceof Ni&&Vn(b.value)===Ks?f(b.value.sections):b instanceof Qs?f(b.sections):b.eachChild(y))},v=s.value;v._styleExpression&&y(v._styleExpression.expression)}return p}getProgramConfiguration(e){return new Fo(this,e)}}var vS={paint:new Ee({"background-color":new Y(ae.paint_background["background-color"]),"background-pattern":new De(ae.paint_background["background-pattern"]),"background-opacity":new Y(ae.paint_background["background-opacity"])})},wS={paint:new Ee({"raster-opacity":new Y(ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Y(ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Y(ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Y(ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Y(ae.paint_raster["raster-saturation"]),"raster-contrast":new Y(ae.paint_raster["raster-contrast"]),"raster-resampling":new Y(ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Y(ae.paint_raster["raster-fade-duration"])})};class bS extends Gi{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var TS={paint:new Ee({"sky-type":new Y(ae.paint_sky["sky-type"]),"sky-atmosphere-sun":new Y(ae.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Y(ae.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Y(ae.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Y(ae.paint_sky["sky-gradient-radius"]),"sky-gradient":new de(ae.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Y(ae.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Y(ae.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Y(ae.paint_sky["sky-opacity"])})};function Om(r,e,i){const s=Il(0,0,1),u=g0(cm());return function(p,f,y){y*=.5;var v=f[0],b=f[1],E=f[2],I=f[3],A=Math.sin(y),P=Math.cos(y);p[0]=v*P-E*A,p[1]=b*P+I*A,p[2]=E*P+v*A,p[3]=I*P-b*A}(u,u,i?-Q(r)+Math.PI:Q(r)),_0(u,u,-Q(e)),m0(s,s,u),f0(s,s)}const SS={circle:class extends Gi{constructor(r){super(r,j2)}createBucket(r){return new om(r)}queryRadius(r){const e=r;return kl("circle-radius",this,e)+kl("circle-stroke-width",this,e)+Fd(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,i,s,u,p,f,y){const v=a0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return y0(r,s,p,f,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,b)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new Fo(this,r)}},heatmap:class extends Gi{createBucket(r){return new v0(r)}constructor(r){super(r,Y2),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=dm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return kl("heatmap-radius",this,r)}queryIntersectsFeature(r,e,i,s,u,p,f,y){const v=this.paint.get("heatmap-radius").evaluate(e,i);return y0(r,s,p,f,y,!0,!0,new J(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new Fo(this,r)}},hillshade:class extends Gi{constructor(r){super(r,Q2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(r){return new Fo(this,r)}},fill:class extends Gi{constructor(r){super(r,mT)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(r){return new Fo(this,r)}recalculate(r,e){super.recalculate(r,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new vm(r)}queryRadius(){return Fd(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,i,s,u,p){return!r.queryGeometry.isAboveHorizon&&n0(s0(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Gi{constructor(r){super(r,CT)}createBucket(r){return new wm(r)}queryRadius(){return Fd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new Fo(this,r)}queryIntersectsFeature(r,e,i,s,u,p,f,y,v){const b=a0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),E=this.paint.get("fill-extrusion-height").evaluate(e,i),I=this.paint.get("fill-extrusion-base").evaluate(e,i),A=[0,0],P=y&&p.elevation,N=p.elevation?p.elevation.exaggeration():1;if(P){const ie=r.tile.getBucket(this).centroidVertexArray,he=v+1;if(he<ie.length){const _e=ie.get(he);A[0]=_e.a_centroid_pos0,A[1]=_e.a_centroid_pos1}}if(A[0]===0&&A[1]===1)return!1;const U=function(ie,he,_e,ye,we,be,Me,Fe,Ne){return be?function(Ge,Pe,Be,qe,Re,ht,nt,jt,pt){const Dt=[],lt=[],mt=[0,0,0,1];for(const Bt of Ge){const tr=[],bn=[];for(const qn of Bt){const Wn=qn.x+qe.x,Mn=qn.y+qe.y,Yt=kT(Wn,Mn,Pe,Be,ht,nt,jt,pt);mt[0]=Wn,mt[1]=Mn,mt[2]=Yt.base,mt[3]=1,yu(mt,mt,Re),mt[3]=Math.max(mt[3],1e-5);const tn=P0([mt[0]/mt[3],mt[1]/mt[3],mt[2]/mt[3]]);mt[0]=Wn,mt[1]=Mn,mt[2]=Yt.top,mt[3]=1,yu(mt,mt,Re),mt[3]=Math.max(mt[3],1e-5);const nr=P0([mt[0]/mt[3],mt[1]/mt[3],mt[2]/mt[3]]);tr.push(tn),bn.push(nr)}Dt.push(tr),lt.push(bn)}return[Dt,lt]}(ie,he,_e,ye,we,be,Me,Fe,Ne):function(Ge,Pe,Be,qe,Re){const ht=[],nt=[],jt=Re[8]*Pe,pt=Re[9]*Pe,Dt=Re[10]*Pe,lt=Re[11]*Pe,mt=Re[8]*Be,Bt=Re[9]*Be,tr=Re[10]*Be,bn=Re[11]*Be;for(const qn of Ge){const Wn=[],Mn=[];for(const Yt of qn){const tn=Yt.x+qe.x,nr=Yt.y+qe.y,zn=Re[0]*tn+Re[4]*nr+Re[12],rr=Re[1]*tn+Re[5]*nr+Re[13],Xn=Re[2]*tn+Re[6]*nr+Re[14],on=Re[3]*tn+Re[7]*nr+Re[15],Er=zn+jt,Tn=rr+pt,pn=Xn+Dt,Pn=Math.max(on+lt,1e-5),Cr=zn+mt,ir=rr+Bt,Fn=Xn+tr,Gt=Math.max(on+bn,1e-5),kr=new J(Er/Pn,Tn/Pn);kr.z=pn/Pn,Wn.push(kr);const Yr=new J(Cr/Gt,ir/Gt);Yr.z=Fn/Gt,Mn.push(Yr)}ht.push(Wn),nt.push(Mn)}return[ht,nt]}(ie,he,_e,ye,we)}(s,I,E,b,f,P?y:null,A,N,p.center.lat),K=r.queryGeometry;return function(ie,he,_e){let ye=1/0;n0(_e,he)&&(ye=z0(_e,he[0]));for(let we=0;we<he.length;we++){const be=he[we],Me=ie[we];for(let Fe=0;Fe<be.length-1;Fe++){const Ne=be[Fe],Ge=[Ne,be[Fe+1],Me[Fe+1],Me[Fe],Ne];t0(_e,Ge)&&(ye=Math.min(ye,z0(_e,Ge)))}}return ye!==1/0&&ye}(U[0],U[1],K.isPointQuery()?K.screenBounds:K.screenGeometry)}},line:class extends Gi{constructor(r){super(r,D0),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ns,this.gradientVersion=(this.gradientVersion+1)%Ae}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=R0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new bm(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new Fo(this,r)}queryRadius(r){const e=r,i=L0(kl("line-width",this,e),kl("line-gap-width",this,e)),s=kl("line-offset",this,e);return i/2+Math.abs(s)+Fd(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,i,s,u,p){if(r.queryGeometry.isAboveHorizon)return!1;const f=s0(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),y=r.pixelToTileUnitsFactor/2*L0(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),v=this.paint.get("line-offset").evaluate(e,i);return v&&(s=function(b,E){const I=[],A=new J(0,0);for(let P=0;P<b.length;P++){const N=b[P],U=[];for(let K=0;K<N.length;K++){const ie=N[K-1],he=N[K],_e=N[K+1],ye=K===0?A:he.sub(ie)._unit()._perp(),we=K===N.length-1?A:_e.sub(he)._unit()._perp(),be=ye._add(we)._unit();be._mult(1/(be.x*we.x+be.y*we.y)),U.push(be._mult(E)._add(he))}I.push(U)}return I}(s,v*r.pixelToTileUnitsFactor)),function(b,E,I){for(let A=0;A<E.length;A++){const P=E[A];if(b.length>=3){for(let N=0;N<P.length;N++)if(Cl(b,P[N]))return!0}if(N2(b,P,I))return!0}return!1}(f,s,y)}isTileClipped(){return!0}},symbol:Yd,background:class extends Gi{constructor(r){super(r,vS)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Gi{constructor(r){super(r,wS)}getProgramIds(){return["raster"]}},sky:class extends Gi{constructor(r){super(r,TS),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=dm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(r,e){const i=this.paint.get("sky-type");if(i==="atmosphere"){const s=this.paint.get("sky-atmosphere-sun"),u=!s,p=r.style.light,f=p.properties.get("position");return u&&p.properties.get("anchor")==="viewport"&&Ye("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Om(f.azimuthal,90-f.polar,e):Om(s[0],90-s[1],e)}if(i==="gradient"){const s=this.paint.get("sky-gradient-center");return Om(s[0],90-s[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}},{HTMLImageElement:ux,HTMLCanvasElement:hx,HTMLVideoElement:dx,ImageData:px,ImageBitmap:Qd}=ve;class Jd{constructor(e,i,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,s){const{width:u,height:p}=e,f=!(this.size&&this.size[0]===u&&this.size[1]===p||s),{context:y}=this,{gl:v}=y;if(this.useMipmap=Boolean(i&&i.useMipmap),v.bindTexture(v.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!i||i.premultiply!==!1)),f)this.size=[u,p],e instanceof ux||e instanceof hx||e instanceof dx||e instanceof px||Qd&&e instanceof Qd?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,u,p,0,this.format,v.UNSIGNED_BYTE,e.data);else{const{x:b,y:E}=s||{x:0,y:0};e instanceof ux||e instanceof hx||e instanceof dx||e instanceof px||Qd&&e instanceof Qd?v.texSubImage2D(v.TEXTURE_2D,0,b,E,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,b,E,u,p,v.RGBA,v.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&v.generateMipmap(v.TEXTURE_2D)}bind(e,i,s){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),s!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,s||e),this.filter=e),i!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class wa{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof An?new An(e.lng,e.lat):An.convert(e),this}setSouthWest(e){return this._sw=e instanceof An?new An(e.lng,e.lat):An.convert(e),this}extend(e){const i=this._sw,s=this._ne;let u,p;if(e instanceof An)u=e,p=e;else{if(!(e instanceof wa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(wa.convert(e)):this.extend(An.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return i||s?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),s.lng=Math.max(p.lng,s.lng),s.lat=Math.max(p.lat,s.lat)):(this._sw=new An(u.lng,u.lat),this._ne=new An(p.lng,p.lat)),this}getCenter(){return new An((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new An(this.getWest(),this.getNorth())}getSouthEast(){return new An(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:s}=An.convert(e);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof wa?e:new wa(e)}}const fx=63710088e-1;class An{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new An($e(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,s=this.lat*i,u=e.lat*i,p=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return fx*Math.acos(Math.min(p,1))}toBounds(e=0){const i=360*e/40075017,s=i/Math.cos(Math.PI/180*this.lat);return new wa(new An(this.lng-s,this.lat-i),new An(this.lng+s,this.lat+i))}static convert(e){if(e instanceof An)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new An(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new An(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const mx=2*Math.PI*fx;function gx(r){return mx*Math.cos(r*Math.PI/180)}function _x(r){return(180+r)/360}function yx(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Nm(r,e){return r/gx(e)}function ep(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Um(r,e){return r*gx(ep(e))}class Fl{constructor(e,i,s=0){this.x=+e,this.y=+i,this.z=+s}static fromLngLat(e,i=0){const s=An.convert(e);return new Fl(_x(s.lng),yx(s.lat),Nm(i,s.lat))}toLngLat(){return new An(360*this.x-180,ep(this.y))}toAltitude(){return Um(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/mx*(e=ep(this.y),1/Math.cos(e*Math.PI/180));var e}}class Vm{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new ms({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const s=this.getKey(e,i);return this.positions[s]}trim(){const e=this.width,i=this.height=Zt(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,s){const u=[];let p=e.length%2==1?-e[e.length-1]*s:0,f=e[0]*s,y=!0;u.push({left:p,right:f,isDash:y,zeroLength:e[0]===0});let v=e[0];for(let b=1;b<e.length;b++){y=!y;const E=e[b];p=v*s,v+=E,f=v*s,u.push({left:p,right:f,isDash:y,zeroLength:E===0})}return u}addRoundDash(e,i,s){const u=i/2;for(let p=-s;p<=s;p++){const f=this.width*(this.nextRow+s+p);let y=0,v=e[y];for(let b=0;b<this.width;b++){b/v.right>1&&(v=e[++y]);const E=Math.abs(b-v.left),I=Math.abs(b-v.right),A=Math.min(E,I);let P;const N=p/s*(u+1);if(v.isDash){const U=u-Math.abs(N);P=Math.sqrt(A*A+U*U)}else P=u-Math.sqrt(A*A+N*N);this.image.data[f+b]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(e,i){for(let v=e.length-1;v>=0;--v){const b=e[v],E=e[v+1];b.zeroLength?e.splice(v,1):E&&E.isDash===b.isDash&&(E.left=b.left,e.splice(v,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const p=this.width*this.nextRow;let f=0,y=e[f];for(let v=0;v<this.width;v++){v/y.right>1&&(y=e[++f]);const b=Math.abs(v-y.left),E=Math.abs(v-y.right),I=Math.min(b,E);this.image.data[p+v]=Math.max(0,Math.min(255,(y.isDash?I:-I)+i+128))}}addDash(e,i){const s=this.getKey(e,i);if(this.positions[s])return this.positions[s];const u=i==="round",p=u?7:0,f=2*p+1;if(this.nextRow+f>this.height)return Ye("LineAtlas out of space"),null;e.length===0&&e.push(1);let y=0;for(let E=0;E<e.length;E++)e[E]<0&&(Ye("Negative value is found in line dasharray, replacing values with 0"),e[E]=0),y+=e[E];if(y!==0){const E=this.width/y,I=this.getDashRanges(e,this.width,E);u?this.addRoundDash(I,E,p):this.addRegularDash(I,i==="square"?.5*E:0)}const v=this.nextRow+p;this.nextRow+=f;const b={tl:[v,p],br:[y,0]};return this.positions[s]=b,b}}rt("LineAtlas",Vm);class ES{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const CS=ve.performance;function xx(r){const e=r?r.url.toString():void 0;return CS.getEntriesByName(e)}class kS{constructor(){this.tasks={},this.taskQueue=[],qt(["process"],this),this.invoker=new ES(this.process),this.nextId=0}add(e,i){const s=this.nextId++,u=function({type:p,isSymbolTile:f,zoom:y}){return y=y||0,p==="message"?0:p!=="maybePrepare"||f?p!=="parseTile"||f?p==="parseTile"&&f?300-y:p==="maybePrepare"&&f?400-y:500:200-y:100-y}(i);if(u===0){Jt();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:i,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){Jt();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let u=0;u<this.taskQueue.length;u++){const p=this.tasks[this.taskQueue[u]];p.priority<i&&(i=p.priority,e=u)}if(e===null)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}function vx(r,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[r*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class $m{constructor(e,i,s){this.z=e,this.x=i,this.y=s,this.key=Au(0,e,e,i,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const s=(p=this.y,f=this.z,y=vx(256*(u=this.x),256*(p=Math.pow(2,f)-p-1),f),v=vx(256*(u+1),256*(p+1),f),y[0]+","+y[1]+","+v[0]+","+v[1]);var u,p,f,y,v;const b=function(E,I,A){let P,N="";for(let U=E;U>0;U--)P=1<<U-1,N+=(I&P?1:0)+(A&P?2:0);return N}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",b).replace("{bbox-epsg-3857}",s)}getTilePoint(e){const i=Math.pow(2,this.z);return new J((e.x*i-this.x)*Kt,(e.y*i-this.y)*Kt)}getTileVec3(e){const i=Math.pow(2,this.z);return Il((e.x*i-this.x)*Kt,(e.y*i-this.y)*Kt,Um(e.z,e.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class wx{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Au(e,i.z,i.z,i.x,i.y)}}class Ur{constructor(e,i,s,u,p){this.overscaledZ=e,this.wrap=i,this.canonical=new $m(s,+u,+p),this.key=i===0&&e===s?this.canonical.key:Au(i,e,s,u,p)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Ur(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ur(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Au(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return Au(this.wrap*+i,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Ur(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new Ur(i,this.wrap,i,s,u),new Ur(i,this.wrap,i,s+1,u),new Ur(i,this.wrap,i,s,u+1),new Ur(i,this.wrap,i,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ur(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ur(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new wx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Fl(e.x-this.wrap,e.y))}getTileVec3(e){return this.canonical.getTileVec3(new Fl(e.x-this.wrap,e.y,e.z))}}function Au(r,e,i,s,u){const p=1<<Math.min(i,22);let f=p*(u%p)+s%p;return r&&i<22&&(f+=p*p*((r<0?-2*r-1:2*r)%(1<<2*(22-i)))),16*(32*f+i)+(e-i)}rt("CanonicalTileID",$m),rt("OverscaledTileID",Ur,{omit:["projMatrix"]});class bx{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const s=e[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class Tx{constructor(e,i,s,u,p){this.type="Feature",this._vectorTileFeature=e,e._z=i,e._x=s,e._y=u,this.properties=e.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(e[i]=this[i]);return e}}var IS=it([{name:"a_pos",type:"Int16",components:2}]);class Sx{constructor(e,i,s){this.tileID=e,this.uid=Rt(),this.uses=0,this.tileSize=i,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const i=e+this.timeAdded;i<Ln.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}loadVectorData(e,i,s){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const f={};if(!p)return f;for(const y of u){const v=y.layerIds.map(b=>p.getLayer(b)).filter(Boolean);if(v.length!==0){y.layers=v,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(b=>v.filter(E=>E.id===b)[0]));for(const b of v)f[b.id]=y}}return f}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof xs){if(this.hasSymbolBuckets=!0,!s)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof xs&&p.hasRTLText){this.hasRTLText=!0,F.isLoading()||F.isLoaded()||z()!=="deferred"||R();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Lo}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const u=this.buckets[s];u.uploadPending()&&u.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Jd(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Jd(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Jd(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,s,u,p,f,y,v){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:y,transform:f,params:p},e,i,s):{}}querySourceFeatures(e,i){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),p=i?i.sourceLayer:"",f=u._geojsonTileLayer||u[p];if(!f)return;const y=cs(i&&i.filter),{z:v,x:b,y:E}=this.tileID.canonical,I={z:v,x:b,y:E};for(let A=0;A<f.length;A++){const P=f.feature(A);if(y.needGeometry){const K=xa(P,!0);if(!y.filter(new O(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!y.filter(new O(this.tileID.overscaledZ),P))continue;const N=s.getId(P,p),U=new Tx(P,v,b,E,N);U.tile=I,e.push(U)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const s=Nn(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const p=this.expirationTime-i;p?this.expirationTime=s+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const s=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!i.style.hasLayer(u))continue;const p=this.buckets[u],f=p.layers[0].sourceLayer||"_geojsonTileLayer",y=s[f],v=e[f];if(!y||!v||Object.keys(v).length===0)continue;p.update(v,y,this.imageAtlas&&this.imageAtlas.patternPositions||{});const b=i&&i.style&&i.style.getLayer(u);b&&(this.queryPadding=Math.max(this.queryPadding,b.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ln.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ln.now()+e}setDependencies(e,i){const s={};for(const u of i)s[u]=!0;this.dependencies[e]=s}hasDependency(e,i){for(const s of e){const u=this.dependencies[s];if(u){for(const p of i)if(u[p])return!0}}return!1}clearQueryDebugViz(){}}class AS{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,s){const u=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ot(this.stateChanges[e][u],s),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])s[p]||(this.deletedStates[e][u][p]=null)}else for(const p in s)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,i,s){if(this.deletedStates[e]===null)return;const u=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&i!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,i){const s=String(i),u=ot({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][i];if(p===null)return{};for(const f in p)delete u[f]}return u}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const f in this.stateChanges[u])this.state[u][f]||(this.state[u][f]={}),ot(this.state[u][f],this.stateChanges[u][f]),p[f]=this.state[u][f];s[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const f in this.state[u])p[f]={},this.state[u][f]={};else for(const f in this.deletedStates[u]){if(this.deletedStates[u][f]===null)this.state[u][f]={};else for(const y of Object.keys(this.deletedStates[u][f]))delete this.state[u][f][y];p[f]=this.state[u][f]}s[u]=s[u]||{},ot(s[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(const u in e)e[u].setFeatureState(s,i)}}class Ex{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const s=this.toIdx(e,i);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Cx(r,e,i,s){let u=0,p=Number.MAX_VALUE;for(let f=0;f<3;f++)if(Math.abs(s[f])<1e-15){if(i[f]<r[f]||i[f]>e[f])return null}else{const y=1/s[f];let v=(r[f]-i[f])*y,b=(e[f]-i[f])*y;if(v>b){const E=v;v=b,b=E}if(v>u&&(u=v),b<p&&(p=b),u>p)return null}return u}function kx(r,e,i,s,u,p,f,y,v,b,E){const I=s-r,A=u-e,P=p-i,N=f-r,U=y-e,K=v-i,ie=E[1]*K-E[2]*U,he=E[2]*N-E[0]*K,_e=E[0]*U-E[1]*N,ye=I*ie+A*he+P*_e;if(Math.abs(ye)<1e-15)return null;const we=1/ye,be=b[0]-r,Me=b[1]-e,Fe=b[2]-i,Ne=(be*ie+Me*he+Fe*_e)*we;if(Ne<0||Ne>1)return null;const Ge=Me*P-Fe*A,Pe=Fe*I-be*P,Be=be*A-Me*I,qe=(E[0]*Ge+E[1]*Pe+E[2]*Be)*we;return qe<0||Ne+qe>1?null:(N*Ge+U*Pe+K*Be)*we}function Ix(r,e,i){return(r-e)/(i-e)}function Ax(r,e,i,s,u,p,f,y,v){const b=1<<i,E=p-s,I=f-u,A=(r+1)/b*E+s,P=(e+0)/b*I+u,N=(e+1)/b*I+u;y[0]=(r+0)/b*E+s,y[1]=P,v[0]=A,v[1]=N}class Mx{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(p){const f=Math.ceil(Math.log2(p.dim/8)),y=[];let v=Math.ceil(Math.pow(2,f));const b=1/v,E=(P,N,U,K,ie)=>{const he=K?1:0,_e=(P+1)*U-he,ye=N*U,we=(N+1)*U-he;ie[0]=P*U,ie[1]=ye,ie[2]=_e,ie[3]=we};let I=new Ex(v);const A=[];for(let P=0;P<v*v;P++){E(P%v,Math.floor(P/v),b,!1,A);const N=vs(A[0],A[1],p),U=vs(A[2],A[1],p),K=vs(A[2],A[3],p),ie=vs(A[0],A[3],p);I.minimums.push(Math.min(N,U,K,ie)),I.maximums.push(Math.max(N,U,K,ie)),I.leaves.push(1)}for(y.push(I),v/=2;v>=1;v/=2){const P=y[y.length-1];I=new Ex(v);for(let N=0;N<v*v;N++){E(N%v,Math.floor(N/v),2,!0,A);const U=P.getElevation(A[0],A[1]),K=P.getElevation(A[2],A[1]),ie=P.getElevation(A[2],A[3]),he=P.getElevation(A[0],A[3]),_e=P.isLeaf(A[0],A[1]),ye=P.isLeaf(A[2],A[1]),we=P.isLeaf(A[2],A[3]),be=P.isLeaf(A[0],A[3]),Me=Math.min(U.min,K.min,ie.min,he.min),Fe=Math.max(U.max,K.max,ie.max,he.max),Ne=_e&&ye&&we&&be;I.maximums.push(Fe),I.minimums.push(Me),I.leaves.push(Fe-Me<=5&&Ne?1:0)}y.push(I)}return y}(this.dem),s=i.length-1,u=i[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(i,0,0,s,0)}raycastRoot(e,i,s,u,p,f,y=1){return Cx([e,i,-100],[s,u,this.maximums[0]*y],p,f)}raycast(e,i,s,u,p,f,y=1){if(!this.nodeCount)return null;const v=this.raycastRoot(e,i,s,u,p,f,y);if(v==null)return null;const b=[],E=[],I=[],A=[],P=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;P.length>0;){const{idx:N,t:U,nodex:K,nodey:ie,depth:he}=P.pop();if(this.leaves[N]){Ax(K,ie,he,e,i,s,u,I,A);const ye=1<<he,we=(K+0)/ye,be=(K+1)/ye,Me=(ie+0)/ye,Fe=(ie+1)/ye,Ne=vs(we,Me,this.dem)*y,Ge=vs(be,Me,this.dem)*y,Pe=vs(be,Fe,this.dem)*y,Be=vs(we,Fe,this.dem)*y,qe=kx(I[0],I[1],Ne,A[0],I[1],Ge,A[0],A[1],Pe,p,f),Re=kx(A[0],A[1],Pe,I[0],A[1],Be,I[0],I[1],Ne,p,f),ht=Math.min(qe!==null?qe:Number.MAX_VALUE,Re!==null?Re:Number.MAX_VALUE);if(ht!==Number.MAX_VALUE)return ht;{const nt=p0([],p,f,U);if(zx(Ne,Ge,Be,Pe,Ix(nt[0],I[0],A[0]),Ix(nt[1],I[1],A[1]))>=nt[2])return U}continue}let _e=0;for(let ye=0;ye<this._siblingOffset.length;ye++){Ax((K<<1)+this._siblingOffset[ye][0],(ie<<1)+this._siblingOffset[ye][1],he+1,e,i,s,u,I,A),I[2]=-100,A[2]=this.maximums[this.childOffsets[N]+ye]*y;const we=Cx(I,A,p,f);if(we!=null){const be=we;b[ye]=be;let Me=!1;for(let Fe=0;Fe<_e&&!Me;Fe++)be>=b[E[Fe]]&&(E.splice(Fe,0,ye),Me=!0);Me||(E[_e]=ye),_e++}}for(let ye=0;ye<_e;ye++){const we=E[ye];P.push({idx:this.childOffsets[N]+we,t:b[we],nodex:(K<<1)+this._siblingOffset[we][0],nodey:(ie<<1)+this._siblingOffset[we][1],depth:he+1})}}return null}_addNode(e,i,s){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,s,u,p){if(e[u].isLeaf(i,s)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const f=u-1,y=e[f];let v,b=0;for(let E=0;E<this._siblingOffset.length;E++){const I=2*i+this._siblingOffset[E][0],A=2*s+this._siblingOffset[E][1],P=y.getElevation(I,A),N=y.isLeaf(I,A),U=this._addNode(P.min,P.max,N);N&&(b|=1<<E),v||(v=U)}for(let E=0;E<this._siblingOffset.length;E++)b&1<<E||this._construct(e,2*i+this._siblingOffset[E][0],2*s+this._siblingOffset[E][1],f,v+E)}}function zx(r,e,i,s,u,p){return Ut(Ut(r,i,p),Ut(e,s,p),u)}function vs(r,e,i){const s=i.dim,u=Ie(r*s-.5,0,s-1),p=Ie(e*s-.5,0,s-1),f=Math.floor(u),y=Math.floor(p),v=Math.min(f+1,s-1),b=Math.min(y+1,s-1);return zx(i.get(f,y),i.get(v,y),i.get(f,b),i.get(v,b),u-f,p-y)}const Px={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class tp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,s,u=!1,p=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return Ye(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const f=this.dim=i.height-2;if(this.data=new Uint32Array(i.data.buffer),this.encoding=s||"mapbox",this.borderReady=u,!u){for(let y=0;y<f;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(f,y)]=this.data[this._idx(f-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,f)]=this.data[this._idx(y,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Mx(this)}get(e,i,s=!1){const u=new Uint8Array(this.data.buffer);s&&(e=Ie(e,-1,this.dim),i=Ie(i,-1,this.dim));const p=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[p],u[p+1],u[p+2])}static getUnpackVector(e){return Px[e]}get unpackVector(){return Px[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,s){return(256*e*256+256*i+s)/10-1e4}_unpackTerrarium(e,i,s){return 256*e+i+s/256-32768}static pack(e,i){const s=[0,0,0,0],u=tp.getUnpackVector(i);let p=Math.floor((e+u[3])/u[2]);return s[2]=p%256,p=Math.floor(p/256),s[1]=p%256,p=Math.floor(p/256),s[0]=p,s}getPixels(){return new mi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,p=i*this.dim+this.dim,f=s*this.dim,y=s*this.dim+this.dim;switch(i){case-1:u=p-1;break;case 1:p=u+1}switch(s){case-1:f=y-1;break;case 1:y=f+1}const v=-i*this.dim,b=-s*this.dim;for(let E=f;E<y;E++)for(let I=u;I<p;I++)this.data[this._idx(I,E)]=e.data[this._idx(I+v,E+b)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}rt("DEMData",tp),rt("DemMinMaxQuadTree",Mx,{omit:["dem"]});class MS{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,s){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:i,timeout:void 0};if(s!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},s)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const s=e.wrapped().key,u=i===void 0?0:this.data[s].indexOf(i),p=this.data[s][u];return this.data[s].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[s].length===0&&delete this.data[s],this.onRemove(p.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const s in this.data)for(const u of this.data[s])e(u.value)||i.push(u);for(const s of i)this.remove(s.value.tileID,s)}}class Ol{constructor(e,i,s){this.func=e,this.mask=i,this.range=s}}Ol.ReadOnly=!1,Ol.ReadWrite=!0,Ol.disabled=new Ol(519,Ol.ReadOnly,[0,1]);const jm=7680;class Gm{constructor(e,i,s,u,p,f){this.test=e,this.ref=i,this.mask=s,this.fail=u,this.depthFail=p,this.pass=f}}Gm.disabled=new Gm({func:519,mask:0},0,0,jm,jm,jm);class so{constructor(e,i,s){this.blendFunction=e,this.blendColor=i,this.mask=s}}so.Replace=[1,0],so.disabled=new so(so.Replace,bt.transparent,[!1,!1,!1,!1]),so.unblended=new so(so.Replace,bt.transparent,[!0,!0,!0,!0]),so.alphaBlended=new so([1,771],bt.transparent,[!0,!0,!0,!0]);const Zm=1029,qm=2305;class Zi{constructor(e,i,s){this.enable=e,this.mode=i,this.frontFace=s}}Zi.disabled=new Zi(!1,Zm,qm),Zi.backCCW=new Zi(!0,Zm,qm),Zi.backCW=new Zi(!0,Zm,2304),Zi.frontCW=new Zi(!0,1028,2304),Zi.frontCCW=new Zi(!0,1028,qm);class ba extends st{constructor(e,i,s){super(),this.id=e,this._onlySymbols=s,i.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new MS(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new AS}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const s=this._tiles[i];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return je(this._tiles).map(e=>e.tileID).sort(Dx).map(e=>e.key)}getRenderableIds(e){const i=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&i.push(this._tiles[s]);return e?i.sort((s,u)=>{const p=s.tileID,f=u.tileID,y=new J(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),v=new J(f.canonical.x,f.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-f.overscaledZ||v.y-y.y||v.x-y.x}).map(s=>s.tileID.key):i.map(s=>s.tileID).sort(Dx).map(s=>s.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const s=this._tiles[e];s&&(s.state!=="loading"&&(s.state=i),this._loadTile(s,this._tileLoaded.bind(this,s,e,i)))}_tileLoaded(e,i,s,u){if(u)return e.state="errored",void(u.status!==404?this._source.fire(new Le(u,{tile:e})):this.update(this.transform));e.timeAdded=Ln.now(),s==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ze("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const p=i[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const f=this.getTileByID(p);s(e,f),s(f,e)}}function s(u,p){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let f=p.tileID.canonical.x-u.tileID.canonical.x;const y=p.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),b=p.tileID.key;f===0&&y===0||Math.abs(y)>1||(Math.abs(f)>1&&(Math.abs(f+v)===1?f+=v:Math.abs(f-v)===1&&(f-=v)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,f,y),u.neighboringTiles&&u.neighboringTiles[b]&&(u.neighboringTiles[b].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,s,u){for(const p in this._tiles){let f=this._tiles[p];if(u[p]||!f.hasData()||f.tileID.overscaledZ<=i||f.tileID.overscaledZ>s)continue;let y=f.tileID;for(;f&&f.tileID.overscaledZ>i+1;){const b=f.tileID.scaledTo(f.tileID.overscaledZ-1);f=this._tiles[b.key],f&&f.hasData()&&(y=b)}let v=y;for(;v.overscaledZ>i;)if(v=v.scaledTo(v.overscaledZ-1),e[v.key]){u[y.key]=y;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=i?s:null}for(let s=e.overscaledZ-1;s>=i;s--){const u=e.scaledTo(s),p=this._getLoadedTile(u);if(p)return p}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const s=Math.ceil(e.width/i)+1,u=Math.ceil(e.height/i)+1,p=Math.floor(s*u*5),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(f)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const s={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),s[p.tileID.key]=p}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,i,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let u;this.updateCacheSize(e,i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Ur(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(u=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(y=>this._source.hasTile(y)))):u=[];const p=this._updateRetainedTiles(u);if(Rx(this._source.type)&&u.length!==0){const y={},v={},b=Object.keys(p);for(const I of b){const A=p[I],P=this._tiles[I];if(!P||P.fadeEndTime&&P.fadeEndTime<=Ln.now())continue;const N=this.findLoadedParent(A,Math.max(A.overscaledZ-ba.maxOverzooming,this._source.minzoom));N&&(this._addTile(N.tileID),y[N.tileID.key]=N.tileID),v[I]=A}const E=u[u.length-1].overscaledZ;for(const I in this._tiles){const A=this._tiles[I];if(p[I]||!A.hasData())continue;let P=A.tileID;for(;P.overscaledZ>E;){P=P.scaledTo(P.overscaledZ-1);const N=this._tiles[P.key];if(N&&N.hasData()&&v[P.key]){p[I]=A.tileID;break}}}for(const I in y)p[I]||(this._coveredTiles[I]=!0,p[I]=y[I])}for(const y in p)this._tiles[y].clearFadeHold();const f=function(y,v){const b=[];for(const E in y)E in v||b.push(E);return b}(this._tiles,p);for(const y of f){const v=this._tiles[y];v.hasSymbolBuckets&&!v.holdingForFade()?v.setHoldDuration(this.map._fadeDuration):v.hasSymbolBuckets&&!v.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const s={},u=e[e.length-1].overscaledZ,p=e[0].overscaledZ,f=Math.max(p-ba.maxOverzooming,this._source.minzoom),y=Math.max(p+ba.maxUnderzooming,this._source.minzoom),v={};for(const b of e){const E=this._addTile(b);i[b.key]=b,E.hasData()||u<this._source.maxzoom&&(v[b.key]=b)}this._retainLoadedChildren(v,u,y,i);for(const b of e){let E=this._tiles[b.key];if(E.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const A=b.children(this._source.maxzoom)[0],P=this.getTile(A);if(P&&P.hasData()){i[A.key]=A;continue}}else{const A=b.children(this._source.maxzoom);if(i[A[0].key]&&i[A[1].key]&&i[A[2].key]&&i[A[3].key])continue}let I=E.wasRequested();for(let A=b.overscaledZ-1;A>=f;--A){const P=b.scaledTo(A);if(s[P.key]||(s[P.key]=!0,E=this.getTile(P),!E&&I&&(E=this._addTile(P)),E&&(i[P.key]=P,I=E.wasRequested(),E.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}i.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(p),s)break;u=p}for(const p of i)this._loadedParentTiles[p]=s}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const s=Boolean(i);return s||(i=new Sx(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))),i?(i.uses++,this._tiles[e.key]=i,s||this._source.fire(new Ze("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=i.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._cache.reset()}tilesIn(e,i,s){const u=[],p=this.transform;if(!p)return u;for(const f in this._tiles){const y=this._tiles[f];if(s&&y.clearQueryDebugViz(),y.holdingForFade())continue;const v=e.containsTile(y,p,i);v&&u.push(v)}return u}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of i)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Rx(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Ln.now())return!0}return!1}setFeatureState(e,i,s){this._state.updateState(e=e||"_geojsonTileLayer",i,s)}removeFeatureState(e,i,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,s)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,s){const u=this._tiles[e];u&&u.setDependencies(i,s)}reloadTilesForDependencies(e,i){for(const s in this._tiles)this._tiles[s].hasDependency(e,i)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,i))}}function Dx(r,e){const i=Math.abs(2*r.wrap)-+(r.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||s-i||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function Rx(r){return r==="raster"||r==="image"||r==="video"}ba.maxOverzooming=10,ba.maxUnderzooming=3;class np{constructor(e,i,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=s}static create(e,i,s){const u=s||e.findDEMTileFor(i);if(!u||!u.dem)return;const p=u.dem,f=u.tileID,y=1<<i.canonical.z-f.canonical.z;return new np(u,u.tileSize/Kt/y,[(i.canonical.x/y-f.canonical.x)*p.dim,(i.canonical.y/y-f.canonical.y)*p.dim])}tileCoordToPixel(e,i){const s=i*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),p=Math.floor(s);return new J(u,p)}getElevationAt(e,i,s,u){const p=e*this._scale+this._offset[0],f=i*this._scale+this._offset[1],y=Math.floor(p),v=Math.floor(f),b=this._dem;return u=!!u,s?Ut(Ut(b.get(y,v,u),b.get(y,v+1,u),f-v),Ut(b.get(y+1,v,u),b.get(y+1,v+1,u),f-v),p-y):b.get(y,v,u)}getElevationAtPixel(e,i,s){return this._dem.get(e,i,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Nm(1,e)*this._dem.stride}}class Lx{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ca(Kt,16,0),this.featureIndexArray=new qy,this.promoteId=i}insert(e,i,s,u,p,f=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,p,f);const v=this.grid;for(let b=0;b<i.length;b++){const E=i[b],I=[1/0,1/0,-1/0,-1/0];for(let A=0;A<E.length;A++){const P=E[A];I[0]=Math.min(I[0],P.x),I[1]=Math.min(I[1],P.y),I[2]=Math.max(I[2],P.x),I[3]=Math.max(I[3],P.y)}I[0]<Kt&&I[1]<Kt&&I[2]>=0&&I[3]>=0&&v.insert(y,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new va.VectorTile(new Cu(this.rawTileData)).layers,this.sourceLayerCoder=new bx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,i,s,u){this.loadVTLayers();const p=e.params||{},f=cs(p.filter),y=e.tileResult,v=e.transform,b=y.bufferedTilespaceBounds,E=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(N,U,K,ie)=>o0(y.bufferedTilespaceGeometry,N,U,K,ie));E.sort(zS);let I=null;v.elevation&&E.length>0&&(I=np.create(v.elevation,this.tileID));const A={};let P;for(let N=0;N<E.length;N++){const U=E[N];if(U===P)continue;P=U;const K=this.featureIndexArray.get(U);let ie=null;this.loadMatchingFeature(A,K,f,p.layers,p.availableImages,i,s,u,(he,_e,ye,we=0)=>(ie||(ie=ya(he)),_e.queryIntersectsFeature(y,he,ye,ie,this.z,e.transform,e.pixelPosMatrix,I,we)))}return A}loadMatchingFeature(e,i,s,u,p,f,y,v,b){const{featureIndex:E,bucketIndex:I,sourceLayerIndex:A,layoutVertexArrayOffset:P}=i,N=this.bucketLayerIDs[I];if(u&&!function(he,_e){for(let ye=0;ye<he.length;ye++)if(_e.indexOf(he[ye])>=0)return!0;return!1}(u,N))return;const U=this.sourceLayerCoder.decode(A),K=this.vtLayers[U].feature(E);if(s.needGeometry){const he=xa(K,!0);if(!s.filter(new O(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!s.filter(new O(this.tileID.overscaledZ),K))return;const ie=this.getId(K,U);for(let he=0;he<N.length;he++){const _e=N[he];if(u&&u.indexOf(_e)<0)continue;const ye=f[_e];if(!ye)continue;let we={};ie!==void 0&&v&&(we=v.getState(ye.sourceLayer||"_geojsonTileLayer",ie));const be=ot({},y[_e]);be.paint=Bx(be.paint,ye.paint,K,we,p),be.layout=Bx(be.layout,ye.layout,K,we,p);const Me=!b||b(K,ye,we,P);if(!Me)continue;const Fe=new Tx(K,this.z,this.x,this.y,ie);Fe.layer=be;let Ne=e[_e];Ne===void 0&&(Ne=e[_e]=[]),Ne.push({featureIndex:E,feature:Fe,intersectionZ:Me})}}lookupSymbolFeatures(e,i,s,u,p,f,y,v){const b={};this.loadVTLayers();const E=cs(p);for(const I of e)this.loadMatchingFeature(b,{bucketIndex:s,sourceLayerIndex:u,featureIndex:I,layoutVertexArrayOffset:0},E,f,y,v,i);return b}hasLayer(e){for(const i of this.bucketLayerIDs)for(const s of i)if(e===s)return!0;return!1}getId(e,i){let s=e.id;return this.promoteId&&(s=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof s=="boolean"&&(s=Number(s))),s}}function Bx(r,e,i,s,u){return xn(r,(p,f)=>{const y=e instanceof ue?e.get(f):null;return y&&y.evaluate?y.evaluate(i,s,u):y})}function zS(r,e){return e-r}rt("FeatureIndex",Lx,{omit:["rawTileData","sourceLayerCoder"]});class Fx{constructor(e){const i={},s=[];for(const y in e){const v=e[y],b=i[y]={};for(const E in v.glyphs){const I=v.glyphs[+E];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const A=I.metrics.localGlyph?2:1,P={x:0,y:0,w:I.bitmap.width+2*A,h:I.bitmap.height+2*A};s.push(P),b[E]=P}}const{w:u,h:p}=Em(s),f=new ms({width:u||1,height:p||1});for(const y in e){const v=e[y];for(const b in v.glyphs){const E=v.glyphs[+b];if(!E||E.bitmap.width===0||E.bitmap.height===0)continue;const I=i[y][b],A=E.metrics.localGlyph?2:1;ms.copy(E.bitmap,f,{x:0,y:0},{x:I.x+A,y:I.y+A},E.bitmap)}}this.image=f,this.positions=i}}rt("GlyphAtlas",Fx);class PS{constructor(e){this.tileID=new Ur(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile}parse(e,i,s,u,p){this.status="parsing",this.data=e,this.collisionBoxArray=new Lo;const f=new bx(Object.keys(e.layers).sort()),y=new Lx(this.tileID,this.promoteId);y.bucketLayerIDs=[];const v={},b=new Vm(256,256),E={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:s},I=i.familiesBySource[this.source];for(const we in I){const be=e.layers[we];if(!be)continue;let Me=!1,Fe=!1;for(const Pe of I[we])Pe[0].type==="symbol"?Me=!0:Fe=!0;if(this.isSymbolTile===!0&&!Me||this.isSymbolTile===!1&&!Fe)continue;be.version===1&&Ye(`Vector tile source "${this.source}" layer "${we}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ne=f.encode(we),Ge=[];for(let Pe=0;Pe<be.length;Pe++){const Be=be.feature(Pe),qe=y.getId(Be,we);Ge.push({feature:Be,id:qe,index:Pe,sourceLayerIndex:Ne})}for(const Pe of I[we]){const Be=Pe[0];this.isSymbolTile!==void 0&&Be.type==="symbol"!==this.isSymbolTile||Be.minzoom&&this.zoom<Math.floor(Be.minzoom)||Be.maxzoom&&this.zoom>=Be.maxzoom||Be.visibility!=="none"&&(Wm(Pe,this.zoom,s),(v[Be.id]=Be.createBucket({index:y.bucketLayerIDs.length,layers:Pe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ne,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(Ge,E,this.tileID.canonical),y.bucketLayerIDs.push(Pe.map(qe=>qe.id)))}}let A,P,N,U;b.trim();const K={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ie=xn(E.glyphDependencies,we=>Object.keys(we).map(Number));Object.keys(ie).length?u.send("getGlyphs",{uid:this.uid,stacks:ie},(we,be)=>{A||(A=we,P=be,ye.call(this))},void 0,!1,K):P={};const he=Object.keys(E.iconDependencies);he.length?u.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"icons"},(we,be)=>{A||(A=we,N=be,ye.call(this))},void 0,!1,K):N={};const _e=Object.keys(E.patternDependencies);function ye(){if(A)return p(A);if(P&&N&&U){const we=new Fx(P),be=new j0(N,U);for(const Me in v){const Fe=v[Me];Fe instanceof xs?(Wm(Fe.layers,this.zoom,s),pS(Fe,P,we.positions,N,be.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):Fe.hasPattern&&(Fe instanceof bm||Fe instanceof vm||Fe instanceof wm)&&(Wm(Fe.layers,this.zoom,s),Fe.addFeatures(E,this.tileID.canonical,be.patternPositions))}this.status="done",p(null,{buckets:je(v).filter(Me=>!Me.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:we.image,lineAtlas:b,imageAtlas:be,glyphMap:this.returnDependencies?P:null,iconMap:this.returnDependencies?N:null,glyphPositions:this.returnDependencies?we.positions:null})}}_e.length?u.send("getImages",{icons:_e,source:this.source,tileID:this.tileID,type:"patterns"},(we,be)=>{A||(A=we,U=be,ye.call(this))},void 0,!1,K):U={},ye.call(this)}}function Wm(r,e,i){const s=new O(e);for(const u of r)u.recalculate(s,i)}class Ox{constructor(e){this.entries={},this.scheduler=e}request(e,i,s,u){const p=this.entries[e]=this.entries[e]||{callbacks:[]};if(p.result){const[f,y]=p.result;return this.scheduler?this.scheduler.add(()=>{u(f,y)},i):u(f,y),()=>{}}return p.callbacks.push(u),p.cancel||(p.cancel=s((f,y)=>{p.result=[f,y];for(const v of p.callbacks)this.scheduler?this.scheduler.add(()=>{v(f,y)},i):v(f,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(f=>f!==u),p.callbacks.length||(p.cancel(),delete this.entries[e]))}}}function Nx(r,e,i){const s=JSON.stringify(r.request);return r.data&&(this.deduped.entries[s]={result:[null,r.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},u=>{const p=D(r.request,(f,y,v,b)=>{f?u(f):y&&u(null,{vectorTile:i?void 0:new va.VectorTile(new Cu(y)),rawData:y,cacheControl:v,expires:b})});return()=>{p.cancel(),u()}},e)}a.ARRAY_TYPE=Kr,a.AUTH_ERR_MSG=Zr,a.Actor=class{constructor(r,e,i){this.target=r,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},qt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Jt()?r:ve,this.scheduler=new kS}send(r,e,i,s,u=!1,p){const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=p,this.callbacks[f]=i);const y=ai(this.globalScope)?void 0:[];return this.target.postMessage({id:f,type:r,hasCallback:!!i,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:ha(e,y)},y),{cancel:()=>{i&&delete this.callbacks[f],this.target.postMessage({id:f,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(r){const e=r.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s.cancel()}else if(e.mustQueue||Jt()){const s=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),s&&s.metadata||{type:"message"})}else this.processTask(i,e)}processTask(r,e){if(e.type==="<response>"){const i=this.callbacks[r];delete this.callbacks[r],i&&(e.error?i(da(e.error)):i(null,da(e.data)))}else{const i=ai(this.globalScope)?void 0:[],s=e.hasCallback?(p,f)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:p?ha(p):null,data:ha(f,i)},i)}:p=>{},u=da(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,s);else if(this.parent.getWorkerSource){const p=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,p[0],u.source)[p[1]](u,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=$m,a.Color=bt,a.ColorMode=so,a.CullFaceMode=Zi,a.DEMData=tp,a.DataConstantProperty=Y,a.DedupedRequest=Ox,a.DepthMode=Ol,a.EXTENT=Kt,a.Elevation=class{getAtPointOrZero(r,e=0){return this.getAtPoint(r,e)||0}getAtPoint(r,e,i=!0){e==null&&(e=null);const s=this._source();if(!s||r.y<0||r.y>1)return e;const u=s.getSource().maxzoom,p=1<<u,f=Math.floor(r.x),y=r.x-f,v=new Ur(u,f,u,Math.floor(y*p),Math.floor(r.y*p)),b=this.findDEMTileFor(v);if(!b||!b.dem)return e;const E=b.dem,I=1<<b.tileID.canonical.z,A=(y*I-b.tileID.canonical.x)*E.dim,P=(r.y*I-b.tileID.canonical.y)*E.dim,N=Math.floor(A),U=Math.floor(P);return(i?this.exaggeration():1)*Ut(Ut(E.get(N,U),E.get(N,U+1),P-U),Ut(E.get(N+1,U),E.get(N+1,U+1),P-U),A-N)}getAtTileOffset(r,e,i){const s=1<<r.canonical.z;return this.getAtPointOrZero(new Fl(r.wrap+(r.canonical.x+e/Kt)/s,(r.canonical.y+i/Kt)/s))}getForTilePoints(r,e,i,s){const u=np.create(this,r,s);return!!u&&(e.forEach(p=>{p[2]=this.exaggeration()*u.getElevationAt(p[0],p[1],i)}),!0)}getMinMaxForTile(r){const e=this.findDEMTileFor(r);if(!e||!e.dem)return null;const i=e.dem.tree,s=e.tileID,u=1<<r.canonical.z-s.canonical.z;let p=r.canonical.x/u-s.canonical.x,f=r.canonical.y/u-s.canonical.y,y=0;for(let v=0;v<r.canonical.z-s.canonical.z&&!i.leaves[y];v++){p*=2,f*=2;const b=2*Math.floor(f)+Math.floor(p);y=i.childOffsets[y]+b,p%=1,f%=1}return{min:this.exaggeration()*i.minimums[y],max:this.exaggeration()*i.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Le,a.EvaluationParameters=O,a.Event=Ze,a.Evented=st,a.GlyphManager=Ll,a.ImagePosition=Cm,a.LineAtlas=Vm,a.LngLat=An,a.LngLatBounds=wa,a.LocalGlyphMode=Mm,a.MAX_SAFE_INTEGER=Ae,a.MercatorCoordinate=Fl,a.ONE_EM=lr,a.OverscaledTileID=Ur,a.Properties=Ee,a.RGBAImage=mi,a.RequestManager=class{constructor(r,e,i){this._transformRequestFn=r,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const r=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ci,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,e){return this._transformRequestFn&&this._transformRequestFn(r,e)||{url:r}}normalizeStyleURL(r,e){if(!Kn(r))return r;const i=Yn(r);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(r,e){if(!Kn(r))return r;const i=Yn(r);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(r,e){if(!Kn(r))return r;const i=Yn(r);return i.path=`/v4/${i.authority}.json`,i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)}normalizeSpriteURL(r,e,i,s){const u=Yn(r);return Kn(r)?(u.path=`/styles/v1${u.path}/sprite${e}${i}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${i}`,ft(u))}normalizeTileURL(r,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!Kn(r))return r;const s=Yn(r);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&s.authority!=="raster"&&i===512?"@2x":""}${sr.supported?".webp":"$1"}`),s.authority==="raster"?s.path=`/${At.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${At.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(p){for(const f of p){const y=f.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(s.params)||At.ACCESS_TOKEN;return At.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(r,e){const i=Yn(r);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return r;let s="mapbox://";i.path.match(/^\/raster\/v1\//)?s+=`raster/${i.path.replace(`/${At.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${i.path.replace(`/${At.TILE_URL_VERSION}/`,"")}`;let u=i.params;return e&&(u=u.filter(p=>!p.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(r,e){const i=!!e&&Kn(e),s=[];for(const u of r.tiles||[])Lr(u)?s.push(this.canonicalizeTileURL(u,i)):s.push(u);return s}_makeAPIURL(r,e){const i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=Yn(At.API_URL);if(r.protocol=s.protocol,r.authority=s.authority,r.protocol==="http"){const u=r.params.indexOf("secure");u>=0&&r.params.splice(u,1)}if(s.path!=="/"&&(r.path=`${s.path}${r.path}`),!At.REQUIRE_ACCESS_TOKEN)return ft(r);if(e=e||At.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return r.params=r.params.filter(u=>u.indexOf("access_token")===-1),r.params.push(`access_token=${e||""}`),ft(r)}},a.ResourceType=So,a.SegmentVector=_r,a.SourceCache=ba,a.StencilMode=Gm,a.StructArrayLayout1ui2=Hr,a.StructArrayLayout2f1f2i16=Ci,a.StructArrayLayout2i4=gt,a.StructArrayLayout2ui4=er,a.StructArrayLayout3f12=xt,a.StructArrayLayout3ui6=nn,a.StructArrayLayout4i8=vn,a.Texture=Jd,a.Tile=Sx,a.Transitionable=ne,a.Uniform1f=Rd,a.Uniform1i=class extends ps{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},a.Uniform2f=class extends ps{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},a.Uniform3f=class extends ps{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},a.Uniform4f=Yy,a.UniformColor=Qy,a.UniformMatrix3f=class extends ps{constructor(r,e){super(r,e),this.current=z2}set(r){for(let e=0;e<9;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},a.UniformMatrix4f=class extends ps{constructor(r,e){super(r,e),this.current=M2}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},a.UnwrappedTileID=wx,a.ValidationError=Ce,a.VectorTileWorkerSource=class extends st{constructor(r,e,i,s,u){super(),this.actor=r,this.layerIndex=e,this.availableImages=i,this.loadVectorData=u||Nx,this.loading={},this.loaded={},this.deduped=new Ox(r.scheduler),this.isSpriteLoaded=s,this.scheduler=r.scheduler}loadTile(r,e){const i=r.uid,s=r&&r.request,u=s&&s.collectResourceTiming,p=this.loading[i]=new PS(r);p.abort=this.loadVectorData(r,(f,y)=>{const v=!this.loading[i];if(delete this.loading[i],v||f||!y)return p.status="done",v||(this.loaded[i]=p),e(f);const b=y.rawData,E={};y.expires&&(E.expires=y.expires),y.cacheControl&&(E.cacheControl=y.cacheControl),p.vectorTile=y.vectorTile||new va.VectorTile(new Cu(b));const I=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(A,P)=>{if(A||!P)return e(A);const N={};if(u){const U=xx(s);U.length>0&&(N.resourceTiming=JSON.parse(JSON.stringify(U)))}e(null,ot({rawTileData:b.slice(0)},P,E,N))})};this.isSpriteLoaded?I():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(I,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):I()}),this.loaded=this.loaded||{},this.loaded[i]=p})}reloadTile(r,e){const i=this.loaded,s=r.uid,u=this;if(i&&i[s]){const p=i[s];p.showCollisionBoxes=r.showCollisionBoxes,p.enableTerrain=!!r.enableTerrain;const f=(y,v)=>{const b=p.reloadCallback;b&&(delete p.reloadCallback,p.parse(p.vectorTile,u.layerIndex,this.availableImages,u.actor,b)),e(y,v)};p.status==="parsing"?p.reloadCallback=f:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,f):f())}}abortTile(r,e){const i=r.uid,s=this.loading[i];s&&(s.abort&&s.abort(),delete this.loading[i]),e()}removeTile(r,e){const i=this.loaded,s=r.uid;i&&i[s]&&delete i[s],e()}},a.WritingMode=gi,a.ZoomHistory=_d,a.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r},a.addDynamicAttributes=Rm,a.altitudeFromMercatorZ=Um,a.asyncAll=We,a.bezier=xe,a.bindAll=qt,a.bufferConvexPolygon=function(r,e){const i=[];for(let s=0;s<r.length;s++){const u=$e(s-1,-1,r.length-1),p=$e(s+1,-1,r.length-1),f=r[s],y=r[p],v=r[u].sub(f).unit(),b=y.sub(f).unit(),E=b.angleWithSep(v.x,v.y),I=v.add(b).unit().mult(-1*e/Math.sin(E/2));i.push(f.add(I))}return i},a.cacheEntryPossiblyAdded=function(r){To++,To>Hs&&(r.getActor().send("enforceCacheSizeLimit",$a),To=0)},a.clamp=Ie,a.clearTileCache=function(r){const e=ve.caches.delete(Xo);r&&e.catch(r).then(()=>r())},a.clipLine=tx,a.clone=function(r){var e=new Kr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},a.clone$1=function(r){var e=new Kr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},a.clone$2=Ot,a.collisionCircleLayout=NT,a.config=At,a.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},a.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r},a.create=Od,a.create$1=function(){var r=new Kr(16);return Kr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},a.create$2=l0,a.createExpression=fi,a.createFilter=cs,a.createLayout=it,a.createStyleLayer=function(r){return r.type==="custom"?new bS(r):new SS[r.type](r)},a.cross=function(r,e,i){var s=e[0],u=e[1],p=e[2],f=i[0],y=i[1],v=i[2];return r[0]=u*v-p*y,r[1]=p*f-s*v,r[2]=s*y-u*f,r},a.degToRad=Q,a.div=function(r,e,i){return r[0]=e[0]/i[0],r[1]=e[1]/i[1],r[2]=e[2]/i[2],r},a.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]},a.dot$1=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},a.ease=Ve,a.easeCubicInOut=Te,a.emitValidationErrors=ou,a.endsWith=Wt,a.enforceCacheSizeLimit=function(r){Ji(),qr&&qr.then(e=>{e.keys().then(i=>{for(let s=0;s<i.length-r;s++)e.delete(i[s])})})},a.evaluateSizeForFeature=jd,a.evaluateSizeForZoom=zl,a.evaluateVariableOffset=sx,a.evented=M,a.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},a.exactEquals$1=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},a.exported=Ln,a.exported$1=sr,a.extend=ot,a.filterObject=an,a.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},a.fromQuat=function(r,e){var i=e[0],s=e[1],u=e[2],p=e[3],f=i+i,y=s+s,v=u+u,b=i*f,E=s*f,I=s*y,A=u*f,P=u*y,N=u*v,U=p*f,K=p*y,ie=p*v;return r[0]=1-I-N,r[1]=E+ie,r[2]=A-K,r[3]=0,r[4]=E-ie,r[5]=1-b-N,r[6]=P+U,r[7]=0,r[8]=A+K,r[9]=P-U,r[10]=1-b-I,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},a.fromRotation=function(r,e){var i=Math.sin(e),s=Math.cos(e);return r[0]=s,r[1]=i,r[2]=0,r[3]=-i,r[4]=s,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},a.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},a.furthestTileCorner=function(r){const e=Math.round((r+45+360)%360/90)%4;return re[e]},a.getAABBPointSquareDist=function(r,e,i){let s=0;for(let u=0;u<2;++u){const p=i?i[u]:0;r[u]>p&&(s+=(r[u]-p)*(r[u]-p)),e[u]<p&&(s+=(p-e[u])*(p-e[u]))}return s},a.getAnchorAlignment=Am,a.getAnchorJustification=Pm,a.getBounds=function(r){let e=1/0,i=1/0,s=-1/0,u=-1/0;for(const p of r)e=Math.min(e,p.x),i=Math.min(i,p.y),s=Math.max(s,p.x),u=Math.max(u,p.y);return{min:new J(e,i),max:new J(s,u)}},a.getImage=le,a.getJSON=function(r,e){return $(ot(r,{type:"json"}),e)},a.getMapSessionAPI=Ec,a.getPerformanceMeasurement=xx,a.getRTLTextPluginStatus=z,a.getReferrer=Si,a.getVideo=function(r,e){const i=ve.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let s=0;s<r.length;s++){const u=ve.document.createElement("source");H(r[s])||(i.crossOrigin="Anonymous"),u.src=r[s],i.appendChild(u)}return{cancel:()=>{}}},a.identity=lm,a.identity$1=g0,a.invert=function(r,e){var i=e[0],s=e[1],u=e[2],p=e[3],f=e[4],y=e[5],v=e[6],b=e[7],E=e[8],I=e[9],A=e[10],P=e[11],N=e[12],U=e[13],K=e[14],ie=e[15],he=i*y-s*f,_e=i*v-u*f,ye=i*b-p*f,we=s*v-u*y,be=s*b-p*y,Me=u*b-p*v,Fe=E*U-I*N,Ne=E*K-A*N,Ge=E*ie-P*N,Pe=I*K-A*U,Be=I*ie-P*U,qe=A*ie-P*K,Re=he*qe-_e*Be+ye*Pe+we*Ge-be*Ne+Me*Fe;return Re?(r[0]=(y*qe-v*Be+b*Pe)*(Re=1/Re),r[1]=(u*Be-s*qe-p*Pe)*Re,r[2]=(U*Me-K*be+ie*we)*Re,r[3]=(A*be-I*Me-P*we)*Re,r[4]=(v*Ge-f*qe-b*Ne)*Re,r[5]=(i*qe-u*Ge+p*Ne)*Re,r[6]=(K*ye-N*Me-ie*_e)*Re,r[7]=(E*Me-A*ye+P*_e)*Re,r[8]=(f*Be-y*Ge+b*Fe)*Re,r[9]=(s*Ge-i*Be-p*Fe)*Re,r[10]=(N*be-U*ye+ie*he)*Re,r[11]=(I*ye-E*be-P*he)*Re,r[12]=(y*Ne-f*Pe-v*Fe)*Re,r[13]=(i*Pe-s*Ne+u*Fe)*Re,r[14]=(U*_e-N*we-K*he)*Re,r[15]=(E*we-I*_e+A*he)*Re,r):null},a.isMapAuthenticated=function(r){return wo.has(r)},a.isMapboxURL=Kn,a.latFromMercatorY=ep,a.len=W2,a.length=u0,a.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},a.loadVectorTile=Nx,a.makeRequest=$,a.mercatorXfromLng=_x,a.mercatorYfromLat=yx,a.mercatorZfromAltitude=Nm,a.mul=function(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r[3]=e[3]*i[3],r},a.mul$1=G2,a.mul$2=q2,a.multiply=c0,a.multiply$1=d0,a.nextPowerOfTwo=Zt,a.normalize=f0,a.normalize$1=function(r,e){var i=e[0],s=e[1],u=e[2],p=e[3],f=i*i+s*s+u*u+p*p;return f>0&&(f=1/Math.sqrt(f)),r[0]=i*f,r[1]=s*f,r[2]=u*f,r[3]=p*f,r},a.number=Ut,a.ortho=function(r,e,i,s,u,p,f){var y=1/(e-i),v=1/(s-u),b=1/(p-f);return r[0]=-2*y,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*b,r[11]=0,r[12]=(e+i)*y,r[13]=(u+s)*v,r[14]=(f+p)*b,r[15]=1,r},a.pbf=Cu,a.perspective=function(r,e,i,s,u){var p,f=1/Math.tan(e/2);return r[0]=f/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=(u+s)*(p=1/(s-u)),r[14]=2*u*s*p):(r[10]=-1,r[14]=-2*s),r},a.pick=function(r,e){const i={};for(let s=0;s<e.length;s++){const u=e[s];u in r&&(i[u]=r[u])}return i},a.plugin=F,a.pointGeometry=J,a.polygonIntersectsBox=o0,a.polygonIntersectsPolygon=t0,a.polygonizeBounds=function(r,e,i=0,s=!0){const u=new J(i,i),p=r.sub(u),f=e.add(u),y=[p,new J(f.x,p.y),f,new J(p.x,f.y)];return s&&y.push(p),y},a.posAttributes=IS,a.postMapLoadEvent=Xs,a.postTurnstileEvent=Ws,a.potpack=Em,a.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},a.radToDeg=function(r){return r*ee},a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(r){return r({pluginStatus:_,pluginURL:w}),M.on("pluginStateChange",r),r},a.removeAuthState=function(r){wo.delete(r)},a.renderColorRamp=dm,a.rotateX=function(r,e,i){var s=Math.sin(i),u=Math.cos(i),p=e[4],f=e[5],y=e[6],v=e[7],b=e[8],E=e[9],I=e[10],A=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=p*u+b*s,r[5]=f*u+E*s,r[6]=y*u+I*s,r[7]=v*u+A*s,r[8]=b*u-p*s,r[9]=E*u-f*s,r[10]=I*u-y*s,r[11]=A*u-v*s,r},a.rotateX$1=_0,a.rotateY=function(r,e,i){var s=Math.sin(i),u=Math.cos(i),p=e[0],f=e[1],y=e[2],v=e[3],b=e[8],E=e[9],I=e[10],A=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=p*u-b*s,r[1]=f*u-E*s,r[2]=y*u-I*s,r[3]=v*u-A*s,r[8]=p*s+b*u,r[9]=f*s+E*u,r[10]=y*s+I*u,r[11]=v*s+A*u,r},a.rotateZ=function(r,e,i){var s=Math.sin(i),u=Math.cos(i),p=e[0],f=e[1],y=e[2],v=e[3],b=e[4],E=e[5],I=e[6],A=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=p*u+b*s,r[1]=f*u+E*s,r[2]=y*u+I*s,r[3]=v*u+A*s,r[4]=b*u-p*s,r[5]=E*u-f*s,r[6]=I*u-y*s,r[7]=A*u-v*s,r},a.rotateZ$1=function(r,e,i){i*=.5;var s=e[0],u=e[1],p=e[2],f=e[3],y=Math.sin(i),v=Math.cos(i);return r[0]=s*v+u*y,r[1]=u*v-s*y,r[2]=p*v+f*y,r[3]=f*v-p*y,r},a.scale=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r},a.scale$1=function(r,e,i){var s=i[0],u=i[1],p=i[2];return r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r[3]=e[3]*s,r[4]=e[4]*u,r[5]=e[5]*u,r[6]=e[6]*u,r[7]=e[7]*u,r[8]=e[8]*p,r[9]=e[9]*p,r[10]=e[10]*p,r[11]=e[11]*p,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},a.scale$2=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r},a.scaleAndAdd=p0,a.setCacheLimits=function(r,e){$a=r,Hs=e},a.setRTLTextPlugin=function(r,e,i=!1){if(_===n||_===l||_===d)throw new Error("setRTLTextPlugin cannot be called multiple times.");w=Ln.resolveURL(r),_=n,g=e,C(),i||R()},a.smoothstep=function(r,e,i){return(i=Ie((i-r)/(e-r),0,1))*i*(3-2*i)},a.spec=ae,a.storeAuthState=function(r,e){e?wo.add(r):wo.delete(r)},a.sub=Z2,a.subtract=h0,a.symbolSize=UT,a.transformMat3=function(r,e,i){var s=e[0],u=e[1],p=e[2];return r[0]=s*i[0]+u*i[3]+p*i[6],r[1]=s*i[1]+u*i[4]+p*i[7],r[2]=s*i[2]+u*i[5]+p*i[8],r},a.transformMat4=yu,a.transformMat4$1=function(r,e,i){var s=e[0],u=e[1],p=e[2],f=i[3]*s+i[7]*u+i[11]*p+i[15];return r[0]=(i[0]*s+i[4]*u+i[8]*p+i[12])/(f=f||1),r[1]=(i[1]*s+i[5]*u+i[9]*p+i[13])/f,r[2]=(i[2]*s+i[6]*u+i[10]*p+i[14])/f,r},a.transformQuat=m0,a.translate=function(r,e,i){var s,u,p,f,y,v,b,E,I,A,P,N,U=i[0],K=i[1],ie=i[2];return e===r?(r[12]=e[0]*U+e[4]*K+e[8]*ie+e[12],r[13]=e[1]*U+e[5]*K+e[9]*ie+e[13],r[14]=e[2]*U+e[6]*K+e[10]*ie+e[14],r[15]=e[3]*U+e[7]*K+e[11]*ie+e[15]):(u=e[1],p=e[2],f=e[3],y=e[4],v=e[5],b=e[6],E=e[7],I=e[8],A=e[9],P=e[10],N=e[11],r[0]=s=e[0],r[1]=u,r[2]=p,r[3]=f,r[4]=y,r[5]=v,r[6]=b,r[7]=E,r[8]=I,r[9]=A,r[10]=P,r[11]=N,r[12]=s*U+y*K+I*ie+e[12],r[13]=u*U+v*K+A*ie+e[13],r[14]=p*U+b*K+P*ie+e[14],r[15]=f*U+E*K+N*ie+e[15]),r},a.triggerPluginCompletionEvent=S,a.uniqueId=Rt,a.validateCustomStyleLayer=function(r){const e=[],i=r.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFog=_l,a.validateLight=iu,a.validateStyle=hs,a.values=je,a.vectorTile=va,a.version=B,a.warnOnce=Ye,a.window=ve,a.wrap=$e}),T(["./shared"],function(a){function B($){const D=typeof $;if(D==="number"||D==="boolean"||D==="string"||$==null)return JSON.stringify($);if(Array.isArray($)){let H="[";for(const oe of $)H+=`${B(oe)},`;return`${H}]`}const L=Object.keys($).sort();let j="{";for(let H=0;H<L.length;H++)j+=`${JSON.stringify(L[H])}:${B($[L[H]])},`;return`${j}}`}function W($){let D="";for(const L of a.refProperties)D+=`/${B($[L])}`;return D}class ce{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,L){for(const H of D){this._layerConfigs[H.id]=H;const oe=this._layers[H.id]=a.createStyleLayer(H);oe._featureFilter=a.createFilter(oe.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of L)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const j=function(H,oe){const fe={};for(let le=0;le<H.length;le++){const ge=oe&&oe[H[le].id]||W(H[le]);oe&&(oe[H[le].id]=ge);let ze=fe[ge];ze||(ze=fe[ge]=[]),ze.push(H[le])}const me=[];for(const le in fe)me.push(fe[le]);return me}(a.values(this._layerConfigs),this.keyCache);for(const H of j){const oe=H.map(Ze=>this._layers[Ze.id]),fe=oe[0];if(fe.visibility==="none")continue;const me=fe.source||"";let le=this.familiesBySource[me];le||(le=this.familiesBySource[me]={});const ge=fe.sourceLayer||"_geojsonTileLayer";let ze=le[ge];ze||(ze=le[ge]=[]),ze.push(oe)}}}const{ImageBitmap:J}=a.window;class q{loadTile(D,L){const{uid:j,encoding:H,rawImageData:oe,padding:fe,buildQuadTree:me}=D,le=J&&oe instanceof J?this.getImageData(oe,fe):oe;L(null,new a.DEMData(j,le,H,fe<1,me))}getImageData(D,L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(D.width,D.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=D.width,this.offscreenCanvas.height=D.height,this.offscreenCanvasContext.drawImage(D,0,0,D.width,D.height);const j=this.offscreenCanvasContext.getImageData(-L,-L,D.width+2*L,D.height+2*L);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:j.width,height:j.height},j.data)}}var ve=function $(D,L){var j,H=D&&D.type;if(H==="FeatureCollection")for(j=0;j<D.features.length;j++)$(D.features[j],L);else if(H==="GeometryCollection")for(j=0;j<D.geometries.length;j++)$(D.geometries[j],L);else if(H==="Feature")$(D.geometry,L);else if(H==="Polygon")Ae(D.coordinates,L);else if(H==="MultiPolygon")for(j=0;j<D.coordinates.length;j++)Ae(D.coordinates[j],L);return D};function Ae($,D){if($.length!==0){Se($[0],D);for(var L=1;L<$.length;L++)Se($[L],!D)}}function Se($,D){for(var L=0,j=0,H=$.length,oe=H-1;j<H;oe=j++)L+=($[j][0]-$[oe][0])*($[oe][1]+$[j][1]);L>=0!=!!D&&$.reverse()}const ee=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Q{constructor(D){this._feature=D,this.extent=a.EXTENT,this.type=D.type,this.properties=D.tags,"id"in D&&!isNaN(D.id)&&(this.id=parseInt(D.id,10))}loadGeometry(){if(this._feature.type===1){const D=[];for(const L of this._feature.geometry)D.push([new a.pointGeometry(L[0],L[1])]);return D}{const D=[];for(const L of this._feature.geometry){const j=[];for(const H of L)j.push(new a.pointGeometry(H[0],H[1]));D.push(j)}return D}}toGeoJSON(D,L,j){return ee.call(this,D,L,j)}}class re{constructor(D){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=D.length,this._features=D}feature(D){return new Q(this._features[D])}}var Te=a.vectorTile.VectorTileFeature,xe=Ve;function Ve($,D){this.options=D||{},this.features=$,this.length=$.length}function Ie($,D){this.id=typeof $.id=="number"?$.id:void 0,this.type=$.type,this.rawGeometry=$.type===1?[$.geometry]:$.geometry,this.properties=$.tags,this.extent=D||4096}Ve.prototype.feature=function($){return new Ie(this.features[$],this.options.extent)},Ie.prototype.loadGeometry=function(){var $=this.rawGeometry;this.geometry=[];for(var D=0;D<$.length;D++){for(var L=$[D],j=[],H=0;H<L.length;H++)j.push(new a.pointGeometry(L[H][0],L[H][1]));this.geometry.push(j)}return this.geometry},Ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $=this.geometry,D=1/0,L=-1/0,j=1/0,H=-1/0,oe=0;oe<$.length;oe++)for(var fe=$[oe],me=0;me<fe.length;me++){var le=fe[me];D=Math.min(D,le.x),L=Math.max(L,le.x),j=Math.min(j,le.y),H=Math.max(H,le.y)}return[D,j,L,H]},Ie.prototype.toGeoJSON=Te.prototype.toGeoJSON;var $e=je,We=xe;function je($){var D=new a.pbf;return function(L,j){for(var H in L.layers)j.writeMessage(3,ot,L.layers[H])}($,D),D.finish()}function ot($,D){var L;D.writeVarintField(15,$.version||1),D.writeStringField(1,$.name||""),D.writeVarintField(5,$.extent||4096);var j={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<$.length;L++)j.feature=$.feature(L),D.writeMessage(2,zt,j);var H=j.keys;for(L=0;L<H.length;L++)D.writeStringField(3,H[L]);var oe=j.values;for(L=0;L<oe.length;L++)D.writeMessage(4,qt,oe[L])}function zt($,D){var L=$.feature;L.id!==void 0&&D.writeVarintField(1,L.id),D.writeMessage(2,Rt,$),D.writeVarintField(3,L.type),D.writeMessage(4,Ht,L)}function Rt($,D){var L=$.feature,j=$.keys,H=$.values,oe=$.keycache,fe=$.valuecache;for(var me in L.properties){var le=oe[me];le===void 0&&(j.push(me),oe[me]=le=j.length-1),D.writeVarint(le);var ge=L.properties[me],ze=typeof ge;ze!=="string"&&ze!=="boolean"&&ze!=="number"&&(ge=JSON.stringify(ge));var Ze=ze+":"+ge,Le=fe[Ze];Le===void 0&&(H.push(ge),fe[Ze]=Le=H.length-1),D.writeVarint(Le)}}function St($,D){return(D<<3)+(7&$)}function Zt($){return $<<1^$>>31}function Ht($,D){for(var L=$.loadGeometry(),j=$.type,H=0,oe=0,fe=L.length,me=0;me<fe;me++){var le=L[me],ge=1;j===1&&(ge=le.length),D.writeVarint(St(1,ge));for(var ze=j===3?le.length-1:le.length,Ze=0;Ze<ze;Ze++){Ze===1&&j!==1&&D.writeVarint(St(2,ze-1));var Le=le[Ze].x-H,st=le[Ze].y-oe;D.writeVarint(Zt(Le)),D.writeVarint(Zt(st)),H+=Le,oe+=st}j===3&&D.writeVarint(St(7,1))}}function qt($,D){var L=typeof $;L==="string"?D.writeStringField(1,$):L==="boolean"?D.writeBooleanField(7,$):L==="number"&&($%1!=0?D.writeDoubleField(3,$):$<0?D.writeSVarintField(6,$):D.writeVarintField(5,$))}function Wt($,D,L,j,H,oe){if(H-j<=L)return;const fe=j+H>>1;xn($,D,fe,j,H,oe%2),Wt($,D,L,j,fe-1,oe+1),Wt($,D,L,fe+1,H,oe+1)}function xn($,D,L,j,H,oe){for(;H>j;){if(H-j>600){const ge=H-j+1,ze=L-j+1,Ze=Math.log(ge),Le=.5*Math.exp(2*Ze/3),st=.5*Math.sqrt(Ze*Le*(ge-Le)/ge)*(ze-ge/2<0?-1:1);xn($,D,L,Math.max(j,Math.floor(L-ze*Le/ge+st)),Math.min(H,Math.floor(L+(ge-ze)*Le/ge+st)),oe)}const fe=D[2*L+oe];let me=j,le=H;for(an($,D,j,L),D[2*H+oe]>fe&&an($,D,j,H);me<le;){for(an($,D,me,le),me++,le--;D[2*me+oe]<fe;)me++;for(;D[2*le+oe]>fe;)le--}D[2*j+oe]===fe?an($,D,j,le):(le++,an($,D,le,H)),le<=L&&(j=le+1),L<=le&&(H=le-1)}}function an($,D,L,j){Ot($,L,j),Ot(D,2*L,2*j),Ot(D,2*L+1,2*j+1)}function Ot($,D,L){const j=$[D];$[D]=$[L],$[L]=j}function He($,D,L,j){const H=$-L,oe=D-j;return H*H+oe*oe}$e.fromVectorTileJs=je,$e.fromGeojsonVt=function($,D){D=D||{};var L={};for(var j in $)L[j]=new xe($[j].features,D),L[j].name=j,L[j].version=D.version,L[j].extent=D.extent;return je({layers:L})},$e.GeoJSONWrapper=We;const Ye=$=>$[0],ut=$=>$[1];class Mt{constructor(D,L=Ye,j=ut,H=64,oe=Float64Array){this.nodeSize=H,this.points=D;const fe=D.length<65536?Uint16Array:Uint32Array,me=this.ids=new fe(D.length),le=this.coords=new oe(2*D.length);for(let ge=0;ge<D.length;ge++)me[ge]=ge,le[2*ge]=L(D[ge]),le[2*ge+1]=j(D[ge]);Wt(me,le,H,0,me.length-1,0)}range(D,L,j,H){return function(oe,fe,me,le,ge,ze,Ze){const Le=[0,oe.length-1,0],st=[];let ae,Ce;for(;Le.length;){const dt=Le.pop(),vt=Le.pop(),yt=Le.pop();if(vt-yt<=Ze){for(let ln=yt;ln<=vt;ln++)ae=fe[2*ln],Ce=fe[2*ln+1],ae>=me&&ae<=ge&&Ce>=le&&Ce<=ze&&st.push(oe[ln]);continue}const Nt=Math.floor((yt+vt)/2);ae=fe[2*Nt],Ce=fe[2*Nt+1],ae>=me&&ae<=ge&&Ce>=le&&Ce<=ze&&st.push(oe[Nt]);const Pt=(dt+1)%2;(dt===0?me<=ae:le<=Ce)&&(Le.push(yt),Le.push(Nt-1),Le.push(Pt)),(dt===0?ge>=ae:ze>=Ce)&&(Le.push(Nt+1),Le.push(vt),Le.push(Pt))}return st}(this.ids,this.coords,D,L,j,H,this.nodeSize)}within(D,L,j){return function(H,oe,fe,me,le,ge){const ze=[0,H.length-1,0],Ze=[],Le=le*le;for(;ze.length;){const st=ze.pop(),ae=ze.pop(),Ce=ze.pop();if(ae-Ce<=ge){for(let Pt=Ce;Pt<=ae;Pt++)He(oe[2*Pt],oe[2*Pt+1],fe,me)<=Le&&Ze.push(H[Pt]);continue}const dt=Math.floor((Ce+ae)/2),vt=oe[2*dt],yt=oe[2*dt+1];He(vt,yt,fe,me)<=Le&&Ze.push(H[dt]);const Nt=(st+1)%2;(st===0?fe-le<=vt:me-le<=yt)&&(ze.push(Ce),ze.push(dt-1),ze.push(Nt)),(st===0?fe+le>=vt:me+le>=yt)&&(ze.push(dt+1),ze.push(ae),ze.push(Nt))}return Ze}(this.ids,this.coords,D,L,j,this.nodeSize)}}const Jt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$=>$},Nn=Math.fround||(kn=new Float32Array(1),$=>(kn[0]=+$,kn[0]));var kn;class _t{constructor(D){this.options=sr(Object.create(Jt),D),this.trees=new Array(this.options.maxZoom+1)}load(D){const{log:L,minZoom:j,maxZoom:H,nodeSize:oe}=this.options;L&&console.time("total time");const fe=`prepare ${D.length} points`;L&&console.time(fe),this.points=D;let me=[];for(let le=0;le<D.length;le++)D[le].geometry&&me.push(Un(D[le],le));this.trees[H+1]=new Mt(me,jr,dr,oe,Float32Array),L&&console.timeEnd(fe);for(let le=H;le>=j;le--){const ge=+Date.now();me=this._cluster(me,le),this.trees[le]=new Mt(me,jr,dr,oe,Float32Array),L&&console.log("z%d: %d clusters in %dms",le,me.length,+Date.now()-ge)}return L&&console.timeEnd("total time"),this}getClusters(D,L){let j=((D[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,D[1]));let oe=D[2]===180?180:((D[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)j=-180,oe=180;else if(j>oe){const ze=this.getClusters([j,H,180,fe],L),Ze=this.getClusters([-180,H,oe,fe],L);return ze.concat(Ze)}const me=this.trees[this._limitZoom(L)],le=me.range(Ln(j),Rr(fe),Ln(oe),Rr(H)),ge=[];for(const ze of le){const Ze=me.points[ze];ge.push(Ze.numPoints?ai(Ze):this.points[Ze.index])}return ge}getChildren(D){const L=this._getOriginId(D),j=this._getOriginZoom(D),H="No cluster with the specified id.",oe=this.trees[j];if(!oe)throw new Error(H);const fe=oe.points[L];if(!fe)throw new Error(H);const me=this.options.radius/(this.options.extent*Math.pow(2,j-1)),le=oe.within(fe.x,fe.y,me),ge=[];for(const ze of le){const Ze=oe.points[ze];Ze.parentId===D&&ge.push(Ze.numPoints?ai(Ze):this.points[Ze.index])}if(ge.length===0)throw new Error(H);return ge}getLeaves(D,L,j){const H=[];return this._appendLeaves(H,D,L=L||10,j=j||0,0),H}getTile(D,L,j){const H=this.trees[this._limitZoom(D)],oe=Math.pow(2,D),{extent:fe,radius:me}=this.options,le=me/fe,ge=(j-le)/oe,ze=(j+1+le)/oe,Ze={features:[]};return this._addTileFeatures(H.range((L-le)/oe,ge,(L+1+le)/oe,ze),H.points,L,j,oe,Ze),L===0&&this._addTileFeatures(H.range(1-le/oe,ge,1,ze),H.points,oe,j,oe,Ze),L===oe-1&&this._addTileFeatures(H.range(0,ge,le/oe,ze),H.points,-1,j,oe,Ze),Ze.features.length?Ze:null}getClusterExpansionZoom(D){let L=this._getOriginZoom(D)-1;for(;L<=this.options.maxZoom;){const j=this.getChildren(D);if(L++,j.length!==1)break;D=j[0].properties.cluster_id}return L}_appendLeaves(D,L,j,H,oe){const fe=this.getChildren(L);for(const me of fe){const le=me.properties;if(le&&le.cluster?oe+le.point_count<=H?oe+=le.point_count:oe=this._appendLeaves(D,le.cluster_id,j,H,oe):oe<H?oe++:D.push(me),D.length===j)break}return oe}_addTileFeatures(D,L,j,H,oe,fe){for(const me of D){const le=L[me],ge=le.numPoints;let ze,Ze,Le;if(ge)ze=li(le),Ze=le.x,Le=le.y;else{const Ce=this.points[le.index];ze=Ce.properties,Ze=Ln(Ce.geometry.coordinates[0]),Le=Rr(Ce.geometry.coordinates[1])}const st={type:1,geometry:[[Math.round(this.options.extent*(Ze*oe-j)),Math.round(this.options.extent*(Le*oe-H))]],tags:ze};let ae;ge?ae=le.id:this.options.generateId?ae=le.index:this.points[le.index].id&&(ae=this.points[le.index].id),ae!==void 0&&(st.id=ae),fe.features.push(st)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(+D,this.options.maxZoom+1))}_cluster(D,L){const j=[],{radius:H,extent:oe,reduce:fe,minPoints:me}=this.options,le=H/(oe*Math.pow(2,L));for(let ge=0;ge<D.length;ge++){const ze=D[ge];if(ze.zoom<=L)continue;ze.zoom=L;const Ze=this.trees[L+1],Le=Ze.within(ze.x,ze.y,le),st=ze.numPoints||1;let ae=st;for(const Ce of Le){const dt=Ze.points[Ce];dt.zoom>L&&(ae+=dt.numPoints||1)}if(ae>=me){let Ce=ze.x*st,dt=ze.y*st,vt=fe&&st>1?this._map(ze,!0):null;const yt=(ge<<5)+(L+1)+this.points.length;for(const Nt of Le){const Pt=Ze.points[Nt];if(Pt.zoom<=L)continue;Pt.zoom=L;const ln=Pt.numPoints||1;Ce+=Pt.x*ln,dt+=Pt.y*ln,Pt.parentId=yt,fe&&(vt||(vt=this._map(ze,!0)),fe(vt,this._map(Pt)))}ze.parentId=yt,j.push(Ft(Ce/ae,dt/ae,yt,ae,vt))}else if(j.push(ze),ae>1)for(const Ce of Le){const dt=Ze.points[Ce];dt.zoom<=L||(dt.zoom=L,j.push(dt))}}return j}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,L){if(D.numPoints)return L?sr({},D.properties):D.properties;const j=this.points[D.index].properties,H=this.options.map(j);return L&&H===j?sr({},H):H}}function Ft($,D,L,j,H){return{x:Nn($),y:Nn(D),zoom:1/0,id:L,parentId:-1,numPoints:j,properties:H}}function Un($,D){const[L,j]=$.geometry.coordinates;return{x:Nn(Ln(L)),y:Nn(Rr(j)),zoom:1/0,index:D,parentId:-1}}function ai($){return{type:"Feature",id:$.id,properties:li($),geometry:{type:"Point",coordinates:[(D=$.x,360*(D-.5)),At($.y)]}};var D}function li($){const D=$.numPoints,L=D>=1e4?`${Math.round(D/1e3)}k`:D>=1e3?Math.round(D/100)/10+"k":D;return sr(sr({},$.properties),{cluster:!0,cluster_id:$.id,point_count:D,point_count_abbreviated:L})}function Ln($){return $/360+.5}function Rr($){const D=Math.sin($*Math.PI/180),L=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return L<0?0:L>1?1:L}function At($){const D=(180-360*$)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function sr($,D){for(const L in D)$[L]=D[L];return $}function jr($){return $.x}function dr($){return $.y}function In($,D,L,j){for(var H,oe=j,fe=L-D>>1,me=L-D,le=$[D],ge=$[D+1],ze=$[L],Ze=$[L+1],Le=D+3;Le<L;Le+=3){var st=Gr($[Le],$[Le+1],le,ge,ze,Ze);if(st>oe)H=Le,oe=st;else if(st===oe){var ae=Math.abs(Le-fe);ae<me&&(H=Le,me=ae)}}oe>j&&(H-D>3&&In($,D,H,j),$[H+2]=oe,L-H>3&&In($,H,L,j))}function Gr($,D,L,j,H,oe){var fe=H-L,me=oe-j;if(fe!==0||me!==0){var le=(($-L)*fe+(D-j)*me)/(fe*fe+me*me);le>1?(L=H,j=oe):le>0&&(L+=fe*le,j+=me*le)}return(fe=$-L)*fe+(me=D-j)*me}function pr($,D,L,j){var H={id:$===void 0?null:$,type:D,geometry:L,tags:j,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(oe){var fe=oe.geometry,me=oe.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")ci(oe,fe);else if(me==="Polygon"||me==="MultiLineString")for(var le=0;le<fe.length;le++)ci(oe,fe[le]);else if(me==="MultiPolygon")for(le=0;le<fe.length;le++)for(var ge=0;ge<fe[le].length;ge++)ci(oe,fe[le][ge])}(H),H}function ci($,D){for(var L=0;L<D.length;L+=3)$.minX=Math.min($.minX,D[L]),$.minY=Math.min($.minY,D[L+1]),$.maxX=Math.max($.maxX,D[L]),$.maxY=Math.max($.maxY,D[L+1])}function Zr($,D,L,j){if(D.geometry){var H=D.geometry.coordinates,oe=D.geometry.type,fe=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),me=[],le=D.id;if(L.promoteId?le=D.properties[L.promoteId]:L.generateId&&(le=j||0),oe==="Point")Kn(H,me);else if(oe==="MultiPoint")for(var ge=0;ge<H.length;ge++)Kn(H[ge],me);else if(oe==="LineString")Lr(H,me,fe,!1);else if(oe==="MultiLineString"){if(L.lineMetrics){for(ge=0;ge<H.length;ge++)Lr(H[ge],me=[],fe,!1),$.push(pr(le,"LineString",me,D.properties));return}en(H,me,fe,!1)}else if(oe==="Polygon")en(H,me,fe,!0);else{if(oe!=="MultiPolygon"){if(oe==="GeometryCollection"){for(ge=0;ge<D.geometry.geometries.length;ge++)Zr($,{id:le,geometry:D.geometry.geometries[ge],properties:D.properties},L,j);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<H.length;ge++){var ze=[];en(H[ge],ze,fe,!0),me.push(ze)}}$.push(pr(le,oe,me,D.properties))}}function Kn($,D){D.push(Yn($[0])),D.push(ft($[1])),D.push(0)}function Lr($,D,L,j){for(var H,oe,fe=0,me=0;me<$.length;me++){var le=Yn($[me][0]),ge=ft($[me][1]);D.push(le),D.push(ge),D.push(0),me>0&&(fe+=j?(H*ge-le*oe)/2:Math.sqrt(Math.pow(le-H,2)+Math.pow(ge-oe,2))),H=le,oe=ge}var ze=D.length-3;D[2]=1,In(D,0,ze,L),D[ze+2]=1,D.size=Math.abs(fe),D.start=0,D.end=D.size}function en($,D,L,j){for(var H=0;H<$.length;H++){var oe=[];Lr($[H],oe,L,j),D.push(oe)}}function Yn($){return $/360+.5}function ft($){var D=Math.sin($*Math.PI/180),L=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return L<0?0:L>1?1:L}function fr($,D,L,j,H,oe,fe,me){if(j/=D,oe>=(L/=D)&&fe<j)return $;if(fe<L||oe>=j)return null;for(var le=[],ge=0;ge<$.length;ge++){var ze=$[ge],Ze=ze.geometry,Le=ze.type,st=H===0?ze.minX:ze.minY,ae=H===0?ze.maxX:ze.maxY;if(st>=L&&ae<j)le.push(ze);else if(!(ae<L||st>=j)){var Ce=[];if(Le==="Point"||Le==="MultiPoint")vo(Ze,Ce,L,j,H);else if(Le==="LineString")Yi(Ze,Ce,L,j,H,!1,me.lineMetrics);else if(Le==="MultiLineString")Wo(Ze,Ce,L,j,H,!1);else if(Le==="Polygon")Wo(Ze,Ce,L,j,H,!0);else if(Le==="MultiPolygon")for(var dt=0;dt<Ze.length;dt++){var vt=[];Wo(Ze[dt],vt,L,j,H,!0),vt.length&&Ce.push(vt)}if(Ce.length){if(me.lineMetrics&&Le==="LineString"){for(dt=0;dt<Ce.length;dt++)le.push(pr(ze.id,Le,Ce[dt],ze.tags));continue}Le!=="LineString"&&Le!=="MultiLineString"||(Ce.length===1?(Le="LineString",Ce=Ce[0]):Le="MultiLineString"),Le!=="Point"&&Le!=="MultiPoint"||(Le=Ce.length===3?"Point":"MultiPoint"),le.push(pr(ze.id,Le,Ce,ze.tags))}}}return le.length?le:null}function vo($,D,L,j,H){for(var oe=0;oe<$.length;oe+=3){var fe=$[oe+H];fe>=L&&fe<=j&&(D.push($[oe]),D.push($[oe+1]),D.push($[oe+2]))}}function Yi($,D,L,j,H,oe,fe){for(var me,le,ge=Ws($),ze=H===0?Va:Ec,Ze=$.start,Le=0;Le<$.length-3;Le+=3){var st=$[Le],ae=$[Le+1],Ce=$[Le+2],dt=$[Le+3],vt=$[Le+4],yt=H===0?st:ae,Nt=H===0?dt:vt,Pt=!1;fe&&(me=Math.sqrt(Math.pow(st-dt,2)+Math.pow(ae-vt,2))),yt<L?Nt>L&&(le=ze(ge,st,ae,dt,vt,L),fe&&(ge.start=Ze+me*le)):yt>j?Nt<j&&(le=ze(ge,st,ae,dt,vt,j),fe&&(ge.start=Ze+me*le)):Xs(ge,st,ae,Ce),Nt<L&&yt>=L&&(le=ze(ge,st,ae,dt,vt,L),Pt=!0),Nt>j&&yt<=j&&(le=ze(ge,st,ae,dt,vt,j),Pt=!0),!oe&&Pt&&(fe&&(ge.end=Ze+me*le),D.push(ge),ge=Ws($)),fe&&(Ze+=me)}var ln=$.length-3;st=$[ln],ae=$[ln+1],Ce=$[ln+2],(yt=H===0?st:ae)>=L&&yt<=j&&Xs(ge,st,ae,Ce),ln=ge.length-3,oe&&ln>=3&&(ge[ln]!==ge[0]||ge[ln+1]!==ge[1])&&Xs(ge,ge[0],ge[1],ge[2]),ge.length&&D.push(ge)}function Ws($){var D=[];return D.size=$.size,D.start=$.start,D.end=$.end,D}function Wo($,D,L,j,H,oe){for(var fe=0;fe<$.length;fe++)Yi($[fe],D,L,j,H,oe,!1)}function Xs($,D,L,j){$.push(D),$.push(L),$.push(j)}function Va($,D,L,j,H,oe){var fe=(oe-D)/(j-D);return $.push(oe),$.push(L+(H-L)*fe),$.push(1),fe}function Ec($,D,L,j,H,oe){var fe=(oe-L)/(H-L);return $.push(D+(j-D)*fe),$.push(oe),$.push(1),fe}function wo($,D){for(var L=[],j=0;j<$.length;j++){var H,oe=$[j],fe=oe.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")H=Xo(oe.geometry,D);else if(fe==="MultiLineString"||fe==="Polygon"){H=[];for(var me=0;me<oe.geometry.length;me++)H.push(Xo(oe.geometry[me],D))}else if(fe==="MultiPolygon")for(H=[],me=0;me<oe.geometry.length;me++){for(var le=[],ge=0;ge<oe.geometry[me].length;ge++)le.push(Xo(oe.geometry[me][ge],D));H.push(le)}L.push(pr(oe.id,fe,H,oe.tags))}return L}function Xo($,D){var L=[];L.size=$.size,$.start!==void 0&&(L.start=$.start,L.end=$.end);for(var j=0;j<$.length;j+=3)L.push($[j]+D,$[j+1],$[j+2]);return L}function qr($,D){if($.transformed)return $;var L,j,H,oe=1<<$.z,fe=$.x,me=$.y;for(L=0;L<$.features.length;L++){var le=$.features[L],ge=le.geometry,ze=le.type;if(le.geometry=[],ze===1)for(j=0;j<ge.length;j+=2)le.geometry.push(Qi(ge[j],ge[j+1],D,oe,fe,me));else for(j=0;j<ge.length;j++){var Ze=[];for(H=0;H<ge[j].length;H+=2)Ze.push(Qi(ge[j][H],ge[j][H+1],D,oe,fe,me));le.geometry.push(Ze)}}return $.transformed=!0,$}function Qi($,D,L,j,H,oe){return[Math.round(L*($*j-H)),Math.round(L*(D*j-oe))]}function $a($,D,L,j,H){for(var oe=D===H.maxZoom?0:H.tolerance/((1<<D)*H.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:L,y:j,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},me=0;me<$.length;me++){fe.numFeatures++,Hs(fe,$[me],oe,H);var le=$[me].minX,ge=$[me].minY,ze=$[me].maxX,Ze=$[me].maxY;le<fe.minX&&(fe.minX=le),ge<fe.minY&&(fe.minY=ge),ze>fe.maxX&&(fe.maxX=ze),Ze>fe.maxY&&(fe.maxY=Ze)}return fe}function Hs($,D,L,j){var H=D.geometry,oe=D.type,fe=[];if(oe==="Point"||oe==="MultiPoint")for(var me=0;me<H.length;me+=3)fe.push(H[me]),fe.push(H[me+1]),$.numPoints++,$.numSimplified++;else if(oe==="LineString")Ji(fe,H,$,L,!1,!1);else if(oe==="MultiLineString"||oe==="Polygon")for(me=0;me<H.length;me++)Ji(fe,H[me],$,L,oe==="Polygon",me===0);else if(oe==="MultiPolygon")for(var le=0;le<H.length;le++){var ge=H[le];for(me=0;me<ge.length;me++)Ji(fe,ge[me],$,L,!0,me===0)}if(fe.length){var ze=D.tags||null;if(oe==="LineString"&&j.lineMetrics){for(var Ze in ze={},D.tags)ze[Ze]=D.tags[Ze];ze.mapbox_clip_start=H.start/H.size,ze.mapbox_clip_end=H.end/H.size}var Le={geometry:fe,type:oe==="Polygon"||oe==="MultiPolygon"?3:oe==="LineString"||oe==="MultiLineString"?2:1,tags:ze};D.id!==null&&(Le.id=D.id),$.features.push(Le)}}function Ji($,D,L,j,H,oe){var fe=j*j;if(j>0&&D.size<(H?fe:j))L.numPoints+=D.length/3;else{for(var me=[],le=0;le<D.length;le+=3)(j===0||D[le+2]>fe)&&(L.numSimplified++,me.push(D[le]),me.push(D[le+1])),L.numPoints++;H&&function(ge,ze){for(var Ze=0,Le=0,st=ge.length,ae=st-2;Le<st;ae=Le,Le+=2)Ze+=(ge[Le]-ge[ae])*(ge[Le+1]+ge[ae+1]);if(Ze>0===ze)for(Le=0,st=ge.length;Le<st/2;Le+=2){var Ce=ge[Le],dt=ge[Le+1];ge[Le]=ge[st-2-Le],ge[Le+1]=ge[st-1-Le],ge[st-2-Le]=Ce,ge[st-1-Le]=dt}}(me,oe),$.push(me)}}function bo($,D){var L=(D=this.options=function(H,oe){for(var fe in oe)H[fe]=oe[fe];return H}(Object.create(this.options),D)).debug;if(L&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var j=function(H,oe){var fe=[];if(H.type==="FeatureCollection")for(var me=0;me<H.features.length;me++)Zr(fe,H.features[me],oe,me);else Zr(fe,H.type==="Feature"?H:{geometry:H},oe);return fe}($,D);this.tiles={},this.tileCoords=[],L&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(j=function(H,oe){var fe=oe.buffer/oe.extent,me=H,le=fr(H,1,-1-fe,fe,0,-1,2,oe),ge=fr(H,1,1-fe,2+fe,0,-1,2,oe);return(le||ge)&&(me=fr(H,1,-fe,1+fe,0,-1,2,oe)||[],le&&(me=wo(le,1).concat(me)),ge&&(me=me.concat(wo(ge,-1)))),me}(j,D)).length&&this.splitTile(j,0,0,0),L&&(j.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function To($,D,L){return 32*((1<<$)*L+D)+$}function So($,D){const L=$.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);const j=this._geoJSONIndex.getTile(L.z,L.x,L.y);if(!j)return D(null,null);const H=new re(j.features);let oe=$e(H);oe.byteOffset===0&&oe.byteLength===oe.buffer.byteLength||(oe=new Uint8Array(oe)),D(null,{vectorTile:H,rawData:oe.buffer})}bo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},bo.prototype.splitTile=function($,D,L,j,H,oe,fe){for(var me=[$,D,L,j],le=this.options,ge=le.debug;me.length;){j=me.pop(),L=me.pop(),D=me.pop(),$=me.pop();var ze=1<<D,Ze=To(D,L,j),Le=this.tiles[Ze];if(!Le&&(ge>1&&console.time("creation"),Le=this.tiles[Ze]=$a($,D,L,j,le),this.tileCoords.push({z:D,x:L,y:j}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,L,j,Le.numFeatures,Le.numPoints,Le.numSimplified),console.timeEnd("creation"));var st="z"+D;this.stats[st]=(this.stats[st]||0)+1,this.total++}if(Le.source=$,H){if(D===le.maxZoom||D===H)continue;var ae=1<<H-D;if(L!==Math.floor(oe/ae)||j!==Math.floor(fe/ae))continue}else if(D===le.indexMaxZoom||Le.numPoints<=le.indexMaxPoints)continue;if(Le.source=null,$.length!==0){ge>1&&console.time("clipping");var Ce,dt,vt,yt,Nt,Pt,ln=.5*le.buffer/le.extent,Fi=.5-ln,Xe=.5+ln,Et=1+ln;Ce=dt=vt=yt=null,Nt=fr($,ze,L-ln,L+Xe,0,Le.minX,Le.maxX,le),Pt=fr($,ze,L+Fi,L+Et,0,Le.minX,Le.maxX,le),$=null,Nt&&(Ce=fr(Nt,ze,j-ln,j+Xe,1,Le.minY,Le.maxY,le),dt=fr(Nt,ze,j+Fi,j+Et,1,Le.minY,Le.maxY,le),Nt=null),Pt&&(vt=fr(Pt,ze,j-ln,j+Xe,1,Le.minY,Le.maxY,le),yt=fr(Pt,ze,j+Fi,j+Et,1,Le.minY,Le.maxY,le),Pt=null),ge>1&&console.timeEnd("clipping"),me.push(Ce||[],D+1,2*L,2*j),me.push(dt||[],D+1,2*L,2*j+1),me.push(vt||[],D+1,2*L+1,2*j),me.push(yt||[],D+1,2*L+1,2*j+1)}}},bo.prototype.getTile=function($,D,L){var j=this.options,H=j.extent,oe=j.debug;if($<0||$>24)return null;var fe=1<<$,me=To($,D=(D%fe+fe)%fe,L);if(this.tiles[me])return qr(this.tiles[me],H);oe>1&&console.log("drilling down to z%d-%d-%d",$,D,L);for(var le,ge=$,ze=D,Ze=L;!le&&ge>0;)ge--,ze=Math.floor(ze/2),Ze=Math.floor(Ze/2),le=this.tiles[To(ge,ze,Ze)];return le&&le.source?(oe>1&&console.log("found parent tile z%d-%d-%d",ge,ze,Ze),oe>1&&console.time("drilling down"),this.splitTile(le.source,ge,ze,Ze,$,D,L),oe>1&&console.timeEnd("drilling down"),this.tiles[me]?qr(this.tiles[me],H):null):null};class Ho extends a.VectorTileWorkerSource{constructor(D,L,j,H,oe){super(D,L,j,H,So),oe&&(this.loadGeoJSON=oe)}loadData(D,L){const j=D&&D.request,H=j&&j.collectResourceTiming;this.loadGeoJSON(D,(oe,fe)=>{if(oe||!fe)return L(oe);if(typeof fe!="object")return L(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));{ve(fe,!0);try{if(D.filter){const le=a.createExpression(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map(ze=>`${ze.key}: ${ze.message}`).join(", "));const ge=fe.features.filter(ze=>le.value.evaluate({zoom:0},ze));fe={type:"FeatureCollection",features:ge}}this._geoJSONIndex=D.cluster?new _t(function({superclusterOptions:le,clusterProperties:ge}){if(!ge||!le)return le;const ze={},Ze={},Le={accumulated:null,zoom:0},st={properties:null},ae=Object.keys(ge);for(const Ce of ae){const[dt,vt]=ge[Ce],yt=a.createExpression(vt),Nt=a.createExpression(typeof dt=="string"?[dt,["accumulated"],["get",Ce]]:dt);ze[Ce]=yt.value,Ze[Ce]=Nt.value}return le.map=Ce=>{st.properties=Ce;const dt={};for(const vt of ae)dt[vt]=ze[vt].evaluate(Le,st);return dt},le.reduce=(Ce,dt)=>{st.properties=dt;for(const vt of ae)Le.accumulated=Ce[vt],Ce[vt]=Ze[vt].evaluate(Le,st)},le}(D)).load(fe.features):function(le,ge){return new bo(le,ge)}(fe,D.geojsonVtOptions)}catch(le){return L(le)}this.loaded={};const me={};if(H){const le=a.getPerformanceMeasurement(j);le&&(me.resourceTiming={},me.resourceTiming[D.source]=JSON.parse(JSON.stringify(le)))}L(null,me)}})}reloadTile(D,L){const j=this.loaded;return j&&j[D.uid]?super.reloadTile(D,L):this.loadTile(D,L)}loadGeoJSON(D,L){if(D.request)a.getJSON(D.request,L);else{if(typeof D.data!="string")return L(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));try{return L(null,JSON.parse(D.data))}catch{return L(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(D,L){try{L(null,this._geoJSONIndex.getClusterExpansionZoom(D.clusterId))}catch(j){L(j)}}getClusterChildren(D,L){try{L(null,this._geoJSONIndex.getChildren(D.clusterId))}catch(j){L(j)}}getClusterLeaves(D,L){try{L(null,this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset))}catch(j){L(j)}}}class Si{constructor(D){this.self=D,this.actor=new a.Actor(D,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Ho},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(L,j)=>{if(this.workerSourceTypes[L])throw new Error(`Worker source with name "${L}" already registered.`);this.workerSourceTypes[L]=j},this.self.registerRTLTextPlugin=L=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=L.applyArabicShaping,a.plugin.processBidirectionalText=L.processBidirectionalText,a.plugin.processStyledBidirectionalText=L.processStyledBidirectionalText}}checkIfReady(D,L,j){j()}setReferrer(D,L){this.referrer=L}spriteLoaded(D,L){this.isSpriteLoaded=L;for(const j in this.workerSources[D]){const H=this.workerSources[D][j];for(const oe in H)H[oe]instanceof a.VectorTileWorkerSource&&(H[oe].isSpriteLoaded=L,H[oe].fire(new a.Event("isSpriteLoaded")))}}setImages(D,L,j){this.availableImages[D]=L;for(const H in this.workerSources[D]){const oe=this.workerSources[D][H];for(const fe in oe)oe[fe].availableImages=L}j()}enableTerrain(D,L,j){this.terrain=L,j()}setLayers(D,L,j){this.getLayerIndex(D).replace(L),j()}updateLayers(D,L,j){this.getLayerIndex(D).update(L.layers,L.removedIds),j()}loadTile(D,L,j){const H=this.enableTerrain?a.extend({enableTerrain:this.terrain},L):L;this.getWorkerSource(D,L.type,L.source).loadTile(H,j)}loadDEMTile(D,L,j){const H=this.enableTerrain?a.extend({buildQuadTree:this.terrain},L):L;this.getDEMWorkerSource(D,L.source).loadTile(H,j)}reloadTile(D,L,j){const H=this.enableTerrain?a.extend({enableTerrain:this.terrain},L):L;this.getWorkerSource(D,L.type,L.source).reloadTile(H,j)}abortTile(D,L,j){this.getWorkerSource(D,L.type,L.source).abortTile(L,j)}removeTile(D,L,j){this.getWorkerSource(D,L.type,L.source).removeTile(L,j)}removeSource(D,L,j){if(!this.workerSources[D]||!this.workerSources[D][L.type]||!this.workerSources[D][L.type][L.source])return;const H=this.workerSources[D][L.type][L.source];delete this.workerSources[D][L.type][L.source],H.removeSource!==void 0?H.removeSource(L,j):j()}loadWorkerSource(D,L,j){try{this.self.importScripts(L.url),j()}catch(H){j(H.toString())}}syncRTLPluginState(D,L,j){try{a.plugin.setState(L);const H=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&H!=null){this.self.importScripts(H);const oe=a.plugin.isParsed();j(oe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${H}`),oe)}}catch(H){j(H.toString())}}getAvailableImages(D){let L=this.availableImages[D];return L||(L=[]),L}getLayerIndex(D){let L=this.layerIndexes[D];return L||(L=this.layerIndexes[D]=new ce),L}getWorkerSource(D,L,j){return this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][L]||(this.workerSources[D][L]={}),this.workerSources[D][L][j]||(this.workerSources[D][L][j]=new this.workerSourceTypes[L]({send:(H,oe,fe,me,le,ge)=>{this.actor.send(H,oe,fe,D,le,ge)},scheduler:this.actor.scheduler},this.getLayerIndex(D),this.getAvailableImages(D),this.isSpriteLoaded)),this.workerSources[D][L][j]}getDEMWorkerSource(D,L){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][L]||(this.demWorkerSources[D][L]=new q),this.demWorkerSources[D][L]}enforceCacheSizeLimit(D,L){a.enforceCacheSizeLimit(L)}getWorkerPerformanceMetrics(D,L,j){j(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Si(self)),Si}),T(["./shared"],function(a){var B=W;function W(h){return!function(n){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var d,g,_=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(_);try{g=new Worker(w),d=!0}catch{d=!1}return g&&g.terminate(),URL.revokeObjectURL(w),d}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var d=document.createElement("canvas");d.width=d.height=1;var g=d.getContext("2d");if(!g)return!1;var _=g.getImageData(0,0,1,1);return _&&_.width===d.width}()?(ce[l=n&&n.failIfMajorPerformanceCaveat]===void 0&&(ce[l]=function(d){var g,_=function(w){var S=document.createElement("canvas"),C=Object.create(W.webGLContextAttributes);return C.failIfMajorPerformanceCaveat=w,S.getContext("webgl",C)||S.getContext("experimental-webgl",C)}(d);if(!_)return!1;try{g=_.createShader(_.VERTEX_SHADER)}catch{return!1}return!(!g||_.isContextLost())&&(_.shaderSource(g,"void main() {}"),_.compileShader(g),_.getShaderParameter(g,_.COMPILE_STATUS)===!0)}(l)),ce[l]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var l}(h)}var ce={};function J(h,n){if(Array.isArray(h)){if(!Array.isArray(n)||h.length!==n.length)return!1;for(let l=0;l<h.length;l++)if(!J(h[l],n[l]))return!1;return!0}if(typeof h=="object"&&h!==null&&n!==null){if(typeof n!="object"||Object.keys(h).length!==Object.keys(n).length)return!1;for(const l in h)if(!J(h[l],n[l]))return!1;return!0}return h===n}W.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const q={create:function(h,n,l){const d=a.window.document.createElement(h);return n!==void 0&&(d.className=n),l&&l.appendChild(d),d},createNS:function(h,n){return a.window.document.createElementNS(h,n)}},ve=a.window.document&&a.window.document.documentElement.style,Ae=ve&&ve.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Se;q.disableDrag=function(){ve&&Ae&&(Se=ve[Ae],ve[Ae]="none")},q.enableDrag=function(){ve&&Ae&&(ve[Ae]=Se)},q.setTransform=function(h,n){h.style.transform=n};let ee=!1;try{const h=Object.defineProperty({},"passive",{get(){ee=!0}});a.window.addEventListener("test",h,h),a.window.removeEventListener("test",h,h)}catch{ee=!1}q.addEventListener=function(h,n,l,d={}){h.addEventListener(n,l,"passive"in d&&ee?d:d.capture)},q.removeEventListener=function(h,n,l,d={}){h.removeEventListener(n,l,"passive"in d&&ee?d:d.capture)};const Q=function(h){h.preventDefault(),h.stopPropagation(),a.window.removeEventListener("click",Q,!0)};function re(h,n,l){const d=h.offsetWidth===n.width?1:h.offsetWidth/n.width;return new a.pointGeometry((l.clientX-n.left)*d,(l.clientY-n.top)*d)}q.suppressClick=function(){a.window.addEventListener("click",Q,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",Q,!0)},0)},q.mousePos=function(h,n){const l=h.getBoundingClientRect();return re(h,l,n)},q.touchPos=function(h,n){const l=h.getBoundingClientRect(),d=[];for(let g=0;g<n.length;g++)d.push(re(h,l,n[g]));return d},q.mouseButton=function(h){return a.window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button},q.remove=function(h){h.parentNode&&h.parentNode.removeChild(h)};class Te{constructor(n,l){this.pos=n,this.dir=l}intersectsPlane(n,l,d){const g=a.dot(l,this.dir);if(Math.abs(g)<1e-6)return!1;const _=a.dot(a.sub(a.create(),n,this.pos),l)/g,w=a.scaleAndAdd(a.create(),this.pos,this.dir,_);return a.copy(d,w),!0}}class xe{constructor(n,l){this.points=n,this.planes=l}static fromInvProjectionMatrix(n,l,d){const g=Math.pow(2,d),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const C=a.transformMat4([],S,n),M=1/C[3]/l*g;return a.mul(C,C,[M,M,1/C[3],M])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const C=a.sub([],_[S[0]],_[S[1]]),M=a.sub([],_[S[2]],_[S[1]]),z=a.normalize([],a.cross([],C,M)),R=-a.dot(z,_[S[1]]);return z.concat(R)});return new xe(_,w)}}class Ve{constructor(n,l){this.min=n,this.max=l,this.center=a.scale([],a.add([],this.min,this.max),.5)}quadrant(n){const l=[n%2==0,n<2],d=a.clone(this.min),g=a.clone(this.max);for(let _=0;_<l.length;_++)d[_]=l[_]?this.min[_]:this.center[_],g[_]=l[_]?this.center[_]:this.max[_];return g[2]=this.max[2],new Ve(d,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}intersects(n){const l=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let g=0;g<n.planes.length;g++){const _=n.planes[g];let w=0;for(let S=0;S<l.length;S++)w+=a.dot$1(_,l[S])>=0;if(w===0)return 0;w!==l.length&&(d=!1)}if(d)return 2;for(let g=0;g<3;g++){let _=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let S=0;S<n.points.length;S++){const C=n.points[S][g]-this.min[g];_=Math.min(_,C),w=Math.max(w,C)}if(w<0||_>this.max[g]-this.min[g])return 0}return 1}}function Ie(h){const{userImage:n}=h;return!!(n&&n.render&&n.render())&&(h.data.replace(new Uint8Array(n.data.buffer)),!0)}class $e extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:l,callback:d}of this.requestors)this._notify(l,d);this.requestors=[]}}getImage(n){return this.images[n]}addImage(n,l){this._validate(n,l)&&(this.images[n]=l)}_validate(n,l){let d=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),d=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),d=!1),this._validateContent(l.content,l)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),d=!1),d}_validateStretch(n,l){if(!n)return!0;let d=0;for(const g of n){if(g[0]<d||g[1]<g[0]||l<g[1])return!1;d=g[1]}return!0}_validateContent(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0}removeImage(n){const l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,l){let d=!0;if(!this.isLoaded())for(const g of n)this.images[g]||(d=!1);this.isLoaded()||d?this._notify(n,l):this.requestors.push({ids:n,callback:l})}_notify(n,l){const d={};for(const g of n){this.images[g]||this.fire(new a.Event("styleimagemissing",{id:g}));const _=this.images[g];_?d[g]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:Boolean(_.userImage&&_.userImage.render)}:a.warnOnce(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,d)}getPixelSize(){const{width:n,height:l}=this.atlasImage;return{width:n,height:l}}getPattern(n){const l=this.patterns[n],d=this.getImage(n);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{const g={w:d.data.width+2,h:d.data.height+2,x:0,y:0},_=new a.ImagePosition(g,d);this.patterns[n]={bin:g,position:_}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const _ in this.patterns)n.push(this.patterns[_].bin);const{w:l,h:d}=a.potpack(n),g=this.atlasImage;g.resize({width:l||1,height:d||1});for(const _ in this.patterns){const{bin:w}=this.patterns[_],S=w.x+1,C=w.y+1,M=this.images[_].data,z=M.width,R=M.height;a.RGBAImage.copy(M,g,{x:0,y:0},{x:S,y:C},{width:z,height:R}),a.RGBAImage.copy(M,g,{x:0,y:R-1},{x:S,y:C-1},{width:z,height:1}),a.RGBAImage.copy(M,g,{x:0,y:0},{x:S,y:C+R},{width:z,height:1}),a.RGBAImage.copy(M,g,{x:z-1,y:0},{x:S-1,y:C},{width:1,height:R}),a.RGBAImage.copy(M,g,{x:0,y:0},{x:S+z,y:C},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const l of n){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const d=this.images[l];Ie(d)&&this.updateImage(l,d)}}}const We=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(h,n){return function([l,d,g]){const _=a.degToRad(d+90),w=a.degToRad(g);return{x:l*Math.cos(_)*Math.sin(w),y:l*Math.sin(_)*Math.sin(w),z:l*Math.cos(w),azimuthal:d,polar:g}}(h.expression.evaluate(n))}interpolate(h,n,l){return{x:a.number(h.x,n.x,l),y:a.number(h.y,n.y,l),z:a.number(h.z,n.z,l),azimuthal:a.number(h.azimuthal,n.azimuthal,l),polar:a.number(h.polar,n.polar,l)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),je="-transition";class ot extends a.Evented{constructor(n){super(),this._transitionable=new a.Transitionable(We),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l={}){if(!this._validate(a.validateLight,n,l))for(const d in n){const g=n[d];a.endsWith(d,je)?this._transitionable.setTransition(d.slice(0,-je.length),g):this._transitionable.setValue(d,g)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d){return(!d||d.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const zt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),Rt="-transition";class St extends a.Evented{constructor(n){super(),this._transitionable=new a.Transitionable(zt),this.set(n),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(n){for(const l in n){const d=n[l];a.endsWith(l,Rt)?this._transitionable.setTransition(l.slice(0,-Rt.length),d):this._transitionable.setValue(l,d)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}}function Zt(h,n,l,d){const g=a.smoothstep(45,65,l),[_,w]=Ht(h,d),S=a.length(n);let C=1-Math.min(1,Math.exp((S-_)/(w-_)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*g*h.alpha}function Ht(h,n){const l=.5/Math.tan(.5*n);return[h.range[0]+l,h.range[1]+l]}const qt=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"])}),Wt="-transition";class xn extends a.Evented{constructor(n){super(),this._transitionable=new a.Transitionable(qt),this.set(n),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,l={}){if(!this._validate(a.validateFog,n,l))for(const d in n){const g=n[d];a.endsWith(d,Wt)?this._transitionable.setTransition(d.slice(0,-Wt.length),g):this._transitionable.setValue(d,g)}}getOpacity(n){const l=this.properties&&this.properties.get("color")||1;return a.smoothstep(45,65,n)*l.a}getOpacityAtLatLng(n,l){return function(d,g,_){const w=a.MercatorCoordinate.fromLngLat(g),S=_.elevation?_.elevation.getAtPointOrZero(w):0,C=[w.x,w.y,S];return a.transformMat4$1(C,C,_.mercatorFogMatrix),Zt(d,C,_.pitch,_._fov)}(this.state,n,l)}getFovAdjustedRange(n){return Ht(this.state,n)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d){return(!d||d.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class an{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const d=this.workerPool.acquire(this.id);for(let g=0;g<d.length;g++){const _=new an.Actor(d[g],l,this.id);_.name=`Worker ${g}`,this.actors.push(_)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,l,d){a.asyncAll(this.actors,(g,_)=>{g.send(n,l,_)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ot(h,n,l){return n*(a.EXTENT/(h.tileSize*Math.pow(2,l-h.tileID.overscaledZ)))}an.Actor=a.Actor;class He{constructor(n,l,d,g){this.screenBounds=n,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=d,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(_=>g.pointCoordinate3D(_)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(n,l){let d,g;if(n instanceof a.pointGeometry||typeof n[0]=="number"){const _=a.pointGeometry.convert(n);d=[a.pointGeometry.convert(n)],g=l.isPointAboveHorizon(_)}else{const _=a.pointGeometry.convert(n[0]),w=a.pointGeometry.convert(n[1]);d=[_,w],g=a.polygonizeBounds(_,w).every(S=>l.isPointAboveHorizon(S))}return new He(d,l.getCameraPoint(),g,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const l=this.screenBounds[0],d=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],g=a.polygonizeBounds(l,d,0,!1);return this.cameraPoint.y>d.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<d.x?g.splice(3,0,this.cameraPoint):this.cameraPoint.x>=d.x?g[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(g[3]=this.cameraPoint)),a.bufferConvexPolygon(g,n)}containsTile(n,l,d){const g=n.queryPadding+1,_=d?this._bufferedCameraMercator(g,l).map(O=>n.tileID.getTilePoint(O)):this._bufferedScreenMercator(g,l).map(O=>n.tileID.getTilePoint(O)),w=this.screenGeometryMercator.map(O=>n.tileID.getTileVec3(O)),S=w.map(O=>new a.pointGeometry(O[0],O[1])),C=l.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),M=n.tileID.getTileVec3(C),z=w.map(O=>{const G=a.sub(O,O,M);return a.normalize(G,G),new Te(M,G)}),R=Ot(n,1,l.zoom);if(a.polygonIntersectsBox(_,0,0,a.EXTENT,a.EXTENT))return{queryGeometry:this,tilespaceGeometry:S,tilespaceRays:z,bufferedTilespaceGeometry:_,bufferedTilespaceBounds:(F=a.getBounds(_),F.min.x=a.clamp(F.min.x,0,a.EXTENT),F.min.y=a.clamp(F.min.y,0,a.EXTENT),F.max.x=a.clamp(F.max.x,0,a.EXTENT),F.max.y=a.clamp(F.max.y,0,a.EXTENT),F),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:R};var F}_bufferedScreenMercator(n,l){const d=Ye(n);if(this._screenRaycastCache[d])return this._screenRaycastCache[d];{const g=this.bufferedScreenGeometry(n).map(_=>l.pointCoordinate3D(_));return this._screenRaycastCache[d]=g,g}}_bufferedCameraMercator(n,l){const d=Ye(n);if(this._cameraRaycastCache[d])return this._cameraRaycastCache[d];{const g=this.bufferedCameraGeometry(n).map(_=>l.pointCoordinate3D(_));return this._cameraRaycastCache[d]=g,g}}}function Ye(h){return 100*h|0}function ut(h,n,l){const d=function(g,_){if(g)return l(g);if(_){const w=a.pick(a.extend(_,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(w.vectorLayers=_.vector_layers,w.vectorLayerIds=w.vectorLayers.map(S=>S.id)),w.tiles=n.canonicalizeTileset(w,h.url),l(null,w)}};return h.url?a.getJSON(n.transformRequest(n.normalizeSourceURL(h.url),a.ResourceType.Source),d):a.exported.frame(()=>d(null,h))}class Mt{constructor(n,l,d){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=d||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),d=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*l),g=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*l),_=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*l),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*l);return n.x>=d&&n.x<_&&n.y>=g&&n.y<w}}class Jt{constructor(n,l,d){this.context=n;const g=n.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(d),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Nn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class kn{constructor(n,l,d,g){this.length=l.length,this.attributes=d,this.itemSize=l.bytesPerElement,this.dynamicDraw=g,this.context=n;const _=n.gl;this.buffer=_.createBuffer(),n.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let d=0;d<this.attributes.length;d++){const g=l.attributes[this.attributes[d].name];g!==void 0&&n.enableVertexAttribArray(g)}}setVertexAttribPointers(n,l,d){for(let g=0;g<this.attributes.length;g++){const _=this.attributes[g],w=l.attributes[_.name];w!==void 0&&n.vertexAttribPointer(w,_.components,n[Nn[_.type]],!1,this.itemSize,_.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _t{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ft extends _t{getDefault(){return a.Color.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Un extends _t{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class ai extends _t{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class li extends _t{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ln extends _t{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Rr extends _t{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class At extends _t{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class sr extends _t{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class jr extends _t{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class dr extends _t{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class In extends _t{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class Gr extends _t{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class pr extends _t{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class ci extends _t{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Zr extends _t{getDefault(){return a.Color.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Kn extends _t{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Lr extends _t{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class en extends _t{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Yn extends _t{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class ft extends _t{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class fr extends _t{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class vo extends _t{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Yi extends _t{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Ws extends _t{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Wo extends _t{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Xs extends _t{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Va extends _t{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ec extends _t{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class wo extends _t{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Xo extends _t{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class qr extends _t{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Qi extends _t{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class $a extends Qi{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Hs extends Qi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Ji extends Hs{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class bo{constructor(n,l,d,g){this.context=n,this.width=l,this.height=d;const _=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new $a(n,_),g&&(this.depthAttachment=new Hs(n,_))}destroy(){const n=this.context.gl,l=this.colorAttachment.get();if(l&&n.deleteTexture(l),this.depthAttachment){const d=this.depthAttachment.get();d&&n.deleteRenderbuffer(d)}n.deleteFramebuffer(this.framebuffer)}}class To{constructor(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ft(this),this.clearDepth=new Un(this),this.clearStencil=new ai(this),this.colorMask=new li(this),this.depthMask=new Ln(this),this.stencilMask=new Rr(this),this.stencilFunc=new At(this),this.stencilOp=new sr(this),this.stencilTest=new jr(this),this.depthRange=new dr(this),this.depthTest=new In(this),this.depthFunc=new Gr(this),this.blend=new pr(this),this.blendFunc=new ci(this),this.blendColor=new Zr(this),this.blendEquation=new Kn(this),this.cullFace=new Lr(this),this.cullFaceSide=new en(this),this.frontFace=new Yn(this),this.program=new ft(this),this.activeTexture=new fr(this),this.viewport=new vo(this),this.bindFramebuffer=new Yi(this),this.bindRenderbuffer=new Ws(this),this.bindTexture=new Wo(this),this.bindVertexBuffer=new Xs(this),this.bindElementBuffer=new Va(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ec(this),this.pixelStoreUnpack=new wo(this),this.pixelStoreUnpackPremultiplyAlpha=new Xo(this),this.pixelStoreUnpackFlipY=new qr(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l){return new Jt(this,n,l)}createVertexBuffer(n,l,d){return new kn(this,n,l,d)}createRenderbuffer(n,l,d){const g=this.gl,_=g.createRenderbuffer();return this.bindRenderbuffer.set(_),g.renderbufferStorage(g.RENDERBUFFER,n,l,d),this.bindRenderbuffer.set(null),_}createFramebuffer(n,l,d){return new bo(this,n,l,d)}clear({color:n,depth:l,stencil:d}){const g=this.gl;let _=0;n&&(_|=g.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(_|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),d!==void 0&&(_|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),g.clear(_)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){J(n.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class So extends a.Evented{constructor(n,l,d,g){super(),this.id=n,this.dispatcher=d,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},l),a.extend(this,a.pick(l,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ut(this._options,this.map._requestManager,(n,l)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):l&&(a.extend(this,l),l.bounds&&(this.tileBounds=new Mt(l.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(l.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,l){const d=a.exported.devicePixelRatio>=2,g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),d,this.tileSize);n.request=a.getImage(this.map._requestManager.transformRequest(g,a.ResourceType.Tile),(_,w,S,C)=>{if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(_)n.state="errored",l(_);else if(w){this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:S,expires:C});const M=this.map.painter.context,z=M.gl;n.texture=this.map.painter.getTileTexture(w.width),n.texture?n.texture.update(w,{useMipmap:!0}):(n.texture=new a.Texture(M,w,z.RGBA,{useMipmap:!0}),n.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),M.extTextureFilterAnisotropic&&z.texParameterf(z.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax)),n.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),l(null)}})}abortTile(n,l){n.request&&(n.request.cancel(),delete n.request),l()}unloadTile(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()}hasTransition(){return!1}}let Ho;var Si=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class $ extends a.Evented{constructor(n,l,d,g){super(),this.id=n,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=l}load(n,l){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(d,g)=>{this._loaded=!0,d?this.fire(new a.ErrorEvent(d)):g&&(this.image=a.exported.getImageData(g),n&&(this.coordinates=n),l&&l(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}setCoordinates(n){this.coordinates=n;const l=n.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(g){let _=1/0,w=1/0,S=-1/0,C=-1/0;for(const F of g)_=Math.min(_,F.x),w=Math.min(w,F.y),S=Math.max(S,F.x),C=Math.max(C,F.y);const M=Math.max(S-_,C-w),z=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),R=Math.pow(2,z);return new a.CanonicalTileID(z,Math.floor((_+S)/2*R),Math.floor((w+C)/2*R))}(l),this.minzoom=this.maxzoom=this.tileID.z;const d=l.map(g=>this.tileID.getTilePoint(g)._round());return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(d[2].x,d[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Si.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}loadTile(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const D={vector:class extends a.Evented{constructor(h,n,l,d){if(super(),this.id=h,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(n,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ut(this._options,this.map._requestManager,(h,n)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new a.ErrorEvent(h)):n&&(a.extend(this,n),n.bounds&&(this.tileBounds=new Mt(n.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(n.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}setSourceProperty(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h();const n=this.map.style._getSourceCaches(this.id);for(const l of n)l.clearTiles();this.load()}setTiles(h){return this.setSourceProperty(()=>{this._options.tiles=h}),this}setUrl(h){return this.setSourceProperty(()=>{this.url=h,this._options.url=h}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(h,n){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),d={request:this.map._requestManager.transformRequest(l,a.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(d.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=n:h.request=h.actor.send("reloadTile",d,g.bind(this));else if(h.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",d,g.bind(this),void 0,!0);else{const _=a.loadVectorTile.call({deduped:this._deduped},d,(w,S)=>{w||!S?g.call(this,w):(d.data={cacheControl:S.cacheControl,expires:S.expires,rawData:S.rawData.slice(0)},h.actor&&h.actor.send("loadTile",d,g.bind(this),void 0,!0))},!0);h.request={cancel:_}}function g(_,w){return delete h.request,h.aborted?n(null):_&&_.status!==404?n(_):(w&&w.resourceTiming&&(h.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&h.setExpiryData(w),h.loadVectorData(w,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:So,"raster-dem":class extends So{constructor(h,n,l,d){super(h,n,l,d),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(h,n){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function d(g,_){g&&(h.state="errored",n(g)),_&&(h.dem=_,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",n(null))}h.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),function(g,_,w,S){if(delete h.request,h.aborted)h.state="unloaded",n(null);else if(g)h.state="errored",n(g);else if(_){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:w,expires:S});const C=a.window.ImageBitmap&&_ instanceof a.window.ImageBitmap&&(Ho==null&&(Ho=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),Ho),M=1-(_.width-a.prevPowerOfTwo(_.width))/2;M<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const z=C?_:a.exported.getImageData(_,M),R={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:z,encoding:this.encoding,padding:M};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",R,d.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const n=h.canonical,l=Math.pow(2,n.z),d=(n.x-1+l)%l,g=n.x===0?h.wrap-1:h.wrap,_=(n.x+1+l)%l,w=n.x+1===l?h.wrap+1:h.wrap,S={};return S[new a.OverscaledTileID(h.overscaledZ,g,n.z,d,n.y).key]={backfilled:!1},S[new a.OverscaledTileID(h.overscaledZ,w,n.z,_,n.y).key]={backfilled:!1},n.y>0&&(S[new a.OverscaledTileID(h.overscaledZ,g,n.z,d,n.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(h.overscaledZ,h.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(h.overscaledZ,w,n.z,_,n.y-1).key]={backfilled:!1}),n.y+1<l&&(S[new a.OverscaledTileID(h.overscaledZ,g,n.z,d,n.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(h.overscaledZ,h.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(h.overscaledZ,w,n.z,_,n.y+1).key]={backfilled:!1}),S}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends a.Evented{constructor(h,n,l,d){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(d),this._data=n.data,this._options=a.extend({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const g=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*g,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*g,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:a.EXTENT,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*g,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},n),this}getClusterChildren(h,n){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},n),this}getClusterLeaves(h,n,l,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:n,offset:l},d),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=a.extend({},this.workerOptions),n=this._data;typeof n=="string"?(h.request=this.map._requestManager.transformRequest(a.exported.resolveURL(n),a.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(l,d)=>{if(this._loaded=!0,this._pendingLoad=null,l)this.fire(new a.ErrorEvent(l));else{const g={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&d&&d.resourceTiming&&d.resourceTiming[this.id]&&(g.resourceTiming=d.resourceTiming[this.id]),this.fire(new a.Event("data",g)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,n){const l=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(l,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(d,g)=>(delete h.request,h.unloadVectorData(),h.aborted?n(null):d?n(d):(h.loadVectorData(g,this.map.painter,l==="reloadTile"),n(null))),void 0,l==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ${constructor(h,n,l,d){super(h,n,l,d),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const n of h.urls)this.urls.push(this.map._requestManager.transformRequest(n,a.ResourceType.Source).url);a.getVideo(this.urls,(n,l)=>{this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):l&&(this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const n=this.video.seekable;h<n.start(0)||h>n.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,n=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Si.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(h,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:$,canvas:class extends ${constructor(h,n,l,d){super(h,n,l,d),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(_=>typeof _!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Si.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(n,this.canvas,l.RGBA,{premultiply:!0});for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}}},L=function(h,n,l,d){const g=new D[n.type](h,n,l,d);if(g.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${g.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],g),g};function j(h,n){const l=a.identity([]);return a.scale$1(l,l,[.5*h.width,.5*-h.height,1]),a.translate(l,l,[1,-1,0]),a.multiply(l,l,h.calculateProjMatrix(n.toUnwrapped()))}function H(h,n,l,d,g,_,w,S=!1){const C=h.tilesIn(d,w,S);C.sort(fe);const M=[];for(const R of C)M.push({wrappedTileID:R.tile.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(n,l,h._state,R,g,_,j(h.transform,R.tile.tileID),S)});const z=function(R){const F={},O={};for(const G of R){const Z=G.queryResults,ne=G.wrappedTileID,V=O[ne]=O[ne]||{};for(const X in Z){const te=Z[X],se=V[X]=V[X]||{},ue=F[X]=F[X]||[];for(const Y of te)se[Y.featureIndex]||(se[Y.featureIndex]=!0,ue.push(Y))}}return F}(M);for(const R in z)z[R].forEach(F=>{const O=F.feature,G=h.getFeatureState(O.layer["source-layer"],O.id);O.source=O.layer.source,O.layer["source-layer"]&&(O.sourceLayer=O.layer["source-layer"]),O.state=G});return z}function oe(h,n){const l=h.getRenderableIds().map(_=>h.getTileByID(_)),d=[],g={};for(let _=0;_<l.length;_++){const w=l[_],S=w.tileID.canonical.key;g[S]||(g[S]=!0,w.querySourceFeatures(d,n))}return d}function fe(h,n){const l=h.tileID,d=n.tileID;return l.overscaledZ-d.overscaledZ||l.canonical.y-d.canonical.y||l.wrap-d.wrap||l.canonical.x-d.canonical.x}function me(){return wl.workerClass!=null?new wl.workerClass:new a.window.Worker(wl.workerUrl)}const le="mapboxgl_preloaded_worker_pool";class ge{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<ge.workerCount;)this.workers.push(new me);return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[le]}numActive(){return Object.keys(this.active).length}}let ze;function Ze(){return ze||(ze=new ge),ze}function Le(h,n){const l={};for(const d in h)d!=="ref"&&(l[d]=h[d]);return a.refProperties.forEach(d=>{d in n&&(l[d]=n[d])}),l}function st(h){h=h.slice();const n=Object.create(null);for(let l=0;l<h.length;l++)n[h[l].id]=h[l];for(let l=0;l<h.length;l++)"ref"in h[l]&&(h[l]=Le(h[l],n[h[l].ref]));return h}ge.workerCount=2;const ae={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Ce(h,n,l){l.push({command:ae.addSource,args:[h,n[h]]})}function dt(h,n,l){n.push({command:ae.removeSource,args:[h]}),l[h]=!0}function vt(h,n,l,d){dt(h,l,d),Ce(h,n,l)}function yt(h,n,l){let d;for(d in h[l])if(h[l].hasOwnProperty(d)&&d!=="data"&&!J(h[l][d],n[l][d]))return!1;for(d in n[l])if(n[l].hasOwnProperty(d)&&d!=="data"&&!J(h[l][d],n[l][d]))return!1;return!0}function Nt(h,n,l,d,g,_){let w;for(w in n=n||{},h=h||{})h.hasOwnProperty(w)&&(J(h[w],n[w])||l.push({command:_,args:[d,w,n[w],g]}));for(w in n)n.hasOwnProperty(w)&&!h.hasOwnProperty(w)&&(J(h[w],n[w])||l.push({command:_,args:[d,w,n[w],g]}))}function Pt(h){return h.id}function ln(h,n){return h[n.id]=n,h}class Fi{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);let l=1,d=this._distances[l];const g=n*this.paddedLength+this.padding;for(;d<g&&l<this._distances.length;)d=this._distances[++l];const _=l-1,w=this._distances[_],S=d-w,C=S>0?(g-w)/S:0;return this.points[_].mult(1-C).add(this.points[l].mult(C))}}class Xe{constructor(n,l,d){const g=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(n/d),this.yCellCount=Math.ceil(l/d);for(let w=0;w<this.xCellCount*this.yCellCount;w++)g.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,d,g,_){this._forEachCell(l,d,g,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(_)}insertCircle(n,l,d,g){this._forEachCell(l-g,d-g,l+g,d+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(d),this.circles.push(g)}_insertBoxCell(n,l,d,g,_,w){this.boxCells[_].push(w)}_insertCircleCell(n,l,d,g,_,w){this.circleCells[_].push(w)}_query(n,l,d,g,_,w){if(d<0||n>this.width||g<0||l>this.height)return!_&&[];const S=[];if(n<=0&&l<=0&&this.width<=d&&this.height<=g){if(_)return!0;for(let C=0;C<this.boxKeys.length;C++)S.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const M=this.circles[3*C],z=this.circles[3*C+1],R=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:M-R,y1:z-R,x2:M+R,y2:z+R})}return w?S.filter(w):S}return this._forEachCell(n,l,d,g,this._queryCell,S,{hitTest:_,seenUids:{box:{},circle:{}}},w),_?S.length>0:S}_queryCircle(n,l,d,g,_){const w=n-d,S=n+d,C=l-d,M=l+d;if(S<0||w>this.width||M<0||C>this.height)return!g&&[];const z=[];return this._forEachCell(w,C,S,M,this._queryCellCircle,z,{hitTest:g,circle:{x:n,y:l,radius:d},seenUids:{box:{},circle:{}}},_),g?z.length>0:z}query(n,l,d,g,_){return this._query(n,l,d,g,!1,_)}hitTest(n,l,d,g,_){return this._query(n,l,d,g,!0,_)}hitTestCircle(n,l,d,g){return this._queryCircle(n,l,d,!0,g)}_queryCell(n,l,d,g,_,w,S,C){const M=S.seenUids,z=this.boxCells[_];if(z!==null){const F=this.bboxes;for(const O of z)if(!M.box[O]){M.box[O]=!0;const G=4*O;if(n<=F[G+2]&&l<=F[G+3]&&d>=F[G+0]&&g>=F[G+1]&&(!C||C(this.boxKeys[O]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[O],x1:F[G],y1:F[G+1],x2:F[G+2],y2:F[G+3]})}}}const R=this.circleCells[_];if(R!==null){const F=this.circles;for(const O of R)if(!M.circle[O]){M.circle[O]=!0;const G=3*O;if(this._circleAndRectCollide(F[G],F[G+1],F[G+2],n,l,d,g)&&(!C||C(this.circleKeys[O]))){if(S.hitTest)return w.push(!0),!0;{const Z=F[G],ne=F[G+1],V=F[G+2];w.push({key:this.circleKeys[O],x1:Z-V,y1:ne-V,x2:Z+V,y2:ne+V})}}}}}_queryCellCircle(n,l,d,g,_,w,S,C){const M=S.circle,z=S.seenUids,R=this.boxCells[_];if(R!==null){const O=this.bboxes;for(const G of R)if(!z.box[G]){z.box[G]=!0;const Z=4*G;if(this._circleAndRectCollide(M.x,M.y,M.radius,O[Z+0],O[Z+1],O[Z+2],O[Z+3])&&(!C||C(this.boxKeys[G])))return w.push(!0),!0}}const F=this.circleCells[_];if(F!==null){const O=this.circles;for(const G of F)if(!z.circle[G]){z.circle[G]=!0;const Z=3*G;if(this._circlesCollide(O[Z],O[Z+1],O[Z+2],M.x,M.y,M.radius)&&(!C||C(this.circleKeys[G])))return w.push(!0),!0}}}_forEachCell(n,l,d,g,_,w,S,C){const M=this._convertToXCellCoord(n),z=this._convertToYCellCoord(l),R=this._convertToXCellCoord(d),F=this._convertToYCellCoord(g);for(let O=M;O<=R;O++)for(let G=z;G<=F;G++)if(_.call(this,n,l,d,g,this.xCellCount*G+O,w,S,C))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,d,g,_,w){const S=g-n,C=_-l,M=d+w;return M*M>S*S+C*C}_circleAndRectCollide(n,l,d,g,_,w,S){const C=(w-g)/2,M=Math.abs(n-(g+C));if(M>C+d)return!1;const z=(S-_)/2,R=Math.abs(l-(_+z));if(R>z+d)return!1;if(M<=C||R<=z)return!0;const F=M-C,O=R-z;return F*F+O*O<=d*d}}const Et=Math.tan(85*Math.PI/180);function wt(h,n,l,d,g){const _=a.create$1();return n?(a.scale$1(_,_,[1/g,1/g,1]),l||a.rotateZ(_,_,d.angle)):a.multiply(_,d.labelPlaneMatrix,h),_}function ui(h,n,l,d,g){if(n){const _=a.clone$1(h);return a.scale$1(_,_,[g,g,1]),l||a.rotateZ(_,_,-d.angle),_}return d.glCoordMatrix}function Qn(h,n,l=0){const d=[h.x,h.y,l,1];l?a.transformMat4(d,d,n):Cc(d,d,n);const g=d[3];return{point:new a.pointGeometry(d[0]/g,d[1]/g),signedDistanceFromCamera:g}}function Ct(h,n){return Math.min(.5+h/n*.5,1.5)}function ja(h,n){const l=h[0]/h[3],d=h[1]/h[3];return l>=-n[0]&&l<=n[0]&&d>=-n[1]&&d<=n[1]}function Ks(h,n,l,d,g,_,w,S,C){const M=d?h.textSizeData:h.iconSizeData,z=a.evaluateSizeForZoom(M,l.transform.zoom),R=[256/l.width*2+1,256/l.height*2+1],F=d?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;F.clear();const O=h.lineVertexArray,G=d?h.text.placedSymbolArray:h.icon.placedSymbolArray,Z=l.transform.width/l.transform.height;let ne=!1;for(let V=0;V<G.length;V++){const X=G.get(V);if(X.writingMode!==a.WritingMode.vertical||ne||V!==0&&G.get(V-1).writingMode===a.WritingMode.horizontal||(ne=!0),X.hidden||X.writingMode===a.WritingMode.vertical&&!ne){Oi(X.numGlyphs,F);continue}ne=!1;const te=new a.pointGeometry(X.tileAnchorX,X.tileAnchorY),se=C?C(te):0,ue=[te.x,te.y,se],Y=[...ue,1];if(a.transformMat4(Y,Y,n),!ja(Y,R)){Oi(X.numGlyphs,F);continue}const pe=Ct(l.transform.cameraToCenterDistance,Y[3]),ke=a.evaluateSizeForFeature(M,z,X),De=w?ke/pe:ke*pe,de=Qn(new a.pointGeometry(ue[0],ue[1]),g,ue[2]);if(de.signedDistanceFromCamera<=0){Oi(X.numGlyphs,F);continue}let Ee={};const Je=w?null:C,tt=mn(X,De,!1,S,n,g,_,h.glyphOffsetArray,O,F,de.point,te,Ee,Z,Je);ne=tt.useVertical,Je&&tt.needsFlipping&&(Ee={}),(tt.notEnoughRoom||ne||tt.needsFlipping&&mn(X,De,!0,S,n,g,_,h.glyphOffsetArray,O,F,de.point,te,Ee,Z,Je).notEnoughRoom)&&Oi(X.numGlyphs,F)}d?h.text.dynamicLayoutVertexBuffer.updateData(F):h.icon.dynamicLayoutVertexBuffer.updateData(F)}function Ko(h,n,l,d,g,_,w,S,C,M,z,R,F){const O=S.glyphStartIndex+S.numGlyphs,G=S.lineStartIndex,Z=S.lineStartIndex+S.lineLength,ne=n.getoffsetX(S.glyphStartIndex),V=n.getoffsetX(O-1),X=Qo(h*ne,l,d,g,_,w,S.segment,G,Z,C,M,z,R,F,!0);if(!X)return null;const te=Qo(h*V,l,d,g,_,w,S.segment,G,Z,C,M,z,R,F,!0);return te?{first:X,last:te}:null}function Br(h,n,l,d){return h.writingMode===a.WritingMode.horizontal&&Math.abs(l.y-n.y)>Math.abs(l.x-n.x)*d?{useVertical:!0}:h.writingMode===a.WritingMode.vertical?n.y<l.y?{needsFlipping:!0}:null:h.flipState!==0&&function(g,_,w){const S=(_.x-g.x)*w;return S===0||Math.abs((_.y-g.y)/S)>Et}(n,l,d)?h.flipState===1?{needsFlipping:!0}:null:n.x>l.x?{needsFlipping:!0}:null}function mn(h,n,l,d,g,_,w,S,C,M,z,R,F,O,G){const Z=n/24,ne=h.lineOffsetX*Z,V=h.lineOffsetY*Z;let X;if(h.numGlyphs>1){const te=h.glyphStartIndex+h.numGlyphs,se=h.lineStartIndex,ue=h.lineStartIndex+h.lineLength,Y=Ko(Z,S,ne,V,l,z,R,h,C,_,F,G,!1);if(!Y)return{notEnoughRoom:!0};const pe=Qn(Y.first.point,w).point,ke=Qn(Y.last.point,w).point;if(d&&!l){const De=Br(h,pe,ke,O);if(h.flipState=De&&De.needsFlipping?1:2,De)return De}X=[Y.first];for(let De=h.glyphStartIndex+1;De<te-1;De++)X.push(Qo(Z*S.getoffsetX(De),ne,V,l,z,R,h.segment,se,ue,C,_,F,G,!1,!1));X.push(Y.last)}else{if(d&&!l){const se=Qn(R,g).point,ue=h.lineStartIndex+h.segment+1,Y=new a.pointGeometry(C.getx(ue),C.gety(ue)),pe=Qn(Y,g),ke=Br(h,se,pe.signedDistanceFromCamera>0?pe.point:Yo(R,Y,se,1,g,void 0),O);if(h.flipState=ke&&ke.needsFlipping?1:2,ke)return ke}const te=Qo(Z*S.getoffsetX(h.glyphStartIndex),ne,V,l,z,R,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,C,_,F,G,!1,!1);if(!te)return{notEnoughRoom:!0};X=[te]}for(const te of X)a.addDynamicAttributes(M,te.point,te.angle);return{}}function Gh(h,n,l){const d={x:h.x,y:h.y,z:0};if(!l)return Qn(d,n,d.z);const g=l(h);return Qn(new a.pointGeometry(d.x,d.y),n,d.z+g)}function Yo(h,n,l,d,g,_){const w=Gh(h.add(h.sub(n)._unit()),g,_).point,S=l.sub(w);return l.add(S._mult(d/S.mag()))}function Qo(h,n,l,d,g,_,w,S,C,M,z,R,F,O,G){const Z=d?h-n:h+n;let ne=Z>0?1:-1,V=0;d&&(ne*=-1,V=Math.PI),ne<0&&(V+=Math.PI);let X=ne>0?S+w:S+w+1,te=g,se=g,ue=0,Y=0;const pe=Math.abs(Z),ke=[],De=[];let de=_;const Ee=()=>{const kt=X-ne;return ue===0?_:new a.pointGeometry(M.getx(kt),M.gety(kt))},Je=()=>Yo(Ee(),de,se,pe-ue+1,z,F);for(;ue+Y<=pe;){if(X+=ne,X<S||X>=C)return null;if(se=te,ke.push(te),O&&De.push(de||Ee()),te=R[X],te===void 0){de=new a.pointGeometry(M.getx(X),M.gety(X));const kt=Gh(de,z,F);te=kt.signedDistanceFromCamera>0?R[X]=kt.point:Je()}else de=null;ue+=Y,Y=se.dist(te)}G&&F&&(de=de||new a.pointGeometry(M.getx(X),M.gety(X)),R[X]=te=R[X]===void 0?te:Je(),Y=se.dist(te));const tt=(pe-ue)/Y,et=te.sub(se),Ue=et.mult(tt)._add(se);l&&Ue._add(et._unit()._perp()._mult(l*ne));const it=V+Math.atan2(te.y-se.y,te.x-se.x);return ke.push(Ue),O&&(de=de||new a.pointGeometry(M.getx(X),M.gety(X)),De.push(function(kt,gt,vn){const dn=1-vn;return new a.pointGeometry(kt.x*dn+gt.x*vn,kt.y*dn+gt.y*vn)}(De.length>0?De[De.length-1]:de,de,tt))),{point:Ue,angle:it,path:ke,tilePath:De}}const Ys=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Oi(h,n){for(let l=0;l<h;l++){const d=n.length;n.resize(d+4),n.float32.set(Ys,3*d)}}function Cc(h,n,l){const d=n[0],g=n[1];return h[0]=l[0]*d+l[4]*g+l[12],h[1]=l[1]*d+l[5]*g+l[13],h[3]=l[3]*d+l[7]*g+l[15],h}const bt=100;class kc{constructor(n,l,d=new Xe(n.width+200,n.height+200,25),g=new Xe(n.width+200,n.height+200,25)){this.transform=n,this.grid=d,this.ignoredGrid=g,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+bt,this.screenBottomBoundary=n.height+bt,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=l}placeCollisionBox(n,l,d,g,_,w,S){let C=l.projectedAnchorZ;l.elevation&&(C+=l.elevation);const M=this.projectAndGetPerspectiveRatio(w,l.projectedAnchorX,l.projectedAnchorY,C,l.tileID),z=_*M.perspectiveRatio,R=(l.x1*n+d.x-l.padding)*z+M.point.x,F=(l.y1*n+d.y-l.padding)*z+M.point.y,O=(l.x2*n+d.x+l.padding)*z+M.point.x,G=(l.y2*n+d.y+l.padding)*z+M.point.y,Z=M.perspectiveRatio<=.55||M.aboveHorizon;return!this.isInsideGrid(R,F,O,G)||!g&&this.grid.hitTest(R,F,O,G,S)||Z?{box:[],offscreen:!1}:{box:[R,F,O,G],offscreen:this.isOffscreen(R,F,O,G)}}placeCollisionCircles(n,l,d,g,_,w,S,C,M,z,R,F,O,G){const Z=[],ne=this.transform.elevation,V=ne?Je=>ne.getAtTileOffset(G,Je.x,Je.y):Je=>0,X=new a.pointGeometry(l.tileAnchorX,l.tileAnchorY),te=V(X),se=this.projectAndGetPerspectiveRatio(w,X.x,X.y,te,G),{perspectiveRatio:ue}=se,Y=(z?_/ue:_*ue)/a.ONE_EM,pe=Qn(X,S,te).point,ke=se.signedDistanceFromCamera>0?Ko(Y,g,l.lineOffsetX*Y,l.lineOffsetY*Y,!1,pe,X,l,d,S,{},ne&&!z?V:null,z&&!!ne):null;let De=!1,de=!1,Ee=!0;if(ke&&!se.aboveHorizon){const Je=.5*F*ue+O,tt=new a.pointGeometry(-100,-100),et=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ue=new Fi,it=ke.first,kt=ke.last;let gt=[];for(let xt=it.path.length-1;xt>=1;xt--)gt.push(it.path[xt]);for(let xt=1;xt<kt.path.length;xt++)gt.push(kt.path[xt]);const vn=2.5*Je;if(C){const xt=gt.map(ne?(It,gn)=>{const Xr=V(gn<it.path.length-1?it.tilePath[it.path.length-1-gn]:kt.tilePath[gn-it.path.length+2]);return Qn(It,C,Xr)}:It=>Qn(It,C));gt=xt.some(It=>It.signedDistanceFromCamera<=0)?[]:xt.map(It=>It.point)}let dn=[];if(gt.length>0){const xt=gt[0].clone(),It=gt[0].clone();for(let gn=1;gn<gt.length;gn++)xt.x=Math.min(xt.x,gt[gn].x),xt.y=Math.min(xt.y,gt[gn].y),It.x=Math.max(It.x,gt[gn].x),It.y=Math.max(It.y,gt[gn].y);dn=xt.x>=tt.x&&It.x<=et.x&&xt.y>=tt.y&&It.y<=et.y?[gt]:It.x<tt.x||xt.x>et.x||It.y<tt.y||xt.y>et.y?[]:a.clipLine([gt],tt.x,tt.y,et.x,et.y)}for(const xt of dn){Ue.reset(xt,.25*Je);let It=0;It=Ue.length<=.5*Je?1:Math.ceil(Ue.paddedLength/vn)+1;for(let gn=0;gn<It;gn++){const Xr=gn/Math.max(It-1,1),Ei=Ue.lerp(Xr),ar=Ei.x+bt,Tr=Ei.y+bt;Z.push(ar,Tr,Je,0);const Ci=ar-Je,$i=Tr-Je,nn=ar+Je,_n=Tr+Je;if(Ee=Ee&&this.isOffscreen(Ci,$i,nn,_n),de=de||this.isInsideGrid(Ci,$i,nn,_n),!n&&this.grid.hitTestCircle(ar,Tr,Je,R)&&(De=!0,!M))return{circles:[],offscreen:!1,collisionDetected:De}}}}return{circles:!M&&De||!de?[]:Z,offscreen:Ee,collisionDetected:De}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let d=1/0,g=1/0,_=-1/0,w=-1/0;for(const z of n){const R=new a.pointGeometry(z.x+bt,z.y+bt);d=Math.min(d,R.x),g=Math.min(g,R.y),_=Math.max(_,R.x),w=Math.max(w,R.y),l.push(R)}const S=this.grid.query(d,g,_,w).concat(this.ignoredGrid.query(d,g,_,w)),C={},M={};for(const z of S){const R=z.key;if(C[R.bucketInstanceId]===void 0&&(C[R.bucketInstanceId]={}),C[R.bucketInstanceId][R.featureIndex])continue;const F=[new a.pointGeometry(z.x1,z.y1),new a.pointGeometry(z.x2,z.y1),new a.pointGeometry(z.x2,z.y2),new a.pointGeometry(z.x1,z.y2)];a.polygonIntersectsPolygon(l,F)&&(C[R.bucketInstanceId][R.featureIndex]=!0,M[R.bucketInstanceId]===void 0&&(M[R.bucketInstanceId]=[]),M[R.bucketInstanceId].push(R.featureIndex))}return M}insertCollisionBox(n,l,d,g,_){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:g,collisionGroupID:_},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,d,g,_){const w=l?this.ignoredGrid:this.grid,S={bucketInstanceId:d,featureIndex:g,collisionGroupID:_};for(let C=0;C<n.length;C+=4)w.insertCircle(S,n[C],n[C+1],n[C+2])}projectAndGetPerspectiveRatio(n,l,d,g,_){const w=[l,d,g||0,1];let S=!1;if(g||this.transform.pitch>0){a.transformMat4(w,w,n);let C=!1;this.fogState&&_&&(C=function(M,z,R,F,O,G){const Z=G.calculateFogTileMatrix(O),ne=[z,R,F];return a.transformMat4$1(ne,ne,Z),Zt(M,ne,G.pitch,G._fov)}(this.fogState,l,d,g||0,_.toUnwrapped(),this.transform)>.9),S=w[2]>w[3]||C}else Cc(w,w,n);return{point:new a.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+bt,(-w[1]/w[3]+1)/2*this.transform.height+bt),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/w[3]*.5,1.5),signedDistanceFromCamera:w[3],aboveHorizon:S}}isOffscreen(n,l,d,g){return d<bt||n>=this.screenRightBoundary||g<bt||l>this.screenBottomBoundary}isInsideGrid(n,l,d,g){return d>=0&&n<this.gridRightBoundary&&g>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n}}class Ga{constructor(n,l,d,g){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):g&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class Zn{constructor(n,l,d,g,_){this.text=new Ga(n?n.text:null,l,d,_),this.icon=new Ga(n?n.icon:null,l,g,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Fr{constructor(n,l,d){this.text=n,this.icon=l,this.skipFade=d}}class Zh{constructor(){this.invProjMatrix=a.create$1(),this.viewportMatrix=a.create$1(),this.circles=[]}}class Za{constructor(n,l,d,g,_){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=d,this.bucketIndex=g,this.tileID=_}}class Vn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:d=>d.collisionGroupID===l}}return this.collisionGroups[n]}}function Jo(h,n,l,d,g){const{horizontalAlign:_,verticalAlign:w}=a.getAnchorAlignment(h),S=-(_-.5)*n,C=-(w-.5)*l,M=a.evaluateVariableOffset(h,d);return new a.pointGeometry(S+M[0]*g,C+M[1]*g)}function Ni(h,n,l,d,g){const _=new a.pointGeometry(h,n);return l&&_._rotate(d?g:-g),_}class Jn{constructor(n,l,d,g,_){this.transform=n.clone(),this.collisionIndex=new kc(this.transform,_),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Vn(d),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,l,d,g){const _=d.getBucket(l),w=d.latestFeatureIndex;if(!_||!w||l.id!==_.layerIds[0])return;const S=d.collisionBoxArray,C=_.layers[0].layout,M=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),z=d.tileSize/a.EXTENT,R=this.transform.calculateProjMatrix(d.tileID.toUnwrapped()),F=C.get("text-pitch-alignment")==="map",O=C.get("text-rotation-alignment")==="map",G=Ot(d,1,this.transform.zoom),Z=wt(R,F,O,this.transform,G);let ne=null;if(F){const X=ui(R,F,O,this.transform,G);ne=a.multiply([],this.transform.labelPlaneMatrix,X)}this.retainedQueryData[_.bucketInstanceId]=new Za(_.bucketInstanceId,w,_.sourceLayerIndex,_.index,d.tileID);const V={bucket:_,layout:C,posMatrix:R,textLabelPlaneMatrix:Z,labelToScreenMatrix:ne,scale:M,textPixelRatio:z,holdingForFade:d.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(_.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(g)for(const X of _.sortKeyRanges){const{sortKey:te,symbolInstanceStart:se,symbolInstanceEnd:ue}=X;n.push({sortKey:te,symbolInstanceStart:se,symbolInstanceEnd:ue,parameters:V})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:V})}attemptAnchorPlacement(n,l,d,g,_,w,S,C,M,z,R,F,O,G,Z,ne,V,X){const te=[F.textOffset0,F.textOffset1],se=Jo(n,d,g,te,_),ue=this.collisionIndex.placeCollisionBox(_,l,Ni(se.x,se.y,w,S,this.transform.angle),R,C,M,z.predicate);if((!ne||this.collisionIndex.placeCollisionBox(G.getSymbolInstanceIconSize(X,this.transform.zoom,O),ne,Ni(se.x,se.y,w,S,this.transform.angle),R,C,M,z.predicate).box.length!==0)&&ue.box.length>0){let Y;return this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(Y=this.prevPlacement.variableOffsets[F.crossTileID].anchor),this.variableOffsets[F.crossTileID]={textOffset:te,width:d,height:g,anchor:n,textScale:_,prevAnchor:Y},this.markUsedJustification(G,n,F,Z),G.allowVerticalPlacement&&(this.markUsedOrientation(G,Z,F),this.placedOrientations[F.crossTileID]=Z),{shift:se,placedGlyphBoxes:ue}}}placeLayerBucketPart(n,l,d,g){const{bucket:_,layout:w,posMatrix:S,textLabelPlaneMatrix:C,labelToScreenMatrix:M,textPixelRatio:z,holdingForFade:R,collisionBoxArray:F,partiallyEvaluatedTextSize:O,partiallyEvaluatedIconSize:G,collisionGroup:Z}=n.parameters,ne=w.get("text-optional"),V=w.get("icon-optional"),X=w.get("text-allow-overlap"),te=w.get("icon-allow-overlap"),se=w.get("text-rotation-alignment")==="map",ue=w.get("text-pitch-alignment")==="map",Y=w.get("icon-text-fit")!=="none",pe=w.get("symbol-z-order")==="viewport-y",ke=X&&(te||!_.hasIconData()||V),De=te&&(X||!_.hasTextData()||ne);!_.collisionArrays&&F&&_.deserializeCollisionBoxes(F),d&&g&&_.updateCollisionDebugBuffers(this.transform.zoom,F);const de=(Ee,Je,tt)=>{if(l[Ee.crossTileID])return;if(R)return void(this.placements[Ee.crossTileID]=new Fr(!1,!1,!1));let et=!1,Ue=!1,it=!0,kt=null,gt={box:null,offscreen:null},vn={box:null,offscreen:null},dn=null,xt=null,It=null,gn=0,Xr=0,Ei=0;tt.textFeatureIndex?gn=tt.textFeatureIndex:Ee.useRuntimeCollisionCircles&&(gn=Ee.featureIndex),tt.verticalTextFeatureIndex&&(Xr=tt.verticalTextFeatureIndex);const ar=nn=>{nn.tileID=this.retainedQueryData[_.bucketInstanceId].tileID,(this.transform.elevation||nn.elevation)&&(nn.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[_.bucketInstanceId].tileID,nn.tileAnchorX,nn.tileAnchorY):0)},Tr=tt.textBox;if(Tr){ar(Tr);const nn=$t=>{let wn=a.WritingMode.horizontal;if(_.allowVerticalPlacement&&!$t&&this.prevPlacement){const Sr=this.prevPlacement.placedOrientations[Ee.crossTileID];Sr&&(this.placedOrientations[Ee.crossTileID]=Sr,wn=Sr,this.markUsedOrientation(_,wn,Ee))}return wn},_n=($t,wn)=>{if(_.allowVerticalPlacement&&Ee.numVerticalGlyphVertices>0&&tt.verticalTextBox){for(const Sr of _.writingModes)if(Sr===a.WritingMode.vertical?(gt=wn(),vn=gt):gt=$t(),gt&&gt.box&&gt.box.length)break}else gt=$t()};if(w.get("text-variable-anchor")){let $t=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ee.crossTileID]){const cn=this.prevPlacement.variableOffsets[Ee.crossTileID];$t.indexOf(cn.anchor)>0&&($t=$t.filter(er=>er!==cn.anchor),$t.unshift(cn.anchor))}const wn=(cn,er,Hr)=>{const ki=_.getSymbolInstanceTextSize(O,Ee,this.transform.zoom,Je),bl=(cn.x2-cn.x1)*ki+2*cn.padding,fu=(cn.y2-cn.y1)*ki+2*cn.padding,Tl=Y&&!te?er:null;Tl&&ar(Tl);let Lo={box:[],offscreen:!1};const zd=X?2*$t.length:$t.length;for(let ga=0;ga<zd;++ga){const Sl=this.attemptAnchorPlacement($t[ga%$t.length],cn,bl,fu,ki,se,ue,z,S,Z,ga>=$t.length,Ee,Je,_,Hr,Tl,O,G);if(Sl&&(Lo=Sl.placedGlyphBoxes,Lo&&Lo.box&&Lo.box.length)){et=!0,kt=Sl.shift;break}}return Lo};_n(()=>wn(Tr,tt.iconBox,a.WritingMode.horizontal),()=>{const cn=tt.verticalTextBox;return cn&&ar(cn),_.allowVerticalPlacement&&!(gt&&gt.box&&gt.box.length)&&Ee.numVerticalGlyphVertices>0&&cn?wn(cn,tt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),gt&&(et=gt.box,it=gt.offscreen);const Sr=nn(gt&&gt.box);if(!et&&this.prevPlacement){const cn=this.prevPlacement.variableOffsets[Ee.crossTileID];cn&&(this.variableOffsets[Ee.crossTileID]=cn,this.markUsedJustification(_,cn.anchor,Ee,Sr))}}else{const $t=(wn,Sr)=>{const cn=_.getSymbolInstanceTextSize(O,Ee,this.transform.zoom,Je),er=this.collisionIndex.placeCollisionBox(cn,wn,new a.pointGeometry(0,0),X,z,S,Z.predicate);return er&&er.box&&er.box.length&&(this.markUsedOrientation(_,Sr,Ee),this.placedOrientations[Ee.crossTileID]=Sr),er};_n(()=>$t(Tr,a.WritingMode.horizontal),()=>{const wn=tt.verticalTextBox;return _.allowVerticalPlacement&&Ee.numVerticalGlyphVertices>0&&wn?(ar(wn),$t(wn,a.WritingMode.vertical)):{box:null,offscreen:null}}),nn(gt&&gt.box&&gt.box.length)}}if(dn=gt,et=dn&&dn.box&&dn.box.length>0,it=dn&&dn.offscreen,Ee.useRuntimeCollisionCircles){const nn=_.text.placedSymbolArray.get(Ee.centerJustifiedTextSymbolIndex>=0?Ee.centerJustifiedTextSymbolIndex:Ee.verticalPlacedTextSymbolIndex),_n=a.evaluateSizeForFeature(_.textSizeData,O,nn),$t=w.get("text-padding");xt=this.collisionIndex.placeCollisionCircles(X,nn,_.lineVertexArray,_.glyphOffsetArray,_n,S,C,M,d,ue,Z.predicate,Ee.collisionCircleDiameter*_n/a.ONE_EM,$t,this.retainedQueryData[_.bucketInstanceId].tileID),et=X||xt.circles.length>0&&!xt.collisionDetected,it=it&&xt.offscreen}if(tt.iconFeatureIndex&&(Ei=tt.iconFeatureIndex),tt.iconBox){const nn=_n=>{ar(_n);const $t=Y&&kt?Ni(kt.x,kt.y,se,ue,this.transform.angle):new a.pointGeometry(0,0),wn=_.getSymbolInstanceIconSize(G,this.transform.zoom,Je);return this.collisionIndex.placeCollisionBox(wn,_n,$t,te,z,S,Z.predicate)};vn&&vn.box&&vn.box.length&&tt.verticalIconBox?(It=nn(tt.verticalIconBox),Ue=It.box.length>0):(It=nn(tt.iconBox),Ue=It.box.length>0),it=it&&It.offscreen}const Ci=ne||Ee.numHorizontalGlyphVertices===0&&Ee.numVerticalGlyphVertices===0,$i=V||Ee.numIconVertices===0;if(Ci||$i?$i?Ci||(Ue=Ue&&et):et=Ue&&et:Ue=et=Ue&&et,et&&dn&&dn.box&&this.collisionIndex.insertCollisionBox(dn.box,w.get("text-ignore-placement"),_.bucketInstanceId,vn&&vn.box&&Xr?Xr:gn,Z.ID),Ue&&It&&this.collisionIndex.insertCollisionBox(It.box,w.get("icon-ignore-placement"),_.bucketInstanceId,Ei,Z.ID),xt&&(et&&this.collisionIndex.insertCollisionCircles(xt.circles,w.get("text-ignore-placement"),_.bucketInstanceId,gn,Z.ID),d)){const nn=_.bucketInstanceId;let _n=this.collisionCircleArrays[nn];_n===void 0&&(_n=this.collisionCircleArrays[nn]=new Zh);for(let $t=0;$t<xt.circles.length;$t+=4)_n.circles.push(xt.circles[$t+0]),_n.circles.push(xt.circles[$t+1]),_n.circles.push(xt.circles[$t+2]),_n.circles.push(xt.collisionDetected?1:0)}this.placements[Ee.crossTileID]=new Fr(et||ke,Ue||De,it||_.justReloaded),l[Ee.crossTileID]=!0};if(pe){const Ee=_.getSortedSymbolIndexes(this.transform.angle);for(let Je=Ee.length-1;Je>=0;--Je){const tt=Ee[Je];de(_.symbolInstances.get(tt),tt,_.collisionArrays[tt])}}else for(let Ee=n.symbolInstanceStart;Ee<n.symbolInstanceEnd;Ee++)de(_.symbolInstances.get(Ee),Ee,_.collisionArrays[Ee]);if(d&&_.bucketInstanceId in this.collisionCircleArrays){const Ee=this.collisionCircleArrays[_.bucketInstanceId];a.invert(Ee.invProjMatrix,S),Ee.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(n,l,d,g){let _;_=g===a.WritingMode.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(l)];const w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const S of w)S>=0&&(n.text.placedSymbolArray.get(S).crossTileID=_>=0&&S!==_?0:d.crossTileID)}markUsedOrientation(n,l,d){const g=l===a.WritingMode.horizontal||l===a.WritingMode.horizontalOnly?l:0,_=l===a.WritingMode.vertical?l:0,w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const S of w)n.text.placedSymbolArray.get(S).placedOrientation=g;d.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let d=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const g=l?l.symbolFadeChange(n):1,_=l?l.opacities:{},w=l?l.variableOffsets:{},S=l?l.placedOrientations:{};for(const C in this.placements){const M=this.placements[C],z=_[C];z?(this.opacities[C]=new Zn(z,g,M.text,M.icon),d=d||M.text!==z.text.placed||M.icon!==z.icon.placed):(this.opacities[C]=new Zn(null,g,M.text,M.icon,M.skipFade),d=d||M.text||M.icon)}for(const C in _){const M=_[C];if(!this.opacities[C]){const z=new Zn(M,g,!1,!1);z.isHidden()||(this.opacities[C]=z,d=d||M.text.placed||M.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in S)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=S[C]);d?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l){const d={};for(const g of l){const _=g.getBucket(n);_&&g.latestFeatureIndex&&n.id===_.layerIds[0]&&this.updateBucketOpacities(_,d,g.collisionBoxArray)}}updateBucketOpacities(n,l,d){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const g=n.layers[0].layout,_=new Zn(null,0,!1,!1,!0),w=g.get("text-allow-overlap"),S=g.get("icon-allow-overlap"),C=g.get("text-variable-anchor"),M=g.get("text-rotation-alignment")==="map",z=g.get("text-pitch-alignment")==="map",R=g.get("icon-text-fit")!=="none",F=new Zn(null,0,w&&(S||!n.hasIconData()||g.get("icon-optional")),S&&(w||!n.hasTextData()||g.get("text-optional")),!0);!n.collisionArrays&&d&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(d);const O=(G,Z,ne)=>{for(let V=0;V<Z/4;V++)G.opacityVertexArray.emplaceBack(ne)};for(let G=0;G<n.symbolInstances.length;G++){const Z=n.symbolInstances.get(G),{numHorizontalGlyphVertices:ne,numVerticalGlyphVertices:V,crossTileID:X}=Z;let te=this.opacities[X];l[X]?te=_:te||(te=F,this.opacities[X]=te),l[X]=!0;const se=Z.numIconVertices>0,ue=this.placedOrientations[Z.crossTileID],Y=ue===a.WritingMode.vertical,pe=ue===a.WritingMode.horizontal||ue===a.WritingMode.horizontalOnly;if(ne>0||V>0){const ke=Or(te.text);O(n.text,ne,Y?Eo:ke),O(n.text,V,pe?Eo:ke);const De=te.text.isHidden();[Z.rightJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.leftJustifiedTextSymbolIndex].forEach(Je=>{Je>=0&&(n.text.placedSymbolArray.get(Je).hidden=De||Y?1:0)}),Z.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).hidden=De||pe?1:0);const de=this.variableOffsets[Z.crossTileID];de&&this.markUsedJustification(n,de.anchor,Z,ue);const Ee=this.placedOrientations[Z.crossTileID];Ee&&(this.markUsedJustification(n,"left",Z,Ee),this.markUsedOrientation(n,Ee,Z))}if(se){const ke=Or(te.icon);Z.placedIconSymbolIndex>=0&&(O(n.icon,Z.numIconVertices,Y?Eo:ke),n.icon.placedSymbolArray.get(Z.placedIconSymbolIndex).hidden=te.icon.isHidden()),Z.verticalPlacedIconSymbolIndex>=0&&(O(n.icon,Z.numVerticalIconVertices,pe?Eo:ke),n.icon.placedSymbolArray.get(Z.verticalPlacedIconSymbolIndex).hidden=te.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const ke=n.collisionArrays[G];if(ke){let De=new a.pointGeometry(0,0);if(ke.textBox||ke.verticalTextBox){let Ee=!0;if(C){const Je=this.variableOffsets[X];Je?(De=Jo(Je.anchor,Je.width,Je.height,Je.textOffset,Je.textScale),M&&De._rotate(z?this.transform.angle:-this.transform.angle)):Ee=!1}ke.textBox&&es(n.textCollisionBox.collisionVertexArray,te.text.placed,!Ee||Y,De.x,De.y),ke.verticalTextBox&&es(n.textCollisionBox.collisionVertexArray,te.text.placed,!Ee||pe,De.x,De.y)}const de=Boolean(!pe&&ke.verticalIconBox);ke.iconBox&&es(n.iconCollisionBox.collisionVertexArray,te.icon.placed,de,R?De.x:0,R?De.y:0),ke.verticalIconBox&&es(n.iconCollisionBox.collisionVertexArray,te.icon.placed,!de,R?De.x:0,R?De.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=G.invProjMatrix,n.placementViewportMatrix=G.viewportMatrix,n.collisionCircleArray=G.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const d=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*d>n}setStale(){this.stale=!0}}function es(h,n,l,d,g){h.emplaceBack(n?1:0,l?1:0,d||0,g||0),h.emplaceBack(n?1:0,l?1:0,d||0,g||0),h.emplaceBack(n?1:0,l?1:0,d||0,g||0),h.emplaceBack(n?1:0,l?1:0,d||0,g||0)}const hi=Math.pow(2,25),Qs=Math.pow(2,24),qa=Math.pow(2,17),Uf=Math.pow(2,16),eo=Math.pow(2,9),Vf=Math.pow(2,8),qh=Math.pow(2,1);function Or(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const n=h.placed?1:0,l=Math.floor(127*h.opacity);return l*hi+n*Qs+l*qa+n*Uf+l*eo+n*Vf+l*qh+n}const Eo=0;class to{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,l,d,g,_){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(w,g,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((S,C)=>S.sortKey-C.sortKey));this._currentPartIndex<w.length;){const S=w[this._currentPartIndex];if(l.placeLayerBucketPart(S,this._seenCrossTileIDs,d,S.symbolInstanceStart===0),this._currentPartIndex++,_())return!0}return!1}}class Ic{constructor(n,l,d,g,_,w,S,C){this.placement=new Jn(n,_,w,S,C),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(n,l,d){const g=a.exported.now(),_=()=>{const w=a.exported.now()-g;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=l[n[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=S)&&(!w.maxzoom||w.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new to(w)),this._inProgressLayer.continuePlacement(d[w.source],this.placement,this._showCollisionBoxes,w,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Wa=512/a.EXTENT/2;class $f{constructor(n,l,d){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=d;for(let g=0;g<l.length;g++){const _=l.get(g),w=_.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,n)})}}getScaledCoordinates(n,l){const d=Wa/Math.pow(2,l.canonical.z-this.tileID.canonical.z);return{x:Math.floor((l.canonical.x*a.EXTENT+n.tileAnchorX)*d),y:Math.floor((l.canonical.y*a.EXTENT+n.tileAnchorY)*d)}}findMatches(n,l,d){const g=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let _=0;_<n.length;_++){const w=n.get(_);if(w.crossTileID)continue;const S=this.indexedSymbolInstances[w.key];if(!S)continue;const C=this.getScaledCoordinates(w,l);for(const M of S)if(Math.abs(M.coord.x-C.x)<=g&&Math.abs(M.coord.y-C.y)<=g&&!d[M.crossTileID]){d[M.crossTileID]=!0,w.crossTileID=M.crossTileID;break}}}}class jf{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ac{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const d in this.indexes){const g=this.indexes[d],_={};for(const w in g){const S=g[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+l),_[S.tileID.key]=S}this.indexes[d]=_}this.lng=n}addBucket(n,l,d){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let _=0;_<l.symbolInstances.length;_++)l.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const g=this.usedCrossTileIDs[n.overscaledZ];for(const _ in this.indexes){const w=this.indexes[_];if(Number(_)>n.overscaledZ)for(const S in w){const C=w[S];C.tileID.isChildOf(n)&&C.findMatches(l.symbolInstances,n,g)}else{const S=w[n.scaledTo(Number(_)).key];S&&S.findMatches(l.symbolInstances,n,g)}}for(let _=0;_<l.symbolInstances.length;_++){const w=l.symbolInstances.get(_);w.crossTileID||(w.crossTileID=d.generate(),g[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new $f(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const d in l.indexedSymbolInstances)for(const g of l.indexedSymbolInstances[d])delete this.usedCrossTileIDs[n][g.crossTileID]}removeStaleBuckets(n){let l=!1;for(const d in this.indexes){const g=this.indexes[d];for(const _ in g)n[g[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,g[_]),delete g[_],l=!0)}return l}}class Wh{constructor(){this.layerIndexes={},this.crossTileIDs=new jf,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,d){let g=this.layerIndexes[n.id];g===void 0&&(g=this.layerIndexes[n.id]=new Ac);let _=!1;const w={};g.handleWrapJump(d);for(const S of l){const C=S.getBucket(n);C&&n.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(S.tileID,C,this.crossTileIDs)&&(_=!0),w[C.bucketInstanceId]=!0)}return g.removeStaleBuckets(w)&&(_=!0),_}pruneUnusedLayers(n){const l={};n.forEach(d=>{l[d]=!0});for(const d in this.layerIndexes)l[d]||delete this.layerIndexes[d]}}const Js=(h,n)=>a.emitValidationErrors(h,n&&n.filter(l=>l.identifier!=="source.canvas")),Gf=a.pick(ae,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),Xh=a.pick(ae,["setCenter","setZoom","setBearing","setPitch"]),Zf=function(){const h={},n=a.spec.$version;for(const l in a.spec.$root){const d=a.spec.$root[l];if(d.required){let g=null;g=l==="version"?n:d.type==="array"?[]:{},g!=null&&(h[l]=g)}}return h}(),Mc={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class di extends a.Evented{constructor(n,l={}){super(),this.map=n,this.dispatcher=new an(Ze(),this),this.imageManager=new $e,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(n._requestManager,l.localFontFamily?a.LocalGlyphMode.all:l.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,l.localFontFamily||l.localIdeographFontFamily),this.lineAtlas=new a.LineAtlas(256,512),this.crossTileSymbolIndex=new Wh,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const d=this;this._rtlTextPluginCallback=di.registerForPluginStateChange(g=>{d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(_,w)=>{if(a.triggerPluginCompletionEvent(_),w&&w.every(S=>S))for(const S in d._sourceCaches){const C=d._sourceCaches[S],M=C.getSource().type;M!=="vector"&&M!=="geojson"||C.reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const _=this.getSource(g.sourceId);if(_&&_.vectorLayerIds)for(const w in this._layers){const S=this._layers[w];S.source===_.id&&this._validateLayer(S)}})}loadURL(n,l={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const d=typeof l.validate=="boolean"?l.validate:!a.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);const g=this.map._requestManager.transformRequest(n,a.ResourceType.Style);this._request=a.getJSON(g,(_,w)=>{this._request=null,_?this.fire(new a.ErrorEvent(_)):w&&this._load(w,d)})}loadJSON(n,l={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(n,l.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Zf,!1)}_updateLayerCount(n,l){const d=l?1:-1;n.is3D()&&(this._num3DLayers+=d),n.type==="circle"&&(this._numCircleLayers+=d),n.type==="symbol"&&(this._numSymbolLayers+=d)}_load(n,l){if(l&&Js(this,a.validateStyle(n)))return;this._loaded=!0,this.stylesheet=n;for(const g in n.sources)this.addSource(g,n.sources[g],{validate:!1});this._changed=!1,n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(n.glyphs);const d=st(this.stylesheet.layers);this._order=d.map(g=>g.id),this._layers={},this._serializedLayers={};for(let g of d)g=a.createStyleLayer(g),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize(),this._updateLayerCount(g,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ot(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(n){this._spriteRequest=function(l,d,g){let _,w,S;const C=a.exported.devicePixelRatio>1?"@2x":"";let M=a.getJSON(d.transformRequest(d.normalizeSpriteURL(l,C,".json"),a.ResourceType.SpriteJSON),(F,O)=>{M=null,S||(S=F,_=O,R())}),z=a.getImage(d.transformRequest(d.normalizeSpriteURL(l,C,".png"),a.ResourceType.SpriteImage),(F,O)=>{z=null,S||(S=F,w=O,R())});function R(){if(S)g(S);else if(_&&w){const F=a.exported.getImageData(w),O={};for(const G in _){const{width:Z,height:ne,x:V,y:X,sdf:te,pixelRatio:se,stretchX:ue,stretchY:Y,content:pe}=_[G],ke=new a.RGBAImage({width:Z,height:ne});a.RGBAImage.copy(F,ke,{x:V,y:X},{x:0,y:0},{width:Z,height:ne}),O[G]={data:ke,pixelRatio:se,sdf:te,stretchX:ue,stretchY:Y,content:pe}}g(null,O)}}return{cancel(){M&&(M.cancel(),M=null),z&&(z.cancel(),z=null)}}}(n,this.map._requestManager,(l,d)=>{if(this._spriteRequest=null,l)this.fire(new a.ErrorEvent(l));else if(d)for(const g in d)this.imageManager.addImage(g,d[g]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(n){const l=this.getSource(n.source);if(!l)return;const d=n.sourceLayer;d&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(d)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${d}" does not exist on source "${l.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const l=[];for(const d of n){const g=this._layers[d];g.type!=="custom"&&l.push(g.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(n){return!!this.terrain&&Mc[n.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(n){if(!this._loaded)return;const l=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(g.length||_.length)&&this._updateWorkerLayers(g,_);for(const w in this._updatedSources){const S=this._updatedSources[w];S==="reload"?this._reloadSource(w):S==="clear"&&this._clearSource(w)}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._resetUpdates()}const d={};for(const g in this._sourceCaches){const _=this._sourceCaches[g];d[g]=_.used,_.used=!1}for(const g of this._order){const _=this._layers[g];if(_.recalculate(n,this._availableImages),!_.isHidden(n.zoom)){const S=this._getLayerSourceCache(_);S&&(S.used=!0)}const w=this.map.painter;if(w){const S=_.getProgramIds();if(!S)continue;const C=_.getProgramConfiguration(n.zoom);for(const M of S)w.useProgram(M,C)}}for(const g in d){const _=this._sourceCaches[g];d[g]!==_.used&&_.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_.getSource().id}))}this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),Js(this,a.validateStyle(n)))return!1;(n=a.clone$2(n)).layers=st(n.layers);const l=function(g,_){if(!g)return[{command:ae.setStyle,args:[_]}];let w=[];try{if(!J(g.version,_.version))return[{command:ae.setStyle,args:[_]}];J(g.center,_.center)||w.push({command:ae.setCenter,args:[_.center]}),J(g.zoom,_.zoom)||w.push({command:ae.setZoom,args:[_.zoom]}),J(g.bearing,_.bearing)||w.push({command:ae.setBearing,args:[_.bearing]}),J(g.pitch,_.pitch)||w.push({command:ae.setPitch,args:[_.pitch]}),J(g.sprite,_.sprite)||w.push({command:ae.setSprite,args:[_.sprite]}),J(g.glyphs,_.glyphs)||w.push({command:ae.setGlyphs,args:[_.glyphs]}),J(g.transition,_.transition)||w.push({command:ae.setTransition,args:[_.transition]}),J(g.light,_.light)||w.push({command:ae.setLight,args:[_.light]}),J(g.fog,_.fog)||w.push({command:ae.setFog,args:[_.fog]});const S={},C=[];(function(R,F,O,G){let Z;for(Z in F=F||{},R=R||{})R.hasOwnProperty(Z)&&(F.hasOwnProperty(Z)||dt(Z,O,G));for(Z in F)F.hasOwnProperty(Z)&&(R.hasOwnProperty(Z)?J(R[Z],F[Z])||(R[Z].type==="geojson"&&F[Z].type==="geojson"&&yt(R,F,Z)?O.push({command:ae.setGeoJSONSourceData,args:[Z,F[Z].data]}):vt(Z,F,O,G)):Ce(Z,F,O))})(g.sources,_.sources,C,S);const M=[];g.layers&&g.layers.forEach(R=>{S[R.source]?w.push({command:ae.removeLayer,args:[R.id]}):M.push(R)});let z=g.terrain;z&&S[z.source]&&(w.push({command:ae.setTerrain,args:[void 0]}),z=void 0),w=w.concat(C),J(z,_.terrain)||w.push({command:ae.setTerrain,args:[_.terrain]}),function(R,F,O){F=F||[];const G=(R=R||[]).map(Pt),Z=F.map(Pt),ne=R.reduce(ln,{}),V=F.reduce(ln,{}),X=G.slice(),te=Object.create(null);let se,ue,Y,pe,ke,De,de;for(se=0,ue=0;se<G.length;se++)Y=G[se],V.hasOwnProperty(Y)?ue++:(O.push({command:ae.removeLayer,args:[Y]}),X.splice(X.indexOf(Y,ue),1));for(se=0,ue=0;se<Z.length;se++)Y=Z[Z.length-1-se],X[X.length-1-se]!==Y&&(ne.hasOwnProperty(Y)?(O.push({command:ae.removeLayer,args:[Y]}),X.splice(X.lastIndexOf(Y,X.length-ue),1)):ue++,De=X[X.length-se],O.push({command:ae.addLayer,args:[V[Y],De]}),X.splice(X.length-se,0,Y),te[Y]=!0);for(se=0;se<Z.length;se++)if(Y=Z[se],pe=ne[Y],ke=V[Y],!te[Y]&&!J(pe,ke))if(J(pe.source,ke.source)&&J(pe["source-layer"],ke["source-layer"])&&J(pe.type,ke.type)){for(de in Nt(pe.layout,ke.layout,O,Y,null,ae.setLayoutProperty),Nt(pe.paint,ke.paint,O,Y,null,ae.setPaintProperty),J(pe.filter,ke.filter)||O.push({command:ae.setFilter,args:[Y,ke.filter]}),J(pe.minzoom,ke.minzoom)&&J(pe.maxzoom,ke.maxzoom)||O.push({command:ae.setLayerZoomRange,args:[Y,ke.minzoom,ke.maxzoom]}),pe)pe.hasOwnProperty(de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?Nt(pe[de],ke[de],O,Y,de.slice(6),ae.setPaintProperty):J(pe[de],ke[de])||O.push({command:ae.setLayerProperty,args:[Y,de,ke[de]]}));for(de in ke)ke.hasOwnProperty(de)&&!pe.hasOwnProperty(de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?Nt(pe[de],ke[de],O,Y,de.slice(6),ae.setPaintProperty):J(pe[de],ke[de])||O.push({command:ae.setLayerProperty,args:[Y,de,ke[de]]}))}else O.push({command:ae.removeLayer,args:[Y]}),De=X[X.lastIndexOf(Y)+1],O.push({command:ae.addLayer,args:[ke,De]})}(M,_.layers,w)}catch(S){console.warn("Unable to compute style diff:",S),w=[{command:ae.setStyle,args:[_]}]}return w}(this.serialize(),n).filter(g=>!(g.command in Xh));if(l.length===0)return!1;const d=l.filter(g=>!(g.command in Gf));if(d.length>0)throw new Error(`Unimplemented: ${d.map(g=>g.command).join(", ")}.`);return l.forEach(g=>{g.command!=="setTransition"&&this[g.command].apply(this,g.args)}),this.stylesheet=n,!0}addImage(n,l){if(this.getImage(n))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)}updateImage(n,l){this.imageManager.updateImage(n,l)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,l,d={}){if(this._checkLoaded(),this.getSource(n)!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(a.validateStyle.source,`sources.${n}`,l,null,d))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const g=L(n,l,this.dispatcher,this);g.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:g.serialize(),sourceId:n}));const _=w=>{const S=(w?"symbol:":"other:")+n,C=this._sourceCaches[S]=new a.SourceCache(S,g,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[n]=C,C.style=this,C.onAdd(this.map)};_(!1),l.type!=="vector"&&l.type!=="geojson"||_(!0),g.onAdd&&g.onAdd(this.map),this._changed=!0}removeSource(n){this._checkLoaded();const l=this.getSource(n);if(l===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${g}" is using it.`)));if(this.terrain&&this.terrain.get().source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const d=this._getSourceCaches(n);for(const g of d)delete this._sourceCaches[g.id],delete this._updatedSources[g.id],g.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:g.getSource().id})),g.setEventedParent(null),g.clearTiles();delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,l){this._checkLoaded(),this.getSource(n).setData(l),this._changed=!0}getSource(n){const l=this._getSourceCache(n);return l&&l.getSource()}addLayer(n,l,d={}){this._checkLoaded();const g=n.id;if(this.getLayer(g))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${g}" already exists on this map`)));let _;if(n.type==="custom"){if(Js(this,a.validateCustomStyleLayer(n)))return;_=a.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(g,n.source),n=a.clone$2(n),n=a.extend(n,{source:g})),this._validate(a.validateStyle.layer,`layers.${g}`,n,{arrayIndex:-1},d))return;_=a.createStyleLayer(n),this._validateLayer(_),_.setEventedParent(this,{layer:{id:g}}),this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0)}const w=l?this._order.indexOf(l):this._order.length;if(l&&w===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`)));this._order.splice(w,0,g),this._layerOrderChanged=!0,this._layers[g]=_;const S=this._getLayerSourceCache(_);if(this._removedLayers[g]&&_.source&&S&&_.type!=="custom"){const C=this._removedLayers[g];delete this._removedLayers[g],C.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",S.pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(n,l){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===l)return;const d=this._order.indexOf(n);this._order.splice(d,1);const g=l?this._order.indexOf(l):this._order.length;l&&g===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`))):(this._order.splice(g,0,n),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(n){this._checkLoaded();const l=this._layers[n];if(!l)return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be removed.`)));l.setEventedParent(null),this._updateLayerCount(l,!1);const d=this._order.indexOf(n);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}hasLayerType(n){for(const l in this._layers)if(this._layers[l].type===n)return!0;return!1}setLayerZoomRange(n,l,d){this._checkLoaded();const g=this.getLayer(n);g?g.minzoom===l&&g.maxzoom===d||(l!=null&&(g.minzoom=l),d!=null&&(g.maxzoom=d),this._updateLayer(g)):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,l,d={}){this._checkLoaded();const g=this.getLayer(n);if(g){if(!J(g.filter,l))return l==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(a.validateStyle.filter,`layers.${g.id}.filter`,l,null,d)||(g.filter=a.clone$2(l),this._updateLayer(g)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(n){return a.clone$2(this.getLayer(n).filter)}setLayoutProperty(n,l,d,g={}){this._checkLoaded();const _=this.getLayer(n);_?J(_.getLayoutProperty(l),d)||(_.setLayoutProperty(l,d,g),this._updateLayer(_)):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(n,l){const d=this.getLayer(n);if(d)return d.getLayoutProperty(l);this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style.`)))}setPaintProperty(n,l,d,g={}){this._checkLoaded();const _=this.getLayer(n);_?J(_.getPaintProperty(l),d)||(_.setPaintProperty(l,d,g)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(n,l){return this.getLayer(n).getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const d=n.source,g=n.sourceLayer,_=this.getSource(d);if(_===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)));const w=_.type;if(w==="geojson"&&g)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!g)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const S=this._getSourceCaches(d);for(const C of S)C.setFeatureState(g,n.id,l)}removeFeatureState(n,l){this._checkLoaded();const d=n.source,g=this.getSource(d);if(g===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)));const _=g.type,w=_==="vector"?n.sourceLayer:void 0;if(_==="vector"&&!w)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const S=this._getSourceCaches(d);for(const C of S)C.removeFeatureState(w,n.id,l)}getFeatureState(n){this._checkLoaded();const l=n.source,d=n.sourceLayer,g=this.getSource(l);if(g!==void 0){if(g.type!=="vector"||d)return n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(l)[0].getFeatureState(d,n.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n={};for(const l in this._sourceCaches){const d=this._sourceCaches[l].getSource();n[d.id]||(n[d.id]=d.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:n,layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0;const l=this._getLayerSourceCache(n);n.source&&!this._updatedSources[n.source]&&l&&l.getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",l.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(n){const l=w=>this._layers[w].type==="fill-extrusion",d={},g=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(l(S)){d[S]=w;for(const C of n){const M=C[S];if(M)for(const z of M)g.push(z)}}}g.sort((w,S)=>S.intersectionZ-w.intersectionZ);const _=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(l(S))for(let C=g.length-1;C>=0;C--){const M=g[C].feature;if(d[M.layer.id]<w)break;_.push(M),g.pop()}else for(const C of n){const M=C[S];if(M)for(const z of M)_.push(z.feature)}}return _}queryRenderedFeatures(n,l,d){l&&l.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);const g={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const C of l.layers){const M=this._layers[C];if(!M)return this.fire(new a.ErrorEvent(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];g[M.source]=!0}}const _=[];l.availableImages=this._availableImages;const w=l&&l.layers?l.layers.some(C=>{const M=this.getLayer(C);return M&&M.is3D()}):this.has3DLayers(),S=He.createFromScreenPoints(n,d);for(const C in this._sourceCaches){const M=this._sourceCaches[C].getSource().id;l.layers&&!g[M]||_.push(H(this._sourceCaches[C],this._layers,this._serializedLayers,S,l,d,w,!!this.map._showQueryGeometry))}return this.placement&&_.push(function(C,M,z,R,F,O,G){const Z={},ne=O.queryRenderedSymbols(R),V=[];for(const X of Object.keys(ne).map(Number))V.push(G[X]);V.sort(fe);for(const X of V){const te=X.featureIndex.lookupSymbolFeatures(ne[X.bucketInstanceId],M,X.bucketIndex,X.sourceLayerIndex,F.filter,F.layers,F.availableImages,C);for(const se in te){const ue=Z[se]=Z[se]||[],Y=te[se];Y.sort((pe,ke)=>{const De=X.featureSortOrder;if(De){const de=De.indexOf(pe.featureIndex);return De.indexOf(ke.featureIndex)-de}return ke.featureIndex-pe.featureIndex});for(const pe of Y)ue.push(pe)}}for(const X in Z)Z[X].forEach(te=>{const se=te.feature,ue=z(C[X]).getFeatureState(se.layer["source-layer"],se.id);se.source=se.layer.source,se.layer["source-layer"]&&(se.sourceLayer=se.layer["source-layer"]),se.state=ue});return Z}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),S.screenGeometry,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(n,l){l&&l.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);const d=this._getSourceCaches(n);let g=[];for(const _ of d)g=g.concat(oe(_,l));return g}addSourceType(n,l,d){return di.getSourceType(n)?d(new Error(`A source type called "${n}" already exists.`)):(di.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},d):d(null,null))}getLight(){return this.light.getLight()}setLight(n,l={}){this._checkLoaded();const d=this.light.getLight();let g=!1;for(const w in n)if(!J(n[w],d[w])){g=!0;break}if(!g)return;const _={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(_)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(n){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(typeof n.source=="object"){const l="terrain-dem-src";this.addSource(l,n.source),n=a.clone$2(n),n=a.extend(n,{source:l})}if(!this._validate(a.validateStyle.terrain,"terrain",n)){if(this.terrain){const l=this.terrain,d=l.get();for(const g in n)if(!J(n[g],d[g])){l.set(n),this.stylesheet.terrain=n;const _={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};l.updateTransitions(_);break}}else this._createTerrain(n);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(n){const l=this.fog=new xn(n);this.stylesheet.fog=n;const d={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};l.updateTransitions(d)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog,d=l.get();for(const g in n)if(!J(n[g],d[g])){l.set(n),this.stylesheet.fog=n;const _={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};l.updateTransitions(_);break}}else this._createFog(n);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const n=this._order.filter(d=>this.isLayerDraped(this._layers[d])),l=this._order.filter(d=>!this.isLayerDraped(this._layers[d]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...l)}_createTerrain(n){const l=this.terrain=new St(n);this.stylesheet.terrain=n,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const d={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};l.updateTransitions(d)}_force3DLayerUpdate(){for(const n in this._layers){const l=this._layers[n];l.type==="fill-extrusion"&&this._updateLayer(l)}}_validate(n,l,d,g,_={}){return(!_||_.validate!==!1)&&Js(this,n.call(a.validateStyle,a.extend({key:l,style:this.serialize(),value:d,styleSpec:a.spec},g)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){const l=this._getSourceCaches(n);for(const d of l)d.clearTiles()}_reloadSource(n){const l=this._getSourceCaches(n);for(const d of l)d.resume(),d.reload()}_updateSources(n){for(const l in this._sourceCaches)this._sourceCaches[l].update(n)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const l=this._sourceCaches[n];l.resume(),l.reload()}}_updatePlacement(n,l,d,g,_=!1){let w=!1,S=!1;const C={};for(const M of this._order){const z=this._layers[M];if(z.type!=="symbol")continue;if(!C[z.source]){const F=this._getLayerSourceCache(z);if(!F)continue;C[z.source]=F.getRenderableIds(!0).map(O=>F.getTileByID(O)).sort((O,G)=>G.tileID.overscaledZ-O.tileID.overscaledZ||(O.tileID.isLessThan(G.tileID)?-1:1))}const R=this.crossTileSymbolIndex.addLayer(z,C[z.source],n.center.lng);w=w||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),_=_||this._layerOrderChanged||d===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(_||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),n.zoom))&&(this.pauseablePlacement=new Ic(n,this._order,_,l,d,g,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),S=!0),w&&this.pauseablePlacement.placement.setStale()),S||w)for(const M of this._order){const z=this._layers[M];z.type==="symbol"&&this.placement.updateLayerOpacities(z,C[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,l,d){this.imageManager.getImages(l.icons,d),this._updateTilesForChangedImages();const g=_=>{_&&_.setDependencies(l.tileID.key,l.type,l.icons)};g(this._otherSourceCaches[l.source]),g(this._symbolSourceCaches[l.source])}getGlyphs(n,l,d){this.glyphManager.getGlyphs(l.stacks,d)}getResource(n,l,d){return a.makeRequest(l,d)}_getSourceCache(n){return this._otherSourceCaches[n]}_getLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}_getSourceCaches(n){const l=[];return this._otherSourceCaches[n]&&l.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&l.push(this._symbolSourceCaches[n]),l}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}di.getSourceType=function(h){return D[h]},di.setSourceType=function(h,n){D[h]=n},di.registerForPluginStateChange=a.registerForPluginStateChange;var zc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Pc="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let ea={},pi={};ea=Lt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec3 elevationVector(vec2 pos) {vec2 uv=pos/8192.0;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif`,!0),pi=Lt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const ta=Lt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),ts=zc;var Xa={background:Lt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Lt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Lt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Lt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Lt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Lt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Lt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Lt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Lt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Lt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Lt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Lt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Lt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Lt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Lt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Lt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Lt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Lt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Lt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Lt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}`),symbolSDF:Lt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Lt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrainRaster:Lt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Lt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Lt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pc),skyboxGradient:Lt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pc),skyboxCapture:Lt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Lt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);}"),globeAtmosphere:Lt(`uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)
discard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Lt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying float v_depth;void main() {gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Lt(h,n,l){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,_=n.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w=h.match(g),S=n.match(g),C=zc.match(g);let M=S?S.concat(w):w;l||(ea.staticUniforms&&(M=ea.staticUniforms.concat(M)),pi.staticUniforms&&(M=pi.staticUniforms.concat(M))),M&&(M=M.concat(C));const z={};return{fragmentSource:h=h.replace(d,(R,F,O,G,Z)=>(z[Z]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
varying ${O} ${G} ${Z};
#else
uniform ${O} ${G} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${O} ${G} ${Z} = u_${Z};
#endif
`)),vertexSource:n=n.replace(d,(R,F,O,G,Z)=>{const ne=G==="float"?"vec2":"vec4",V=Z.match(/color/)?"color":ne;return z[Z]?F==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${O} ${ne} a_${Z};
varying ${O} ${G} ${Z};
#else
uniform ${O} ${G} u_${Z};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${O} ${G} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${V}(a_${Z}, u_${Z}_t);
#else
    ${O} ${G} ${Z} = u_${Z};
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${O} ${ne} a_${Z};
#else
uniform ${O} ${G} u_${Z};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${O} ${G} ${Z} = a_${Z};
#else
    ${O} ${G} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${O} ${G} ${Z} = unpack_mix_${V}(a_${Z}, u_${Z}_t);
#else
    ${O} ${G} ${Z} = u_${Z};
#endif
`}),staticAttributes:_,staticUniforms:M}}class Ha{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,l,d,g,_,w,S,C){this.context=n;let M=this.boundPaintVertexBuffers.length!==g.length;for(let z=0;!M&&z<g.length;z++)this.boundPaintVertexBuffers[z]!==g[z]&&(M=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===l&&this.boundLayoutVertexBuffer===d&&!M&&this.boundIndexBuffer===_&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===C?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),C&&C.bind()):this.freshBind(l,d,g,_,w,S,C)}freshBind(n,l,d,g,_,w,S){let C;const M=n.numAttributes,z=this.context,R=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=g,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{C=z.currentNumAttributes||0;for(let F=M;F<C;F++)R.disableVertexAttribArray(F)}l.enableAttributes(R,n);for(const F of d)F.enableAttributes(R,n);w&&w.enableAttributes(R,n),S&&S.enableAttributes(R,n),l.bind(),l.setVertexAttribPointers(R,n,_);for(const F of d)F.bind(),F.setVertexAttribPointers(R,n,_);w&&(w.bind(),w.setVertexAttribPointers(R,n,_)),g&&g.bind(),S&&(S.bind(),S.setVertexAttribPointers(R,n,_)),z.currentNumAttributes=M}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Dc(h,n){const l=Math.pow(2,n.canonical.z),d=n.canonical.y;return[new a.MercatorCoordinate(0,d/l).toLngLat().lat,new a.MercatorCoordinate(0,(d+1)/l).toLngLat().lat]}function Ka(h,n,l,d,g,_,w){const S=h.context,C=S.gl,M=l.fbo;if(!M)return;h.prepareDrawTile(n);const z=h.useProgram("hillshade");S.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,M.colorAttachment.get());const R=((F,O,G,Z)=>{const ne=G.paint.get("hillshade-shadow-color"),V=G.paint.get("hillshade-highlight-color"),X=G.paint.get("hillshade-accent-color");let te=G.paint.get("hillshade-illumination-direction")*(Math.PI/180);G.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=F.transform.angle);const se=!F.options.moving;return{u_matrix:Z||F.transform.calculateProjMatrix(O.tileID.toUnwrapped(),se),u_image:0,u_latrange:Dc(0,O.tileID),u_light:[G.paint.get("hillshade-exaggeration"),te],u_shadow:ne,u_highlight:V,u_accent:X}})(h,l,d,h.terrain?n.projMatrix:null);h.prepareDrawProgram(S,z,n.toUnwrapped()),z.draw(S,C.TRIANGLES,g,_,w,a.CullFaceMode.disabled,R,d.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function ns(h,n,l){if(!n.needsDEMTextureUpload)return;const d=h.context,g=d.gl;d.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||h.getTileTexture(l.stride);const _=l.getPixels();n.demTexture?n.demTexture.update(_,{premultiply:!1}):n.demTexture=new a.Texture(d,_,g.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Ut(h,n,l,d,g,_){const w=h.context,S=w.gl;if(!n.dem)return;const C=n.dem;if(w.activeTexture.set(S.TEXTURE1),ns(h,n,C),!n.demTexture)return;n.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const M=C.dim;w.activeTexture.set(S.TEXTURE0);let z=n.fbo;if(!z){const R=new a.Texture(w,{width:M,height:M,data:null},S.RGBA);R.bind(S.LINEAR,S.CLAMP_TO_EDGE),z=n.fbo=w.createFramebuffer(M,M,!0),z.colorAttachment.set(R.texture)}w.bindFramebuffer.set(z.framebuffer),w.viewport.set([0,0,M,M]),h.useProgram("hillshadePrepare").draw(w,S.TRIANGLES,d,g,_,a.CullFaceMode.disabled,((R,F)=>{const O=F.stride,G=a.create$1();return a.ortho(G,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(G,G,[0,-a.EXTENT,0]),{u_matrix:G,u_image:1,u_dimension:[O,O],u_zoom:R.overscaledZ,u_unpack:F.unpackVector}})(n.tileID,C),l.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),n.needsHillshadePrepare=!1}const na=(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_image0:new a.Uniform1i(h,n.u_image0),u_skirt_height:new a.Uniform1f(h,n.u_skirt_height)}),Rc=(h,n)=>({u_matrix:h,u_image0:0,u_skirt_height:n}),Ya=new class{constructor(){this.operations={}}newMorphing(h,n,l,d,g){if(h in this.operations){const _=this.operations[h];_.to.tileID.key!==l.tileID.key&&(_.queued=l)}else this.operations[h]={startTime:d,phase:0,duration:g,from:n,to:l,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const n=this.operations[h];return{from:n.from,to:n.to,phase:n.phase}}update(h){for(const n in this.operations){const l=this.operations[n];for(l.phase=(h-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,h)){delete this.operations[n];break}}}_nextOp(h,n){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=n,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Lc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Bc(h,n){const l=1<<h.z;return!n&&(h.x===0||h.x===l-1)||h.y===0||h.y===l-1}const Qa=h=>({u_matrix:h});function Hh(h,n,l,d,g){if(g>0){const _=a.exported.now(),w=(_-h.timeAdded)/g,S=n?(_-n.timeAdded)/g:-1,C=l.getSource(),M=d.coveringZoomLevel({tileSize:C.tileSize,roundZoom:C.roundZoom}),z=!n||Math.abs(n.tileID.overscaledZ-M)>Math.abs(h.tileID.overscaledZ-M),R=z&&h.refreshedUponExpiration?1:a.clamp(z?w:1-S,0,1);return h.refreshedUponExpiration&&w>=1&&(h.refreshedUponExpiration=!1),n?{opacity:1,mix:1-R}:{opacity:R,mix:0}}return{opacity:1,mix:0}}class qf extends a.SourceCache{constructor(n){const l=L("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new an(Ze(),null),n.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,l,d){if(n.freezeTileCoverage)return;this.transform=n;const g=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((_,w)=>{if(_[w.key]="",!this._tiles[w.key]){const S=new a.Tile(w,this._source.tileSize*w.overscaleFactor(),n.tileZoom);S.state="loaded",this._tiles[w.key]=S}return _},{});for(const _ in this._tiles)_ in g||(this.freeFBO(_),this._tiles[_].unloadVectorData(),delete this._tiles[_])}freeFBO(n){const l=this.proxyCachedFBO[n];if(l!==void 0){const d=Object.values(l);this.renderCachePool.push(...d),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ja extends a.OverscaledTileID{constructor(n,l,d){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=l,this.projMatrix=d}}class Fc extends a.Elevation{constructor(n,l){super(),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[d,g,_]=function(C){const M=new a.StructArrayLayout4i8,z=new a.StructArrayLayout3ui6,R=131;M.reserve(17161),z.reserve(33800);const F=a.EXTENT/128,O=a.EXTENT+F/2,G=O+F;for(let ne=-F;ne<G;ne+=F)for(let V=-F;V<G;V+=F){const X=V<0||V>O||ne<0||ne>O?24575:0,te=a.clamp(Math.round(V),0,a.EXTENT),se=a.clamp(Math.round(ne),0,a.EXTENT);M.emplaceBack(te+X,se,te,se)}const Z=(ne,V)=>{const X=V*R+ne;z.emplaceBack(X+1,X,X+R),z.emplaceBack(X+R,X+R+1,X+1)};for(let ne=1;ne<129;ne++)for(let V=1;V<129;V++)Z(V,ne);return[0,129].forEach(ne=>{for(let V=0;V<130;V++)Z(V,ne),Z(ne,V)}),[M,z,32768]}(),w=n.context;this.gridBuffer=w.createVertexBuffer(d,Si.members),this.gridIndexBuffer=w.createIndexBuffer(g),this.gridSegments=a.SegmentVector.simpleSegment(0,0,d.length,g.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,d.length,_),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new qf(l.map),this.orthoMatrix=a.create$1(),a.ortho(this.orthoMatrix,0,a.EXTENT,0,a.EXTENT,0,1);const S=w.gl;this._overlapStencilMode=new a.StencilMode({func:S.GEQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),n.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=n,this._checkRenderCacheEfficiency()}update(n,l,d){if(n&&n.terrain){this._style!==n&&(this.style=n),this.enabled=!0;const g=n.terrain.properties;this.sourceCache=n._getSourceCache(g.get("source")),this._exaggeration=g.get("exaggeration");const _=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const w=this.sourceCache.getSource().tileSize/128,S=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(l,w*S,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,_(),this._initializing=!0),_(),l.updateElevation(!d),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const n=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||n.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${n.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${n.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._sourceCaches)this._style._sourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,d=this.painter.transform;this._initializing&&(this._initializing=d._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(d.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const g=this.proxyCoords=l.getIds().map(C=>{const M=l.getTileByID(C).tileID;return M.projMatrix=d.calculateProjMatrix(M.toUnwrapped()),M});(function(C,M){const z=M.transform.pointCoordinate(M.transform.getCameraPoint()),R=new a.pointGeometry(z.x,z.y);C.sort((F,O)=>{if(O.overscaledZ-F.overscaledZ)return O.overscaledZ-F.overscaledZ;const G=new a.pointGeometry(F.canonical.x+(1<<F.canonical.z)*F.wrap,F.canonical.y),Z=new a.pointGeometry(O.canonical.x+(1<<O.canonical.z)*O.wrap,O.canonical.y),ne=R.mult(1<<F.canonical.z);return ne.x-=.5,ne.y-=.5,ne.distSqr(G)-ne.distSqr(Z)})})(g,this.painter),this._previousZoom=d.zoom;const _=this.proxyToSource||{};this.proxyToSource={},g.forEach(C=>{this.proxyToSource[C.key]={}}),this.terrainTileForTile={};const w=this._style._sourceCaches;for(const C in w){const M=w[C];if(!M.used||(M!==this.sourceCache&&(this._findCoveringTileCache[M.id]={}),this._setupProxiedCoordsForOrtho(M,n[C],_),M.usedForTerrain))continue;const z=n[C];M.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[l.id]=g.map(C=>new Ja(C,C.key,this.orthoMatrix)),this._assignTerrainTiles(g),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(_),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const S={};this._visibleDemTiles=[];for(const C of this.proxyCoords){const M=this.terrainTileForTile[C.key];if(!M)continue;const z=M.tileID.key;z in S||(this._visibleDemTiles.push(M),S[z]=z)}}_assignTerrainTiles(n){this._initializing||n.forEach(l=>{if(this.terrainTileForTile[l.key])return;const d=this._findTileCoveringTileID(l,this.sourceCache);d&&(this.terrainTileForTile[l.key]=d)})}_prepareDEMTextures(){const n=this.painter.context,l=n.gl;for(const d in this.terrainTileForTile){const g=this.terrainTileForTile[d],_=g.dem;!_||g.demTexture&&!g.needsDEMTextureUpload||(n.activeTexture.set(l.TEXTURE1),ns(this.painter,g,_))}}_prepareDemTileUniforms(n,l,d,g){if(!l||l.demTexture==null)return!1;const _=n.tileID.canonical,w=Math.pow(2,l.tileID.canonical.z-_.z),S=g||"";return d[`u_dem_tl${S}`]=[_.x*w%1,_.y*w%1],d[`u_dem_scale${S}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let n=0;const l=this._visibleDemTiles.reduce((d,g)=>{if(!g.dem)return d;const _=g.dem.tree.minimums[0];return _>0&&n++,d+_},0);return n?l/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,l=n.gl;n.activeTexture.set(l.TEXTURE2);const d=this._getLoadedAreaMinimum(),g={width:1,height:1,data:new Uint8Array(a.DEMData.pack(d,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let _=this._emptyDEMTexture;return _?_.update(g,{premultiply:!1}):_=this._emptyDEMTexture=new a.Texture(n,g,l.RGBA,{premultiply:!1}),_}setupElevationDraw(n,l,d){const g=this.painter.context,_=g.gl,w=(S=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(S),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var S;w.u_dem_size=this.sourceCache.getSource().tileSize,w.u_exaggeration=this.exaggeration();let C=null,M=null,z=1;if(d&&d.morphing&&this._useVertexMorphing){const R=d.morphing.srcDemTile,F=d.morphing.dstDemTile;z=d.morphing.phase,R&&F&&(this._prepareDemTileUniforms(n,R,w,"_prev")&&(M=R),this._prepareDemTileUniforms(n,F,w)&&(C=F))}if(M&&C?(g.activeTexture.set(_.TEXTURE2),C.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),g.activeTexture.set(_.TEXTURE4),M.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),w.u_dem_lerp=z):(C=this.terrainTileForTile[n.tileID.key],g.activeTexture.set(_.TEXTURE2),(this._prepareDemTileUniforms(n,C,w)?C.demTexture:this.emptyDEMTexture).bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST)),d&&d.useDepthForOcclusion&&(g.activeTexture.set(_.TEXTURE3),this._depthTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),w.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),d&&d.useMeterToDem&&C){const R=(1<<C.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=R}d&&d.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=d.labelPlaneMatrixInv),l.setTerrainUniformValues(g,w)}renderToBackBuffer(n){const l=this.painter,d=this.painter.context;n.length!==0&&(d.bindFramebuffer.set(null),d.viewport.set([0,0,l.width,l.height]),this.renderingToTexture=!1,function(g,_,w,S,C){const M=g.context,z=M.gl;let R,F;const O=g.options.showTerrainWireframe?2:0,G=(te,se)=>{if(F===te)return;const ue=[Lc[te]];se&&ue.push(Lc[O]),R=g.useProgram("terrainRaster",null,ue),F=te},Z=g.colorModeForRenderPass(),ne=new a.DepthMode(z.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);Ya.update(C);const V=g.transform,X=6*Math.pow(1.5,22-V.zoom)*_.exaggeration();(O?[!1,!0]:[!1]).forEach(te=>{F=-1;const se=te?z.LINES:z.TRIANGLES,[ue,Y]=te?_.getWirefameBuffer():[_.gridIndexBuffer,_.gridSegments];for(const De of S){const de=w.getTile(De),Ee=a.StencilMode.disabled,Je=_.prevTerrainTileForTile[De.key],tt=_.terrainTileForTile[De.key];ke=tt,(pe=Je)!=null&&ke!=null&&pe.hasData()&&ke.hasData()&&pe.demTexture!=null&&ke.demTexture!=null&&pe.tileID.key!==ke.tileID.key&&Ya.newMorphing(De.key,Je,tt,C,250),M.activeTexture.set(z.TEXTURE0),de.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const et=Ya.getMorphValuesForProxy(De.key),Ue=et?1:0;let it;et&&(it={morphing:{srcDemTile:et.from,dstDemTile:et.to,phase:a.easeCubicInOut(et.phase)}});const kt=Rc(De.projMatrix,Bc(De.canonical,V.renderWorldCopies)?X/10:X);G(Ue,te),_.setupElevationDraw(de,R,it),g.prepareDrawProgram(M,R,De.toUnwrapped()),R.draw(M,se,ne,Ee,Z,a.CullFaceMode.backCCW,kt,"terrain_raster",_.gridBuffer,ue,Y)}var pe,ke})}(l,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const l=this.painter,d=this.painter.context,g=this.proxySourceCache,_=this.proxiedCoords[g.id],w=this._drapedRenderBatches.shift(),S=[],C=l.style.order;let M=0;for(const z of _){const R=g.getTileByID(z.proxyTileKey),F=g.proxyCachedFBO[z.key]?g.proxyCachedFBO[z.key][n]:void 0,O=F!==void 0?g.renderCache[F]:this.pool[M++],G=F!==void 0;if(R.texture=O.tex,G&&!O.dirty){S.push(R.tileID);continue}let Z;d.bindFramebuffer.set(O.fb.framebuffer),this.renderedToTile=!1,O.dirty&&(d.clear({color:a.Color.transparent}),O.dirty=!1);for(let ne=w.start;ne<=w.end;++ne){const V=l.style._layers[C[ne]];if(V.isHidden(l.transform.zoom))continue;const X=l.style._getLayerSourceCache(V),te=X?this.proxyToSource[z.key][X.id]:[z];if(!te)continue;const se=te;d.viewport.set([0,0,O.fb.width,O.fb.height]),Z!==(X?X.id:null)&&(this._setupStencil(O,te,V,X),Z=X?X.id:null),l.renderLayer(l,X,V,se)}this.renderedToTile?(O.dirty=!0,S.push(R.tileID)):G||--M,M===5&&(M=0,this.renderToBackBuffer(S))}return this.renderToBackBuffer(S),this.renderingToTexture=!1,d.bindFramebuffer.set(null),d.viewport.set([0,0,l.width,l.height]),w.end+1}postRender(){}renderCacheEfficiency(n){const l=n.order.length;if(l===0)return{efficiency:100};let d,g=0,_=0,w=!1;for(let S=0;S<l;++S){const C=n._layers[n.order[S]];this._style.isLayerDraped(C)?(w&&++g,++_):w||(w=!0,d=C.id)}return _===0?{efficiency:100}:{efficiency:100*(1-g/_),firstUndrapedLayer:d}}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{n=Math.min(n,l.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,l,d){if(!this._visibleDemTiles)return null;const g=this._visibleDemTiles.filter(_=>_.dem).map(_=>{const w=_.tileID,S=Math.pow(2,w.overscaledZ),{x:C,y:M}=w.canonical,z=C/S,R=(C+1)/S,F=M/S,O=(M+1)/S;return{minx:z,miny:F,maxx:R,maxy:O,t:_.dem.tree.raycastRoot(z,F,R,O,n,l,d),tile:_}});g.sort((_,w)=>(_.t!==null?_.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const _ of g){if(_.t==null)return null;const w=_.tile.dem.tree.raycast(_.minx,_.miny,_.maxx,_.maxy,n,l,d);if(w!=null)return w}return null}_createFBO(){const n=this.painter.context,l=n.gl,d=this.drapeBufferSize;n.activeTexture.set(l.TEXTURE0);const g=new a.Texture(n,{width:d[0],height:d[1],data:null},l.RGBA);g.bind(l.LINEAR,l.CLAMP_TO_EDGE);const _=n.createFramebuffer(d[0],d[1],!1);return _.colorAttachment.set(g.texture),_.depthAttachment=new Ji(n,_.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,d[0],d[1]),this._stencilRef=0,_.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):_.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&!n.extTextureFilterAnisotropicForceOff&&l.texParameterf(l.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:_,tex:g,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const l=this._style._layers[n],d=l.isHidden(this.painter.transform.zoom),g=l.getCrossfadeParameters(),_=!!g&&g.t!==1,w=l.hasTransition();return l.type!=="custom"&&!d&&(_||w)})}_clearRasterFadeFromRenderCache(){let n=!1;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l]._source instanceof So){n=!0;break}if(n)for(let l=0;l<this._style.order.length;++l){const d=this._style._layers[this._style.order[l]],g=d.isHidden(this.painter.transform.zoom),_=this._style._getLayerSourceCache(d);if(d.type!=="raster"||g||!_)continue;const w=d.paint.get("raster-fade-duration");for(const S of this.proxyCoords){const C=this.proxyToSource[S.key][_.id];if(C)for(const M of C){const z=Hh(_.getTile(M),_.findLoadedParent(M,0),_,this.painter.transform,w);(z.opacity!==1||z.mix!==0)&&this._clearRenderCacheForTile(_.id,M)}}}}_setupDrapedRenderBatches(){const n=this._style.order,l=n.length;if(l===0)return;const d=[];let g,_=0,w=this._style._layers[n[_]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++_<l;)w=this._style._layers[n[_]];for(;_<l;++_){const S=this._style._layers[n[_]];S.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(S)?g===void 0&&(g=_):g!==void 0&&(d.push({start:g,end:_-1}),g=void 0))}g!==void 0&&d.push({start:g,end:_-1}),this._drapedRenderBatches=d}_setupRenderCache(n){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const w=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let S=0;S<w.length;++S){const C=Object.values(w[S]);l.renderCachePool.push(...C)}}return}this._clearRasterFadeFromRenderCache();const d=this.proxyCoords,g=this._tilesDirty;for(let w=d.length-1;w>=0;w--){const S=d[w];if(l.getTileByID(S.key),l.proxyCachedFBO[S.key]!==void 0){const C=n[S.key],M=this.proxyToSource[S.key];let z=0;for(const R in M){const F=M[R],O=C[R];if(!O||O.length!==F.length||F.some((G,Z)=>G!==O[Z]||g[R]&&g[R].hasOwnProperty(G.key))){z=-1;break}++z}for(const R in l.proxyCachedFBO[S.key])l.renderCache[l.proxyCachedFBO[S.key][R]].dirty=z<0||z!==Object.values(C).length}}const _=[...this._drapedRenderBatches];_.sort((w,S)=>S.end-S.start-(w.end-w.start));for(const w of _)for(const S of d){if(l.proxyCachedFBO[S.key])continue;let C=l.renderCachePool.pop();C===void 0&&l.renderCache.length<50&&(C=l.renderCache.length,l.renderCache.push(this._createFBO())),C!==void 0&&(l.proxyCachedFBO[S.key]={},l.proxyCachedFBO[S.key][w.start]=C,l.renderCache[C].dirty=!0)}this._tilesDirty={}}_setupStencil(n,l,d,g){if(!g||!this._sourceTilesOverlap[g.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const _=this.painter.context,w=_.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let S;if(d.isTileClipped())S=l.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);S=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+S>255&&(_.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=S,this._overlapStencilMode.ref=this._stencilRef,d.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(n,l){const d=this.painter,g=this.painter.context,_=g.gl;d._tileClippingMaskIDs={},g.setColorMode(a.ColorMode.disabled),g.setDepthMode(a.DepthMode.disabled);const w=d.useProgram("clippingMask");for(const S of n){const C=d._tileClippingMaskIDs[S.key]=--l;w.draw(g,_.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:_.ALWAYS,mask:0},C,255,_.KEEP,_.KEEP,_.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Qa(S.projMatrix),"$clipping",d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}}pointCoordinate(n){const l=this.painter.transform;if(n.x<0||n.x>l.width||n.y<0||n.y>l.height)return null;const d=[n.x,n.y,1,1];a.transformMat4(d,d,l.pixelMatrixInverse),a.scale$2(d,d,1/d[3]),d[0]/=l.worldSize,d[1]/=l.worldSize;const g=l._camera.position,_=a.mercatorZfromAltitude(1,l.center.lat),w=[g[0],g[1],g[2]/_,0],S=a.subtract([],d.slice(0,3),w);a.normalize(S,S);const C=this.raycast(w,S,this._exaggeration);return C!==null&&C?(a.scaleAndAdd(w,w,S,C),w[3]=w[2],w[2]*=_,w):null}drawDepth(){const n=this.painter,l=n.context,d=this.proxySourceCache,g=Math.ceil(n.width),_=Math.ceil(n.height);if(!this._depthFBO||this._depthFBO.width===g&&this._depthFBO.height===_||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const w=l.gl,S=l.createFramebuffer(g,_,!0);l.activeTexture.set(w.TEXTURE0);const C=new a.Texture(l,{width:g,height:_,data:null},w.RGBA);C.bind(w.NEAREST,w.CLAMP_TO_EDGE),S.colorAttachment.set(C.texture);const M=l.createRenderbuffer(l.gl.DEPTH_COMPONENT16,g,_);S.depthAttachment.set(M),this._depthFBO=S,this._depthTexture=C}l.bindFramebuffer.set(this._depthFBO.framebuffer),l.viewport.set([0,0,g,_]),function(w,S,C,M){const z=w.context,R=z.gl;z.clear({depth:1});const F=w.useProgram("terrainDepth"),O=new a.DepthMode(R.LESS,a.DepthMode.ReadWrite,w.depthRangeFor3D);for(const G of M){const Z=C.getTile(G),ne=Rc(G.projMatrix,0);S.setupElevationDraw(Z,F),F.draw(z,R.TRIANGLES,O,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ne,"terrain_depth",S.gridBuffer,S.gridIndexBuffer,S.gridNoSkirtSegments)}}(n,this,d,this.proxyCoords)}_setupProxiedCoordsForOrtho(n,l,d){if(n.getSource()instanceof $)return this._setupProxiedCoordsForImageSource(n,l,d);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const g=this.proxiedCoords[n.id]=[],_=this.proxyCoords;for(let S=0;S<_.length;S++){const C=_[S],M=this._findTileCoveringTileID(C,n);if(M){const z=this._createProxiedId(C,M,d[C.key]&&d[C.key][n.id]);g.push(z),this.proxyToSource[C.key][n.id]=[z]}}let w=!1;for(let S=0;S<l.length;S++){const C=n.getTile(l[S]);if(!C||!C.hasData())continue;const M=this._findTileCoveringTileID(C.tileID,this.proxySourceCache);if(M&&M.tileID.canonical.z!==C.tileID.canonical.z){const z=this.proxyToSource[M.tileID.key][n.id],R=this._createProxiedId(M.tileID,C,d[M.tileID.key]&&d[M.tileID.key][n.id]);z?z.splice(z.length-1,0,R):this.proxyToSource[M.tileID.key][n.id]=[R],g.push(R),w=!0}}this._sourceTilesOverlap[n.id]=w}_setupProxiedCoordsForImageSource(n,l,d){if(!n.getSource().loaded())return;const g=this.proxiedCoords[n.id]=[],_=this.proxyCoords,w=n.getSource(),S=new a.pointGeometry(w.tileID.x,w.tileID.y)._div(1<<w.tileID.z),C=w.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((z,R)=>(z.min.x=Math.min(z.min.x,R.x-S.x),z.min.y=Math.min(z.min.y,R.y-S.y),z.max.x=Math.max(z.max.x,R.x-S.x),z.max.y=Math.max(z.max.y,R.y-S.y),z),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),M=(z,R)=>{const F=z.wrap+z.canonical.x/(1<<z.canonical.z),O=z.canonical.y/(1<<z.canonical.z),G=a.EXTENT/(1<<z.canonical.z),Z=R.wrap+R.canonical.x/(1<<R.canonical.z),ne=R.canonical.y/(1<<R.canonical.z);return F+G<Z+C.min.x||F>Z+C.max.x||O+G<ne+C.min.y||O>ne+C.max.y};for(let z=0;z<_.length;z++){const R=_[z];for(let F=0;F<l.length;F++){const O=n.getTile(l[F]);if(!O||!O.hasData()||M(R,O.tileID))continue;const G=this._createProxiedId(R,O,d[R.key]&&d[R.key][n.id]),Z=this.proxyToSource[R.key][n.id];Z?Z.push(G):this.proxyToSource[R.key][n.id]=[G],g.push(G)}}}_createProxiedId(n,l,d){let g=this.orthoMatrix;if(d){const _=d.find(w=>w.key===l.tileID.key);if(_)return _}if(l.tileID.key!==n.key){const _=n.canonical.z-l.tileID.canonical.z;let w,S,C;g=a.create$1();const M=l.tileID.wrap-n.wrap<<n.overscaledZ;_>0?(w=a.EXTENT>>_,S=w*((l.tileID.canonical.x<<_)-n.canonical.x+M),C=w*((l.tileID.canonical.y<<_)-n.canonical.y)):(w=a.EXTENT<<-_,S=a.EXTENT*(l.tileID.canonical.x-(n.canonical.x+M<<-_)),C=a.EXTENT*(l.tileID.canonical.y-(n.canonical.y<<-_))),a.ortho(g,0,w,0,w,0,1),a.translate(g,g,[S,C,0])}return new Ja(l.tileID,n.key,g)}_findTileCoveringTileID(n,l){let d=l.getTile(n);if(d&&d.hasData())return d;const g=this._findCoveringTileCache[l.id],_=g[n.key];if(d=_?l.getTileByID(_):null,d&&d.hasData()||_===null)return d;let w=d?d.tileID:n,S=w.overscaledZ;const C=l.getSource().minzoom,M=[];if(!_){const R=l.getSource().maxzoom;if(n.canonical.z>=R){const F=n.canonical.z-R;l.getSource().reparseOverscaled?(S=Math.max(n.canonical.z+2,l.transform.tileZoom),w=new a.OverscaledTileID(S,n.wrap,R,n.canonical.x>>F,n.canonical.y>>F)):F!==0&&(S=R,w=new a.OverscaledTileID(S,n.wrap,R,n.canonical.x>>F,n.canonical.y>>F))}w.key!==n.key&&(M.push(w.key),d=l.getTile(w))}const z=R=>{M.forEach(F=>{g[F]=R}),M.length=0};for(S-=1;S>=C&&(!d||!d.hasData());S--){d&&z(d.tileID.key);const R=w.calculateScaledKey(S);if(d=l.getTileByID(R),d&&d.hasData())break;const F=g[R];if(F===null)break;F===void 0?M.push(R):d=l.getTileByID(F)}return z(d?d.tileID.key:null),d&&d.hasData()?d:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(n){this.renderedToTile=!0}_clearRenderCacheForTile(n,l){let d=this._tilesDirty[n];d||(d=this._tilesDirty[n]={}),d[l.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const n=function(l){let d,g,_;const w=new a.StructArrayLayout2ui4,S=131;for(g=1;g<129;g++){for(d=1;d<129;d++)_=g*S+d,w.emplaceBack(_,_+1),w.emplaceBack(_,_+S),w.emplaceBack(_+1,_+S),g===128&&w.emplaceBack(_+S,_+S+1);w.emplaceBack(_+1,_+1+S)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(n),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function el(h){const n=[];for(let l=0;l<h.length;l++){if(h[l]===null)continue;const d=h[l].split(" ");n.push(d.pop())}return n}class tl{static cacheKey(n,l,d){let g=`${n}${d?d.cacheKey:""}`;for(const _ of l)g+=`/${_}`;return g}constructor(n,l,d,g,_,w){const S=n.gl;this.program=S.createProgram();const C=el(d.staticAttributes),M=g?g.getBinderAttributes():[],z=C.concat(M),R=d.staticUniforms?el(d.staticUniforms):[],F=g?g.getBinderUniforms():[],O=R.concat(F),G=[];for(const ue of O)G.indexOf(ue)<0&&G.push(ue);let Z=g?g.defines():[];Z=Z.concat(w.map(ue=>`#define ${ue}`));const ne=Z.concat(ta.fragmentSource,ts,pi.fragmentSource,d.fragmentSource).join(`
`),V=Z.concat(ta.vertexSource,ts,pi.vertexSource,ea.vertexSource,d.vertexSource).join(`
`),X=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(X,ne),S.compileShader(X),S.attachShader(this.program,X);const te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(te,V),S.compileShader(te),S.attachShader(this.program,te),this.attributes={};const se={};this.numAttributes=z.length;for(let ue=0;ue<this.numAttributes;ue++)z[ue]&&(S.bindAttribLocation(this.program,ue,z[ue]),this.attributes[z[ue]]=ue);S.linkProgram(this.program),S.deleteShader(te),S.deleteShader(X);for(let ue=0;ue<G.length;ue++){const Y=G[ue];if(Y&&!se[Y]){const pe=S.getUniformLocation(this.program,Y);pe&&(se[Y]=pe)}}this.fixedUniforms=_(n,se),this.binderUniforms=g?g.getUniforms(n,se):[],w.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((ue,Y)=>({u_dem:new a.Uniform1i(ue,Y.u_dem),u_dem_prev:new a.Uniform1i(ue,Y.u_dem_prev),u_dem_unpack:new a.Uniform4f(ue,Y.u_dem_unpack),u_dem_tl:new a.Uniform2f(ue,Y.u_dem_tl),u_dem_scale:new a.Uniform1f(ue,Y.u_dem_scale),u_dem_tl_prev:new a.Uniform2f(ue,Y.u_dem_tl_prev),u_dem_scale_prev:new a.Uniform1f(ue,Y.u_dem_scale_prev),u_dem_size:new a.Uniform1f(ue,Y.u_dem_size),u_dem_lerp:new a.Uniform1f(ue,Y.u_dem_lerp),u_exaggeration:new a.Uniform1f(ue,Y.u_exaggeration),u_depth:new a.Uniform1i(ue,Y.u_depth),u_depth_size_inv:new a.Uniform2f(ue,Y.u_depth_size_inv),u_meter_to_dem:new a.Uniform1f(ue,Y.u_meter_to_dem),u_label_plane_matrix_inv:new a.UniformMatrix4f(ue,Y.u_label_plane_matrix_inv),u_tile_tl_up:new a.Uniform3f(ue,Y.u_tile_tl_up),u_tile_tr_up:new a.Uniform3f(ue,Y.u_tile_tr_up),u_tile_br_up:new a.Uniform3f(ue,Y.u_tile_br_up),u_tile_bl_up:new a.Uniform3f(ue,Y.u_tile_bl_up),u_tile_up_scale:new a.Uniform1f(ue,Y.u_tile_up_scale)}))(n,se)),w.indexOf("FOG")!==-1&&(this.fogUniforms=((ue,Y)=>({u_fog_matrix:new a.UniformMatrix4f(ue,Y.u_fog_matrix),u_fog_range:new a.Uniform2f(ue,Y.u_fog_range),u_fog_color:new a.Uniform4f(ue,Y.u_fog_color),u_fog_horizon_blend:new a.Uniform1f(ue,Y.u_fog_horizon_blend),u_fog_temporal_offset:new a.Uniform1f(ue,Y.u_fog_temporal_offset)}))(n,se))}setTerrainUniformValues(n,l){if(!this.terrainUniforms)return;const d=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const g in l)d[g].set(l[g])}}setFogUniformValues(n,l){if(!this.fogUniforms)return;const d=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const g in l)d[g].location&&d[g].set(l[g])}}draw(n,l,d,g,_,w,S,C,M,z,R,F,O,G,Z,ne){const V=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(d),n.setStencilMode(g),n.setColorMode(_),n.setCullFace(w);for(const te in this.fixedUniforms)this.fixedUniforms[te].set(S[te]);G&&G.setUniforms(n,this.binderUniforms,F,{zoom:O});const X={[V.LINES]:2,[V.TRIANGLES]:3,[V.LINE_STRIP]:1}[l];for(const te of R.get()){const se=te.vaos||(te.vaos={});(se[C]||(se[C]=new Ha)).bind(n,this,M,G?G.getPaintVertexBuffers():[],z,te.vertexOffset,Z,ne),V.drawElements(l,te.primitiveLength*X,V.UNSIGNED_SHORT,te.primitiveOffset*X*2)}}}function Oc(h,n,l){const d=1/Ot(l,1,n.transform.tileZoom),g=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,n.transform.tileZoom)/g,w=_*(l.tileID.canonical.x+l.tileID.wrap*g),S=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[d,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const Nc=(h,n,l,d)=>{const g=n.style.light,_=g.properties.get("position"),w=[_.x,_.y,_.z],S=a.create$2();g.properties.get("anchor")==="viewport"&&(a.fromRotation(S,-n.transform.angle),a.transformMat3(w,w,S));const C=g.properties.get("color");return{u_matrix:h,u_lightpos:w,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+l,u_opacity:d}},Wf=(h,n,l,d,g,_,w)=>a.extend(Nc(h,n,l,d),Oc(_,n,w),{u_height_factor:-Math.pow(2,g.overscaledZ)/w.tileSize/8}),rs=h=>({u_matrix:h}),is=(h,n,l,d)=>a.extend(rs(h),Oc(l,n,d)),Kh=(h,n)=>({u_matrix:h,u_world:n}),Nr=(h,n,l,d,g)=>a.extend(is(h,n,l,d),{u_world:g}),Uc=(h,n,l,d)=>{const g=h.transform;let _;if(d.paint.get("circle-pitch-alignment")==="map"){const w=Ot(l,1,g.zoom);_=[w,w]}else _=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_matrix:h.translatePosMatrix(n.projMatrix,l,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:_}},nl=h=>{const n=[];return h.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n},rl=(h,n,l)=>{const d=a.EXTENT/l.tileSize;return{u_matrix:h,u_camera_to_center_distance:n.cameraToCenterDistance,u_extrude_scale:[n.pixelsToGLUnits[0]/d,n.pixelsToGLUnits[1]/d]}},il=(h,n,l=1)=>({u_matrix:h,u_color:n,u_overlay:0,u_overlay_scale:l}),Vc=(h,n,l,d)=>({u_matrix:h,u_extrude_scale:Ot(n,1,l),u_intensity:d}),ol=(h,n,l,d,g,_)=>{const w=h.transform,S={u_matrix:ra(h,n,l,g),u_ratio:1/Ot(n,1,w.zoom),u_device_pixel_ratio:a.exported.devicePixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(jc(l)){const C=sl(n,h.transform);S.u_texsize=n.lineAtlasTexture.size,S.u_scale=[C,d.fromScale,d.toScale],S.u_mix=d.t}return S},$c=(h,n,l,d,g)=>{const _=h.transform,w=sl(n,_);return{u_matrix:ra(h,n,l,g),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Ot(n,1,_.zoom),u_device_pixel_ratio:a.exported.devicePixelRatio,u_image:0,u_scale:[w,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}};function sl(h,n){return 1/Ot(h,1,n.tileZoom)}function ra(h,n,l,d){return h.translatePosMatrix(d||n.tileID.projMatrix,n,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const Yh=h=>{const n=[];return jc(h)&&n.push("RENDER_LINE_DASH"),h.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT"),n};function jc(h){const n=h.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}const os=(h,n,l,d,g)=>{return{u_matrix:h,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(w=g.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(_=g.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Xf(g.paint.get("raster-hue-rotate"))};var _,w};function Xf(h){h*=Math.PI/180;const n=Math.sin(h),l=Math.cos(h);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const Qh=(h,n,l,d,g,_,w,S,C,M)=>{const z=g.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:z.cameraToCenterDistance,u_pitch:z.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:z.width/z.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+C,u_pitch_with_map:+d,u_texsize:M,u_texture:0}},Jh=(h,n,l,d,g,_,w,S,C,M,z)=>{const{cameraToCenterDistance:R,_pitch:F}=g.transform;return a.extend(Qh(h,n,l,d,g,_,w,S,C,M),{u_gamma_scale:d?R*Math.cos(g.terrain?0:F):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+z})},Hf=(h,n,l,d,g,_,w,S,C,M)=>a.extend(Jh(h,n,l,d,g,_,w,S,!0,C,!0),{u_texsize_icon:M,u_texture_icon:1}),Kf=(h,n,l)=>({u_matrix:h,u_opacity:n,u_color:l}),Yf=(h,n,l,d,g,_)=>a.extend(function(w,S,C,M){const z=C.imageManager.getPattern(w.from.toString()),R=C.imageManager.getPattern(w.to.toString()),{width:F,height:O}=C.imageManager.getPixelSize(),G=Math.pow(2,M.tileID.overscaledZ),Z=M.tileSize*Math.pow(2,C.transform.tileZoom)/G,ne=Z*(M.tileID.canonical.x+M.tileID.wrap*G),V=Z*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:R.tl,u_pattern_br_b:R.br,u_texsize:[F,O],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:R.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/Ot(M,1,C.transform.tileZoom),u_pixel_coord_upper:[ne>>16,V>>16],u_pixel_coord_lower:[65535&ne,65535&V]}}(d,_,l,g),{u_matrix:h,u_opacity:n}),Gc={fillExtrusion:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_lightpos:new a.Uniform3f(h,n.u_lightpos),u_lightintensity:new a.Uniform1f(h,n.u_lightintensity),u_lightcolor:new a.Uniform3f(h,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(h,n.u_vertical_gradient),u_opacity:new a.Uniform1f(h,n.u_opacity)}),fillExtrusionPattern:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_lightpos:new a.Uniform3f(h,n.u_lightpos),u_lightintensity:new a.Uniform1f(h,n.u_lightintensity),u_lightcolor:new a.Uniform3f(h,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(h,n.u_vertical_gradient),u_height_factor:new a.Uniform1f(h,n.u_height_factor),u_image:new a.Uniform1i(h,n.u_image),u_texsize:new a.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(h,n.u_scale),u_fade:new a.Uniform1f(h,n.u_fade),u_opacity:new a.Uniform1f(h,n.u_opacity)}),fill:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix)}),fillPattern:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_image:new a.Uniform1i(h,n.u_image),u_texsize:new a.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(h,n.u_scale),u_fade:new a.Uniform1f(h,n.u_fade)}),fillOutline:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_world:new a.Uniform2f(h,n.u_world)}),fillOutlinePattern:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_world:new a.Uniform2f(h,n.u_world),u_image:new a.Uniform1i(h,n.u_image),u_texsize:new a.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(h,n.u_scale),u_fade:new a.Uniform1f(h,n.u_fade)}),circle:(h,n)=>({u_camera_to_center_distance:new a.Uniform1f(h,n.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(h,n.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(h,n.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(h,n.u_matrix)}),collisionBox:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_camera_to_center_distance:new a.Uniform1f(h,n.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(h,n.u_extrude_scale)}),collisionCircle:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_inv_matrix:new a.UniformMatrix4f(h,n.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(h,n.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(h,n.u_viewport_size)}),debug:(h,n)=>({u_color:new a.UniformColor(h,n.u_color),u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_overlay:new a.Uniform1i(h,n.u_overlay),u_overlay_scale:new a.Uniform1f(h,n.u_overlay_scale)}),clippingMask:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix)}),heatmap:(h,n)=>({u_extrude_scale:new a.Uniform1f(h,n.u_extrude_scale),u_intensity:new a.Uniform1f(h,n.u_intensity),u_matrix:new a.UniformMatrix4f(h,n.u_matrix)}),heatmapTexture:(h,n)=>({u_image:new a.Uniform1i(h,n.u_image),u_color_ramp:new a.Uniform1i(h,n.u_color_ramp),u_opacity:new a.Uniform1f(h,n.u_opacity)}),hillshade:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_image:new a.Uniform1i(h,n.u_image),u_latrange:new a.Uniform2f(h,n.u_latrange),u_light:new a.Uniform2f(h,n.u_light),u_shadow:new a.UniformColor(h,n.u_shadow),u_highlight:new a.UniformColor(h,n.u_highlight),u_accent:new a.UniformColor(h,n.u_accent)}),hillshadePrepare:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_image:new a.Uniform1i(h,n.u_image),u_dimension:new a.Uniform2f(h,n.u_dimension),u_zoom:new a.Uniform1f(h,n.u_zoom),u_unpack:new a.Uniform4f(h,n.u_unpack)}),line:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_ratio:new a.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(h,n.u_units_to_pixels),u_dash_image:new a.Uniform1i(h,n.u_dash_image),u_gradient_image:new a.Uniform1i(h,n.u_gradient_image),u_image_height:new a.Uniform1f(h,n.u_image_height),u_texsize:new a.Uniform2f(h,n.u_texsize),u_scale:new a.Uniform3f(h,n.u_scale),u_mix:new a.Uniform1f(h,n.u_mix)}),linePattern:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_texsize:new a.Uniform2f(h,n.u_texsize),u_ratio:new a.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(h,n.u_device_pixel_ratio),u_image:new a.Uniform1i(h,n.u_image),u_units_to_pixels:new a.Uniform2f(h,n.u_units_to_pixels),u_scale:new a.Uniform3f(h,n.u_scale),u_fade:new a.Uniform1f(h,n.u_fade)}),raster:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_tl_parent:new a.Uniform2f(h,n.u_tl_parent),u_scale_parent:new a.Uniform1f(h,n.u_scale_parent),u_buffer_scale:new a.Uniform1f(h,n.u_buffer_scale),u_fade_t:new a.Uniform1f(h,n.u_fade_t),u_opacity:new a.Uniform1f(h,n.u_opacity),u_image0:new a.Uniform1i(h,n.u_image0),u_image1:new a.Uniform1i(h,n.u_image1),u_brightness_low:new a.Uniform1f(h,n.u_brightness_low),u_brightness_high:new a.Uniform1f(h,n.u_brightness_high),u_saturation_factor:new a.Uniform1f(h,n.u_saturation_factor),u_contrast_factor:new a.Uniform1f(h,n.u_contrast_factor),u_spin_weights:new a.Uniform3f(h,n.u_spin_weights)}),symbolIcon:(h,n)=>({u_is_size_zoom_constant:new a.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(h,n.u_size_t),u_size:new a.Uniform1f(h,n.u_size),u_camera_to_center_distance:new a.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(h,n.u_pitch),u_rotate_symbol:new a.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(h,n.u_fade_change),u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new a.Uniform1i(h,n.u_is_text),u_pitch_with_map:new a.Uniform1i(h,n.u_pitch_with_map),u_texsize:new a.Uniform2f(h,n.u_texsize),u_texture:new a.Uniform1i(h,n.u_texture)}),symbolSDF:(h,n)=>({u_is_size_zoom_constant:new a.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(h,n.u_size_t),u_size:new a.Uniform1f(h,n.u_size),u_camera_to_center_distance:new a.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(h,n.u_pitch),u_rotate_symbol:new a.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(h,n.u_fade_change),u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new a.Uniform1i(h,n.u_is_text),u_pitch_with_map:new a.Uniform1i(h,n.u_pitch_with_map),u_texsize:new a.Uniform2f(h,n.u_texsize),u_texture:new a.Uniform1i(h,n.u_texture),u_gamma_scale:new a.Uniform1f(h,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(h,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(h,n.u_is_halo)}),symbolTextAndIcon:(h,n)=>({u_is_size_zoom_constant:new a.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(h,n.u_size_t),u_size:new a.Uniform1f(h,n.u_size),u_camera_to_center_distance:new a.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(h,n.u_pitch),u_rotate_symbol:new a.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(h,n.u_fade_change),u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new a.Uniform1i(h,n.u_is_text),u_pitch_with_map:new a.Uniform1i(h,n.u_pitch_with_map),u_texsize:new a.Uniform2f(h,n.u_texsize),u_texsize_icon:new a.Uniform2f(h,n.u_texsize_icon),u_texture:new a.Uniform1i(h,n.u_texture),u_texture_icon:new a.Uniform1i(h,n.u_texture_icon),u_gamma_scale:new a.Uniform1f(h,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(h,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(h,n.u_is_halo)}),background:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_opacity:new a.Uniform1f(h,n.u_opacity),u_color:new a.UniformColor(h,n.u_color)}),backgroundPattern:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_opacity:new a.Uniform1f(h,n.u_opacity),u_image:new a.Uniform1i(h,n.u_image),u_pattern_tl_a:new a.Uniform2f(h,n.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(h,n.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(h,n.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(h,n.u_pattern_br_b),u_texsize:new a.Uniform2f(h,n.u_texsize),u_mix:new a.Uniform1f(h,n.u_mix),u_pattern_size_a:new a.Uniform2f(h,n.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(h,n.u_pattern_size_b),u_scale_a:new a.Uniform1f(h,n.u_scale_a),u_scale_b:new a.Uniform1f(h,n.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(h,n.u_tile_units_to_pixels)}),terrainRaster:na,terrainDepth:na,skybox:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_sun_direction:new a.Uniform3f(h,n.u_sun_direction),u_cubemap:new a.Uniform1i(h,n.u_cubemap),u_opacity:new a.Uniform1f(h,n.u_opacity),u_temporal_offset:new a.Uniform1f(h,n.u_temporal_offset)}),skyboxGradient:(h,n)=>({u_matrix:new a.UniformMatrix4f(h,n.u_matrix),u_color_ramp:new a.Uniform1i(h,n.u_color_ramp),u_center_direction:new a.Uniform3f(h,n.u_center_direction),u_radius:new a.Uniform1f(h,n.u_radius),u_opacity:new a.Uniform1f(h,n.u_opacity),u_temporal_offset:new a.Uniform1f(h,n.u_temporal_offset)}),skyboxCapture:(h,n)=>({u_matrix_3f:new a.UniformMatrix3f(h,n.u_matrix_3f),u_sun_direction:new a.Uniform3f(h,n.u_sun_direction),u_sun_intensity:new a.Uniform1f(h,n.u_sun_intensity),u_color_tint_r:new a.Uniform4f(h,n.u_color_tint_r),u_color_tint_m:new a.Uniform4f(h,n.u_color_tint_m),u_luminance:new a.Uniform1f(h,n.u_luminance)})};let ss;function Co(h,n,l,d,g,_,w){const S=h.context,C=S.gl,M=h.useProgram("collisionBox"),z=[];let R=0,F=0;for(let te=0;te<d.length;te++){const se=d[te],ue=n.getTile(se),Y=ue.getBucket(l);if(!Y)continue;let pe=se.projMatrix;g[0]===0&&g[1]===0||(pe=h.translatePosMatrix(se.projMatrix,ue,g,_));const ke=w?Y.textCollisionBox:Y.iconCollisionBox,De=Y.collisionCircleArray;if(De.length>0){const de=a.create$1(),Ee=pe;a.mul$1(de,Y.placementInvProjMatrix,h.transform.glCoordMatrix),a.mul$1(de,de,Y.placementViewportMatrix),z.push({circleArray:De,circleOffset:F,transform:Ee,invTransform:de}),R+=De.length/4,F=R}ke&&(h.terrain&&h.terrain.setupElevationDraw(ue,M),M.draw(S,C.LINES,a.DepthMode.disabled,a.StencilMode.disabled,h.colorModeForRenderPass(),a.CullFaceMode.disabled,rl(pe,h.transform,ue),l.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,h.transform.zoom,null,ke.collisionVertexBuffer,ke.collisionVertexBufferExt))}if(!w||!z.length)return;const O=h.useProgram("collisionCircle"),G=new a.StructArrayLayout2f1f2i16;G.resize(4*R),G._trim();let Z=0;for(const te of z)for(let se=0;se<te.circleArray.length/4;se++){const ue=4*se,Y=te.circleArray[ue+0],pe=te.circleArray[ue+1],ke=te.circleArray[ue+2],De=te.circleArray[ue+3];G.emplace(Z++,Y,pe,ke,De,0),G.emplace(Z++,Y,pe,ke,De,1),G.emplace(Z++,Y,pe,ke,De,2),G.emplace(Z++,Y,pe,ke,De,3)}(!ss||ss.length<2*R)&&(ss=function(te){const se=2*te,ue=new a.StructArrayLayout3ui6;ue.resize(se),ue._trim();for(let Y=0;Y<se;Y++){const pe=6*Y;ue.uint16[pe+0]=4*Y+0,ue.uint16[pe+1]=4*Y+1,ue.uint16[pe+2]=4*Y+2,ue.uint16[pe+3]=4*Y+2,ue.uint16[pe+4]=4*Y+3,ue.uint16[pe+5]=4*Y+0}return ue}(R));const ne=S.createIndexBuffer(ss,!0),V=S.createVertexBuffer(G,a.collisionCircleLayout.members,!0);for(const te of z){const se={u_matrix:te.transform,u_inv_matrix:te.invTransform,u_camera_to_center_distance:(X=h.transform).cameraToCenterDistance,u_viewport_size:[X.width,X.height]};O.draw(S,C.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,h.colorModeForRenderPass(),a.CullFaceMode.disabled,se,l.id,V,ne,a.SegmentVector.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,h.transform.zoom,null,null,null)}var X;V.destroy(),ne.destroy()}const Zc=a.identity(new Float32Array(16));function ed(h,n,l,d,g,_){const{horizontalAlign:w,verticalAlign:S}=a.getAnchorAlignment(h),C=-(w-.5)*n,M=-(S-.5)*l,z=a.evaluateVariableOffset(h,d);return new a.pointGeometry((C/g+z[0])*_,(M/g+z[1])*_)}function qc(h,n,l,d,g,_,w,S,C,M,z,R){const F=h.text.placedSymbolArray,O=h.text.dynamicLayoutVertexArray,G=h.icon.dynamicLayoutVertexArray,Z={};O.clear();for(let ne=0;ne<F.length;ne++){const V=F.get(ne),X=h.allowVerticalPlacement&&!V.placedOrientation,te=V.hidden||!V.crossTileID||X?null:d[V.crossTileID];if(te){const se=new a.pointGeometry(V.tileAnchorX,V.tileAnchorY),ue=R(se),Y=Qn(se,l?S:w,ue),pe=Ct(_.cameraToCenterDistance,Y.signedDistanceFromCamera);let ke=g.evaluateSizeForFeature(h.textSizeData,M,V)*pe/a.ONE_EM;l&&(ke*=h.tilePixelRatio/C);const{width:De,height:de,anchor:Ee,textOffset:Je,textScale:tt}=te,et=ed(Ee,De,de,Je,tt,ke),Ue=l?Qn(se.add(et),w,ue).point:Y.point.add(n?et.rotate(-_.angle):et),it=h.allowVerticalPlacement&&V.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let kt=0;kt<V.numGlyphs;kt++)a.addDynamicAttributes(O,Ue,it);z&&V.associatedIconIndex>=0&&(Z[V.associatedIconIndex]={shiftedAnchor:Ue,angle:it})}else Oi(V.numGlyphs,O)}if(z){G.clear();const ne=h.icon.placedSymbolArray;for(let V=0;V<ne.length;V++){const X=ne.get(V);if(X.hidden)Oi(X.numGlyphs,G);else{const te=Z[V];if(te)for(let se=0;se<X.numGlyphs;se++)a.addDynamicAttributes(G,te.shiftedAnchor,te.angle);else Oi(X.numGlyphs,G)}}h.icon.dynamicLayoutVertexBuffer.updateData(G)}h.text.dynamicLayoutVertexBuffer.updateData(O)}function ko(h,n,l){return l.iconsInText&&n?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Wc(h,n,l,d,g,_,w,S,C,M,z,R){const F=h.context,O=F.gl,G=h.transform,Z=S==="map",ne=C==="map",V=Z&&l.layout.get("symbol-placement")!=="point",X=Z&&!ne&&!V,te=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let se=!1;const ue=h.depthModeForSublayer(0,a.DepthMode.ReadOnly),Y=l.layout.get("text-variable-anchor"),pe=[],ke=h.terrain&&ne?["PITCH_WITH_MAP_TERRAIN"]:null;for(const De of d){const de=n.getTile(De),Ee=de.getBucket(l);if(!Ee)continue;const Je=g?Ee.text:Ee.icon;if(!Je||!Je.segments.get().length)continue;const tt=Je.programConfigurations.get(l.id),et=g||Ee.sdfIcons,Ue=g?Ee.textSizeData:Ee.iconSizeData,it=ne||G.pitch!==0,kt=h.useProgram(ko(et,g,Ee),tt,ke),gt=a.evaluateSizeForZoom(Ue,G.zoom);let vn,dn,xt,It,gn=[0,0],Xr=null;if(g){if(dn=de.glyphAtlasTexture,xt=O.LINEAR,vn=de.glyphAtlasTexture.size,Ee.iconsInText){gn=de.imageAtlasTexture.size,Xr=de.imageAtlasTexture;const Hr=Ue.kind==="composite"||Ue.kind==="camera";It=it||h.options.rotating||h.options.zooming||Hr?O.LINEAR:O.NEAREST}}else{const Hr=l.layout.get("icon-size").constantOr(0)!==1||Ee.iconsNeedLinear;dn=de.imageAtlasTexture,xt=et||h.options.rotating||h.options.zooming||Hr||it?O.LINEAR:O.NEAREST,vn=de.imageAtlasTexture.size}const Ei=Ot(de,1,h.transform.zoom),ar=wt(De.projMatrix,ne,Z,h.transform,Ei),Tr=h.terrain&&ne&&V?a.invert(new Float32Array(16),ar):Zc,Ci=ui(De.projMatrix,ne,Z,h.transform,Ei),$i=Y&&Ee.hasTextData(),nn=l.layout.get("icon-text-fit")!=="none"&&$i&&Ee.hasIconData();if(V){const Hr=G.elevation;Ks(Ee,De.projMatrix,h,g,ar,Ci,ne,M,Hr?ki=>Hr.getAtTileOffset(De,ki.x,ki.y):null)}const _n=h.translatePosMatrix(De.projMatrix,de,_,w),$t=V||g&&Y||nn?Zc:ar,wn=h.translatePosMatrix(Ci,de,_,w,!0),Sr=et&&l.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let cn;cn=et?Ee.iconsInText?Hf(Ue.kind,gt,X,ne,h,_n,$t,wn,vn,gn):Jh(Ue.kind,gt,X,ne,h,_n,$t,wn,g,vn,!0):Qh(Ue.kind,gt,X,ne,h,_n,$t,wn,g,vn);const er={program:kt,buffers:Je,uniformValues:cn,atlasTexture:dn,atlasTextureIcon:Xr,atlasInterpolation:xt,atlasInterpolationIcon:It,isSDF:et,hasHalo:Sr,tile:de,labelPlaneMatrixInv:Tr};if(te&&Ee.canOverlap){se=!0;const Hr=Je.segments.get();for(const ki of Hr)pe.push({segments:new a.SegmentVector([ki]),sortKey:ki.sortKey,state:er})}else pe.push({segments:Je.segments,sortKey:0,state:er})}se&&pe.sort((De,de)=>De.sortKey-de.sortKey);for(const De of pe){const de=De.state;if(h.terrain&&h.terrain.setupElevationDraw(de.tile,de.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:de.labelPlaneMatrixInv}),F.activeTexture.set(O.TEXTURE0),de.atlasTexture.bind(de.atlasInterpolation,O.CLAMP_TO_EDGE),de.atlasTextureIcon&&(F.activeTexture.set(O.TEXTURE1),de.atlasTextureIcon&&de.atlasTextureIcon.bind(de.atlasInterpolationIcon,O.CLAMP_TO_EDGE)),de.isSDF){const Ee=de.uniformValues;de.hasHalo&&(Ee.u_is_halo=1,Io(de.buffers,De.segments,l,h,de.program,ue,z,R,Ee)),Ee.u_is_halo=0}Io(de.buffers,De.segments,l,h,de.program,ue,z,R,de.uniformValues)}}function Io(h,n,l,d,g,_,w,S,C){const M=d.context;g.draw(M,M.gl.TRIANGLES,_,w,S,a.CullFaceMode.disabled,C,l.id,h.layoutVertexBuffer,h.indexBuffer,n,l.paint,d.transform.zoom,h.programConfigurations.get(l.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function Ao(h,n,l,d,g,_,w){const S=h.context.gl,C=l.paint.get("fill-pattern"),M=C&&C.constantOr(1),z=l.getCrossfadeParameters();let R,F,O,G,Z;w?(F=M&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=S.LINES):(F=M?"fillPattern":"fill",R=S.TRIANGLES);for(const ne of d){const V=n.getTile(ne);if(M&&!V.patternsLoaded())continue;const X=V.getBucket(l);if(!X)continue;h.prepareDrawTile(ne);const te=X.programConfigurations.get(l.id),se=h.useProgram(F,te);M&&(h.context.activeTexture.set(S.TEXTURE0),V.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),te.updatePaintBuffers(z));const ue=C.constantOr(null);if(ue&&V.imageAtlas){const pe=V.imageAtlas,ke=pe.patternPositions[ue.to.toString()],De=pe.patternPositions[ue.from.toString()];ke&&De&&te.setConstantPatternPositions(ke,De)}const Y=h.translatePosMatrix(ne.projMatrix,V,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(w){G=X.indexBuffer2,Z=X.segments2;const pe=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[S.drawingBufferWidth,S.drawingBufferHeight];O=F==="fillOutlinePattern"&&M?Nr(Y,h,z,V,pe):Kh(Y,pe)}else G=X.indexBuffer,Z=X.segments,O=M?is(Y,h,z,V):rs(Y);h.prepareDrawProgram(h.context,se,ne.toUnwrapped()),se.draw(h.context,R,g,h.stencilModeForClipping(ne),_,a.CullFaceMode.disabled,O,l.id,X.layoutVertexBuffer,G,Z,l.paint,h.transform.zoom,te)}}function al(h,n,l,d,g,_,w){const S=h.context,C=S.gl,M=l.paint.get("fill-extrusion-pattern"),z=M.constantOr(1),R=l.getCrossfadeParameters(),F=l.paint.get("fill-extrusion-opacity");for(const O of d){const G=n.getTile(O),Z=G.getBucket(l);if(!Z)continue;const ne=Z.programConfigurations.get(l.id),V=h.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ne);if(h.terrain){const Y=h.terrain;if(!Z.enableTerrain)continue;if(Y.setupElevationDraw(G,V,{useMeterToDem:!0}),Xc(S,n,O,Z,l,Y),!Z.centroidVertexBuffer){const pe=V.attributes.a_centroid_pos;pe!==void 0&&C.vertexAttrib2f(pe,0,0)}}z&&(h.context.activeTexture.set(C.TEXTURE0),G.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ne.updatePaintBuffers(R));const X=M.constantOr(null);if(X&&G.imageAtlas){const Y=G.imageAtlas,pe=Y.patternPositions[X.to.toString()],ke=Y.patternPositions[X.from.toString()];pe&&ke&&ne.setConstantPatternPositions(pe,ke)}const te=h.translatePosMatrix(O.projMatrix,G,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),se=l.paint.get("fill-extrusion-vertical-gradient"),ue=z?Wf(te,h,se,F,O,R,G):Nc(te,h,se,F);h.prepareDrawProgram(S,V,O.toUnwrapped()),V.draw(S,S.gl.TRIANGLES,g,_,w,a.CullFaceMode.backCCW,ue,l.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,l.paint,h.transform.zoom,ne,h.terrain?Z.centroidVertexBuffer:null)}}function Xc(h,n,l,d,g,_){const w=[V=>{let X=V.canonical.x-1,te=V.wrap;return X<0&&(X=(1<<V.canonical.z)-1,te--),new a.OverscaledTileID(V.overscaledZ,te,V.canonical.z,X,V.canonical.y)},V=>{let X=V.canonical.x+1,te=V.wrap;return X===1<<V.canonical.z&&(X=0,te++),new a.OverscaledTileID(V.overscaledZ,te,V.canonical.z,X,V.canonical.y)},V=>new a.OverscaledTileID(V.overscaledZ,V.wrap,V.canonical.z,V.canonical.x,(V.canonical.y===0?1<<V.canonical.z:V.canonical.y)-1),V=>new a.OverscaledTileID(V.overscaledZ,V.wrap,V.canonical.z,V.canonical.x,V.canonical.y===(1<<V.canonical.z)-1?0:V.canonical.y+1)],S=V=>{const X=n.getSource().maxzoom,te=pe=>{const ke=n.getTileByID(pe);if(ke&&ke.hasData())return ke.getBucket(g)};let se,ue,Y;return(V.overscaledZ===V.canonical.z||V.overscaledZ>=X)&&(se=te(V.key)),V.overscaledZ>=X&&(ue=te(V.calculateScaledKey(V.overscaledZ+1))),V.overscaledZ>X&&(Y=te(V.calculateScaledKey(V.overscaledZ-1))),se||ue||Y},C=[0,0,0],M=(V,X)=>(C[0]=Math.min(V.min.y,X.min.y),C[1]=Math.max(V.max.y,X.max.y),C[2]=a.EXTENT-X.min.x>V.max.x?X.min.x-a.EXTENT:V.max.x,C),z=(V,X)=>(C[0]=Math.min(V.min.x,X.min.x),C[1]=Math.max(V.max.x,X.max.x),C[2]=a.EXTENT-X.min.y>V.max.y?X.min.y-a.EXTENT:V.max.y,C),R=[(V,X)=>M(V,X),(V,X)=>M(X,V),(V,X)=>z(V,X),(V,X)=>z(X,V)],F=new a.pointGeometry(0,0);let O,G,Z;const ne=(V,X,te,se,ue)=>{const Y=[[se?te:V,se?V:te,0],[se?te:X,se?X:te,0]],pe=ue<0?a.EXTENT+ue:ue,ke=[se?pe:(V+X)/2,se?(V+X)/2:pe,0];return te===0&&ue<0||te!==0&&ue>0?_.getForTilePoints(Z,[ke],!0,G):Y.push(ke),_.getForTilePoints(l,Y,!0,O),Math.max(Y[0][2],Y[1][2],ke[2])/_.exaggeration()};for(let V=0;V<4;V++){const X=d.borders[V];if(X.length===0&&(d.borderDone[V]=!0),d.borderDone[V])continue;const te=Z=w[V](l),se=S(te);if(!se||!se.enableTerrain||(G=_.findDEMTileFor(te),!G||!G.dem))continue;if(!O){const ke=_.findDEMTileFor(l);if(!ke||!ke.dem)return;O=ke}const ue=(V<2?1:5)-V,Y=se.borders[ue];let pe=0;for(let ke=0;ke<X.length;ke++){const De=d.featuresOnBorder[X[ke]],de=De.borders[V];let Ee;for(;pe<Y.length&&(Ee=se.featuresOnBorder[Y[pe]],!(Ee.borders[ue][1]>de[0]+3));)se.borderDone[ue]||se.encodeCentroid(void 0,Ee,!1),pe++;if(Ee&&pe<Y.length){const Je=pe;let tt=0;for(;!(Ee.borders[ue][0]>de[1]-3)&&(tt++,++pe!==Y.length);)Ee=se.featuresOnBorder[Y[pe]];if(Ee=se.featuresOnBorder[Y[Je]],De.intersectsCount()>1||Ee.intersectsCount()>1||tt!==1){tt!==1&&(pe=Je),d.encodeCentroid(void 0,De,!1),se.borderDone[ue]||se.encodeCentroid(void 0,Ee,!1);continue}const et=R[V](De,Ee),Ue=V%2?a.EXTENT-1:0;F.x=ne(et[0],Math.min(a.EXTENT-1,et[1]),Ue,V<2,et[2]),F.y=0,d.encodeCentroid(F,De,!1),se.borderDone[ue]||se.encodeCentroid(F,Ee,!1)}else d.encodeCentroid(void 0,De,!1)}d.borderDone[V]=d.needsCentroidUpdate=!0,se.borderDone[ue]||(se.borderDone[ue]=se.needsCentroidUpdate=!0)}(d.needsCentroidUpdate||!d.centroidVertexBuffer&&d.centroidVertexArray.length!==0)&&d.uploadCentroid(h)}const Vt=new a.Color(1,0,0,1),ll=new a.Color(0,1,0,1),Qf=new a.Color(0,0,1,1),td=new a.Color(1,0,1,1),ia=new a.Color(0,1,1,1);function nd(h,n,l,d){oa(h,0,n+l/2,h.transform.width,l,d)}function rd(h,n,l,d){oa(h,n-l/2,0,l,h.transform.height,d)}function oa(h,n,l,d,g,_){const w=h.context,S=w.gl;S.enable(S.SCISSOR_TEST),S.scissor(n*a.exported.devicePixelRatio,l*a.exported.devicePixelRatio,d*a.exported.devicePixelRatio,g*a.exported.devicePixelRatio),w.clear({color:_}),S.disable(S.SCISSOR_TEST)}function Jf(h,n,l){const d=h.context,g=d.gl,_=l.projMatrix,w=h.useProgram("debug"),S=n.getTileByID(l.key);h.terrain&&h.terrain.setupElevationDraw(S,w);const C=a.DepthMode.disabled,M=a.StencilMode.disabled,z=h.colorModeForRenderPass(),R="$debug";d.activeTexture.set(g.TEXTURE0),h.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),w.draw(d,g.LINE_STRIP,C,M,z,a.CullFaceMode.disabled,il(_,a.Color.red),R,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments);const F=S.latestRawTileData,O=Math.floor((F&&F.byteLength||0)/1024),G=n.getTile(l).tileSize,Z=512/Math.min(G,512)*(l.overscaledZ/h.transform.zoom)*.5;let ne=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(ne+=` => ${l.overscaledZ}`),function(V,X){V.initDebugOverlayCanvas();const te=V.debugOverlayCanvas,se=V.context.gl,ue=V.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,te.width,te.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(X,5,5),ue.strokeText(X,5,5),V.debugOverlayTexture.update(te),V.debugOverlayTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE)}(h,`${ne} ${O}kb`),w.draw(d,g.TRIANGLES,C,M,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,il(_,a.Color.transparent,Z),R,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments)}const Hc=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:cl}=Hc;function fi(h,n,l,d){h.emplaceBack(n,l,d)}class ul{constructor(n){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,fi(this.vertexArray,-1,-1,1),fi(this.vertexArray,1,-1,1),fi(this.vertexArray,-1,1,1),fi(this.vertexArray,1,1,1),fi(this.vertexArray,-1,-1,-1),fi(this.vertexArray,1,-1,-1),fi(this.vertexArray,-1,1,-1),fi(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,cl),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function no(h,n,l,d,g,_){const w=h.gl,S=n.paint.get("sky-atmosphere-color"),C=n.paint.get("sky-atmosphere-halo-color"),M=n.paint.get("sky-atmosphere-sun-intensity"),z=((R,F,O,G,Z)=>({u_matrix_3f:R,u_sun_direction:F,u_sun_intensity:O,u_color_tint_r:[G.r,G.g,G.b,G.a],u_color_tint_m:[Z.r,Z.g,Z.b,Z.a],u_luminance:5e-5}))(a.fromMat4([],d),g,M,S,C);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+_,n.skyboxTexture,0),l.draw(h,w.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,z,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Kc={symbol:function(h,n,l,d,g){if(h.renderPass!=="translucent")return;const _=a.StencilMode.disabled,w=h.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(S,C,M,z,R,F,O){const G=C.transform,Z=R==="map",ne=F==="map";for(const V of S){const X=z.getTile(V),te=X.getBucket(M);if(!te||!te.text||!te.text.segments.get().length)continue;const se=a.evaluateSizeForZoom(te.textSizeData,G.zoom),ue=Ot(X,1,C.transform.zoom),Y=wt(V.projMatrix,ne,Z,C.transform,ue),pe=M.layout.get("icon-text-fit")!=="none"&&te.hasIconData();if(se){const ke=Math.pow(2,G.zoom-X.tileID.overscaledZ),De=G.elevation;qc(te,Z,ne,O,a.symbolSize,G,Y,V.projMatrix,ke,se,pe,De?de=>De.getAtTileOffset(V,de.x,de.y):de=>0)}}}(d,h,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),g),l.paint.get("icon-opacity").constantOr(1)!==0&&Wc(h,n,l,d,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),_,w),l.paint.get("text-opacity").constantOr(1)!==0&&Wc(h,n,l,d,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),_,w),n.map.showCollisionBoxes&&(Co(h,n,l,d,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Co(h,n,l,d,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(h,n,l,d){if(h.renderPass!=="translucent")return;const g=l.paint.get("circle-opacity"),_=l.paint.get("circle-stroke-width"),w=l.paint.get("circle-stroke-opacity"),S=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(g.constantOr(1)===0&&(_.constantOr(1)===0||w.constantOr(1)===0))return;const C=h.context,M=C.gl,z=h.depthModeForSublayer(0,a.DepthMode.ReadOnly),R=a.StencilMode.disabled,F=h.colorModeForRenderPass(),O=[];for(let G=0;G<d.length;G++){const Z=d[G],ne=n.getTile(Z),V=ne.getBucket(l);if(!V)continue;const X=V.programConfigurations.get(l.id),te=nl(l),se={programConfiguration:X,program:h.useProgram("circle",X,te),layoutVertexBuffer:V.layoutVertexBuffer,indexBuffer:V.indexBuffer,uniformValues:Uc(h,Z,ne,l),tile:ne};if(S){const ue=V.segments.get();for(const Y of ue)O.push({segments:new a.SegmentVector([Y]),sortKey:Y.sortKey,state:se})}else O.push({segments:V.segments,sortKey:0,state:se})}S&&O.sort((G,Z)=>G.sortKey-Z.sortKey);for(const G of O){const{programConfiguration:Z,program:ne,layoutVertexBuffer:V,indexBuffer:X,uniformValues:te,tile:se}=G.state,ue=G.segments;h.terrain&&h.terrain.setupElevationDraw(se,ne,{useDepthForOcclusion:!0}),h.prepareDrawProgram(C,ne,se.tileID.toUnwrapped()),ne.draw(C,M.TRIANGLES,z,R,F,a.CullFaceMode.disabled,te,l.id,V,X,ue,l.paint,h.transform.zoom,Z)}},heatmap:function(h,n,l,d){if(l.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const g=h.context,_=g.gl,w=a.StencilMode.disabled,S=new a.ColorMode([_.ONE,_.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(C,M,z){const R=C.gl;C.activeTexture.set(R.TEXTURE1),C.viewport.set([0,0,M.width/4,M.height/4]);let F=z.heatmapFbo;if(F)R.bindTexture(R.TEXTURE_2D,F.colorAttachment.get()),C.bindFramebuffer.set(F.framebuffer);else{const O=R.createTexture();R.bindTexture(R.TEXTURE_2D,O),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),F=z.heatmapFbo=C.createFramebuffer(M.width/4,M.height/4,!1),function(G,Z,ne,V){const X=G.gl;X.texImage2D(X.TEXTURE_2D,0,X.RGBA,Z.width/4,Z.height/4,0,X.RGBA,G.extRenderToTextureHalfFloat?G.extTextureHalfFloat.HALF_FLOAT_OES:X.UNSIGNED_BYTE,null),V.colorAttachment.set(ne)}(C,M,O,F)}})(g,h,l),g.clear({color:a.Color.transparent});for(let C=0;C<d.length;C++){const M=d[C];if(n.hasRenderableParent(M))continue;const z=n.getTile(M),R=z.getBucket(l);if(!R)continue;const F=R.programConfigurations.get(l.id),O=h.useProgram("heatmap",F),{zoom:G}=h.transform;h.terrain&&h.terrain.setupElevationDraw(z,O),h.prepareDrawProgram(g,O,M.toUnwrapped()),O.draw(g,_.TRIANGLES,a.DepthMode.disabled,w,S,a.CullFaceMode.disabled,Vc(M.projMatrix,z,G,l.paint.get("heatmap-intensity")),l.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,l.paint,h.transform.zoom,F)}g.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(g,_){const w=g.context,S=w.gl,C=_.heatmapFbo;if(!C)return;w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,C.colorAttachment.get()),w.activeTexture.set(S.TEXTURE1);let M=_.colorRampTexture;M||(M=_.colorRampTexture=new a.Texture(w,_.colorRamp,S.RGBA)),M.bind(S.LINEAR,S.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(w,S.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,((z,R,F,O)=>({u_image:0,u_color_ramp:1,u_opacity:R.paint.get("heatmap-opacity")}))(0,_),_.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,_.paint,g.transform.zoom)}(h,l))},line:function(h,n,l,d){if(h.renderPass!=="translucent")return;const g=l.paint.get("line-opacity"),_=l.paint.get("line-width");if(g.constantOr(1)===0||_.constantOr(1)===0)return;const w=h.depthModeForSublayer(0,a.DepthMode.ReadOnly),S=h.colorModeForRenderPass(),C=l.paint.get("line-dasharray"),M=C.constantOr(1),z=l.layout.get("line-cap"),R=l.paint.get("line-pattern"),F=R.constantOr(1),O=l.paint.get("line-gradient"),G=l.getCrossfadeParameters(),Z=F?"linePattern":"line",ne=h.context,V=ne.gl;for(const X of d){const te=n.getTile(X);if(F&&!te.patternsLoaded())continue;const se=te.getBucket(l);if(!se)continue;h.prepareDrawTile(X);const ue=se.programConfigurations.get(l.id),Y=Yh(l),pe=h.useProgram(Z,ue,Y),ke=R.constantOr(null);if(ke&&te.imageAtlas){const tt=te.imageAtlas,et=tt.patternPositions[ke.to.toString()],Ue=tt.patternPositions[ke.from.toString()];et&&Ue&&ue.setConstantPatternPositions(et,Ue)}const De=C.constantOr(null),de=z.constantOr(null);if(!F&&De&&de&&te.lineAtlas){const tt=te.lineAtlas,et=tt.getDash(De.to,de),Ue=tt.getDash(De.from,de);et&&Ue&&ue.setConstantPatternPositions(et,Ue)}const Ee=h.terrain?X.projMatrix:null,Je=F?$c(h,te,l,G,Ee):ol(h,te,l,G,Ee,se.lineClipsArray.length);if(O){const tt=se.gradients[l.id];let et=tt.texture;if(l.gradientVersion!==tt.version){let Ue=256;if(l.stepInterpolant){const it=n.getSource().maxzoom,kt=X.canonical.z===it?Math.ceil(1<<h.transform.maxZoom-X.canonical.z):1;Ue=a.clamp(a.nextPowerOfTwo(se.maxLineLength/a.EXTENT*1024*kt),256,ne.maxTextureSize)}tt.gradient=a.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Ue,image:tt.gradient||void 0,clips:se.lineClipsArray}),tt.texture?tt.texture.update(tt.gradient):tt.texture=new a.Texture(ne,tt.gradient,V.RGBA),tt.version=l.gradientVersion,et=tt.texture}ne.activeTexture.set(V.TEXTURE1),et.bind(l.stepInterpolant?V.NEAREST:V.LINEAR,V.CLAMP_TO_EDGE)}M&&(ne.activeTexture.set(V.TEXTURE0),te.lineAtlasTexture.bind(V.LINEAR,V.REPEAT),ue.updatePaintBuffers(G)),F&&(ne.activeTexture.set(V.TEXTURE0),te.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),ue.updatePaintBuffers(G)),h.prepareDrawProgram(ne,pe,X.toUnwrapped()),pe.draw(ne,V.TRIANGLES,w,h.stencilModeForClipping(X),S,a.CullFaceMode.disabled,Je,l.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,l.paint,h.transform.zoom,ue,se.layoutVertexBuffer2)}},fill:function(h,n,l,d){const g=l.paint.get("fill-color"),_=l.paint.get("fill-opacity");if(_.constantOr(1)===0)return;const w=h.colorModeForRenderPass(),S=l.paint.get("fill-pattern"),C=h.opaquePassEnabledForLayer()&&!S.constantOr(1)&&g.constantOr(a.Color.transparent).a===1&&_.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===C){const M=h.depthModeForSublayer(1,h.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Ao(h,n,l,d,M,w,!1)}if(h.renderPass==="translucent"&&l.paint.get("fill-antialias")){const M=h.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Ao(h,n,l,d,M,w,!0)}},"fill-extrusion":function(h,n,l,d){const g=l.paint.get("fill-extrusion-opacity");if(g!==0&&h.renderPass==="translucent"){const _=new a.DepthMode(h.context.gl.LEQUAL,a.DepthMode.ReadWrite,h.depthRangeFor3D);if(g!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))al(h,n,l,d,_,a.StencilMode.disabled,a.ColorMode.disabled),al(h,n,l,d,_,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const w=h.colorModeForRenderPass();al(h,n,l,d,_,a.StencilMode.disabled,w)}}},hillshade:function(h,n,l,d){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const g=h.context,_=h.depthModeForSublayer(0,a.DepthMode.ReadOnly),w=h.colorModeForRenderPass(),S=h.terrain&&h.terrain.renderingToTexture,[C,M]=h.renderPass!=="translucent"||S?[{},d]:h.stencilConfigForOverlap(d);for(const z of M){const R=n.getTile(z);if(R.needsHillshadePrepare&&h.renderPass==="offscreen")Ut(h,R,l,_,a.StencilMode.disabled,w);else if(h.renderPass==="translucent"){const F=S&&h.terrain?h.terrain.stencilModeForRTTOverlap(z):C[z.overscaledZ];Ka(h,z,R,l,_,F,w)}}g.viewport.set([0,0,h.width,h.height])},raster:function(h,n,l,d,g,_){if(h.renderPass!=="translucent"||l.paint.get("raster-opacity")===0||!d.length)return;const w=h.context,S=w.gl,C=n.getSource(),M=h.useProgram("raster"),z=h.colorModeForRenderPass(),R=h.terrain&&h.terrain.renderingToTexture,[F,O]=C instanceof $||R?[{},d]:h.stencilConfigForOverlap(d),G=O[O.length-1].overscaledZ,Z=!h.options.moving;for(const ne of O){const V=R?a.DepthMode.disabled:h.depthModeForSublayer(ne.overscaledZ-G,l.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,S.LESS),X=ne.toUnwrapped(),te=n.getTile(ne);if(R&&(!te||!te.hasData()))continue;const se=R?ne.projMatrix:h.transform.calculateProjMatrix(X,Z),ue=h.terrain&&R?h.terrain.stencilModeForRTTOverlap(ne):F[ne.overscaledZ],Y=_?0:l.paint.get("raster-fade-duration");te.registerFadeDuration(Y);const pe=n.findLoadedParent(ne,0),ke=Hh(te,pe,n,h.transform,Y);let De,de;h.terrain&&h.terrain.prepareDrawTile(ne);const Ee=l.paint.get("raster-resampling")==="nearest"?S.NEAREST:S.LINEAR;w.activeTexture.set(S.TEXTURE0),te.texture.bind(Ee,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(S.TEXTURE1),pe?(pe.texture.bind(Ee,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),De=Math.pow(2,pe.tileID.overscaledZ-te.tileID.overscaledZ),de=[te.tileID.canonical.x*De%1,te.tileID.canonical.y*De%1]):te.texture.bind(Ee,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST);const Je=os(se,de||[0,0],De||1,ke,l);h.prepareDrawProgram(w,M,X),C instanceof $?M.draw(w,S.TRIANGLES,V,a.StencilMode.disabled,z,a.CullFaceMode.disabled,Je,l.id,C.boundsBuffer,h.quadTriangleIndexBuffer,C.boundsSegments):M.draw(w,S.TRIANGLES,V,ue,z,a.CullFaceMode.disabled,Je,l.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,n,l,d){const g=l.paint.get("background-color"),_=l.paint.get("background-opacity");if(_===0)return;const w=h.context,S=w.gl,C=h.transform,M=C.tileSize,z=l.paint.get("background-pattern");if(h.isPatternMissing(z))return;const R=!z&&g.a===1&&_===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==R)return;const F=a.StencilMode.disabled,O=h.depthModeForSublayer(0,R==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),G=h.colorModeForRenderPass(),Z=h.useProgram(z?"backgroundPattern":"background"),ne=d||C.coveringTiles({tileSize:M});z&&(w.activeTexture.set(S.TEXTURE0),h.imageManager.bind(h.context));const V=l.getCrossfadeParameters();for(const X of ne){const te=X.toUnwrapped(),se=d?X.projMatrix:h.transform.calculateProjMatrix(te);h.prepareDrawTile(X);const ue=z?Yf(se,_,h,z,{tileID:X,tileSize:M},V):Kf(se,_,g);h.prepareDrawProgram(w,Z,te),Z.draw(w,S.TRIANGLES,O,F,G,a.CullFaceMode.disabled,ue,l.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},sky:function(h,n,l){const d=l.paint.get("sky-opacity");if(d===0)return;const g=h.context,_=l.paint.get("sky-type"),w=new a.DepthMode(g.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),S=h.frameCounter/1e3%1;_==="atmosphere"?h.renderPass==="offscreen"?l.needsSkyboxCapture(h)&&(function(C,M,z,R){const F=C.context,O=F.gl;let G=M.skyboxFbo;if(!G){G=M.skyboxFbo=F.createFramebuffer(32,32,!1),M.skyboxGeometry=new ul(F),M.skyboxTexture=F.gl.createTexture(),O.bindTexture(O.TEXTURE_CUBE_MAP,M.skyboxTexture),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_MAG_FILTER,O.LINEAR);for(let X=0;X<6;++X)O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+X,0,O.RGBA,32,32,0,O.RGBA,O.UNSIGNED_BYTE,null)}F.bindFramebuffer.set(G.framebuffer),F.viewport.set([0,0,32,32]);const Z=M.getCenter(C,!0),ne=C.useProgram("skyboxCapture"),V=new Float64Array(16);a.identity(V),a.rotateY(V,V,.5*-Math.PI),no(F,M,ne,V,Z,0),a.identity(V),a.rotateY(V,V,.5*Math.PI),no(F,M,ne,V,Z,1),a.identity(V),a.rotateX(V,V,.5*-Math.PI),no(F,M,ne,V,Z,2),a.identity(V),a.rotateX(V,V,.5*Math.PI),no(F,M,ne,V,Z,3),a.identity(V),no(F,M,ne,V,Z,4),a.identity(V),a.rotateY(V,V,Math.PI),no(F,M,ne,V,Z,5),F.viewport.set([0,0,C.width,C.height])}(h,l),l.markSkyboxValid(h)):h.renderPass==="sky"&&function(C,M,z,R,F){const O=C.context,G=O.gl,Z=C.transform,ne=C.useProgram("skybox");O.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_CUBE_MAP,M.skyboxTexture);const V=((X,te,se,ue,Y)=>({u_matrix:X,u_sun_direction:te,u_cubemap:0,u_opacity:ue,u_temporal_offset:Y}))(Z.skyboxMatrix,M.getCenter(C,!1),0,R,F);C.prepareDrawProgram(O,ne),ne.draw(O,G.TRIANGLES,z,a.StencilMode.disabled,C.colorModeForRenderPass(),a.CullFaceMode.backCW,V,"skybox",M.skyboxGeometry.vertexBuffer,M.skyboxGeometry.indexBuffer,M.skyboxGeometry.segment)}(h,l,w,d,S):_==="gradient"&&h.renderPass==="sky"&&function(C,M,z,R,F){const O=C.context,G=O.gl,Z=C.transform,ne=C.useProgram("skyboxGradient");M.skyboxGeometry||(M.skyboxGeometry=new ul(O)),O.activeTexture.set(G.TEXTURE0);let V=M.colorRampTexture;V||(V=M.colorRampTexture=new a.Texture(O,M.colorRamp,G.RGBA)),V.bind(G.LINEAR,G.CLAMP_TO_EDGE);const X=((te,se,ue,Y,pe)=>({u_matrix:te,u_color_ramp:0,u_center_direction:se,u_radius:a.degToRad(ue),u_opacity:Y,u_temporal_offset:pe}))(Z.skyboxMatrix,M.getCenter(C,!1),M.paint.get("sky-gradient-radius"),R,F);C.prepareDrawProgram(O,ne),ne.draw(O,G.TRIANGLES,z,a.StencilMode.disabled,C.colorModeForRenderPass(),a.CullFaceMode.backCW,X,"skyboxGradient",M.skyboxGeometry.vertexBuffer,M.skyboxGeometry.indexBuffer,M.skyboxGeometry.segment)}(h,l,w,d,S)},debug:function(h,n,l){for(let d=0;d<l.length;d++)Jf(h,n,l[d])},custom:function(h,n,l){const d=h.context,g=l.implementation;if(h.renderPass==="offscreen"){const _=g.prerender;_&&(h.setCustomLayerDefaults(),d.setColorMode(h.colorModeForRenderPass()),_.call(g,d.gl,h.transform.customLayerMatrix()),d.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),d.setColorMode(h.colorModeForRenderPass()),d.setStencilMode(a.StencilMode.disabled);const _=g.renderingMode==="3d"?new a.DepthMode(h.context.gl.LEQUAL,a.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,a.DepthMode.ReadOnly);d.setDepthMode(_),g.render(d.gl,h.transform.customLayerMatrix()),d.setDirty(),h.setBaseState(),d.bindFramebuffer.set(null)}}};class hl{constructor(n,l){this.context=new To(n),this.transform=l,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wh,this.gpuTimers={},this.frameCounter=0}updateTerrain(n,l){const d=!!n&&!!n.terrain;if(!(d||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Fc(this,n));const g=this._terrain;this.transform.elevation=d?g:null,g.update(n,this.transform,l)}_updateFog(n){const l=n.fog;if(!l||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[d,g]=l.getFovAdjustedRange(this.transform._fov);if(d>g)return void(this.transform.fogCullDistSq=null);const _=d+.78*(g-d);this.transform.fogCullDistSq=_*_}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(n,l){if(this.width=n*a.exported.devicePixelRatio,this.height=l*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style.order)this.style._layers[d].resize()}setup(){const n=this.context,l=new a.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(a.EXTENT,0),l.emplaceBack(0,a.EXTENT),l.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(l,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const d=new a.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(a.EXTENT,0),d.emplaceBack(0,a.EXTENT),d.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(d,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const g=new a.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(a.EXTENT,0,a.EXTENT,0),g.emplaceBack(0,a.EXTENT,0,a.EXTENT),g.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(g,Si.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const _=new a.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA),this.identityMat=a.create$1();const C=this.context.gl;this.stencilClearMode=new a.StencilMode({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO),this.loadTimeStamps.push(a.window.performance.now())}clearStencil(){const n=this.context,l=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(n,l.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Qa(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,l,d){if(!(l&&this.currentStencilSource!==l.id&&n.isTileClipped()&&d&&d.length))return;this.currentStencilSource=l.id;const g=this.context,_=g.gl;this.nextStencilID+d.length>256&&this.clearStencil(),g.setColorMode(a.ColorMode.disabled),g.setDepthMode(a.DepthMode.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of d){const C=this._tileClippingMaskIDs[S.key]=this.nextStencilID++;w.draw(g,_.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:_.ALWAYS,mask:0},C,255,_.KEEP,_.KEEP,_.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Qa(S.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new a.StencilMode({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const l=this.context.gl;return new a.StencilMode({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(n){const l=this.context.gl,d=n.sort((w,S)=>S.overscaledZ-w.overscaledZ),g=d[d.length-1].overscaledZ,_=d[0].overscaledZ-g+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const w={};for(let S=0;S<_;S++)w[S+g]=new a.StencilMode({func:l.GEQUAL,mask:255},S+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=_,[w,d]}return[{[g]:a.StencilMode.disabled},d]}colorModeForRenderPass(){const n=this.context.gl;if(this._showOverdrawInspector){const l=1/8;return new a.ColorMode([n.CONSTANT_COLOR,n.ONE],new a.Color(l,l,l,0),[!0,!0,!0,!0])}return this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(n,l,d){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new a.DepthMode(d||this.context.gl.LEQUAL,l,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,l){this.style=n,this.options=l,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const d=this.style.order,g=this.style._sourceCaches;for(const M in g){const z=g[M];z.used&&z.prepare(this.context)}const _={},w={},S={};for(const M in g){const z=g[M];_[M]=z.getVisibleCoordinates(),w[M]=_[M].slice().reverse(),S[M]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<d.length;M++)if(this.style._layers[d[M]].is3D()){this.opaquePassCutoff=M;break}if(this.terrain&&(this.terrain.updateTileBinding(S),this.opaquePassCutoff=0),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const M of d){const z=this.style._layers[M],R=n._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const F=R?w[R.id]:void 0;(z.type==="custom"||z.isSky()||F&&F.length)&&this.renderLayer(this,R,z,F)}this.depthRangeFor3D=[0,1-(n.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let C=a.Color.transparent;if(this.style.fog&&(C=this.style.fog.properties.get("color")),this.context.clear({color:l.showOverdrawInspector?a.Color.black:C,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[d[this.currentLayer]],z=n._getLayerSourceCache(M);if(M.isSky())continue;const R=z?w[z.id]:void 0;this._renderTileClippingMasks(M,z,R),this.renderLayer(this,z,M,R)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const M=this.style._layers[d[this.currentLayer]],z=n._getLayerSourceCache(M);M.isSky()&&this.renderLayer(this,z,M,z?w[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;){const M=this.style._layers[d[this.currentLayer]],z=n._getLayerSourceCache(M);if(M.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(M)){if(M.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const R=z?(M.type==="symbol"?S:w)[z.id]:void 0;this._renderTileClippingMasks(M,z,z?_[z.id]:void 0),this.renderLayer(this,z,M,R),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let M=null;a.values(this.style._layers).forEach(z=>{const R=n._getLayerSourceCache(z);R&&!z.isHidden(this.transform.zoom)&&(!M||M.getSource().maxzoom<R.getSource().maxzoom)&&(M=R)}),M&&this.options.showTileBoundaries&&Kc.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const z=M.transform.padding;nd(M,M.transform.height-(z.top||0),3,Vt),nd(M,z.bottom||0,3,ll),rd(M,z.left||0,3,Qf),rd(M,M.transform.width-(z.right||0),3,td);const R=M.transform.centerPoint;(function(F,O,G,Z){oa(F,O-1,G-10,2,20,Z),oa(F,O-10,G-1,20,2,Z)})(M,R.x,M.transform.height-R.y,ia)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%a.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(n,l,d,g){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="sky"||d.type==="custom"||g&&g.length)&&(this.id=d.id,this.gpuTimingStart(d),Kc[d.type](n,l,d,g,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;let d=this.gpuTimers[n.id];d||(d=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:l.createQueryEXT()}),d.calls++,l.beginQueryEXT(l.TIME_ELAPSED_EXT,d.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}queryGpuTimers(n){const l={};for(const d in n){const g=n[d],_=this.context.extTimerQuery,w=_.getQueryObjectEXT(g.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(g.query),l[d]=w}return l}translatePosMatrix(n,l,d,g,_){if(!d[0]&&!d[1])return n;const w=_?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(w){const M=Math.sin(w),z=Math.cos(w);d=[d[0]*z-d[1]*M,d[0]*M+d[1]*z]}const S=[_?d[0]:Ot(l,d[0],this.transform.zoom),_?d[1]:Ot(l,d[1],this.transform.zoom),0],C=new Float32Array(16);return a.translate(C,n,S),C}saveTileTexture(n){const l=this._tileTextures[n.size[0]];l?l.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const l=this.imageManager.getPattern(n.from.toString()),d=this.imageManager.getPattern(n.to.toString());return!l||!d}currentGlobalDefines(){const n=this.terrain&&this.terrain.renderingToTexture,l=this.style&&this.style.fog,d=[];return this.terrain&&!this.terrain.renderingToTexture&&d.push("TERRAIN"),l&&!n&&l.getOpacity(this.transform.pitch)!==0&&d.push("FOG"),n&&d.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&d.push("OVERDRAW_INSPECTOR"),d}useProgram(n,l,d){this.cache=this.cache||{};const g=d||[],_=this.currentGlobalDefines().concat(g),w=tl.cacheKey(n,_,l);return this.cache[w]||(this.cache[w]=new tl(this.context,n,Xa[n],l,Gc[n],_)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(n){this.terrain&&this.terrain.prepareDrawTile(n)}prepareDrawProgram(n,l,d){if(this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const _=g.getOpacity(this.transform.pitch);_!==0&&l.setFogUniformValues(n,((w,S,C,M)=>{const z=S.properties.get("color"),R=w.frameCounter/1e3%1,F=[z.r/z.a,z.g/z.a,z.b/z.a,M];return{u_fog_matrix:C?w.transform.calculateFogTileMatrix(C):w.identityMat,u_fog_range:S.getFovAdjustedRange(w.transform._fov),u_fog_color:F,u_fog_horizon_blend:S.properties.get("horizon-blend"),u_fog_temporal_offset:R}})(this,g,d,_))}}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const n=this.context.gl,l=n.createTexture();return n.bindTexture(n.TEXTURE_2D,l),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}}class as{constructor(n=0,l=0,d=0,g=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(d)||d<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=d,this.right=g}interpolate(n,l,d){return l.top!=null&&n.top!=null&&(this.top=a.number(n.top,l.top,d)),l.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,l.bottom,d)),l.left!=null&&n.left!=null&&(this.left=a.number(n.left,l.left,d)),l.right!=null&&n.right!=null&&(this.right=a.number(n.right,l.right,d)),this}getCenter(n,l){const d=a.clamp((this.left+n-this.right)/2,0,n),g=a.clamp((this.top+l-this.bottom)/2,0,l);return new a.pointGeometry(d,g)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new as(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mr(h,n){return[h[4*n],h[4*n+1],h[4*n+2],h[4*n+3]]}function Yc(h,n,l){h[4*n+0]=l[0],h[4*n+1]=l[1],h[4*n+2]=l[2],h[4*n+3]=l[3]}function dl(h,n){const l=mr(h,3);a.fromQuat(h,n),Yc(h,3,l)}function Qc(h,n){Yc(h,3,[n[0],n[1],n[2],1])}function ro(h,n){const l=a.identity$1([]);return a.rotateZ$1(l,l,-n),a.rotateX$1(l,l,-h),l}function ls(h,n){const l=[h[0],h[1],0],d=[n[0],n[1],0];if(a.length(l)>=1e-15){const w=a.normalize([],l);a.scale(d,w,a.dot(d,w)),n[0]=d[0],n[1]=d[1]}const g=a.cross([],n,h);if(a.len(g)<1e-15)return null;const _=Math.atan2(-g[1],g[0]);return ro(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),_)}class pl{constructor(n,l){this.position=n,this.orientation=l}get position(){return this._position}set position(n){this._position=this._renderWorldCopies?function(l){if(!l)return;const d=Array.isArray(l)?new a.MercatorCoordinate(l[0],l[1],l[2]):l;return d.x=a.wrap(d.x,0,1),d}(n):n}lookAtPoint(n,l){if(this.orientation=null,!this.position)return;const d=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(n)):0,g=this.position,_=a.MercatorCoordinate.fromLngLat(n,d),w=[_.x-g.x,_.y-g.y,_.z-g.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=ls(w,l)}setPitchBearing(n,l){this.orientation=ro(a.degToRad(n),a.degToRad(-l))}}class Jc{constructor(n,l){this._transform=a.identity([]),this._orientation=a.identity$1([]),l&&(this._orientation=l,dl(this._transform,this._orientation)),n&&Qc(this._transform,n)}get mercatorPosition(){const n=this.position;return new a.MercatorCoordinate(n[0],n[1],n[2])}get position(){const n=mr(this._transform,3);return[n[0],n[1],n[2]]}set position(n){Qc(this._transform,n)}get orientation(){return this._orientation}set orientation(n){this._orientation=n,dl(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,l){this._orientation=ro(n,l),dl(this._transform,this._orientation)}forward(){const n=mr(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=mr(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=mr(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,l){const d=new Float64Array(16);return a.invert(d,this.getWorldToCamera(n,l)),d}getWorldToCameraPosition(n,l,d){const g=this.position;a.scale(g,g,-n);const _=new Float64Array(16);return a.fromScaling(_,[d,d,d]),a.translate(_,_,g),_[10]*=l,_}getWorldToCamera(n,l){const d=new Float64Array(16),g=new Float64Array(4),_=this.position;return a.conjugate(g,this._orientation),a.scale(_,_,-n),a.fromQuat(d,g),a.translate(d,d,_),d[1]*=-1,d[5]*=-1,d[9]*=-1,d[13]*=-1,d[8]*=l,d[9]*=l,d[10]*=l,d[11]*=l,d}getCameraToClipPerspective(n,l,d,g){const _=new Float64Array(16);return a.perspective(_,n,l,d,g),_}getDistanceToElevation(n){const l=n===0?0:a.mercatorZfromAltitude(n,this.position[1]),d=this.forward();return(l-this.position[2])/d[2]}clone(){return new Jc([...this.position],[...this.orientation])}}class cs{constructor(n,l,d,g,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=d==null?0:d,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new as,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new Jc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const n=new cs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._cameraZoom=this._cameraZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._averageElevation=this._averageElevation,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,n?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(n){this._terrainEnabled()&&this._cameraZoom==null&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),n&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const l=-a.wrap(n,-180,180)*Math.PI/180;var d;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=(d=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d),function(g,_,w){var S=_[0],C=_[1],M=_[2],z=_[3],R=Math.sin(w),F=Math.cos(w);g[0]=S*F+M*R,g[1]=C*F+z*R,g[2]=S*-R+M*F,g[3]=C*-R+z*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const l=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(n){const l=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const n=this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(this.center),-1);return n===-1?(this._cameraZoom=null,!1):(this._centerAltitude=n,!0)}_updateCameraOnTerrain(){const n=this.cameraToCenterDistance/this.worldSize,l=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(l+n)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],d=this.horizonLineFromTop();let g=0,_=0;for(let w=0;w<l.length;w++){const S=new a.pointGeometry(l[w][0]*this.width,d+l[w][1]*(this.height-d)),C=n.pointCoordinate(S);if(!C)continue;const M=1/Math.hypot(C[0]-this._camera.position[0],C[1]-this._camera.position[1]);g+=C[3]*M,_+=M}return _===0?NaN:g/_}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._cameraZoom==null||!this._elevation)return;const n=this._cameraZoom,l=this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(this.center)),d=a.mercatorZfromAltitude(l,this.center.lat),g=this._mercatorZfromZoom(n),_=this._mercatorZfromZoom(this._maxZoom),w=Math.max(g-d,_);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let d;d=n.z<this._camera.position[2]?[l.x,l.y,l.z]:[n.x,n.y,n.z];const g=a.length(a.sub([],this._camera.position,d));return a.clamp(this._zoomFromMercatorZ(g),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let l=!1;if(n.orientation&&!a.exactEquals(n.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(n.orientation)),n.position){const d=[n.position.x,n.position.y,n.position.z];a.exactEquals$1(d,this._camera.position)||(this._setCameraPosition(d),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,l=new pl;return l.position=new a.MercatorCoordinate(n[0],n[1],n[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this._renderWorldCopies,l}_setCameraOrientation(n){if(!a.length$1(n))return!1;a.normalize$1(n,n);const l=a.transformQuat([],[0,0,-1],n),d=a.transformQuat([],[0,-1,0],n);if(d[2]<0)return!1;const g=ls(l,d);return!!g&&(this._camera.orientation=g,!0)}_setCameraPosition(n){const l=this.zoomScale(this.minZoom)*this.tileSize,d=this.zoomScale(this.maxZoom)*this.tileSize,g=this.cameraToCenterDistance;n[2]=a.clamp(n[2],g/d,g/l),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,d){this._unmodified=!1,this._edgeInsets.interpolate(n,l,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const l=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(n){const l=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies){const d=this.pointCoordinate(new a.pointGeometry(0,0)),g=this.pointCoordinate(new a.pointGeometry(this.width,0)),_=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new a.pointGeometry(0,this.height)),S=Math.floor(Math.min(d.x,g.x,_.x,w.x)),C=Math.floor(Math.max(d.x,g.x,_.x,w.x)),M=1;for(let z=S-M;z<=C+M;z++)z!==0&&l.push(new a.UnwrappedTileID(z,n))}return l}coveringTiles(n){let l=this.coveringZoomLevel(n);const d=l,g=this.elevation&&!n.isTerrainDEM;if(n.minzoom!==void 0&&l<n.minzoom)return[];n.maxzoom!==void 0&&l>n.maxzoom&&(l=n.maxzoom);const _=a.MercatorCoordinate.fromLngLat(this.center),w=1<<l,S=[w*_.x,w*_.y,0],C=xe.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l),M=this.pointCoordinate(this.getCameraPoint()),z=w*a.mercatorZfromAltitude(1,this.center.lat),R=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),F=[w*M.x,w*M.y,R],O=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),G=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?l:0,Z=n.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ne=n.isTerrainDEM?-Z:this._elevation?this._elevation.getMinElevationBelowMSL():0,V=de=>({aabb:new Ve([de*w,0,ne],[(de+1)*w,w,Z]),zoom:0,x:0,y:0,wrap:de,fullyVisible:!1}),X=[];let te=[];const se=l,ue=n.reparseOverscaled?d:l,Y=de=>{if(!this._elevation||!de.tileID)return;const Ee=this._elevation.getMinMaxForTile(de.tileID),Je=de.aabb;Ee?(Je.min[2]=Ee.min,Je.max[2]=Ee.max,Je.center[2]=(Je.min[2]+Je.max[2])/2):(de.shouldSplit=De(de),de.shouldSplit||(Je.min[2]=Je.max[2]=Je.center[2]=this._centerAltitude))},pe=de=>de*de,ke=pe((R-this._centerAltitude)*z),De=de=>{if(de.zoom<G)return!0;if(de.zoom===se)return!1;if(de.shouldSplit!=null)return de.shouldSplit;const Ee=de.aabb.distanceX(F),Je=de.aabb.distanceY(F);let tt=ke;g&&(tt=pe(de.aabb.distanceZ(F)*z));const et=Ee*Ee+Je*Je+tt;return et<pe((1<<se-de.zoom)*O*((Ue,it)=>{if(it*pe(.707)<Ue)return 1;const kt=Math.sqrt(it/Ue);return kt/(1.4144271570014144+(Math.pow(1.1,kt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(tt,ke),et))};if(this._renderWorldCopies)for(let de=1;de<=3;de++)X.push(V(-de)),X.push(V(de));for(X.push(V(0));X.length>0;){const de=X.pop(),Ee=de.x,Je=de.y;let tt=de.fullyVisible;if(!tt){const et=de.aabb.intersects(C);if(et===0)continue;tt=et===2}if(de.zoom!==se&&De(de))for(let et=0;et<4;et++){const Ue=(Ee<<1)+et%2,it=(Je<<1)+(et>>1),kt={aabb:de.aabb.quadrant(et),zoom:de.zoom+1,x:Ue,y:it,wrap:de.wrap,fullyVisible:tt,tileID:void 0,shouldSplit:void 0};g&&(kt.tileID=new a.OverscaledTileID(de.zoom+1===se?ue:de.zoom+1,de.wrap,de.zoom+1,Ue,it),Y(kt)),X.push(kt)}else{const et=de.zoom===se?ue:de.zoom;if(n.minzoom&&n.minzoom>et)continue;const Ue=S[0]-(.5+Ee+(de.wrap<<de.zoom))*(1<<l-de.zoom),it=S[1]-.5-Je,kt=de.tileID?de.tileID:new a.OverscaledTileID(et,de.wrap,de.zoom,Ee,Je);te.push({tileID:kt,distanceSq:Ue*Ue+it*it})}}if(this.fogCullDistSq){const de=this.fogCullDistSq,Ee=this.horizonLineFromTop();te=te.filter(Je=>{const tt=[0,0,0,1],et=[a.EXTENT,a.EXTENT,0,1],Ue=this.calculateFogTileMatrix(Je.tileID.toUnwrapped());a.transformMat4(tt,tt,Ue),a.transformMat4(et,et,Ue);const it=a.getAABBPointSquareDist(tt,et);if(it===0)return!0;let kt=!1;const gt=this._elevation;if(gt&&it>de&&Ee!==0){const vn=this.calculateProjMatrix(Je.tileID.toUnwrapped());let dn;n.isTerrainDEM||(dn=gt.getMinMaxForTile(Je.tileID)),dn||(dn={min:ne,max:Z});const xt=a.furthestTileCorner(this.bearing),It=[xt[0]*a.EXTENT,xt[1]*a.EXTENT,dn.max];a.transformMat4$1(It,It,vn),kt=(1-It[1])*this.height*.5<Ee}return it<de||kt})}return te.sort((de,Ee)=>de.distanceSq-Ee.distanceSq).map(de=>de.tileID)}resize(n,l){this.width=n,this.height=l,this.pixelsToGLUnits=[2/n,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const l=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(l)*this.worldSize)}unproject(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(n,l){const d=this.pointCoordinate(l),g=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(n),w=new a.MercatorCoordinate(_.x-(d.x-g.x),_.y-(d.y-g.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(n){this.center=this.coordinateLocation(n),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n){return this._coordinatePoint(this.locationCoordinate(n),!1)}locationPoint3D(n){return this._coordinatePoint(this.locationCoordinate(n),!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n){return a.MercatorCoordinate.fromLngLat(n)}coordinateLocation(n){return n.toLngLat()}pointRayIntersection(n,l){const d=l!=null?l:this._centerAltitude,g=[n.x,n.y,0,1],_=[n.x,n.y,1,1];a.transformMat4(g,g,this.pixelMatrixInverse),a.transformMat4(_,_,this.pixelMatrixInverse);const w=_[3];a.scale$2(g,g,1/g[3]),a.scale$2(_,_,1/w);const S=g[2],C=_[2];return{p0:g,p1:_,t:S===C?0:(d-S)/(C-S)}}screenPointToMercatorRay(n){const l=[n.x,n.y,0,1],d=[n.x,n.y,1,1];return a.transformMat4(l,l,this.pixelMatrixInverse),a.transformMat4(d,d,this.pixelMatrixInverse),a.scale$2(l,l,1/l[3]),a.scale$2(d,d,1/d[3]),l[2]=a.mercatorZfromAltitude(l[2],this._center.lat)*this.worldSize,d[2]=a.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,a.scale$2(l,l,1/this.worldSize),a.scale$2(d,d,1/this.worldSize),new Te([l[0],l[1],l[2]],a.normalize([],a.sub([],d,l)))}rayIntersectionCoordinate(n){const{p0:l,p1:d,t:g}=n,_=a.mercatorZfromAltitude(l[2],this._center.lat),w=a.mercatorZfromAltitude(d[2],this._center.lat);return new a.MercatorCoordinate(a.number(l[0],d[0],g)/this.worldSize,a.number(l[1],d[1],g)/this.worldSize,a.number(_,w,g))}pointCoordinate(n,l=this._centerAltitude){const d=this.horizonLineFromTop(!1),g=new a.pointGeometry(n.x,Math.max(d,n.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(g,l))}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);const l=this.elevation;let d=this.elevation.pointCoordinate(n);if(d)return new a.MercatorCoordinate(d[0],d[1],d[2]);let g=0,_=this.horizonLineFromTop();if(n.y>_)return this.pointCoordinate(n);const w=.02*_,S=n.clone();for(let C=0;C<10&&_-g>w;C++){S.y=a.number(g,_,.66);const M=l.pointCoordinate(S);M?(_=S.y,d=M):g=S.y}return d?new a.MercatorCoordinate(d[0],d[1],d[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){if(this.elevation)return!this.elevation.pointCoordinate(n);{const l=this.horizonLineFromTop();return n.y<l}}_coordinatePoint(n,l){const d=l&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,g=[n.x*this.worldSize,n.y*this.worldSize,d+n.toAltitude(),1];return a.transformMat4(g,g,this.pixelMatrix),g[3]>0?new a.pointGeometry(g[0]/g[3],g[1]/g[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(n,l){const d=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),g=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),_=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),w=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let S=this.pointCoordinate(d,n),C=this.pointCoordinate(g,n);const M=this.pointCoordinate(_,l),z=this.pointCoordinate(w,l),R=(F,O)=>(O.y-F.y)/(O.x-F.x);return S.y>1&&C.y>=0?S=new a.MercatorCoordinate((1-z.y)/R(z,S)+z.x,1):S.y<0&&C.y<=1&&(S=new a.MercatorCoordinate(-z.y/R(z,S)+z.x,0)),C.y>1&&S.y>=0?C=new a.MercatorCoordinate((1-M.y)/R(M,C)+M.x,1):C.y<0&&S.y<=1&&(C=new a.MercatorCoordinate(-M.y/R(M,C)+M.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(S)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(z)).extend(this.coordinateLocation(M))}_getBounds3D(){const n=this.elevation,l=n.visibleDemTiles.reduce((d,g)=>{if(g.dem){const _=g.dem.tree;d.min=Math.min(d.min,_.minimums[0]),d.max=Math.max(d.max,_.maximums[0])}return d},{min:Number.MAX_VALUE,max:0});return this._getBounds(l.min*n.exaggeration(),l.max*n.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(n=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,d=this.height/2-l*(1-this._horizonShift);return n?Math.max(0,d):d}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(n){if(n){const l=n.getEast(),d=n.getWest();this.lngRange=[d,l>d?l:l+360],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()}else this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}calculatePosMatrix(n,l){const d=n.canonical,g=l/this.zoomScale(d.z),_=d.x+Math.pow(2,d.z)*n.wrap,w=a.identity(new Float64Array(16));return a.translate(w,w,[_*g,d.y*g,0]),a.scale$1(w,w,[g/a.EXTENT,g/a.EXTENT,1]),w}calculateFogTileMatrix(n){const l=n.key,d=this._fogTileMatrixCache;if(d[l])return d[l];const g=this.calculatePosMatrix(n,this.cameraWorldSize);return a.multiply(g,this.worldToFogMatrix,g),d[l]=new Float32Array(g),d[l]}calculateProjMatrix(n,l=!1){const d=n.key,g=l?this._alignedProjMatrixCache:this._projMatrixCache;if(g[d])return g[d];const _=this.calculatePosMatrix(n,this.worldSize);return a.multiply(_,l?this.alignedProjMatrix:this.projMatrix,_),g[d]=new Float32Array(_),g[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const n=this._elevation;this._updateCameraState();const l=this._camera.position,d=this._camera.forward();if(l[2]<=0||d[2]>=0)return;const g=a.mercatorZfromAltitude(1,this._center.lat);l[2]/=g,d[2]/=g,a.normalize(d,d);const _=n.raycast(l,d,n.exaggeration());if(_){const w=a.scaleAndAdd([],l,d,_),S=new a.MercatorCoordinate(w[0],w[1],a.mercatorZfromAltitude(w[2],a.latFromMercatorY(w[1]))),C=this._camera.position,M=S.z+a.length([S.x-C[0],S.y-C[1],S.z-C[2]]);this._cameraZoom=this._zoomFromMercatorZ(M),this._centerAltitude=S.toAltitude(),this._center=S.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const n=this._elevation;this._updateCameraState();const l=n.getAtPointOrZero(this._camera.mercatorPosition),d=this._minimumHeightOverTerrain()*Math.cos(a.degToRad(this._maxPitch)),g=a.mercatorZfromAltitude(l,this._center.lat),_=this._camera.position[2]-g;if(_<d){const w=a.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),S=this._camera.mercatorPosition,C=[w.x-S.x,w.y-S.y,w.z-S.z],M=a.length(C);C[2]-=d-_;const z=a.length(C);if(z===0)return;a.scale(C,C,M/z),this._camera.position=[w.x-C[0],w.y-C[1],w.z-C[2]],this._camera.orientation=ls(C,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,l,d,g,_,w=1/0,S=-1/0;const C=this.size,M=this._unmodified;if(this.latRange){const O=this.latRange;w=a.mercatorYfromLat(O[1])*this.worldSize,S=a.mercatorYfromLat(O[0])*this.worldSize,d=S-w<C.y?C.y/(S-w):0}if(this.lngRange){const O=this.lngRange;n=a.mercatorXfromLng(O[0])*this.worldSize,l=a.mercatorXfromLng(O[1])*this.worldSize,g=l-n<C.x?C.x/(l-n):0}const z=this.point,R=Math.max(g||0,d||0);if(R)return this.center=this.unproject(new a.pointGeometry(g?(l+n)/2:z.x,d?(S+w)/2:z.y)),this.zoom+=this.scaleZoom(R),this._unmodified=M,void(this._constraining=!1);if(this.latRange){const O=z.y,G=C.y/2;O-G<w&&(_=w+G),O+G>S&&(_=S-G)}let F=z.x;if(this.lngRange){const O=this.worldSize/2-(n+l)/2;F=(F+O+this.worldSize)%this.worldSize,n+=O,l+=O;const G=C.x/2;F-G<n&&(F=n+G),F+G>l&&(F=l-G),F-=O}F===z.x&&_===void 0||(this.center=this.unproject(new a.pointGeometry(F,_!==void 0?_:z.y))),this._constrainCameraAltitude(),this._unmodified=M,this._constraining=!1}_minZoomForBounds(){const n=(g,_)=>Math.log2(g/(this.tileSize*Math.abs(_[1]-_[0])));let l=0;if(this.latRange){const g=this.latRange;l=n(this.height,[a.mercatorYfromLat(g[0]),a.mercatorYfromLat(g[1])])}let d=0;if(this.lngRange){const g=this.lngRange;d=n(this.width,[a.mercatorXfromLng(g[0]),a.mercatorXfromLng(g[1])])}return Math.max(l,d)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const l=this.pixelsPerMeter;this._updateCameraState();const d=Math.PI/2+this._pitch,g=this.fovAboveCenter,_=this.elevation?this.elevation.getMinElevationBelowMSL()*l:0,w=(this._camera.position[2]*this.worldSize-_)/Math.cos(this._pitch),S=Math.sin(g)*w/Math.sin(a.clamp(Math.PI-d-g,.01,Math.PI-.01)),C=this.point,M=C.x,z=C.y,R=Math.cos(Math.PI/2-this._pitch)*S+w,F=Math.min(1.01*R,w*(1/this._horizonShift)),O=this.height/50,G=this._camera.getWorldToCamera(this.worldSize,l),Z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,O,F);Z[8]=2*-n.x/this.width,Z[9]=2*n.y/this.height;let ne=a.mul$1([],Z,G);this.mercatorMatrix=a.scale$1([],ne,[this.worldSize,this.worldSize,this.worldSize/l]),this.projMatrix=ne,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const V=new Float32Array(16);a.identity(V),a.scale$1(V,V,[1,-1,1]),a.rotateX(V,V,this._pitch),a.rotateZ(V,V,this.angle);const X=a.perspective(new Float32Array(16),this._fov,this.width/this.height,O,F),te=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;X[8]=2*-n.x/this.width,X[9]=2*(n.y+te)/this.height,this.skyboxMatrix=a.multiply(V,X,V);const se=this.width%2/2,ue=this.height%2/2,Y=Math.cos(this.angle),pe=Math.sin(this.angle),ke=M-Math.round(M)+Y*se+pe*ue,De=z-Math.round(z)+Y*ue+pe*se,de=new Float64Array(ne);if(a.translate(de,de,[ke>.5?ke-1:ke,De>.5?De-1:De,0]),this.alignedProjMatrix=de,ne=a.create$1(),a.scale$1(ne,ne,[this.width/2,-this.height/2,1]),a.translate(ne,ne,[1,-1,0]),this.labelPlaneMatrix=ne,ne=a.create$1(),a.scale$1(ne,ne,[1,-1,1]),a.translate(ne,ne,[-1,-1,0]),a.scale$1(ne,ne,[2/this.width,2/this.height,1]),this.glCoordMatrix=ne,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),ne=a.invert(new Float64Array(16),this.pixelMatrix),!ne)throw new Error("failed to invert matrix");this.pixelMatrixInverse=ne,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSize,l=this.cameraPixelsPerMeter,d=this._camera.position,g=1/this.height,_=[n,n,l];a.scale(_,_,g),a.scale(d,d,-1),a.multiply$1(d,d,_);const w=a.create$1();a.translate(w,w,d),a.scale$1(w,w,_),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,l,g)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const n=this._camera.forward(),l=this.cameraToCenterDistance,d=this.point,g=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-a.mercatorZfromAltitude(this._centerAltitude,this.center.lat),_=this.cameraToCenterDistance/g;this._camera.position=[d.x/this.worldSize-n[0]*l/_,d.y/this.worldSize-n[1]*l/_,a.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-n[2]*l/_]}_translateCameraConstrained(n){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),d=n[2];let g=1;d>0&&(g=Math.min((l-this._camera.position[2])/d,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,n,g),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,l=this._camera.forward(),{pitch:d,bearing:g}=this._camera.getPitchBearing(),_=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat),w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),S=Math.max((n[2]-_)/Math.cos(d),w),C=this._zoomFromMercatorZ(S);a.scaleAndAdd(n,n,l,S),this._pitch=a.clamp(d,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(g,-Math.PI,Math.PI),this._setZoom(a.clamp(C,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new a.MercatorCoordinate(n[0],n[1],n[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min((this._cameraZoom!=null?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}_terrainEnabled(){return!!this._elevation}isCornerOffEdge(n,l){const d=Math.min(n.x,l.x),g=Math.max(n.x,l.x),_=Math.min(n.y,l.y),w=Math.max(n.y,l.y);if(_<this.horizonLineFromTop(!1))return!0;const S=[new a.pointGeometry(d,_),new a.pointGeometry(g,w),new a.pointGeometry(d,w),new a.pointGeometry(g,_)],C=this._renderWorldCopies?-3:0,M=this._renderWorldCopies?4:1;for(const z of S){const R=this.pointRayIntersection(z);if(R.t<0)return!0;const F=this.rayIntersectionCoordinate(R);if(F.x<C||F.y<0||F.x>M||F.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.isCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(n,l){const d=a.length(a.sub([],this._camera.position,n)),g=this._zoomFromMercatorZ(d)+l;return d-this._mercatorZfromZoom(g)}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,n))}}function id(h,n){let l=!1,d=null;const g=()=>{d=null,l&&(h(),d=setTimeout(g,n),l=!1)};return()=>(l=!0,d||g(),d)}class od{constructor(n){this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=id(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const l=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,g=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,g),w=Math.round(l.lng*_)/_,S=Math.round(l.lat*_)/_,C=this._map.getBearing(),M=this._map.getPitch();let z="";if(z+=n?`/${w}/${S}/${d}`:`${d}/${S}/${w}`,(C||M)&&(z+="/"+Math.round(10*C)/10),M&&(z+=`/${Math.round(M)}`),this._hashName){const R=this._hashName;let F=!1;const O=a.window.location.hash.slice(1).split("&").map(G=>{const Z=G.split("=")[0];return Z===R?(F=!0,`${Z}=${z}`):G}).filter(G=>G);return F||O.push(`${R}=${z}`),`#${O.join("&")}`}return`#${z}`}_getCurrentHash(){const n=a.window.location.hash.replace("#","");if(this._hashName){let l;return n.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(l=d)}),(l&&l[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(l=>isNaN(l))){const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:l,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,n)}}const Mo={linearity:.3,easing:a.bezier(0,0,.3,1)},eu=a.extend({deceleration:2500,maxSpeed:1400},Mo),sd=a.extend({deceleration:20,maxSpeed:1400},Mo),ad=a.extend({deceleration:1e3,maxSpeed:360},Mo),fl=a.extend({deceleration:1e3,maxSpeed:90},Mo);class tu{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=a.exported.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)l.zoom+=_.zoomDelta||0,l.bearing+=_.bearingDelta||0,l.pitch+=_.pitchDelta||0,_.panDelta&&l.pan._add(_.panDelta),_.around&&(l.around=_.around),_.pinchAround&&(l.pinchAround=_.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(l.pan.mag()){const _=aa(l.pan.mag(),d,a.extend({},eu,n||{}));g.offset=l.pan.mult(_.amount/l.pan.mag()),g.center=this._map.transform.center,sa(g,_)}if(l.zoom){const _=aa(l.zoom,d,sd);g.zoom=this._map.transform.zoom+_.amount,sa(g,_)}if(l.bearing){const _=aa(l.bearing,d,ad);g.bearing=this._map.transform.bearing+a.clamp(_.amount,-179,179),sa(g,_)}if(l.pitch){const _=aa(l.pitch,d,fl);g.pitch=this._map.transform.pitch+_.amount,sa(g,_)}if(g.zoom||g.bearing){const _=l.pinchAround===void 0?l.around:l.pinchAround;g.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),a.extend(g,{noMoveStart:!0})}}function sa(h,n){(!h.duration||h.duration<n.duration)&&(h.duration=n.duration,h.easing=n.easing)}function aa(h,n,l){const{maxSpeed:d,linearity:g,deceleration:_}=l,w=a.clamp(h*g/(n/1e3),-d,d),S=Math.abs(w)/(_*g);return{easing:l.easing,duration:1e3*S,amount:w*(S/2)}}class br extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d,g={}){const _=q.mousePos(l.getCanvasContainer(),d),w=l.unproject(_);super(n,a.extend({point:_,lngLat:w,originalEvent:d},g)),this._defaultPrevented=!1,this.target=l}}class la extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){const g=n==="touchend"?d.changedTouches:d.touches,_=q.touchPos(l.getCanvasContainer(),g),w=_.map(C=>l.unproject(C)),S=_.reduce((C,M,z,R)=>C.add(M.div(R.length)),new a.pointGeometry(0,0));super(n,{points:_,point:S,lngLats:w,lngLat:l.unproject(S),originalEvent:d}),this._defaultPrevented=!1}}class ld extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){super(n,{originalEvent:d}),this._defaultPrevented=!1}}class us{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new ld(n.type,this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new br(n.type,this._map,n))}mouseup(n){this._map.fire(new br(n.type,this._map,n))}preclick(n){const l=a.extend({},n);l.type="preclick",this._map.fire(new br(l.type,this._map,l))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(n),this._map.fire(new br(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new br(n.type,this._map,n))}mouseover(n){this._map.fire(new br(n.type,this._map,n))}mouseout(n){this._map.fire(new br(n.type,this._map,n))}touchstart(n){return this._firePreventable(new la(n.type,this._map,n))}touchmove(n){this._map.fire(new la(n.type,this._map,n))}touchend(n){this._map.fire(new la(n.type,this._map,n))}touchcancel(n){this._map.fire(new la(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cd{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(n){this._map.fire(new br(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new br("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new br(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ud{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(q.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const d=l;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=d,this._box||(this._box=q.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const _=Math.min(g.x,d.x),w=Math.max(g.x,d.x),S=Math.min(g.y,d.y),C=Math.max(g.y,d.y);this._map._requestDomTask(()=>{this._box&&(q.setTransform(this._box,`translate(${_}px,${S}px)`),this._box.style.width=w-_+"px",this._box.style.height=C-S+"px")})}mouseupWindow(n,l){if(!this._active||n.button!==0)return;const d=this._startPos,g=l;if(this.reset(),q.suppressClick(),d.x!==g.x||d.y!==g.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:_=>_.fitScreenCoordinates(d,g,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new a.Event(n,{originalEvent:l}))}}function ml(h,n){const l={};for(let d=0;d<h.length;d++)l[h[d].identifier]=n[d];return l}class hd{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,l,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),d.length===this.numTouches&&(this.centroid=function(g){const _=new a.pointGeometry(0,0);for(const w of g)_._add(w);return _.div(g.length)}(l),this.touches=ml(d,l)))}touchmove(n,l,d){if(this.aborted||!this.centroid)return;const g=ml(d,l);for(const _ in this.touches){const w=this.touches[_],S=g[_];(!S||S.dist(w)>30)&&(this.aborted=!0)}}touchend(n,l,d){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class gl{constructor(n){this.singleTap=new hd(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,l,d){this.singleTap.touchstart(n,l,d)}touchmove(n,l,d){this.singleTap.touchmove(n,l,d)}touchend(n,l,d){const g=this.singleTap.touchend(n,l,d);if(g){const _=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(g)<30;if(_&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class dd{constructor(){this._zoomIn=new gl({numTouches:1,numTaps:2}),this._zoomOut=new gl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,d){this._zoomIn.touchstart(n,l,d),this._zoomOut.touchstart(n,l,d)}touchmove(n,l,d){this._zoomIn.touchmove(n,l,d),this._zoomOut.touchmove(n,l,d)}touchend(n,l,d){const g=this._zoomIn.touchend(n,l,d),_=this._zoomOut.touchend(n,l,d);return g?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(g)},{originalEvent:n})}):_?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(_)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const gr={0:1,2:2};class nu{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(n,l){return!1}_move(n,l){return{}}mousedown(n,l){if(this._lastPoint)return;const d=q.mouseButton(n);this._correctButton(n,d)&&(this._lastPoint=l,this._eventButton=d)}mousemoveWindow(n,l){const d=this._lastPoint;if(d){if(n.preventDefault(),function(g,_){const w=gr[_];return g.buttons===void 0||(g.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(l.dist(d)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(d,l)}}mouseupWindow(n){this._lastPoint&&q.mouseButton(n)===this._eventButton&&(this._moved&&q.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ui extends nu{mousedown(n,l){super.mousedown(n,l),this._lastPoint&&(this._active=!0)}_correctButton(n,l){return l===0&&!n.ctrlKey}_move(n,l){return{around:l,panDelta:l.sub(n)}}}class ru extends nu{_correctButton(n,l){return l===0&&n.ctrlKey||l===2}_move(n,l){const d=.8*(l.x-n.x);if(d)return this._active=!0,{bearingDelta:d}}contextmenu(n){n.preventDefault()}}class Vi extends nu{_correctButton(n,l){return l===0&&n.ctrlKey||l===2}_move(n,l){const d=-.5*(l.y-n.y);if(d)return this._active=!0,{pitchDelta:d}}contextmenu(n){n.preventDefault()}}class hs{constructor(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(n,l,d){return this._calculateTransform(n,l,d)}touchmove(n,l,d){if(this._active&&!(d.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,l,d)}touchend(n,l,d){this._calculateTransform(n,l,d),this._active&&d.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,d){d.length>0&&(this._active=!0);const g=ml(d,l),_=new a.pointGeometry(0,0),w=new a.pointGeometry(0,0);let S=0;for(const M in g){const z=g[M],R=this._touches[M];R&&(_._add(z),w._add(z.sub(R)),S++,g[M]=z)}if(this._touches=g,S<this._minTouches||!w.mag())return;const C=w.div(S);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(S),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,l,d){return{}}touchstart(n,l,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,d){if(!this._firstTwoTouches)return;n.preventDefault();const[g,_]=this._firstTwoTouches,w=_l(d,l,g),S=_l(d,l,_);if(!w||!S)return;const C=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],C,n)}touchend(n,l,d){if(!this._firstTwoTouches)return;const[g,_]=this._firstTwoTouches,w=_l(d,l,g),S=_l(d,l,_);w&&S||(this._active&&q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function _l(h,n,l){for(let d=0;d<h.length;d++)if(h[d].identifier===l)return n[d]}function pd(h,n){return Math.log(h/n)/Math.LN2}class em extends iu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const d=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(pd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:pd(this._distance,d),pinchAround:l}}}function ou(h,n){return 180*h.angleWith(n)/Math.PI}class ca extends iu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l){const d=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ou(this._vector,d),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,d=ou(n,this._startVector);return Math.abs(d)<l}}function Wr(h){return Math.abs(h.y)>Math.abs(h.x)}class fd extends iu{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(n){this._lastPoints=n,Wr(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,d){const g=n[0].sub(this._lastPoints[0]),_=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(g,_,d.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(g.y+_.y)/2*-.5}}gestureBeginsVertically(n,l,d){if(this._valid!==void 0)return this._valid;const g=n.mag()>=2,_=l.mag()>=2;if(!g&&!_)return;if(!g||!_)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const w=n.y>0==l.y>0;return Wr(n)&&Wr(l)&&w}}const md={panStep:100,bearingStep:15,pitchStep:10};class ua{constructor(){const n=md;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,d=0,g=0,_=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?d=-1:(n.preventDefault(),_=-1);break;case 39:n.shiftKey?d=1:(n.preventDefault(),_=1);break;case 38:n.shiftKey?g=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?g=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,g=0),{cameraAnimation:S=>{const C=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:rt,zoom:l?Math.round(C)+l*(n.shiftKey?2:1):C,bearing:S.getBearing()+d*this._bearingStep,pitch:S.getPitch()+g*this._pitchStep,offset:[-_*this._panStep,-w*this._panStep],center:S.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function rt(h){return h*(2-h)}const su=4.000244140625;class gd{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._handler=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;let l=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const d=a.exported.now(),g=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,l!==0&&l%su==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(g*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=q.mousePos(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform,l=()=>n._terrainEnabled()?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>su?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&M!==0&&(M=1/M);const z=l(),R=Math.pow(2,z),F=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):R;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(F*M))),this._type==="wheel"&&(this._startZoom=l(),this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:l(),g=this._startZoom,_=this._easing;let w,S=!1;if(this._type==="wheel"&&g&&_){const C=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),M=_(C);w=a.number(g,d,M),C<1?this._frameId||(this._frameId=!0):S=!0}else w=d,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:w-l(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=a.ease;if(this._prevEase){const d=this._prevEase,g=(a.exported.now()-d.start)/d.duration,_=d.easing(g+.01)-d.easing(g),w=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-w*w);l=a.bezier(w,S,.25,1)}return this._prevEase={start:a.exported.now(),duration:n,easing:l},l}blur(){this.reset()}reset(){this._active=!1}}class ha{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class da{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,l){return n.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:d.getZoom()+(n.shiftKey?-1:1),around:d.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _d{constructor(){this._tap=new gl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,l,d){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?d.length>0&&(this._swipePoint=l[0],this._swipeTouch=d[0].identifier):this._tap.touchstart(n,l,d))}touchmove(n,l,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const g=l[0],_=g.y-this._swipePoint.y;return this._swipePoint=g,n.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(n,l,d)}touchend(n,l,d){this._tapTime?this._swipePoint&&d.length===0&&this.reset():this._tap.touchend(n,l,d)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yd{constructor(n,l,d){this._el=n,this._mousePan=l,this._touchPan=d}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xd{constructor(n,l,d){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=l,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class vd{constructor(n,l,d,g){this._el=n,this._touchZoom=l,this._touchRotate=d,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const pa=h=>h.zoom||h.drag||h.pitch||h.rotate;class wd extends a.Event{}class bd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,l){const d=a.sub([],l,n);this.radius=a.length(d[2]<0?a.div([],d,this.constants):[d[0],d[1],0])}projectRay(n){a.div(n,n,this.constants),a.normalize(n,n),a.mul$2(n,n,this.constants);const l=a.scale([],n,this.radius);if(l[2]>0){const d=a.scale([],[0,0,1],a.dot(l,[0,0,1])),g=a.scale([],a.normalize([],[l[0],l[1],0]),this.radius),_=a.add([],l,a.scale([],a.sub([],a.add([],g,d),l),2));l[0]=_[0],l[1]=_[1]}return l}}function zo(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class au{constructor(n,l){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new tu(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new bd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),a.bindAll(["handleEvent","handleWindowEvent"],this);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[g,_,w]of this._listeners)q.addEventListener(g,_,g===a.window.document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,l,d]of this._listeners)q.removeEventListener(n,l,n===a.window.document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(n){const l=this._map,d=l.getCanvasContainer();this._add("mapEvent",new us(l,n));const g=l.boxZoom=new ud(l,n);this._add("boxZoom",g);const _=new dd,w=new da;l.doubleClickZoom=new ha(w,_),this._add("tapZoom",_),this._add("clickZoom",w);const S=new _d;this._add("tapDragZoom",S);const C=l.touchPitch=new fd;this._add("touchPitch",C);const M=new ru(n),z=new Vi(n);l.dragRotate=new xd(n,M,z),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const R=new Ui(n),F=new hs(n);l.dragPan=new yd(d,R,F),this._add("mousePan",R),this._add("touchPan",F,["touchZoom","touchRotate"]);const O=new ca,G=new em;l.touchZoomRotate=new vd(d,G,O,S),this._add("touchRotate",O,["touchPan","touchZoom"]),this._add("touchZoom",G,["touchPan","touchRotate"]),this._add("blockableMapEvent",new cd(l));const Z=l.scrollZoom=new gd(l,this);this._add("scrollZoom",Z,["mousePan"]);const ne=l.keyboard=new ua;this._add("keyboard",ne);for(const V of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[V]&&l[V].enable(n[V])}_add(n,l,d){this._handlers.push({handlerName:n,handler:l,allowed:d}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(pa(this._eventsInProgress))||this.isZooming()}_blockedByActive(n,l,d){for(const g in n)if(g!==d&&(!l||l.indexOf(g)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const l=[];for(const d of n)this._el.contains(d.target)&&l.push(d);return l}handleEvent(n,l){this._updatingCamera=!0;const d=n.type==="renderFrame",g=d?void 0:n,_={needsRenderFrame:!1},w={},S={},C=n.touches?this._getMapTouches(n.touches):void 0,M=C?q.touchPos(this._el,C):d?void 0:q.mousePos(this._el,n);for(const{handlerName:F,handler:O,allowed:G}of this._handlers){if(!O.isEnabled())continue;let Z;this._blockedByActive(S,G,F)?O.reset():O[l||n.type]&&(Z=O[l||n.type](n,M,C),this.mergeHandlerResult(_,w,Z,F,g),Z&&Z.needsRenderFrame&&this._triggerRenderFrame()),(Z||O.isActive())&&(S[F]=O)}const z={};for(const F in this._previousActiveHandlers)S[F]||(z[F]=g);this._previousActiveHandlers=S,(Object.keys(z).length||zo(_))&&(this._changes.push([_,w,z]),this._triggerRenderFrame()),(Object.keys(S).length||zo(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:R}=_;R&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],R(this._map))}mergeHandlerResult(n,l,d,g,_){if(!d)return;a.extend(n,d);const w={handlerName:g,originalEvent:d.originalEvent||_};d.zoomDelta!==void 0&&(l.zoom=w),d.panDelta!==void 0&&(l.drag=w),d.pitchDelta!==void 0&&(l.pitch=w),d.bearingDelta!==void 0&&(l.rotate=w)}_applyChanges(){const n={},l={},d={};for(const[g,_,w]of this._changes)g.panDelta&&(n.panDelta=(n.panDelta||new a.pointGeometry(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(n.around=g.around),g.aroundCoord!==void 0&&(n.aroundCoord=g.aroundCoord),g.pinchAround!==void 0&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),a.extend(l,_),a.extend(d,w);this._updateMapTransform(n,l,d),this._changes=[]}_updateMapTransform(n,l,d){const g=this._map,_=g.transform,w=X=>[X.x,X.y,X.z];if((X=>{const te=this._eventsInProgress.drag;return te&&!this._handlersById[te.handlerName].isActive()})()&&!zo(n)){const X=_.zoom;_.cameraElevationReference="sea",_.recenterOnTerrain(),_.cameraElevationReference="ground",X!==_.zoom&&this._map._update(!0)}if(!zo(n))return this._fireEvents(l,d,!0);let{panDelta:S,zoomDelta:C,bearingDelta:M,pitchDelta:z,around:R,aroundCoord:F,pinchAround:O}=n;O!==void 0&&(R=O),(X=>l.drag&&!this._eventsInProgress.drag)()&&R&&(this._dragOrigin=w(_.pointCoordinate3D(R)),this._trackingEllipsoid.setup(_._camera.position,this._dragOrigin)),_.cameraElevationReference="sea",g._stop(!0),R=R||g.transform.centerPoint,M&&(_.bearing+=M),z&&(_.pitch+=z),_._updateCameraState();const G=[0,0,0];if(S){const X=_.screenPointToMercatorRay(R),te=_.screenPointToMercatorRay(R.sub(S)),se=this._trackingEllipsoid.projectRay(X.dir),ue=this._trackingEllipsoid.projectRay(te.dir);G[0]=ue[0]-se[0],G[1]=ue[1]-se[1]}const Z=_.zoom,ne=[0,0,0];if(C){const X=w(F||_.pointCoordinate3D(R)),te={dir:a.normalize([],a.sub([],X,_._camera.position))},se=_.screenPointToMercatorRay(_.centerPoint);if(te.dir[2]<0){const ue=a.altitudeFromMercatorZ(X[2],X[1]),Y=_.rayIntersectionCoordinate(_.pointRayIntersection(_.centerPoint,ue)),pe=_.zoomDeltaToMovement(w(Y),C)*(se.dir[2]/te.dir[2]);a.scale(ne,te.dir,pe)}else if(_._terrainEnabled()){const ue=_.zoomDeltaToMovement(X,C);a.scale(ne,te.dir,ue)}}const V=a.add(G,G,ne);_._translateCameraConstrained(V),C&&Math.abs(_.zoom-Z)>1e-4&&_.recenterOnTerrain(),_.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,d,!0)}_fireEvents(n,l,d){const g=pa(this._eventsInProgress),_=pa(n),w={};for(const z in n){const{originalEvent:R}=n[z];this._eventsInProgress[z]||(w[`${z}start`]=R),this._eventsInProgress[z]=n[z]}!g&&_&&this._fireEvent("movestart",_.originalEvent);for(const z in w)this._fireEvent(z,w[z]);_&&this._fireEvent("move",_.originalEvent);for(const z in n){const{originalEvent:R}=n[z];this._fireEvent(z,R)}const S={};let C;for(const z in this._eventsInProgress){const{handlerName:R,originalEvent:F}=this._eventsInProgress[z];this._handlersById[R].isActive()||(delete this._eventsInProgress[z],C=l[R]||F,S[`${z}end`]=C)}for(const z in S)this._fireEvent(z,S[z]);const M=pa(this._eventsInProgress);if(d&&(g||_)&&!M){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),R=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;z?(R(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:C})):(this._map.fire(new a.Event("moveend",{originalEvent:C})),R(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new a.Event(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new wd("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class yl extends a.Evented{constructor(n,l){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}panBy(n,l,d){return n=a.pointGeometry.convert(n).mult(-1),this.panTo(this.transform.center,a.extend({offset:n},l),d)}panTo(n,l,d){return this.easeTo(a.extend({center:n},l),d)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,d){return this.easeTo(a.extend({zoom:n},l),d)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,d){return this.easeTo(a.extend({bearing:n},l),d)}resetNorth(n,l){return this.rotateTo(0,a.extend({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}cameraForBounds(n,l){n=a.LngLatBounds.convert(n);const d=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),d,l)}_extendCameraOptions(n){const l={top:0,bottom:0,right:0,left:0};if(typeof(n=a.extend({padding:l,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=="number"){const d=n.padding;n.padding={top:d,bottom:d,right:d,left:d}}return n.padding=a.extend(l,n.padding),n}_cameraForBoxAndBearing(n,l,d,g){const _=this._extendCameraOptions(g),w=this.transform,S=w.padding,C=w.project(a.LngLat.convert(n)),M=w.project(a.LngLat.convert(l)),z=C.rotate(-a.degToRad(d)),R=M.rotate(-a.degToRad(d)),F=new a.pointGeometry(Math.max(z.x,R.x),Math.max(z.y,R.y)),O=new a.pointGeometry(Math.min(z.x,R.x),Math.min(z.y,R.y)),G=F.sub(O),Z=(w.width-(S.left+S.right+_.padding.left+_.padding.right))/G.x,ne=(w.height-(S.top+S.bottom+_.padding.top+_.padding.bottom))/G.y;if(ne<0||Z<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const V=Math.min(w.scaleZoom(w.scale*Math.min(Z,ne)),_.maxZoom),X=typeof _.offset.x=="number"?new a.pointGeometry(_.offset.x,_.offset.y):a.pointGeometry.convert(_.offset),te=new a.pointGeometry((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(d*Math.PI/180),se=X.add(te).mult(w.scale/w.zoomScale(V));return{center:w.unproject(C.add(M).div(2).sub(se)),zoom:V,bearing:d}}_cameraForBox(n,l,d,g,_){const w=this._extendCameraOptions(_);d=d||0,g=g||0,n=a.LngLat.convert(n),l=a.LngLat.convert(l);const S=this.transform.clone();S.padding=w.padding;const C=this.getFreeCameraOptions(),M=new a.LngLat(.5*(n.lng+l.lng),.5*(n.lat+l.lat)),z=.5*(d+g);if(S._camera.position[2]<a.mercatorZfromAltitude(z,M.lat))return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");C.lookAtPoint(M),S.setFreeCameraOptions(C);const R=a.MercatorCoordinate.fromLngLat(n),F=a.MercatorCoordinate.fromLngLat(l),O=S.pointRayIntersection(S.centerPoint,z),G=[(Z=S.rayIntersectionCoordinate(O)).x,Z.y,Z.z];var Z;const ne=S.screenPointToMercatorRay(S.centerPoint);let V,X=0;do{const te=Math.floor(S.zoom),se=1<<te,ue=Math.min(se*R.x,se*F.x),Y=Math.min(se*R.y,se*F.y),pe=Math.max(se*R.x,se*F.x),ke=Math.max(se*R.y,se*F.y),De=new Ve([ue,Y,d],[pe,ke,g]),de=xe.fromInvProjectionMatrix(S.invProjMatrix,S.worldSize,te);if(De.intersects(de)!==2){V&&(S._camera.position=a.scaleAndAdd([],S._camera.position,ne.dir,-V),S._updateStateFromCamera());break}const Ee=a.sub([],S._camera.position,G);V=.5*a.length(Ee),S._camera.position=a.scaleAndAdd([],S._camera.position,ne.dir,V);try{S._updateStateFromCamera()}catch{return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++X<10);return{center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}}fitBounds(n,l,d){return this._fitInternal(this.cameraForBounds(n,l),l,d)}_raycastElevationBox(n,l){const d=this.transform.elevation;if(!d)return;const g=new a.pointGeometry(n.x,l.y),_=new a.pointGeometry(l.x,n.y),w=d.pointCoordinate(n);if(!w)return;const S=d.pointCoordinate(l);if(!S)return;const C=d.pointCoordinate(g);if(!C)return;const M=d.pointCoordinate(_);if(!M)return;const z=new a.MercatorCoordinate(w[0],w[1]).toLngLat(),R=new a.MercatorCoordinate(S[0],S[1]).toLngLat(),F=new a.MercatorCoordinate(C[0],C[1]).toLngLat(),O=new a.MercatorCoordinate(M[0],M[1]).toLngLat(),G=Math.min(z.lng,Math.min(R.lng,Math.min(F.lng,O.lng))),Z=Math.min(z.lat,Math.min(R.lat,Math.min(F.lat,O.lat))),ne=Math.max(z.lng,Math.max(R.lng,Math.max(F.lng,O.lng))),V=Math.max(z.lat,Math.max(R.lat,Math.max(F.lat,O.lat))),X=Math.min(w[3],Math.min(S[3],Math.min(C[3],M[3]))),te=Math.max(w[3],Math.max(S[3],Math.max(C[3],M[3])));return{minLngLat:new a.LngLat(G,Z),maxLngLat:new a.LngLat(ne,V),minAltitude:X,maxAltitude:te}}fitScreenCoordinates(n,l,d,g,_){let w,S,C,M;const z=a.pointGeometry.convert(n),R=a.pointGeometry.convert(l),F=this._raycastElevationBox(z,R);if(F)w=F.minLngLat,S=F.maxLngLat,C=F.minAltitude,M=F.maxAltitude;else{if(this.transform.isCornerOffEdge(z,R))return this;w=this.transform.pointLocation(z),S=this.transform.pointLocation(R)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(n)),this.transform.pointLocation(a.pointGeometry.convert(l)),d,g):this._cameraForBox(w,S,C,M,g),g,_)}_fitInternal(n,l,d){return n?(delete(l=a.extend(n,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this}jumpTo(n,l){this.stop();const d=this.transform;let g=!1,_=!1,w=!1;return"zoom"in n&&d.zoom!==+n.zoom&&(g=!0,d.zoom=+n.zoom),n.center!==void 0&&(d.center=a.LngLat.convert(n.center)),"bearing"in n&&d.bearing!==+n.bearing&&(_=!0,d.bearing=+n.bearing),"pitch"in n&&d.pitch!==+n.pitch&&(w=!0,d.pitch=+n.pitch),n.padding==null||d.isPaddingEqual(n.padding)||(d.padding=n.padding),this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),g&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),_&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),w&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,l){this.stop();const d=this.transform,g=d.zoom,_=d.pitch,w=d.bearing;d.setFreeCameraOptions(n);const S=g!==d.zoom,C=_!==d.pitch,M=w!==d.bearing;return this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),S&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),M&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),C&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l)),this}easeTo(n,l){this._stop(!1,n.easeId),((n=a.extend({offset:[0,0],duration:500,easing:a.ease},n)).animate===!1||!n.essential&&a.exported.prefersReducedMotion)&&(n.duration=0);const d=this.transform,g=this.getZoom(),_=this.getBearing(),w=this.getPitch(),S=this.getPadding(),C="zoom"in n?+n.zoom:g,M="bearing"in n?this._normalizeBearing(n.bearing,_):_,z="pitch"in n?+n.pitch:w,R="padding"in n?n.padding:d.padding,F=a.pointGeometry.convert(n.offset);let O=d.centerPoint.add(F);const G=d.pointLocation(O),Z=a.LngLat.convert(n.center||G);this._normalizeCenter(Z);const ne=d.project(G),V=d.project(Z).sub(ne),X=d.zoomScale(C-g);let te,se;n.around&&(te=a.LngLat.convert(n.around),se=d.locationPoint(te));const ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||C!==g,this._rotating=this._rotating||_!==M,this._pitching=this._pitching||z!==w,this._padding=!d.isPaddingEqual(R),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,ue),this._ease(Y=>{if(this._zooming&&(d.zoom=a.number(g,C,Y)),this._rotating&&(d.bearing=a.number(_,M,Y)),this._pitching&&(d.pitch=a.number(w,z,Y)),this._padding&&(d.interpolatePadding(S,R,Y),O=d.centerPoint.add(F)),te)d.setLocationAtPoint(te,se);else{const pe=d.zoomScale(d.zoom-g),ke=C>g?Math.min(2,X):Math.max(.5,X),De=Math.pow(ke,1-Y),de=d.unproject(ne.add(V.mult(Y*De)).mult(pe));d.setLocationAtPoint(d.renderWorldCopies?de.wrap():de,O)}this._fireMoveEvents(l)},Y=>{d.recenterOnTerrain(),this._afterEase(l,Y)},n),this}_prepareEase(n,l,d={}){this._moving=!0,this.transform.cameraElevationReference="sea",l||d.moving||this.fire(new a.Event("movestart",n)),this._zooming&&!d.zooming&&this.fire(new a.Event("zoomstart",n)),this._rotating&&!d.rotating&&this.fire(new a.Event("rotatestart",n)),this._pitching&&!d.pitching&&this.fire(new a.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new a.Event("move",n)),this._zooming&&this.fire(new a.Event("zoom",n)),this._rotating&&this.fire(new a.Event("rotate",n)),this._pitching&&this.fire(new a.Event("pitch",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId,this.transform.cameraElevationReference="ground";const d=this._zooming,g=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new a.Event("zoomend",n)),g&&this.fire(new a.Event("rotateend",n)),_&&this.fire(new a.Event("pitchend",n)),this.fire(new a.Event("moveend",n))}flyTo(n,l){if(!n.essential&&a.exported.prefersReducedMotion){const Ue=a.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ue,l)}this.stop(),n=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},n);const d=this.transform,g=this.getZoom(),_=this.getBearing(),w=this.getPitch(),S=this.getPadding(),C="zoom"in n?a.clamp(+n.zoom,d.minZoom,d.maxZoom):g,M="bearing"in n?this._normalizeBearing(n.bearing,_):_,z="pitch"in n?+n.pitch:w,R="padding"in n?n.padding:d.padding,F=d.zoomScale(C-g),O=a.pointGeometry.convert(n.offset);let G=d.centerPoint.add(O);const Z=d.pointLocation(G),ne=a.LngLat.convert(n.center||Z);this._normalizeCenter(ne);const V=d.project(Z),X=d.project(ne).sub(V);let te=n.curve;const se=Math.max(d.width,d.height),ue=se/F,Y=X.mag();if("minZoom"in n){const Ue=a.clamp(Math.min(n.minZoom,g,C),d.minZoom,d.maxZoom),it=se/d.zoomScale(Ue-g);te=Math.sqrt(it/Y*2)}const pe=te*te;function ke(Ue){const it=(ue*ue-se*se+(Ue?-1:1)*pe*pe*Y*Y)/(2*(Ue?ue:se)*pe*Y);return Math.log(Math.sqrt(it*it+1)-it)}function De(Ue){return(Math.exp(Ue)-Math.exp(-Ue))/2}function de(Ue){return(Math.exp(Ue)+Math.exp(-Ue))/2}const Ee=ke(0);let Je=function(Ue){return de(Ee)/de(Ee+te*Ue)},tt=function(Ue){return se*((de(Ee)*(De(it=Ee+te*Ue)/de(it))-De(Ee))/pe)/Y;var it},et=(ke(1)-Ee)/te;if(Math.abs(Y)<1e-6||!isFinite(et)){if(Math.abs(se-ue)<1e-6)return this.easeTo(n,l);const Ue=ue<se?-1:1;et=Math.abs(Math.log(ue/se))/te,tt=function(){return 0},Je=function(it){return Math.exp(Ue*te*it)}}return n.duration="duration"in n?+n.duration:1e3*et/("screenSpeed"in n?+n.screenSpeed/te:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=_!==M,this._pitching=z!==w,this._padding=!d.isPaddingEqual(R),this._prepareEase(l,!1),this._ease(Ue=>{const it=Ue*et,kt=1/Je(it);d.zoom=Ue===1?C:g+d.scaleZoom(kt),this._rotating&&(d.bearing=a.number(_,M,Ue)),this._pitching&&(d.pitch=a.number(w,z,Ue)),this._padding&&(d.interpolatePadding(S,R,Ue),G=d.centerPoint.add(O));const gt=Ue===1?ne:d.unproject(V.add(X.mult(tt(it))).mult(kt));d.setLocationAtPoint(d.renderWorldCopies?gt.wrap():gt,G),d._updateCenterElevation(),this._fireMoveEvents(l)},()=>this._afterEase(l),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,l)}if(!n){const d=this.handlers;d&&d.stop(!1)}return this}_ease(n,l,d){d.animate===!1||d.duration===0?(n(1),l()):(this._easeStart=a.exported.now(),this._easeOptions=d,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,l){n=a.wrap(n,-180,180);const d=Math.abs(n-l);return Math.abs(n-360-l)<d&&(n-=360),Math.abs(n+360-l)<d&&(n+=360),n}_normalizeCenter(n){const l=this.transform;if(!l.renderWorldCopies||l.lngRange)return;const d=n.lng-l.center.lng;n.lng+=d>180?-360:d<-180?360:0}}class lu{constructor(n={}){this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const l=this.options&&this.options.compact;return this._map=n,this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=q.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(n,l){const d=this._map._getUIString(`AttributionControl.${l}`);n.title=d,n.setAttribute("aria-label",d)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){const d=l.reduce((g,_,w)=>(_.value&&(g+=`${_.key}=${_.value}${w<l.length-1?"&":""}`),g),"?");n.href=`${a.config.FEEDBACK_URL}/${d}${this._map._hash?this._map._hash.getHashString(!0):""}`,n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const l=this._map.style._sourceCaches;for(const g in l){const _=l[g];if(_.used){const w=_.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort((g,_)=>g.length-_.length),n=n.filter((g,_)=>{for(let w=_+1;w<n.length;w++)if(n[w].indexOf(g)>=0)return!1;return!0});const d=n.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,n.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class cu{constructor(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)}onAdd(n){this._map=n,this._container=q.create("div","mapboxgl-ctrl");const l=q.create("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){q.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const l in n){const d=n[l].getSource();if(d.hasOwnProperty("mapbox_logo")&&!d.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const l=n[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class uu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,d=l?this._queue.concat(l):this._queue;for(const g of d)if(g.id===n)return void(g.cancelled=!0)}run(n=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const d of l)if(!d.cancelled&&(d.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function hu(h,n,l){if(h=new a.LngLat(h.lng,h.lat),n){const d=new a.LngLat(h.lng-360,h.lat),g=new a.LngLat(h.lng+360,h.lat),_=360*Math.ceil(Math.abs(h.lng-l.center.lng)/360),w=l.locationPoint(h).distSqr(n),S=n.x<0||n.y<0||n.x>l.width||n.y>l.height;l.locationPoint(d).distSqr(n)<w&&(S||Math.abs(d.lng-l.center.lng)<_)?h=d:l.locationPoint(g).distSqr(n)<w&&(S||Math.abs(g.lng-l.center.lng)<_)&&(h=g)}for(;Math.abs(h.lng-l.center.lng)>180;){const d=l.locationPoint(h);if(d.x>=0&&d.y>=0&&d.x<=l.width&&d.y<=l.height)break;h.lng>l.center.lng?h.lng-=360:h.lng+=360}return h}const xl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class vl extends a.Evented{constructor(n,l){if(super(),(n instanceof a.window.HTMLElement||l)&&(n=a.extend({element:n},l)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=a.pointGeometry.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div"),this._element.setAttribute("aria-label","Map marker");const g=q.createNS("http://www.w3.org/2000/svg","svg"),_=41,w=27;g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height",`${_}px`),g.setAttributeNS(null,"width",`${w}px`),g.setAttributeNS(null,"viewBox",`0 0 ${w} ${_}`);const S=q.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const C=q.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill-rule","nonzero");const M=q.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of z){const se=q.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",te.rx),se.setAttributeNS(null,"ry",te.ry),M.appendChild(se)}const R=q.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const F=q.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(F);const O=q.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const G=q.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(G);const Z=q.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const ne=q.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const V=q.createNS("http://www.w3.org/2000/svg","circle");V.setAttributeNS(null,"fill","#000000"),V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"cx","5.5"),V.setAttributeNS(null,"cy","5.5"),V.setAttributeNS(null,"r","5.4999962");const X=q.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#FFFFFF"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962"),ne.appendChild(V),ne.appendChild(X),C.appendChild(M),C.appendChild(R),C.appendChild(O),C.appendChild(Z),C.appendChild(ne),g.appendChild(C),g.setAttributeNS(null,"height",_*this._scale+"px"),g.setAttributeNS(null,"width",w*this._scale+"px"),this._element.appendChild(g),this._offset=a.pointGeometry.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()});const d=this._element.classList;for(const g in xl)d.remove(`mapboxgl-marker-anchor-${g}`);d.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const l=38.1,d=13.5,g=Math.sqrt(Math.pow(d,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-l],"bottom-left":[g,-1*(l-d+g)],"bottom-right":[-g,-1*(l-d+g)],left:[d,-1*(l-d)],right:[-d,-1*(l-d)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(n){const l=n.code,d=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&d!==32&&d!==13||this.togglePopup()}_onMapClick(n){const l=n.originalEvent.target,d=this._element;this._popup&&(l===d||d.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}_evaluateOpacity(){const n=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(n))return void this._clearFadeTimer();const l=this._map.unproject(n);let d=!1;if(this._map.getTerrain()){const _=this._map.getFreeCameraOptions();if(_.position){const w=_.position.toLngLat();d=w.distanceTo(l)<.9*w.distanceTo(this._lngLat)}}const g=(1-this._map._queryFogOpacity(l))*(d?.2:1);this._element.style.opacity=`${g}`,this._popup&&this._popup._setOpacity(`${g}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(n){const l=this._map.transform;return!!n&&n.x>=0&&n.x<l.width&&n.y>=0&&n.y<l.height}_update(n){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=hu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(l=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let d="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?d="rotateX(0deg)":this._pitchAlignment==="map"&&(d=`rotateX(${this._map.getPitch()}deg)`),n&&n.type!=="moveend"||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&q.setTransform(this._element,`${xl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${d} ${l}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const n=this._map.transform,l=this._offset.mult(this._scale);return this._rotationAlignment==="map"&&l._rotate(n.angle),this._pitchAlignment==="map"&&(l.y*=Math.cos(n._pitch)),l}getOffset(){return this._offset}setOffset(n){return this._offset=a.pointGeometry.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Td{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const l=a.easeCubicInOut((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,l,d){this._start=this.getValue(l),this._end=n,this._startTime=l,this._endTime=l+d}}const du={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:fa,HTMLElement:Sd,ImageBitmap:Po}=a.window,Ed={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function ma(h){h.parentNode&&h.parentNode.removeChild(h)}const Cd={showCompass:!0,showZoom:!0,visualizePitch:!1};class pu{constructor(n,l,d=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new ru({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,d&&(this.mousePitch=new Vi({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),q.addEventListener(l,"mousedown",this.mousedown),q.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(l,"touchmove",this.touchmove),q.addEventListener(l,"touchend",this.touchend),q.addEventListener(l,"touchcancel",this.reset)}down(n,l){this.mouseRotate.mousedown(n,l),this.mousePitch&&this.mousePitch.mousedown(n,l),q.disableDrag()}move(n,l){const d=this.map,g=this.mouseRotate.mousemoveWindow(n,l);if(g&&g.bearingDelta&&d.setBearing(d.getBearing()+g.bearingDelta),this.mousePitch){const _=this.mousePitch.mousemoveWindow(n,l);_&&_.pitchDelta&&d.setPitch(d.getPitch()+_.pitchDelta)}}off(){const n=this.element;q.removeEventListener(n,"mousedown",this.mousedown),q.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(n,"touchmove",this.touchmove),q.removeEventListener(n,"touchend",this.touchend),q.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){q.enableDrag(),q.removeEventListener(a.window,"mousemove",this.mousemove),q.removeEventListener(a.window,"mouseup",this.mouseup)}mousedown(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),q.mousePos(this.element,n)),q.addEventListener(a.window,"mousemove",this.mousemove),q.addEventListener(a.window,"mouseup",this.mouseup)}mousemove(n){this.move(n,q.mousePos(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const kd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let io,ds=0,Do=!1;const tm={maxWidth:100,unit:"metric"};function Id(h,n,l){const d=l&&l.maxWidth||100,g=h._container.getBoundingClientRect().height/2,_=h.unproject([0,g]),w=h.unproject([d,g]),S=_.distanceTo(w);if(l&&l.unit==="imperial"){const C=3.2808*S;C>5280?Ro(n,d,C/5280,h._getUIString("ScaleControl.Miles"),h):Ro(n,d,C,h._getUIString("ScaleControl.Feet"),h)}else l&&l.unit==="nautical"?Ro(n,d,S/1852,h._getUIString("ScaleControl.NauticalMiles"),h):S>=1e3?Ro(n,d,S/1e3,h._getUIString("ScaleControl.Kilometers"),h):Ro(n,d,S,h._getUIString("ScaleControl.Meters"),h)}function Ro(h,n,l,d,g){const _=function(S){const C=Math.pow(10,`${Math.floor(S)}`.length-1);let M=S/C;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(z){const R=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*R)/R}(M),C*M}(l),w=_/l;g._requestDomTask(()=>{h.style.width=n*w+"px",h.innerHTML=`${_}&nbsp;${d}`})}const Ad={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Md=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),wl={version:a.version,supported:B,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends yl{constructor(h){if((h=a.extend({},Ed,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new cs(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._renderTaskQueue=new uu,this._domRenderTaskQueue=new uu,this._controls=[],this._markers=[],this._mapId=a.uniqueId(),this._locale=a.extend({},du,h.locale),this._clickTolerance=h.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Td(0),this._requestManager=new a.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,typeof h.container=="string"){if(this._container=a.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof Sd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new au(this,h),this._hash=h.hash&&new od(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,a.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.attributionControl&&this.addControl(new lu({customAttribution:h.customAttribution})),this._logoControl=new cu,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new a.Event(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new a.Event(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(h,n){if(n===void 0&&(n=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=h.onAdd(this);this._controls.push(h);const d=this._controlPositions[n];return n.indexOf("bottom")!==-1?d.insertBefore(l,d.firstChild):d.appendChild(l),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(h);return n>-1&&this._controls.splice(n,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){const[n,l]=this._containerDimensions();if(n===this.transform.width&&l===this.transform.height)return this;this._resizeCanvas(n,l),this.transform.resize(n,l),this.painter.resize(Math.ceil(n),Math.ceil(l));const d=!this._moving;return d&&this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),this.fire(new a.Event("resize",h)),d&&this.fire(new a.Event("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(a.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?85:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}project(h){return this.transform.locationPoint3D(a.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(a.pointGeometry.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(h,n,l){if(h==="mouseenter"||h==="mouseover"){let d=!1;return{layer:n,listener:l,delegates:{mousemove:_=>{const w=this.getLayer(n)?this.queryRenderedFeatures(_.point,{layers:[n]}):[];w.length?d||(d=!0,l.call(this,new br(h,this,_.originalEvent,{features:w}))):d=!1},mouseout:()=>{d=!1}}}}if(h==="mouseleave"||h==="mouseout"){let d=!1;return{layer:n,listener:l,delegates:{mousemove:w=>{(this.getLayer(n)?this.queryRenderedFeatures(w.point,{layers:[n]}):[]).length?d=!0:d&&(d=!1,l.call(this,new br(h,this,w.originalEvent)))},mouseout:w=>{d&&(d=!1,l.call(this,new br(h,this,w.originalEvent)))}}}}{const d=g=>{const _=this.getLayer(n)?this.queryRenderedFeatures(g.point,{layers:[n]}):[];_.length&&(g.features=_,l.call(this,g),delete g.features)};return{layer:n,listener:l,delegates:{[h]:d}}}}on(h,n,l){if(l===void 0)return super.on(h,n);const d=this._createDelegatedListener(h,n,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(d);for(const g in d.delegates)this.on(g,d.delegates[g]);return this}once(h,n,l){if(l===void 0)return super.once(h,n);const d=this._createDelegatedListener(h,n,l);for(const g in d.delegates)this.once(g,d.delegates[g]);return this}off(h,n,l){return l===void 0?super.off(h,n):(this._delegatedListeners&&this._delegatedListeners[h]&&(d=>{const g=this._delegatedListeners[h];for(let _=0;_<g.length;_++){const w=g[_];if(w.layer===n&&w.listener===l){for(const S in w.delegates)this.off(S,w.delegates[S]);return g.splice(_,1),this}}})(),this)}queryRenderedFeatures(h,n){return this.style?(n!==void 0||h===void 0||h instanceof a.pointGeometry||Array.isArray(h)||(n=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(h,n){return this.style.querySourceFeatures(h,n)}queryTerrainElevation(h,n){const l=this.transform.elevation;return l?(n=a.extend({},{exaggerated:!0},n),l.getAtPoint(a.MercatorCoordinate.fromLngLat(h),null,n.exaggerated)):null}setStyle(h,n){return(n=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(h,n))}_getUIString(h){const n=this._locale[h];if(n==null)throw new Error(`Missing UI string '${h}'`);return n}_updateStyle(h,n){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),h&&(this.style=new di(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new di(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,n){if(typeof h=="string"){const l=this._requestManager.normalizeStyleURL(h),d=this._requestManager.transformRequest(l,a.ResourceType.Style);a.getJSON(d,(g,_)=>{g?this.fire(new a.ErrorEvent(g)):_&&this._updateDiff(_,n)})}else typeof h=="object"&&this._updateDiff(h,n)}_updateDiff(h,n){try{this.style.setState(h)&&this._update(!0)}catch(l){a.warnOnce(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(h,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(h,n){return this._lazyInitEmptyStyle(),this.style.addSource(h,n),this._update(!0)}isSourceLoaded(h){const n=this.style&&this.style._getSourceCaches(h);if(n.length!==0)return n.every(l=>l.loaded());this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const n in h){const l=h[n]._tiles;for(const d in l){const g=l[d];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}addSourceType(h,n,l){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,n,l)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,n,{pixelRatio:l=1,sdf:d=!1,stretchX:g,stretchY:_,content:w}={}){if(this._lazyInitEmptyStyle(),n instanceof fa||Po&&n instanceof Po){const{width:S,height:C,data:M}=a.exported.getImageData(n);this.style.addImage(h,{data:new a.RGBAImage({width:S,height:C},M),pixelRatio:l,stretchX:g,stretchY:_,content:w,sdf:d,version:0})}else{if(n.width===void 0||n.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:S,height:C,data:M}=n,z=n;this.style.addImage(h,{data:new a.RGBAImage({width:S,height:C},new Uint8Array(M)),pixelRatio:l,stretchX:g,stretchY:_,content:w,sdf:d,version:0,userImage:z}),z.onAdd&&z.onAdd(this,h)}}}updateImage(h,n){const l=this.style.getImage(h);if(!l)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=n instanceof fa||Po&&n instanceof Po?a.exported.getImageData(n):n,{width:g,height:_,data:w}=d;return g===void 0||_===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):g!==l.data.width||_!==l.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(l.data.replace(w,!(n instanceof fa||Po&&n instanceof Po)),void this.style.updateImage(h,l))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,n){a.getImage(this._requestManager.transformRequest(h,a.ResourceType.Image),(l,d)=>{n(l,d instanceof fa?a.exported.getImageData(d):d)})}listImages(){return this.style.listImages()}addLayer(h,n){return this._lazyInitEmptyStyle(),this.style.addLayer(h,n),this._update(!0)}moveLayer(h,n){return this.style.moveLayer(h,n),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,n,l){return this.style.setLayerZoomRange(h,n,l),this._update(!0)}setFilter(h,n,l={}){return this.style.setFilter(h,n,l),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,n,l,d={}){return this.style.setPaintProperty(h,n,l,d),this._update(!0)}getPaintProperty(h,n){return this.style.getPaintProperty(h,n)}setLayoutProperty(h,n,l,d={}){return this.style.setLayoutProperty(h,n,l,d),this._update(!0)}getLayoutProperty(h,n){return this.style.getLayoutProperty(h,n)}setLight(h,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,n),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(h),this.transform):0}setFeatureState(h,n){return this.style.setFeatureState(h,n),this._update()}removeFeatureState(h,n){return this.style.removeFeatureState(h,n),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_containerDimensions(){let h=0,n=0;return this._container&&(h=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300),[h,n]}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=q.create("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=q.create("div","mapboxgl-canvas-container",h);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=q.create("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const l=this._containerDimensions();this._resizeCanvas(l[0],l[1]);const d=this._controlContainer=q.create("div","mapboxgl-control-container",h),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{g[_]=q.create("div",`mapboxgl-ctrl-${_}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,n){const l=a.exported.devicePixelRatio||1;this._canvas.width=l*Math.ceil(h),this._canvas.height=l*Math.ceil(n),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${n}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const n=this._markers.indexOf(h);n!==-1&&this._markers.splice(n,1)}_setupPainter(){const h=a.extend({},B.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);n?(a.storeAuthState(n,!0),this.painter=new hl(n,this.transform),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(n)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.isMoving()&&this.loaded()?h():this._domRenderTaskQueue.add(h)}_render(h){let n;const l=this.painter.context.extTimerQuery,d=a.exported.now();this.listens("gpu-timing-frame")&&(n=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,n));let g=this._updateAverageElevation(d);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;let _=!1;const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,M=a.exported.now();this.style.zoomHistory.update(C,M);const z=new a.EvaluationParameters(C,{now:M,fadeDuration:w,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),R=z.crossFadingFactor();R===1&&R===this._crossFadingFactor||(_=!0,this._crossFadingFactor=R),this.style.update(z)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||_)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const C=a.exported.now()-d;l.endQueryEXT(l.TIME_ELAPSED_EXT,n),setTimeout(()=>{const M=l.getQueryObjectEXT(n,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(n),this.fire(new a.Event("gpu-timing-frame",{cpuTime:C,gpuTime:M}))},50)}if(this.listens("gpu-timing-layer")){const C=this.painter.collectGpuTimers();setTimeout(()=>{const M=this.painter.queryGpuTimers(C);this.fire(new a.Event("gpu-timing-layer",{layerTimes:M}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty||g;if(S||this._repaint)this.triggerRepaint();else{const C=!this.isMoving()&&this.loaded();if(C&&(g=this._updateAverageElevation(d,!0)),g)this.triggerRepaint();else if(this._triggerFrame(!1),C&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const M=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:M})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const h of this._markers)h._update()}_updateAverageElevation(h,n=!1){const l=d=>(this.transform.averageElevation=d,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);if((n||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const d=this.transform.averageElevation;let g=this.transform.sampleAverageElevation();isNaN(g)?g=0:this._averageElevationLastSampledAt=h;const _=Math.abs(d-g);if(_>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(g),l(g);this._averageElevation.easeTo(g,h,300)}else if(_>1e-4)return this._averageElevation.jumpTo(g),l(g)}return!!this._averageElevation.isEasing(h)&&l(this._averageElevation.getValue(h))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===a.AUTH_ERR_MSG||h.status===401)){const n=this.painter.context.gl;a.storeAuthState(n,!1),this._logoControl instanceof cu&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const l=this.painter.context.gl,d=l.createFramebuffer();function g(_){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,_,0);const w=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,w),w}return l.bindFramebuffer(l.FRAMEBUFFER,d),this._canvasPixelComparison(g(h),n.canvasCopies.map(g),n.timeStamps)}_canvasPixelComparison(h,n,l){let d=l[1]-l[0];const g=h.length/4;for(let _=0;_<n.length;_++){const w=n[_];let S=0;for(let C=0;C<w.length;C+=4)w[C]===h[C]&&w[C+1]===h[C+1]&&w[C+2]===h[C+2]&&w[C+3]===h[C+3]&&(S+=1);d+=(l[_+2]-l[_+1])*(1-S/g)}return d}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),ma(this._canvasContainer),ma(this._controlContainer),ma(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=a.exported.frame(n=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(n)}))}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,n){a.setCacheLimits(h,n)}get version(){return a.version}},NavigationControl:class{constructor(h){this.options=a.extend({},Cd,h),this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),q.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),q.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=q.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const h=this._map.getZoom(),n=h===this._map.getMaxZoom(),l=h===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,n){const l=q.create("button",h,this._container);return l.type="button",l.addEventListener("click",n),l}_setButtonTitle(h,n){const l=this._map._getUIString(`NavigationControl.${n}`);h.title=l,h.setAttribute("aria-label",l)}},GeolocateControl:class extends a.Evented{constructor(h){super(),this.options=a.extend({},kd,h),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=id(this._updateMarkerRotation,20)}onAdd(h){var n;return this._map=h,this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,io!==void 0?n(io):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(l=>{io=l.state!=="denied",n(io)}):(io=!!a.window.navigator.geolocation,n(io)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ds=0,Do=!1}_isOutOfMapMaxBounds(h){const n=this._map.getMaxBounds(),l=h.coords;return n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",h)),this._finish()}}_updateCamera(h){const n=new a.LngLat(h.coords.longitude,h.coords.latitude),l=h.coords.accuracy,d=this._map.getBearing(),g=a.extend({bearing:d},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(l),g,{geolocateSource:!0})}_updateMarker(h){if(h){const n=new a.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map._container.getBoundingClientRect().height/2,n=this._map.unproject([0,h]),l=this._map.unproject([100,h]),d=n.distanceTo(l)/100,g=Math.ceil(2*this._accuracy/d);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&Do)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=q.create("button","mapboxgl-ctrl-geolocate",this._container),q.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",h===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","mapboxgl-user-location"),this._dotElement.appendChild(q.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(q.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new vl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=q.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new vl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ds--,Do=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ds++,ds>1?(h={maximumAge:6e5,timeout:0},Do=!0):(h=this.options.positionOptions,Do=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&h()}).catch(console.error):h()}_clearWatch(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:lu,ScaleControl:class{constructor(h){this.options=a.extend({},tm,h),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Id(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,Id(this._map,this._container,this.options)}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof a.window.HTMLElement?this._container=h.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){q.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=q.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);q.create("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden",!0),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(h){super(),this.options=a.extend(Object.create(Ad),h),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=a.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(a.window.document.createTextNode(h))}setHTML(h){const n=a.window.document.createDocumentFragment(),l=a.window.document.createElement("body");let d;for(l.innerHTML=h;d=l.firstChild,d;)n.appendChild(d);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._container&&this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._container&&this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let n;return this._classList.delete(h)?n=!1:(this._classList.add(h),n=!0),this._container&&this._updateClassList(),n}_createCloseButton(){this.options.closeButton&&(this._closeButton=q.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const n=this._pos,l=this._container.offsetWidth,d=this._container.offsetHeight;let g;return g=n.y+h.bottom.y<d?["top"]:n.y>this._map.transform.height-d?["bottom"]:[],n.x<l/2?g.push("left"):n.x>this._map.transform.width-l/2&&g.push("right"),g.length===0?"bottom":g.join("-")}_updateClassList(){const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),this._container.className=h.join(" ")}_update(h){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=q.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=q.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hu(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h){const n=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),l=function(_){if(_||(_=new a.pointGeometry(0,0)),typeof _=="number"){const w=Math.round(Math.sqrt(.5*Math.pow(_,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,_),"top-left":new a.pointGeometry(w,w),"top-right":new a.pointGeometry(-w,w),bottom:new a.pointGeometry(0,-_),"bottom-left":new a.pointGeometry(w,-w),"bottom-right":new a.pointGeometry(-w,-w),left:new a.pointGeometry(_,0),right:new a.pointGeometry(-_,0)}}if(_ instanceof a.pointGeometry||Array.isArray(_)){const w=a.pointGeometry.convert(_);return{center:w,top:w,"top-left":w,"top-right":w,bottom:w,"bottom-left":w,"bottom-right":w,left:w,right:w}}return{center:a.pointGeometry.convert(_.center||[0,0]),top:a.pointGeometry.convert(_.top||[0,0]),"top-left":a.pointGeometry.convert(_["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(_["top-right"]||[0,0]),bottom:a.pointGeometry.convert(_.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(_["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(_["bottom-right"]||[0,0]),left:a.pointGeometry.convert(_.left||[0,0]),right:a.pointGeometry.convert(_.right||[0,0])}}(this.options.offset),d=this._anchor=this._getAnchor(l),g=n.add(l[d]).round();this._map._requestDomTask(()=>{this._container&&d&&q.setTransform(this._container,`${xl[d]} translate(${g.x}px,${g.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(Md);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._content&&(this._content.style.opacity=h),this._tip&&(this._tip.style.opacity=h)}},Marker:vl,Style:di,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:pl,Evented:a.Evented,config:a.config,prewarm:function(){Ze().acquire(le)},clearPrewarmedResources:function(){const h=ze;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(le),ze=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(h){a.config.ACCESS_TOKEN=h},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(h){a.config.API_URL=h},get workerCount(){return ge.workerCount},set workerCount(h){ge.workerCount=h},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){a.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){a.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return wl});var k=x;return k})})(u2);var wD=u2.exports;const tz=c2();var Py=tz;function Ti({props:t,name:o}){return uM({props:t,name:o,defaultTheme:Py})}const nz=t=>Df(t)&&t!=="classes",rz=lM({defaultTheme:Py,rootShouldForwardProp:nz});var Dr=rz;function iz(t){return vi("MuiPaper",t)}ii("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const oz=["className","component","elevation","square","variant"],d2=t=>{let o;return t<1?o=5.11916*t**2:o=4.5*Math.log(t+1)+2,(o/100).toFixed(2)},sz=t=>{const{square:o,elevation:c,variant:m,classes:x}=t,T={root:["root",m,!o&&"rounded",m==="elevation"&&`elevation${c}`]};return Li(T,iz,x)},az=Dr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,o[c.variant],!c.square&&o.rounded,c.variant==="elevation"&&o[`elevation${c.elevation}`]]}})(({theme:t,ownerState:o})=>Ke({backgroundColor:t.palette.background.paper,color:t.palette.text.primary,transition:t.transitions.create("box-shadow")},!o.square&&{borderRadius:t.shape.borderRadius},o.variant==="outlined"&&{border:`1px solid ${t.palette.divider}`},o.variant==="elevation"&&Ke({boxShadow:t.shadows[o.elevation]},t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${qs("#fff",d2(o.elevation))}, ${qs("#fff",d2(o.elevation))})`}))),lz=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiPaper"}),{className:x,component:T="div",elevation:k=1,square:a=!1,variant:B="elevation"}=m,W=fn(m,oz),ce=Ke({},m,{component:T,elevation:k,square:a,variant:B}),J=sz(ce);return Xt(az,Ke({as:T,ownerState:ce,className:Cn(J.root,x),ref:c},W))});var cz=lz;function uz(t){return vi("MuiAppBar",t)}ii("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);const hz=["className","color","enableColorOnDark","position"],dz=t=>{const{color:o,position:c,classes:m}=t,x={root:["root",`color${On(o)}`,`position${On(c)}`]};return Li(x,uz,m)},pz=Dr(cz,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,o[`position${On(c.position)}`],o[`color${On(c.color)}`]]}})(({theme:t,ownerState:o})=>{const c=t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[900];return Ke({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},o.position==="fixed"&&{position:"fixed",zIndex:t.zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},o.position==="absolute"&&{position:"absolute",zIndex:t.zIndex.appBar,top:0,left:"auto",right:0},o.position==="sticky"&&{position:"sticky",zIndex:t.zIndex.appBar,top:0,left:"auto",right:0},o.position==="static"&&{position:"static"},o.position==="relative"&&{position:"relative"},o.color==="default"&&{backgroundColor:c,color:t.palette.getContrastText(c)},o.color&&o.color!=="default"&&o.color!=="inherit"&&o.color!=="transparent"&&{backgroundColor:t.palette[o.color].main,color:t.palette[o.color].contrastText},o.color==="inherit"&&{color:"inherit"},t.palette.mode==="dark"&&!o.enableColorOnDark&&{backgroundColor:null,color:null},o.color==="transparent"&&Ke({backgroundColor:"transparent",color:"inherit"},t.palette.mode==="dark"&&{backgroundImage:"none"}))}),fz=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiAppBar"}),{className:x,color:T="primary",enableColorOnDark:k=!1,position:a="fixed"}=m,B=fn(m,hz),W=Ke({},m,{color:T,position:a,enableColorOnDark:k}),ce=dz(W);return Xt(pz,Ke({square:!0,component:"header",ownerState:W,elevation:4,className:Cn(ce.root,x,a==="fixed"&&"mui-fixed"),ref:c},B))});var bD=fz;const mz=c2(),gz=JA({defaultTheme:mz});var TD=gz;function _z(t){return vi("MuiToolbar",t)}ii("MuiToolbar",["root","gutters","regular","dense"]);const yz=["className","component","disableGutters","variant"],xz=t=>{const{classes:o,disableGutters:c,variant:m}=t;return Li({root:["root",!c&&"gutters",m]},_z,o)},vz=Dr("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,!c.disableGutters&&o.gutters,o[c.variant]]}})(({theme:t,ownerState:o})=>Ke({position:"relative",display:"flex",alignItems:"center"},!o.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},o.variant==="dense"&&{minHeight:48}),({theme:t,ownerState:o})=>o.variant==="regular"&&t.mixins.toolbar),wz=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiToolbar"}),{className:x,component:T="div",disableGutters:k=!1,variant:a="regular"}=m,B=fn(m,yz),W=Ke({},m,{component:T,disableGutters:k,variant:a}),ce=xz(W);return Xt(vz,Ke({as:T,className:Cn(ce.root,x),ref:c,ownerState:W},B))});var SD=wz;function bz(t){return vi("MuiTypography",t)}ii("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const Tz=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Sz=t=>{const{align:o,gutterBottom:c,noWrap:m,paragraph:x,variant:T,classes:k}=t,a={root:["root",T,t.align!=="inherit"&&`align${On(o)}`,c&&"gutterBottom",m&&"noWrap",x&&"paragraph"]};return Li(a,bz,k)},Ez=Dr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,c.variant&&o[c.variant],c.align!=="inherit"&&o[`align${On(c.align)}`],c.noWrap&&o.noWrap,c.gutterBottom&&o.gutterBottom,c.paragraph&&o.paragraph]}})(({theme:t,ownerState:o})=>Ke({margin:0},o.variant&&t.typography[o.variant],o.align!=="inherit"&&{textAlign:o.align},o.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o.gutterBottom&&{marginBottom:"0.35em"},o.paragraph&&{marginBottom:16})),p2={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Cz={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},kz=t=>Cz[t]||t,Iz=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiTypography"}),x=kz(m.color),T=Qb(Ke({},m,{color:x})),{align:k="inherit",className:a,component:B,gutterBottom:W=!1,noWrap:ce=!1,paragraph:J=!1,variant:q="body1",variantMapping:ve=p2}=T,Ae=fn(T,Tz),Se=Ke({},T,{align:k,color:x,className:a,component:B,gutterBottom:W,noWrap:ce,paragraph:J,variant:q,variantMapping:ve}),ee=B||(J?"p":ve[q]||p2[q])||"span",Q=Sz(Se);return Xt(Ez,Ke({as:ee,ref:c,ownerState:Se,className:Cn(Q.root,a)},Ae))});var Bf=Iz,Dy={},Ff={exports:{}};(function(t){function o(c){return c&&c.__esModule?c:{default:c}}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0})(Ff);var Of={};function Az(t){return vi("MuiSvgIcon",t)}ii("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Mz=["children","className","color","component","fontSize","htmlColor","titleAccess","viewBox"],zz=t=>{const{color:o,fontSize:c,classes:m}=t,x={root:["root",o!=="inherit"&&`color${On(o)}`,`fontSize${On(c)}`]};return Li(x,Az,m)},Pz=Dr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,c.color!=="inherit"&&o[`color${On(c.color)}`],o[`fontSize${On(c.fontSize)}`]]}})(({theme:t,ownerState:o})=>{var c,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:t.transitions.create("fill",{duration:t.transitions.duration.shorter}),fontSize:{inherit:"inherit",small:t.typography.pxToRem(20),medium:t.typography.pxToRem(24),large:t.typography.pxToRem(35)}[o.fontSize],color:(c=(m=t.palette[o.color])==null?void 0:m.main)!=null?c:{action:t.palette.action.active,disabled:t.palette.action.disabled,inherit:void 0}[o.color]}}),f2=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiSvgIcon"}),{children:x,className:T,color:k="inherit",component:a="svg",fontSize:B="medium",htmlColor:W,titleAccess:ce,viewBox:J="0 0 24 24"}=m,q=fn(m,Mz),ve=Ke({},m,{color:k,component:a,fontSize:B,viewBox:J}),Ae=zz(ve);return go(Pz,Ke({as:a,className:Cn(Ae.root,T),ownerState:ve,focusable:"false",viewBox:J,color:W,"aria-hidden":ce?void 0:!0,role:ce?"img":void 0,ref:c},q,{children:[x,ce?Xt("title",{children:ce}):null]}))});f2.muiName="SvgIcon";var m2=f2;function Dz(t,o){const c=(m,x)=>Xt(m2,Ke({"data-testid":`${o}Icon`,ref:x},m,{children:t}));return c.muiName=m2.muiName,Oe.exports.memo(Oe.exports.forwardRef(c))}var Rz=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",capitalize:On,createChainedFunction:$C,createSvgIcon:Dz,debounce:Qw,deprecatedPropType:jC,isMuiElement:Jw,ownerDocument:eb,ownerWindow:iy,requirePropFactory:GC,setRef:oy,unstable_useEnhancedEffect:Ih,unstable_useId:qC,unsupportedProp:WC,useControlled:XC,useEventCallback:Ah,useForkRef:$s,useIsFocusVisible:nb,unstable_ClassNameGenerator:ob}),Lz=Vx(Rz);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.createSvgIcon}});var o=Lz})(Of);var Ry=Vx(ck),Bz=Ff.exports;Object.defineProperty(Dy,"__esModule",{value:!0});var Fz=Dy.default=void 0,Oz=Bz(Of),Nz=Ry,Uz=(0,Oz.default)((0,Nz.jsx)("path",{d:"M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54 0 4.48-2.94 8.27-7 9.54.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2z"}),"Brightness3");Fz=Dy.default=Uz;var Ly={},Vz=Ff.exports;Object.defineProperty(Ly,"__esModule",{value:!0});var $z=Ly.default=void 0,jz=Vz(Of),Gz=Ry,Zz=(0,jz.default)((0,Gz.jsx)("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"Brightness7");$z=Ly.default=Zz;var By={},qz=Ff.exports;Object.defineProperty(By,"__esModule",{value:!0});var Wz=By.default=void 0,Xz=qz(Of),Hz=Ry,Kz=(0,Xz.default)((0,Hz.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");Wz=By.default=Kz;function Fy(t,o){return Fy=Object.setPrototypeOf||function(m,x){return m.__proto__=x,m},Fy(t,o)}function Yz(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,Fy(t,o)}var g2=Du.createContext(null);function Qz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Oy(t,o){var c=function(T){return o&&Oe.exports.isValidElement(T)?o(T):T},m=Object.create(null);return t&&Oe.exports.Children.map(t,function(x){return x}).forEach(function(x){m[x.key]=c(x)}),m}function Jz(t,o){t=t||{},o=o||{};function c(ce){return ce in o?o[ce]:t[ce]}var m=Object.create(null),x=[];for(var T in t)T in o?x.length&&(m[T]=x,x=[]):x.push(T);var k,a={};for(var B in o){if(m[B])for(k=0;k<m[B].length;k++){var W=m[B][k];a[m[B][k]]=c(W)}a[B]=c(B)}for(k=0;k<x.length;k++)a[x[k]]=c(x[k]);return a}function Ua(t,o,c){return c[o]!=null?c[o]:t.props[o]}function eP(t,o){return Oy(t.children,function(c){return Oe.exports.cloneElement(c,{onExited:o.bind(null,c),in:!0,appear:Ua(c,"appear",t),enter:Ua(c,"enter",t),exit:Ua(c,"exit",t)})})}function tP(t,o,c){var m=Oy(t.children),x=Jz(o,m);return Object.keys(x).forEach(function(T){var k=x[T];if(!!Oe.exports.isValidElement(k)){var a=T in o,B=T in m,W=o[T],ce=Oe.exports.isValidElement(W)&&!W.props.in;B&&(!a||ce)?x[T]=Oe.exports.cloneElement(k,{onExited:c.bind(null,k),in:!0,exit:Ua(k,"exit",t),enter:Ua(k,"enter",t)}):!B&&a&&!ce?x[T]=Oe.exports.cloneElement(k,{in:!1}):B&&a&&Oe.exports.isValidElement(W)&&(x[T]=Oe.exports.cloneElement(k,{onExited:c.bind(null,k),in:W.props.in,exit:Ua(k,"exit",t),enter:Ua(k,"enter",t)}))}}),x}var nP=Object.values||function(t){return Object.keys(t).map(function(o){return t[o]})},rP={component:"div",childFactory:function(o){return o}},Ny=function(t){Yz(o,t);function o(m,x){var T;T=t.call(this,m,x)||this;var k=T.handleExited.bind(Qz(T));return T.state={contextValue:{isMounting:!0},handleExited:k,firstRender:!0},T}var c=o.prototype;return c.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},c.componentWillUnmount=function(){this.mounted=!1},o.getDerivedStateFromProps=function(x,T){var k=T.children,a=T.handleExited,B=T.firstRender;return{children:B?eP(x,a):tP(x,k,a),firstRender:!1}},c.handleExited=function(x,T){var k=Oy(this.props.children);x.key in k||(x.props.onExited&&x.props.onExited(T),this.mounted&&this.setState(function(a){var B=Ke({},a.children);return delete B[x.key],{children:B}}))},c.render=function(){var x=this.props,T=x.component,k=x.childFactory,a=fn(x,["component","childFactory"]),B=this.state.contextValue,W=nP(this.state.children).map(k);return delete a.appear,delete a.enter,delete a.exit,T===null?Du.createElement(g2.Provider,{value:B},W):Du.createElement(g2.Provider,{value:B},Du.createElement(T,a,W))},o}(Du.Component);Ny.propTypes={};Ny.defaultProps=rP;var iP=Ny;function oP(t){const{className:o,classes:c,pulsate:m=!1,rippleX:x,rippleY:T,rippleSize:k,in:a,onExited:B,timeout:W}=t,[ce,J]=Oe.exports.useState(!1),q=Cn(o,c.ripple,c.rippleVisible,m&&c.ripplePulsate),ve={width:k,height:k,top:-(k/2)+T,left:-(k/2)+x},Ae=Cn(c.child,ce&&c.childLeaving,m&&c.childPulsate);return!a&&!ce&&J(!0),Oe.exports.useEffect(()=>{if(!a&&B!=null){const Se=setTimeout(B,W);return()=>{clearTimeout(Se)}}},[B,a,W]),Xt("span",{className:q,style:ve,children:Xt("span",{className:Ae})})}const sP=ii("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);var Bi=sP;const aP=["center","classes","className"];let Nf=t=>t,_2,y2,x2,v2;const Uy=550,lP=80,cP=xy(_2||(_2=Nf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),uP=xy(y2||(y2=Nf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),hP=xy(x2||(x2=Nf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),dP=Dr("span",{name:"MuiTouchRipple",slot:"Root",skipSx:!0})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),pP=Dr(oP,{name:"MuiTouchRipple",slot:"Ripple"})(v2||(v2=Nf`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Bi.rippleVisible,cP,Uy,({theme:t})=>t.transitions.easing.easeInOut,Bi.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Bi.child,Bi.childLeaving,uP,Uy,({theme:t})=>t.transitions.easing.easeInOut,Bi.childPulsate,hP,({theme:t})=>t.transitions.easing.easeInOut),fP=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiTouchRipple"}),{center:x=!1,classes:T={},className:k}=m,a=fn(m,aP),[B,W]=Oe.exports.useState([]),ce=Oe.exports.useRef(0),J=Oe.exports.useRef(null);Oe.exports.useEffect(()=>{J.current&&(J.current(),J.current=null)},[B]);const q=Oe.exports.useRef(!1),ve=Oe.exports.useRef(null),Ae=Oe.exports.useRef(null),Se=Oe.exports.useRef(null);Oe.exports.useEffect(()=>()=>{clearTimeout(ve.current)},[]);const ee=Oe.exports.useCallback(xe=>{const{pulsate:Ve,rippleX:Ie,rippleY:$e,rippleSize:We,cb:je}=xe;W(ot=>[...ot,Xt(pP,{classes:{ripple:Cn(T.ripple,Bi.ripple),rippleVisible:Cn(T.rippleVisible,Bi.rippleVisible),ripplePulsate:Cn(T.ripplePulsate,Bi.ripplePulsate),child:Cn(T.child,Bi.child),childLeaving:Cn(T.childLeaving,Bi.childLeaving),childPulsate:Cn(T.childPulsate,Bi.childPulsate)},timeout:Uy,pulsate:Ve,rippleX:Ie,rippleY:$e,rippleSize:We},ce.current)]),ce.current+=1,J.current=je},[T]),Q=Oe.exports.useCallback((xe={},Ve={},Ie)=>{const{pulsate:$e=!1,center:We=x||Ve.pulsate,fakeElement:je=!1}=Ve;if(xe.type==="mousedown"&&q.current){q.current=!1;return}xe.type==="touchstart"&&(q.current=!0);const ot=je?null:Se.current,zt=ot?ot.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Rt,St,Zt;if(We||xe.clientX===0&&xe.clientY===0||!xe.clientX&&!xe.touches)Rt=Math.round(zt.width/2),St=Math.round(zt.height/2);else{const{clientX:Ht,clientY:qt}=xe.touches?xe.touches[0]:xe;Rt=Math.round(Ht-zt.left),St=Math.round(qt-zt.top)}if(We)Zt=Math.sqrt((2*zt.width**2+zt.height**2)/3),Zt%2==0&&(Zt+=1);else{const Ht=Math.max(Math.abs((ot?ot.clientWidth:0)-Rt),Rt)*2+2,qt=Math.max(Math.abs((ot?ot.clientHeight:0)-St),St)*2+2;Zt=Math.sqrt(Ht**2+qt**2)}xe.touches?Ae.current===null&&(Ae.current=()=>{ee({pulsate:$e,rippleX:Rt,rippleY:St,rippleSize:Zt,cb:Ie})},ve.current=setTimeout(()=>{Ae.current&&(Ae.current(),Ae.current=null)},lP)):ee({pulsate:$e,rippleX:Rt,rippleY:St,rippleSize:Zt,cb:Ie})},[x,ee]),re=Oe.exports.useCallback(()=>{Q({},{pulsate:!0})},[Q]),Te=Oe.exports.useCallback((xe,Ve)=>{if(clearTimeout(ve.current),xe.type==="touchend"&&Ae.current){Ae.current(),Ae.current=null,ve.current=setTimeout(()=>{Te(xe,Ve)});return}Ae.current=null,W(Ie=>Ie.length>0?Ie.slice(1):Ie),J.current=Ve},[]);return Oe.exports.useImperativeHandle(c,()=>({pulsate:re,start:Q,stop:Te}),[re,Q,Te]),Xt(dP,Ke({className:Cn(T.root,Bi.root,k),ref:Se},a,{children:Xt(iP,{component:null,exit:!0,children:B})}))});var mP=fP;function gP(t){return vi("MuiButtonBase",t)}const _P=ii("MuiButtonBase",["root","disabled","focusVisible"]);var yP=_P;const xP=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","type"],vP=t=>{const{disabled:o,focusVisible:c,focusVisibleClassName:m,classes:x}=t,k=Li({root:["root",o&&"disabled",c&&"focusVisible"]},gP,x);return c&&m&&(k.root+=` ${m}`),k},wP=Dr("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,o)=>o.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${yP.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),bP=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiButtonBase"}),{action:x,centerRipple:T=!1,children:k,className:a,component:B="button",disabled:W=!1,disableRipple:ce=!1,disableTouchRipple:J=!1,focusRipple:q=!1,LinkComponent:ve="a",onBlur:Ae,onClick:Se,onContextMenu:ee,onDragLeave:Q,onFocus:re,onFocusVisible:Te,onKeyDown:xe,onKeyUp:Ve,onMouseDown:Ie,onMouseLeave:$e,onMouseUp:We,onTouchEnd:je,onTouchMove:ot,onTouchStart:zt,tabIndex:Rt=0,TouchRippleProps:St,type:Zt}=m,Ht=fn(m,xP),qt=Oe.exports.useRef(null),Wt=Oe.exports.useRef(null),{isFocusVisibleRef:xn,onFocus:an,onBlur:Ot,ref:He}=nb(),[Ye,ut]=Oe.exports.useState(!1);W&&Ye&&ut(!1),Oe.exports.useImperativeHandle(x,()=>({focusVisible:()=>{ut(!0),qt.current.focus()}}),[]),Oe.exports.useEffect(()=>{Ye&&q&&!ce&&Wt.current.pulsate()},[ce,q,Ye]);function Mt(ft,fr,vo=J){return Ah(Yi=>(fr&&fr(Yi),!vo&&Wt.current&&Wt.current[ft](Yi),!0))}const Jt=Mt("start",Ie),Nn=Mt("stop",ee),kn=Mt("stop",Q),_t=Mt("stop",We),Ft=Mt("stop",ft=>{Ye&&ft.preventDefault(),$e&&$e(ft)}),Un=Mt("start",zt),ai=Mt("stop",je),li=Mt("stop",ot),Ln=Mt("stop",ft=>{Ot(ft),xn.current===!1&&ut(!1),Ae&&Ae(ft)},!1),Rr=Ah(ft=>{qt.current||(qt.current=ft.currentTarget),an(ft),xn.current===!0&&(ut(!0),Te&&Te(ft)),re&&re(ft)}),At=()=>{const ft=qt.current;return B&&B!=="button"&&!(ft.tagName==="A"&&ft.href)},sr=Oe.exports.useRef(!1),jr=Ah(ft=>{q&&!sr.current&&Ye&&Wt.current&&ft.key===" "&&(sr.current=!0,Wt.current.stop(ft,()=>{Wt.current.start(ft)})),ft.target===ft.currentTarget&&At()&&ft.key===" "&&ft.preventDefault(),xe&&xe(ft),ft.target===ft.currentTarget&&At()&&ft.key==="Enter"&&!W&&(ft.preventDefault(),Se&&Se(ft))}),dr=Ah(ft=>{q&&ft.key===" "&&Wt.current&&Ye&&!ft.defaultPrevented&&(sr.current=!1,Wt.current.stop(ft,()=>{Wt.current.pulsate(ft)})),Ve&&Ve(ft),Se&&ft.target===ft.currentTarget&&At()&&ft.key===" "&&!ft.defaultPrevented&&Se(ft)});let In=B;In==="button"&&(Ht.href||Ht.to)&&(In=ve);const Gr={};In==="button"?(Gr.type=Zt===void 0?"button":Zt,Gr.disabled=W):(!Ht.href&&!Ht.to&&(Gr.role="button"),W&&(Gr["aria-disabled"]=W));const pr=$s(He,qt),ci=$s(c,pr),[Zr,Kn]=Oe.exports.useState(!1);Oe.exports.useEffect(()=>{Kn(!0)},[]);const Lr=Zr&&!ce&&!W,en=Ke({},m,{centerRipple:T,component:B,disabled:W,disableRipple:ce,disableTouchRipple:J,focusRipple:q,tabIndex:Rt,focusVisible:Ye}),Yn=vP(en);return go(wP,Ke({as:In,className:Cn(Yn.root,a),ownerState:en,onBlur:Ln,onClick:Se,onContextMenu:Nn,onFocus:Rr,onKeyDown:jr,onKeyUp:dr,onMouseDown:Jt,onMouseLeave:Ft,onMouseUp:_t,onDragLeave:kn,onTouchEnd:ai,onTouchMove:li,onTouchStart:Un,ref:ci,tabIndex:W?-1:Rt,type:Zt},Gr,Ht,{children:[k,Lr?Xt(mP,Ke({ref:Wt,center:T},St)):null]}))});var w2=bP;function TP(t){return vi("MuiIconButton",t)}const SP=ii("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]);var EP=SP;const CP=["edge","children","className","color","disabled","disableFocusRipple","size"],kP=t=>{const{classes:o,disabled:c,color:m,edge:x,size:T}=t,k={root:["root",c&&"disabled",m!=="default"&&`color${On(m)}`,x&&`edge${On(x)}`,`size${On(T)}`]};return Li(k,TP,o)},IP=Dr(w2,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,c.color!=="default"&&o[`color${On(c.color)}`],c.edge&&o[`edge${On(c.edge)}`],o[`size${On(c.size)}`]]}})(({theme:t,ownerState:o})=>Ke({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:t.palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{backgroundColor:qs(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.edge==="start"&&{marginLeft:o.size==="small"?-3:-12},o.edge==="end"&&{marginRight:o.size==="small"?-3:-12}),({theme:t,ownerState:o})=>Ke({},o.color==="inherit"&&{color:"inherit"},o.color!=="inherit"&&o.color!=="default"&&{color:t.palette[o.color].main,"&:hover":{backgroundColor:qs(t.palette[o.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},o.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${EP.disabled}`]:{backgroundColor:"transparent",color:t.palette.action.disabled}})),AP=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiIconButton"}),{edge:x=!1,children:T,className:k,color:a="default",disabled:B=!1,disableFocusRipple:W=!1,size:ce="medium"}=m,J=fn(m,CP),q=Ke({},m,{edge:x,color:a,disabled:B,disableFocusRipple:W,size:ce}),ve=kP(q);return Xt(IP,Ke({className:Cn(ve.root,k),centerRipple:!0,focusRipple:!W,disabled:B,ref:c,ownerState:q},J,{children:T}))});var ED=AP;function MP({props:t,states:o,muiFormControl:c}){return o.reduce((m,x)=>(m[x]=t[x],c&&typeof t[x]=="undefined"&&(m[x]=c[x]),m),{})}const zP=Oe.exports.createContext();var b2=zP;function PP(){return Oe.exports.useContext(b2)}function DP(t){return Xt(aI,Ke({},t,{defaultTheme:Py}))}function T2(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function RP(t,o=!1){return t&&(T2(t.value)&&t.value!==""||o&&T2(t.defaultValue)&&t.defaultValue!=="")}function LP(t){return vi("MuiInputBase",t)}const BP=ii("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var Vy=BP;const FP=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","startAdornment","type","value"],OP=(t,o)=>{const{ownerState:c}=t;return[o.root,c.formControl&&o.formControl,c.startAdornment&&o.adornedStart,c.endAdornment&&o.adornedEnd,c.error&&o.error,c.size==="small"&&o.sizeSmall,c.multiline&&o.multiline,c.color&&o[`color${On(c.color)}`],c.fullWidth&&o.fullWidth,c.hiddenLabel&&o.hiddenLabel]},NP=(t,o)=>{const{ownerState:c}=t;return[o.input,c.size==="small"&&o.inputSizeSmall,c.multiline&&o.inputMultiline,c.type==="search"&&o.inputTypeSearch,c.startAdornment&&o.inputAdornedStart,c.endAdornment&&o.inputAdornedEnd,c.hiddenLabel&&o.inputHiddenLabel]},UP=t=>{const{classes:o,color:c,disabled:m,error:x,endAdornment:T,focused:k,formControl:a,fullWidth:B,hiddenLabel:W,multiline:ce,size:J,startAdornment:q,type:ve}=t,Ae={root:["root",`color${On(c)}`,m&&"disabled",x&&"error",B&&"fullWidth",k&&"focused",a&&"formControl",J==="small"&&"sizeSmall",ce&&"multiline",q&&"adornedStart",T&&"adornedEnd",W&&"hiddenLabel"],input:["input",m&&"disabled",ve==="search"&&"inputTypeSearch",ce&&"inputMultiline",J==="small"&&"inputSizeSmall",W&&"inputHiddenLabel",q&&"inputAdornedStart",T&&"inputAdornedEnd"]};return Li(Ae,LP,o)},VP=Dr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:OP})(({theme:t,ownerState:o})=>Ke({},t.typography.body1,{color:t.palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Vy.disabled}`]:{color:t.palette.text.disabled,cursor:"default"}},o.multiline&&Ke({padding:"4px 0 5px"},o.size==="small"&&{paddingTop:1}),o.fullWidth&&{width:"100%"})),$P=Dr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:NP})(({theme:t,ownerState:o})=>{const c=t.palette.mode==="light",m={color:"currentColor",opacity:c?.42:.5,transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},x={opacity:"0 !important"},T={opacity:c?.42:.5};return Ke({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":m,"&::-moz-placeholder":m,"&:-ms-input-placeholder":m,"&::-ms-input-placeholder":m,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Vy.formControl} &`]:{"&::-webkit-input-placeholder":x,"&::-moz-placeholder":x,"&:-ms-input-placeholder":x,"&::-ms-input-placeholder":x,"&:focus::-webkit-input-placeholder":T,"&:focus::-moz-placeholder":T,"&:focus:-ms-input-placeholder":T,"&:focus::-ms-input-placeholder":T},[`&.${Vy.disabled}`]:{opacity:1,WebkitTextFillColor:t.palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},o.size==="small"&&{paddingTop:1},o.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},o.type==="search"&&{MozAppearance:"textfield",WebkitAppearance:"textfield"})}),jP=Xt(DP,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),GP=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiInputBase"}),{"aria-describedby":x,autoComplete:T,autoFocus:k,className:a,components:B={},componentsProps:W={},defaultValue:ce,disabled:J,endAdornment:q,fullWidth:ve=!1,id:Ae,inputComponent:Se="input",inputProps:ee={},inputRef:Q,maxRows:re,minRows:Te,multiline:xe=!1,name:Ve,onBlur:Ie,onChange:$e,onClick:We,onFocus:je,onKeyDown:ot,onKeyUp:zt,placeholder:Rt,readOnly:St,renderSuffix:Zt,rows:Ht,startAdornment:qt,type:Wt="text",value:xn}=m,an=fn(m,FP),Ot=ee.value!=null?ee.value:xn,{current:He}=Oe.exports.useRef(Ot!=null),Ye=Oe.exports.useRef(),ut=Oe.exports.useCallback(en=>{},[]),Mt=$s(ee.ref,ut),Jt=$s(Q,Mt),Nn=$s(Ye,Jt),[kn,_t]=Oe.exports.useState(!1),Ft=PP(),Un=MP({props:m,muiFormControl:Ft,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Un.focused=Ft?Ft.focused:kn,Oe.exports.useEffect(()=>{!Ft&&J&&kn&&(_t(!1),Ie&&Ie())},[Ft,J,kn,Ie]);const ai=Ft&&Ft.onFilled,li=Ft&&Ft.onEmpty,Ln=Oe.exports.useCallback(en=>{RP(en)?ai&&ai():li&&li()},[ai,li]);Ih(()=>{He&&Ln({value:Ot})},[Ot,Ln,He]);const Rr=en=>{if(Un.disabled){en.stopPropagation();return}je&&je(en),ee.onFocus&&ee.onFocus(en),Ft&&Ft.onFocus?Ft.onFocus(en):_t(!0)},At=en=>{Ie&&Ie(en),ee.onBlur&&ee.onBlur(en),Ft&&Ft.onBlur?Ft.onBlur(en):_t(!1)},sr=(en,...Yn)=>{if(!He){const ft=en.target||Ye.current;if(ft==null)throw new Error(mc(1));Ln({value:ft.value})}ee.onChange&&ee.onChange(en,...Yn),$e&&$e(en,...Yn)};Oe.exports.useEffect(()=>{Ln(Ye.current)},[]);const jr=en=>{Ye.current&&en.currentTarget===en.target&&Ye.current.focus(),We&&We(en)};let dr=Se,In=ee;xe&&dr==="input"&&(Ht?In=Ke({type:void 0,minRows:Ht,maxRows:Ht},In):In=Ke({type:void 0,maxRows:re,minRows:Te},In),dr=vM);const Gr=en=>{Ln(en.animationName==="mui-auto-fill-cancel"?Ye.current:{value:"x"})};Oe.exports.useEffect(()=>{Ft&&Ft.setAdornedStart(Boolean(qt))},[Ft,qt]);const pr=Ke({},m,{color:Un.color||"primary",disabled:Un.disabled,endAdornment:q,error:Un.error,focused:Un.focused,formControl:Ft,fullWidth:ve,hiddenLabel:Un.hiddenLabel,multiline:xe,size:Un.size,startAdornment:qt,type:Wt}),ci=UP(pr),Zr=B.Root||VP,Kn=W.root||{},Lr=B.Input||$P;return In=Ke({},In,W.input),go(Oe.exports.Fragment,{children:[jP,go(Zr,Ke({},Kn,!df(Zr)&&{ownerState:Ke({},pr,Kn.ownerState)},{ref:c,onClick:jr},an,{className:Cn(ci.root,Kn.className,a),children:[qt,Xt(b2.Provider,{value:null,children:Xt(Lr,Ke({ownerState:pr,"aria-invalid":Un.error,"aria-describedby":x,autoComplete:T,autoFocus:k,defaultValue:ce,disabled:Un.disabled,id:Ae,onAnimationStart:Gr,name:Ve,placeholder:Rt,readOnly:St,required:Un.required,rows:Ht,value:Ot,onKeyDown:ot,onKeyUp:zt,type:Wt},In,!df(Lr)&&{as:dr,ownerState:Ke({},pr,In.ownerState)},{ref:Nn,className:Cn(ci.input,In.className,ee.className),onBlur:At,onChange:sr,onFocus:Rr}))}),q,Zt?Zt(Ke({},Un,{startAdornment:qt})):null]}))]})});var CD=GP;const ZP=Oe.exports.createContext({});var Tc=ZP;function qP(t){return vi("MuiList",t)}ii("MuiList",["root","padding","dense","subheader"]);const WP=["children","className","component","dense","disablePadding","subheader"],XP=t=>{const{classes:o,disablePadding:c,dense:m,subheader:x}=t;return Li({root:["root",!c&&"padding",m&&"dense",x&&"subheader"]},qP,o)},HP=Dr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,!c.disablePadding&&o.padding,c.dense&&o.dense,c.subheader&&o.subheader]}})(({ownerState:t})=>Ke({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),KP=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiList"}),{children:x,className:T,component:k="ul",dense:a=!1,disablePadding:B=!1,subheader:W}=m,ce=fn(m,WP),J=Oe.exports.useMemo(()=>({dense:a}),[a]),q=Ke({},m,{component:k,dense:a,disablePadding:B}),ve=XP(q);return Xt(Tc.Provider,{value:J,children:go(HP,Ke({as:k,className:Cn(ve.root,T),ref:c,ownerState:q},ce,{children:[W,x]}))})});var kD=KP;function YP(t){return vi("MuiListItem",t)}const QP=ii("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]);var Sc=QP;const JP=ii("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);var eD=JP;function tD(t){return vi("MuiListItemSecondaryAction",t)}ii("MuiListItemSecondaryAction",["root","disableGutters"]);const nD=["className"],rD=t=>{const{disableGutters:o,classes:c}=t;return Li({root:["root",o&&"disableGutters"]},tD,c)},iD=Dr("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[o.root,c.disableGutters&&o.disableGutters]}})(({ownerState:t})=>Ke({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},t.disableGutters&&{right:0})),S2=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiListItemSecondaryAction"}),{className:x}=m,T=fn(m,nD),k=Oe.exports.useContext(Tc),a=Ke({},m,{disableGutters:k.disableGutters}),B=rD(a);return Xt(iD,Ke({className:Cn(B.root,x),ownerState:a,ref:c},T))});S2.muiName="ListItemSecondaryAction";var oD=S2;const sD=["className"],aD=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected"],lD=(t,o)=>{const{ownerState:c}=t;return[o.root,c.dense&&o.dense,c.alignItems==="flex-start"&&o.alignItemsFlexStart,c.divider&&o.divider,!c.disableGutters&&o.gutters,!c.disablePadding&&o.padding,c.button&&o.button,c.hasSecondaryAction&&o.secondaryAction]},cD=t=>{const{alignItems:o,button:c,classes:m,dense:x,disabled:T,disableGutters:k,disablePadding:a,divider:B,hasSecondaryAction:W,selected:ce}=t;return Li({root:["root",x&&"dense",!k&&"gutters",!a&&"padding",B&&"divider",T&&"disabled",c&&"button",o==="flex-start"&&"alignItemsFlexStart",W&&"secondaryAction",ce&&"selected"],container:["container"]},YP,m)},uD=Dr("div",{name:"MuiListItem",slot:"Root",overridesResolver:lD})(({theme:t,ownerState:o})=>Ke({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!o.disablePadding&&Ke({paddingTop:8,paddingBottom:8},o.dense&&{paddingTop:4,paddingBottom:4},!o.disableGutters&&{paddingLeft:16,paddingRight:16},!!o.secondaryAction&&{paddingRight:48}),!!o.secondaryAction&&{[`& > .${eD.root}`]:{paddingRight:48}},{[`&.${Sc.focusVisible}`]:{backgroundColor:t.palette.action.focus},[`&.${Sc.selected}`]:{backgroundColor:qs(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${Sc.focusVisible}`]:{backgroundColor:qs(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${Sc.disabled}`]:{opacity:t.palette.action.disabledOpacity}},o.alignItems==="flex-start"&&{alignItems:"flex-start"},o.divider&&{borderBottom:`1px solid ${t.palette.divider}`,backgroundClip:"padding-box"},o.button&&{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:t.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Sc.selected}:hover`]:{backgroundColor:qs(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:qs(t.palette.primary.main,t.palette.action.selectedOpacity)}}},o.hasSecondaryAction&&{paddingRight:48})),hD=Dr("li",{name:"MuiListItem",slot:"Container",overridesResolver:(t,o)=>o.container})({position:"relative"}),dD=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiListItem"}),{alignItems:x="center",autoFocus:T=!1,button:k=!1,children:a,className:B,component:W,components:ce={},componentsProps:J={},ContainerComponent:q="li",ContainerProps:{className:ve}={},dense:Ae=!1,disabled:Se=!1,disableGutters:ee=!1,disablePadding:Q=!1,divider:re=!1,focusVisibleClassName:Te,secondaryAction:xe,selected:Ve=!1}=m,Ie=fn(m.ContainerProps,sD),$e=fn(m,aD),We=Oe.exports.useContext(Tc),je={dense:Ae||We.dense||!1,alignItems:x,disableGutters:ee},ot=Oe.exports.useRef(null);Ih(()=>{T&&ot.current&&ot.current.focus()},[T]);const zt=Oe.exports.Children.toArray(a),Rt=zt.length&&Jw(zt[zt.length-1],["ListItemSecondaryAction"]),St=Ke({},m,{alignItems:x,autoFocus:T,button:k,dense:je.dense,disabled:Se,disableGutters:ee,disablePadding:Q,divider:re,hasSecondaryAction:Rt,selected:Ve}),Zt=cD(St),Ht=$s(ot,c),qt=ce.Root||uD,Wt=J.root||{},xn=Ke({className:Cn(Zt.root,Wt.className,B),disabled:Se},$e);let an=W||"li";return k&&(xn.component=W||"div",xn.focusVisibleClassName=Cn(Sc.focusVisible,Te),an=w2),Rt?(an=!xn.component&&!W?"div":an,q==="li"&&(an==="li"?an="div":xn.component==="li"&&(xn.component="div")),Xt(Tc.Provider,{value:je,children:go(hD,Ke({as:q,className:Cn(Zt.container,ve),ref:Ht,ownerState:St},Ie,{children:[Xt(qt,Ke({},Wt,!df(qt)&&{as:an,ownerState:Ke({},St,Wt.ownerState)},xn,{children:zt})),zt.pop()]}))})):Xt(Tc.Provider,{value:je,children:go(qt,Ke({},Wt,{as:an,ref:Ht,ownerState:St},!df(qt)&&{ownerState:Ke({},St,Wt.ownerState)},xn,{children:[zt,xe&&Xt(oD,{children:xe})]}))})});var ID=dD;function pD(t){return vi("MuiListItemText",t)}const fD=ii("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);var E2=fD;const mD=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],gD=t=>{const{classes:o,inset:c,primary:m,secondary:x,dense:T}=t;return Li({root:["root",c&&"inset",T&&"dense",m&&x&&"multiline"],primary:["primary"],secondary:["secondary"]},pD,o)},_D=Dr("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:c}=t;return[{[`& .${E2.primary}`]:o.primary},{[`& .${E2.secondary}`]:o.secondary},o.root,c.inset&&o.inset,c.primary&&c.secondary&&o.multiline,c.dense&&o.dense]}})(({ownerState:t})=>Ke({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})),yD=Oe.exports.forwardRef(function(o,c){const m=Ti({props:o,name:"MuiListItemText"}),{children:x,className:T,disableTypography:k=!1,inset:a=!1,primary:B,primaryTypographyProps:W,secondary:ce,secondaryTypographyProps:J}=m,q=fn(m,mD),{dense:ve}=Oe.exports.useContext(Tc);let Ae=B!=null?B:x,Se=ce;const ee=Ke({},m,{disableTypography:k,inset:a,primary:!!Ae,secondary:!!Se,dense:ve}),Q=gD(ee);return Ae!=null&&Ae.type!==Bf&&!k&&(Ae=Xt(Bf,Ke({variant:ve?"body2":"body1",className:Q.primary,component:"span",display:"block"},W,{children:Ae}))),Se!=null&&Se.type!==Bf&&!k&&(Se=Xt(Bf,Ke({variant:"body2",className:Q.secondary,color:"text.secondary",display:"block"},J,{children:Se}))),go(_D,Ke({className:Cn(Q.root,T),ownerState:ee,ref:c},q,{children:[Ae,Se]}))});var AD=yD;export{bD as A,TD as B,lk as F,CD as I,ID as L,cz as P,Du as R,Bf as T,AD as a,go as b,kD as c,qs as d,SD as e,ED as f,$z as g,Fz as h,Wz as i,Xt as j,u2 as k,c2 as l,wD as m,vD as n,xD as o,Oe as r,Dr as s};
